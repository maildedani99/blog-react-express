{"ast":null,"code":"import _defineProperty from\"/home/dani/Escritorio/Projects/blog-react-express/frontend-blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/dani/Escritorio/Projects/blog-react-express/frontend-blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/dani/Escritorio/Projects/blog-react-express/frontend-blog/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect,useContext}from'react';import Navbar from'../../components/navbar/navbar';import styles from'./postupdate.module.css';import{Editor}from'@tinymce/tinymce-react';import{useHistory}from'react-router-dom';import{useParams}from'react-router';import{LANDING}from'../../routes/routes';import{PostsContext}from'../../contexts/postcontext';import ReactHtmlParser from'react-html-parser';import swal from'sweetalert';var PostUpdate=function PostUpdate(){var _useParams=useParams(),id=_useParams.id;var _useContext=useContext(PostsContext),icons=_useContext.icons,getPost=_useContext.getPost,post=_useContext.post,render=_useContext.render,setRender=_useContext.setRender;var history=useHistory();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var handleInputChange=function handleInputChange(event){setData(_objectSpread(_objectSpread({},data),{},_defineProperty({},event.target.name,event.target.value)));console.log(data);};var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),wysiwyg=_useState4[0],setWysiwyg=_useState4[1];var handleEditorChange=function handleEditorChange(content){setWysiwyg(content);console.log(content);};var handleSelectChange=function handleSelectChange(event){setData({//...data,\nicon:event.target.value});};getPost(id);var submitForm=function submitForm(){var url=\"http://localhost/api/posts/update/\".concat(id);var body={title:data.title,icon_id:data.icon,description:data.description,content:wysiwyg};var options={method:'PATCH',headers:new Headers({'Content-type':'application/json'}),mode:'cors',body:JSON.stringify(body)};fetch(url,options).then(function(response){if(response.status===201||response.status===200){console.log(response.status);setRender(!render);swal('Enhorabuena','Post creado con exito','success');history.push(LANDING);return response.json();}else{return Promise.reject(response.status);}}).catch(function(error){return console.log(error);});};var initialData=function initialData(){{post&&setData(_objectSpread(_objectSpread({},data),{},{title:post.title,icon_id:post.icon_id,description:post.description,content:post.content}));}};useEffect(function(){getPost(id);initialData();console.log(data);},[id]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-muted mt-5\",children:\"Modificar Post\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.__div_form,children:[/*#__PURE__*/_jsx(\"select\",{className:\"form-control col-3 align-self-center\",defaultValue:post.icon_id,onChange:handleSelectChange,children:icons.map(function(item){return/*#__PURE__*/_jsx(\"option\",{className:styles.__option,value:item.id,label:item.name});})}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control col-6 align-self-center mt-5\",name:\"title\",type:\"text\",placeholder:\"title\",onChange:handleInputChange,defaultValue:post.title,initialValue:post.title}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control col-6 align-self-center mt-5\",name:\"description\",type:\"text\",placeholder:\"description\",onChange:handleInputChange,defaultValue:post.description,initialValue:post.description}),/*#__PURE__*/_jsx(\"div\",{className:\"form-control col-6 align-self-center mt-5\",children:/*#__PURE__*/_jsx(Editor,{initialValue:post.content,apiKey:\"z3chpr7kq0azccojyrbp99s6bab52o2f3t26a7hg1ge0iy93\",init:{height:500,menubar:false,plugins:['advlist autolink lists link image charmap print preview anchor','searchreplace visualblocks code fullscreen','insertdatetime media table paste code help wordcount'],toolbar:'undo redo | formatselect | bold italic backcolor | \\\n             alignleft aligncenter alignright alignjustify | \\\n             bullist numlist outdent indent | removeformat | help'},value:wysiwyg,onEditorChange:handleEditorChange})}),/*#__PURE__*/_jsx(\"input\",{className:\"btn btn-success btn-lg col-2 my-5 align-self-center\",name:\"button\",type:\"button\",value:\"Confirmar cambios\",onClick:submitForm})]})]});};export default PostUpdate;","map":{"version":3,"sources":["/home/dani/Escritorio/Projects/blog-react-express/frontend-blog/src/pages/postupdateview/postUpdateview.js"],"names":["React","useState","useEffect","useContext","Navbar","styles","Editor","useHistory","useParams","LANDING","PostsContext","ReactHtmlParser","swal","PostUpdate","id","icons","getPost","post","render","setRender","history","data","setData","handleInputChange","event","target","name","value","console","log","wysiwyg","setWysiwyg","handleEditorChange","content","handleSelectChange","icon","submitForm","url","body","title","icon_id","description","options","method","headers","Headers","mode","JSON","stringify","fetch","then","response","status","push","json","Promise","reject","catch","error","initialData","__div_form","map","item","__option","height","menubar","plugins","toolbar"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext} from 'react';\nimport Navbar from '../../components/navbar/navbar';\nimport styles from './postupdate.module.css';\nimport {Editor} from '@tinymce/tinymce-react';\nimport {useHistory} from 'react-router-dom';\nimport {useParams} from 'react-router';\nimport {LANDING} from '../../routes/routes';\nimport {PostsContext} from '../../contexts/postcontext';\nimport ReactHtmlParser from 'react-html-parser';\nimport swal from 'sweetalert';\n\nconst PostUpdate = () => {\n  const {id} = useParams ();\n  const {icons, getPost, post, render, setRender} = useContext (PostsContext);\n  const history = useHistory ();\n  const [data, setData] = useState ({});\n\n  const handleInputChange = event => {\n    setData ({\n      ...data,\n      [event.target.name]: event.target.value,\n    });\n    console.log (data);\n  };\n\n  const [wysiwyg, setWysiwyg] = useState (null);\n  const handleEditorChange = content => {\n    setWysiwyg (content);\n    console.log (content);\n  };\n\n  const handleSelectChange = event => {\n    setData ({\n      //...data,\n      icon: event.target.value,\n    });\n  };\n\n  getPost (id);\n\n  const submitForm = () => {\n    const url = `http://localhost/api/posts/update/${id}`;\n    const body = {\n      title: data.title,\n      icon_id: data.icon,\n      description: data.description,\n      content: wysiwyg,\n    };\n    const options = {\n      method: 'PATCH',\n      headers: new Headers ({\n        'Content-type': 'application/json',\n      }),\n      mode: 'cors',\n      body: JSON.stringify (body),\n    };\n    fetch (url, options)\n      .then (response => {\n        if (response.status === 201 || response.status === 200) {\n            console.log(response.status);\n            setRender(!render);\n          swal ('Enhorabuena', 'Post creado con exito', 'success');\n          history.push (LANDING);\n          return response.json ();\n        } else {\n          return Promise.reject (response.status);\n        }\n      })\n      .catch (error => console.log (error));\n  };\n    \n    const initialData = () => {\n\n         {post && \n            setData({\n                ...data,\n                title: post.title,\n                icon_id: post.icon_id,\n                description: post.description,\n                content: post.content,\n            })}\n        \n    }\n\n  useEffect (\n    () => {\n          getPost(id);\n          initialData();\n          console.log(data);\n    },\n    [id]\n  );\n\n  return (\n    <div>\n      <h1 className=\"text-muted mt-5\">Modificar Post</h1>\n      <div className={styles.__div_form}>\n        <select\n          className=\"form-control col-3 align-self-center\"\n          defaultValue={post.icon_id}\n          onChange={handleSelectChange}\n        >\n\n          {icons.map (item => (\n            <option\n              className={styles.__option}\n              value={item.id}\n              label={item.name}\n            />\n          ))}\n        </select>\n\n        <input\n          className=\"form-control col-6 align-self-center mt-5\"\n          name=\"title\"\n          type=\"text\"\n          placeholder=\"title\"\n          onChange={handleInputChange}\n                  defaultValue={post.title}\n                  initialValue={post.title}\n        />\n        <input\n          className=\"form-control col-6 align-self-center mt-5\"\n          name=\"description\"\n          type=\"text\"\n          placeholder=\"description\"\n          onChange={handleInputChange}\n                  defaultValue={post.description}\n                  initialValue={post.description}\n        />\n        <div className=\"form-control col-6 align-self-center mt-5\">\n          <Editor\n            initialValue={post.content}\n            apiKey=\"z3chpr7kq0azccojyrbp99s6bab52o2f3t26a7hg1ge0iy93\"\n            init={{\n              height: 500,\n              menubar: false,\n              plugins: [\n                'advlist autolink lists link image charmap print preview anchor',\n                'searchreplace visualblocks code fullscreen',\n                'insertdatetime media table paste code help wordcount',\n              ],\n              toolbar: 'undo redo | formatselect | bold italic backcolor | \\\n             alignleft aligncenter alignright alignjustify | \\\n             bullist numlist outdent indent | removeformat | help',\n            }}\n            value={wysiwyg}\n            onEditorChange={handleEditorChange}\n          />\n        </div>\n\n        <input\n          className=\"btn btn-success btn-lg col-2 my-5 align-self-center\"\n          name=\"button\"\n          type=\"button\"\n          value=\"Confirmar cambios\"\n          onClick={submitForm}\n        />\n      </div>\n    </div>\n  );\n};\nexport default PostUpdate;\n"]},"metadata":{},"sourceType":"module"}