{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.5.1 (2020-10-01)\n */\n(function () {\n  'use strict';\n\n  var noop = function () {};\n\n  var noarg = function (f) {\n    return function () {\n      return f();\n    };\n  };\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var global$1 = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var isArrayOf = function (value, pred) {\n    if (isArray(value)) {\n      for (var i = 0, len = value.length; i < len; ++i) {\n        if (!pred(value[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var range = function (num, f) {\n    var r = [];\n\n    for (var i = 0; i < num; i++) {\n      r.push(f(i));\n    }\n\n    return r;\n  };\n\n  var chunk = function (array, size) {\n    var r = [];\n\n    for (var i = 0; i < array.length; i += size) {\n      var s = nativeSlice.call(array, i, i + size);\n      r.push(s);\n    }\n\n    return r;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter(a1, function (x) {\n      return !contains(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var sort = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var head = function (xs) {\n    return xs.length === 0 ? Optional.none() : Optional.some(xs[0]);\n  };\n\n  var last = function (xs) {\n    return xs.length === 0 ? Optional.none() : Optional.some(xs[xs.length - 1]);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var value = function (o) {\n    var is = function (v) {\n      return o === v;\n    };\n\n    var or = function (_opt) {\n      return value(o);\n    };\n\n    var orThunk = function (_f) {\n      return value(o);\n    };\n\n    var map = function (f) {\n      return value(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = function (opt) {\n      return opt;\n    };\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n  var SimpleResultType;\n\n  (function (SimpleResultType) {\n    SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n    SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n  })(SimpleResultType || (SimpleResultType = {}));\n\n  var fold = function (res, onError, onValue) {\n    return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n  };\n\n  var partition$1 = function (results) {\n    var values = [];\n    var errors = [];\n    each(results, function (obj) {\n      fold(obj, function (err) {\n        return errors.push(err);\n      }, function (val) {\n        return values.push(val);\n      });\n    });\n    return {\n      values: values,\n      errors: errors\n    };\n  };\n\n  var mapError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: f(res.serror)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var map$1 = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: f(res.svalue)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var bind$1 = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return f(res.svalue);\n    } else {\n      return res;\n    }\n  };\n\n  var bindError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return f(res.serror);\n    } else {\n      return res;\n    }\n  };\n\n  var svalue = function (v) {\n    return {\n      stype: SimpleResultType.Value,\n      svalue: v\n    };\n  };\n\n  var serror = function (e) {\n    return {\n      stype: SimpleResultType.Error,\n      serror: e\n    };\n  };\n\n  var toResult = function (res) {\n    return fold(res, Result.error, Result.value);\n  };\n\n  var fromResult = function (res) {\n    return res.fold(serror, svalue);\n  };\n\n  var SimpleResult = {\n    fromResult: fromResult,\n    toResult: toResult,\n    svalue: svalue,\n    partition: partition$1,\n    serror: serror,\n    bind: bind$1,\n    bindError: bindError,\n    map: map$1,\n    mapError: mapError,\n    fold: fold\n  };\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$2 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$1(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var find$1 = function (obj, pred) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n\n      if (pred(x, i, obj)) {\n        return Optional.some(x);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, function (v) {\n      return v;\n    });\n  };\n\n  var get = function (obj, key) {\n    return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var generate = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var argLength = arguments.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var args = new Array(argLength);\n\n        for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i];\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            if (arguments.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n            }\n\n            var target = arguments[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate\n  };\n  var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n  var shallow = function (old, nu) {\n    return nu;\n  };\n\n  var deep = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = new Array(arguments.length);\n\n      for (var i = 0; i < objects.length; i++) {\n        objects[i] = arguments[i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty$1.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep);\n  var merge = baseMerge(shallow);\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var adt = Adt.generate([{\n    strict: []\n  }, {\n    defaultedThunk: ['fallbackThunk']\n  }, {\n    asOption: []\n  }, {\n    asDefaultedOptionThunk: ['fallbackThunk']\n  }, {\n    mergeWithThunk: ['baseThunk']\n  }]);\n\n  var defaulted = function (fallback) {\n    return adt.defaultedThunk(constant(fallback));\n  };\n\n  var mergeWith = function (base) {\n    return adt.mergeWithThunk(constant(base));\n  };\n\n  var strict = adt.strict;\n  var asOption = adt.asOption;\n  var defaultedThunk = adt.defaultedThunk;\n  var asDefaultedOptionThunk = adt.asDefaultedOptionThunk;\n  var mergeWithThunk = adt.mergeWithThunk;\n  var comparison = Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var partition$2 = function (results) {\n    var errors = [];\n    var values = [];\n    each(results, function (result) {\n      result.fold(function (err) {\n        errors.push(err);\n      }, function (value) {\n        values.push(value);\n      });\n    });\n    return {\n      errors: errors,\n      values: values\n    };\n  };\n\n  var exclude = function (obj, fields) {\n    var r = {};\n    each$1(obj, function (v, k) {\n      if (!contains(fields, k)) {\n        r[k] = v;\n      }\n    });\n    return r;\n  };\n\n  var wrap = function (key, value) {\n    var _a;\n\n    return _a = {}, _a[key] = value, _a;\n  };\n\n  var wrapAll = function (keyvalues) {\n    var r = {};\n    each(keyvalues, function (kv) {\n      r[kv.key] = kv.value;\n    });\n    return r;\n  };\n\n  var exclude$1 = function (obj, fields) {\n    return exclude(obj, fields);\n  };\n\n  var wrap$1 = function (key, value) {\n    return wrap(key, value);\n  };\n\n  var wrapAll$1 = function (keyvalues) {\n    return wrapAll(keyvalues);\n  };\n\n  var mergeValues = function (values, base) {\n    return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge.apply(undefined, values)));\n  };\n\n  var mergeErrors = function (errors) {\n    return Result.error(flatten(errors));\n  };\n\n  var consolidate = function (objs, base) {\n    var partitions = partition$2(objs);\n    return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n  };\n\n  var mergeValues$1 = function (values, base) {\n    return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge.apply(undefined, values))) : SimpleResult.svalue(base);\n  };\n\n  var mergeErrors$1 = function (errors) {\n    return compose(SimpleResult.serror, flatten)(errors);\n  };\n\n  var consolidateObj = function (objects, base) {\n    var partition = SimpleResult.partition(objects);\n    return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n  };\n\n  var consolidateArr = function (objects) {\n    var partitions = SimpleResult.partition(objects);\n    return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n  };\n\n  var ResultCombine = {\n    consolidateObj: consolidateObj,\n    consolidateArr: consolidateArr\n  };\n\n  var formatObj = function (input) {\n    return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n  };\n\n  var formatErrors = function (errors) {\n    var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n      path: [],\n      getErrorInfo: function () {\n        return '... (only showing first ten failures)';\n      }\n    }]) : errors;\n    return map(es, function (e) {\n      return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n    });\n  };\n\n  var nu = function (path, getErrorInfo) {\n    return SimpleResult.serror([{\n      path: path,\n      getErrorInfo: getErrorInfo\n    }]);\n  };\n\n  var missingStrict = function (path, key, obj) {\n    return nu(path, function () {\n      return 'Could not find valid *strict* value for \"' + key + '\" in ' + formatObj(obj);\n    });\n  };\n\n  var missingKey = function (path, key) {\n    return nu(path, function () {\n      return 'Choice schema did not contain choice key: \"' + key + '\"';\n    });\n  };\n\n  var missingBranch = function (path, branches, branch) {\n    return nu(path, function () {\n      return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n    });\n  };\n\n  var unsupportedFields = function (path, unsupported) {\n    return nu(path, function () {\n      return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n    });\n  };\n\n  var custom = function (path, err) {\n    return nu(path, function () {\n      return err;\n    });\n  };\n\n  var adt$1 = Adt.generate([{\n    field: ['key', 'okey', 'presence', 'prop']\n  }, {\n    state: ['okey', 'instantiator']\n  }]);\n\n  var strictAccess = function (path, obj, key) {\n    return get(obj, key).fold(function () {\n      return missingStrict(path, key, obj);\n    }, SimpleResult.svalue);\n  };\n\n  var fallbackAccess = function (obj, key, fallbackThunk) {\n    var v = get(obj, key).fold(function () {\n      return fallbackThunk(obj);\n    }, identity);\n    return SimpleResult.svalue(v);\n  };\n\n  var optionAccess = function (obj, key) {\n    return SimpleResult.svalue(get(obj, key));\n  };\n\n  var optionDefaultedAccess = function (obj, key, fallback) {\n    var opt = get(obj, key).map(function (val) {\n      return val === true ? fallback(obj) : val;\n    });\n    return SimpleResult.svalue(opt);\n  };\n\n  var cExtractOne = function (path, obj, field, strength) {\n    return field.fold(function (key, okey, presence, prop) {\n      var bundle = function (av) {\n        var result = prop.extract(path.concat([key]), strength, av);\n        return SimpleResult.map(result, function (res) {\n          return wrap(okey, strength(res));\n        });\n      };\n\n      var bundleAsOption = function (optValue) {\n        return optValue.fold(function () {\n          var outcome = wrap(okey, strength(Optional.none()));\n          return SimpleResult.svalue(outcome);\n        }, function (ov) {\n          var result = prop.extract(path.concat([key]), strength, ov);\n          return SimpleResult.map(result, function (res) {\n            return wrap(okey, strength(Optional.some(res)));\n          });\n        });\n      };\n\n      return function () {\n        return presence.fold(function () {\n          return SimpleResult.bind(strictAccess(path, obj, key), bundle);\n        }, function (fallbackThunk) {\n          return SimpleResult.bind(fallbackAccess(obj, key, fallbackThunk), bundle);\n        }, function () {\n          return SimpleResult.bind(optionAccess(obj, key), bundleAsOption);\n        }, function (fallbackThunk) {\n          return SimpleResult.bind(optionDefaultedAccess(obj, key, fallbackThunk), bundleAsOption);\n        }, function (baseThunk) {\n          var base = baseThunk(obj);\n          var result = SimpleResult.map(fallbackAccess(obj, key, constant({})), function (v) {\n            return deepMerge(base, v);\n          });\n          return SimpleResult.bind(result, bundle);\n        });\n      }();\n    }, function (okey, instantiator) {\n      var state = instantiator(obj);\n      return SimpleResult.svalue(wrap(okey, strength(state)));\n    });\n  };\n\n  var cExtract = function (path, obj, fields, strength) {\n    var results = map(fields, function (field) {\n      return cExtractOne(path, obj, field, strength);\n    });\n    return ResultCombine.consolidateObj(results, {});\n  };\n\n  var valueThunk = function (getDelegate) {\n    var extract = function (path, strength, val) {\n      return getDelegate().extract(path, strength, val);\n    };\n\n    var toString = function () {\n      return getDelegate().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var value$1 = function (validator) {\n    var extract = function (path, strength, val) {\n      return SimpleResult.bindError(validator(val, strength), function (err) {\n        return custom(path, err);\n      });\n    };\n\n    var toString = function () {\n      return 'val';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var getSetKeys = function (obj) {\n    return keys(filter$1(obj, function (value) {\n      return value !== undefined && value !== null;\n    }));\n  };\n\n  var objOfOnly = function (fields) {\n    var delegate = objOf(fields);\n    var fieldNames = foldr(fields, function (acc, f) {\n      return f.fold(function (key) {\n        return deepMerge(acc, wrap$1(key, true));\n      }, constant(acc));\n    }, {});\n\n    var extract = function (path, strength, o) {\n      var keys = isBoolean(o) ? [] : getSetKeys(o);\n      var extra = filter(keys, function (k) {\n        return !hasNonNullableKey(fieldNames, k);\n      });\n      return extra.length === 0 ? delegate.extract(path, strength, o) : unsupportedFields(path, extra);\n    };\n\n    return {\n      extract: extract,\n      toString: delegate.toString\n    };\n  };\n\n  var objOf = function (fields) {\n    var extract = function (path, strength, o) {\n      return cExtract(path, o, fields, strength);\n    };\n\n    var toString = function () {\n      var fieldStrings = map(fields, function (field) {\n        return field.fold(function (key, okey, presence, prop) {\n          return key + ' -> ' + prop.toString();\n        }, function (okey, _instantiator) {\n          return 'state(' + okey + ')';\n        });\n      });\n      return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var arrOf = function (prop) {\n    var extract = function (path, strength, array) {\n      var results = map(array, function (a, i) {\n        return prop.extract(path.concat(['[' + i + ']']), strength, a);\n      });\n      return ResultCombine.consolidateArr(results);\n    };\n\n    var toString = function () {\n      return 'array(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var oneOf = function (props) {\n    var extract = function (path, strength, val) {\n      var errors = [];\n\n      for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n        var prop = props_1[_i];\n        var res = prop.extract(path, strength, val);\n\n        if (res.stype === SimpleResultType.Value) {\n          return res;\n        }\n\n        errors.push(res);\n      }\n\n      return ResultCombine.consolidateArr(errors);\n    };\n\n    var toString = function () {\n      return 'oneOf(' + map(props, function (prop) {\n        return prop.toString();\n      }).join(', ') + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var setOf = function (validator, prop) {\n    var validateKeys = function (path, keys) {\n      return arrOf(value$1(validator)).extract(path, identity, keys);\n    };\n\n    var extract = function (path, strength, o) {\n      var keys$1 = keys(o);\n      var validatedKeys = validateKeys(path, keys$1);\n      return SimpleResult.bind(validatedKeys, function (validKeys) {\n        var schema = map(validKeys, function (vk) {\n          return adt$1.field(vk, vk, strict(), prop);\n        });\n        return objOf(schema).extract(path, strength, o);\n      });\n    };\n\n    var toString = function () {\n      return 'setOf(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var thunk = function (desc, processor) {\n    var getP = cached(function () {\n      return processor();\n    });\n\n    var extract = function (path, strength, val) {\n      return getP().extract(path, strength, val);\n    };\n\n    var toString = function () {\n      return getP().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var anyValue = constant(value$1(SimpleResult.svalue));\n  var arrOfObj = compose(arrOf, objOf);\n  var state = adt$1.state;\n  var field = adt$1.field;\n\n  var chooseFrom = function (path, strength, input, branches, ch) {\n    var fields = get(branches, ch);\n    return fields.fold(function () {\n      return missingBranch(path, branches, ch);\n    }, function (vp) {\n      return vp.extract(path.concat(['branch: ' + ch]), strength, input);\n    });\n  };\n\n  var choose = function (key, branches) {\n    var extract = function (path, strength, input) {\n      var choice = get(input, key);\n      return choice.fold(function () {\n        return missingKey(path, key);\n      }, function (chosen) {\n        return chooseFrom(path, strength, input, branches, chosen);\n      });\n    };\n\n    var toString = function () {\n      return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var _anyValue = value$1(SimpleResult.svalue);\n\n  var arrOfObj$1 = function (objFields) {\n    return arrOfObj(objFields);\n  };\n\n  var arrOfVal = function () {\n    return arrOf(_anyValue);\n  };\n\n  var valueThunkOf = valueThunk;\n\n  var valueOf = function (validator) {\n    return value$1(function (v) {\n      return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n    });\n  };\n\n  var setOf$1 = function (validator, prop) {\n    return setOf(function (v) {\n      return SimpleResult.fromResult(validator(v));\n    }, prop);\n  };\n\n  var extract = function (label, prop, strength, obj) {\n    var res = prop.extract([label], strength, obj);\n    return SimpleResult.mapError(res, function (errs) {\n      return {\n        input: obj,\n        errors: errs\n      };\n    });\n  };\n\n  var asRaw = function (label, prop, obj) {\n    return SimpleResult.toResult(extract(label, prop, identity, obj));\n  };\n\n  var getOrDie = function (extraction) {\n    return extraction.fold(function (errInfo) {\n      throw new Error(formatError(errInfo));\n    }, identity);\n  };\n\n  var asRawOrDie = function (label, prop, obj) {\n    return getOrDie(asRaw(label, prop, obj));\n  };\n\n  var formatError = function (errInfo) {\n    return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n  };\n\n  var chooseProcessor = function (key, branches) {\n    return choose(key, branches);\n  };\n\n  var choose$1 = function (key, branches) {\n    return choose(key, map$2(branches, objOf));\n  };\n\n  var thunkOf = function (desc, schema) {\n    return thunk(desc, schema);\n  };\n\n  var anyValue$1 = constant(_anyValue);\n\n  var typedValue = function (validator, expectedType) {\n    return value$1(function (a) {\n      var actualType = typeof a;\n      return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n    });\n  };\n\n  var number = typedValue(isNumber, 'number');\n  var string = typedValue(isString, 'string');\n  var boolean = typedValue(isBoolean, 'boolean');\n  var functionProcessor = typedValue(isFunction, 'function');\n\n  var isPostMessageable = function (val) {\n    var every = function (iter, callbackFn) {\n      var result = iter.next();\n\n      while (!result.done) {\n        if (!callbackFn(result.value)) {\n          return false;\n        }\n\n        result = iter.next();\n      }\n\n      return true;\n    };\n\n    if (Object(val) !== val) {\n      return true;\n    }\n\n    switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n\n      case 'Map':\n        return every(val.keys(), isPostMessageable) && every(val.values(), isPostMessageable);\n\n      case 'Set':\n        return every(val.keys(), isPostMessageable);\n\n      default:\n        return false;\n    }\n  };\n\n  var postMessageable = value$1(function (a) {\n    return isPostMessageable(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n  });\n\n  var validateEnum = function (values) {\n    return valueOf(function (value) {\n      return contains(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n    });\n  };\n\n  var strict$1 = function (key) {\n    return field(key, key, strict(), anyValue());\n  };\n\n  var strictOf = function (key, schema) {\n    return field(key, key, strict(), schema);\n  };\n\n  var strictNumber = function (key) {\n    return strictOf(key, number);\n  };\n\n  var strictString = function (key) {\n    return strictOf(key, string);\n  };\n\n  var strictStringEnum = function (key, values) {\n    return field(key, key, strict(), validateEnum(values));\n  };\n\n  var strictBoolean = function (key) {\n    return strictOf(key, boolean);\n  };\n\n  var strictFunction = function (key) {\n    return strictOf(key, functionProcessor);\n  };\n\n  var forbid = function (key, message) {\n    return field(key, key, asOption(), value$1(function (_v) {\n      return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n    }));\n  };\n\n  var strictObjOf = function (key, objSchema) {\n    return field(key, key, strict(), objOf(objSchema));\n  };\n\n  var strictArrayOfObj = function (key, objFields) {\n    return field(key, key, strict(), arrOfObj(objFields));\n  };\n\n  var strictArrayOf = function (key, schema) {\n    return field(key, key, strict(), arrOf(schema));\n  };\n\n  var option = function (key) {\n    return field(key, key, asOption(), anyValue());\n  };\n\n  var optionOf = function (key, schema) {\n    return field(key, key, asOption(), schema);\n  };\n\n  var optionNumber = function (key) {\n    return optionOf(key, number);\n  };\n\n  var optionString = function (key) {\n    return optionOf(key, string);\n  };\n\n  var optionFunction = function (key) {\n    return optionOf(key, functionProcessor);\n  };\n\n  var optionArrayOf = function (key, schema) {\n    return optionOf(key, arrOf(schema));\n  };\n\n  var optionObjOf = function (key, objSchema) {\n    return optionOf(key, objOf(objSchema));\n  };\n\n  var optionObjOfOnly = function (key, objSchema) {\n    return optionOf(key, objOfOnly(objSchema));\n  };\n\n  var defaulted$1 = function (key, fallback) {\n    return field(key, key, defaulted(fallback), anyValue());\n  };\n\n  var defaultedOf = function (key, fallback, schema) {\n    return field(key, key, defaulted(fallback), schema);\n  };\n\n  var defaultedNumber = function (key, fallback) {\n    return defaultedOf(key, fallback, number);\n  };\n\n  var defaultedString = function (key, fallback) {\n    return defaultedOf(key, fallback, string);\n  };\n\n  var defaultedStringEnum = function (key, fallback, values) {\n    return defaultedOf(key, fallback, validateEnum(values));\n  };\n\n  var defaultedBoolean = function (key, fallback) {\n    return defaultedOf(key, fallback, boolean);\n  };\n\n  var defaultedFunction = function (key, fallback) {\n    return defaultedOf(key, fallback, functionProcessor);\n  };\n\n  var defaultedPostMsg = function (key, fallback) {\n    return defaultedOf(key, fallback, postMessageable);\n  };\n\n  var defaultedArrayOf = function (key, fallback, schema) {\n    return defaultedOf(key, fallback, arrOf(schema));\n  };\n\n  var defaultedObjOf = function (key, fallback, objSchema) {\n    return defaultedOf(key, fallback, objOf(objSchema));\n  };\n\n  var state$1 = function (okey, instantiator) {\n    return state(okey, instantiator);\n  };\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$2 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu$1(group(1), group(2));\n  };\n\n  var detect = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$2(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function () {\n    return nu$1(0, 0);\n  };\n\n  var nu$1 = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu$1,\n    detect: detect,\n    unknown: unknown\n  };\n\n  var detect$1 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var endsWith = function (str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$2,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$2 = function () {\n    return nu$3({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$3 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$3,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$2 = function (userAgent, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var is = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq$1 = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$2 = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n    });\n  };\n\n  var isSource = function (component, simulatedEvent) {\n    return eq$1(component.element, simulatedEvent.event.target);\n  };\n\n  var nu$4 = function (parts) {\n    if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n      throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n    }\n\n    return asRawOrDie('Extracting event.handler', objOfOnly([defaulted$1('can', always), defaulted$1('abort', never), defaulted$1('run', noop)]), parts);\n  };\n\n  var all$1 = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc && f(handler).apply(undefined, args);\n      }, true);\n    };\n  };\n\n  var any = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc || f(handler).apply(undefined, args);\n      }, false);\n    };\n  };\n\n  var read = function (handler) {\n    return isFunction(handler) ? {\n      can: constant(true),\n      abort: constant(false),\n      run: handler\n    } : handler;\n  };\n\n  var fuse = function (handlers) {\n    var can = all$1(handlers, function (handler) {\n      return handler.can;\n    });\n    var abort = any(handlers, function (handler) {\n      return handler.abort;\n    });\n\n    var run = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      each(handlers, function (handler) {\n        handler.run.apply(undefined, args);\n      });\n    };\n\n    return nu$4({\n      can: can,\n      abort: abort,\n      run: run\n    });\n  };\n\n  var constant$1 = constant;\n  var touchstart = constant$1('touchstart');\n  var touchmove = constant$1('touchmove');\n  var touchend = constant$1('touchend');\n  var touchcancel = constant$1('touchcancel');\n  var mousedown = constant$1('mousedown');\n  var mousemove = constant$1('mousemove');\n  var mouseout = constant$1('mouseout');\n  var mouseup = constant$1('mouseup');\n  var mouseover = constant$1('mouseover');\n  var focusin = constant$1('focusin');\n  var focusout = constant$1('focusout');\n  var keydown = constant$1('keydown');\n  var keyup = constant$1('keyup');\n  var input = constant$1('input');\n  var change = constant$1('change');\n  var click = constant$1('click');\n  var transitionend = constant$1('transitionend');\n  var selectstart = constant$1('selectstart');\n\n  var prefixName = function (name) {\n    return constant('alloy.' + name);\n  };\n\n  var alloy = {\n    tap: prefixName('tap')\n  };\n  var focus = prefixName('focus');\n  var postBlur = prefixName('blur.post');\n  var postPaste = prefixName('paste.post');\n  var receive = prefixName('receive');\n  var execute = prefixName('execute');\n  var focusItem = prefixName('focus.item');\n  var tap = alloy.tap;\n  var longpress = prefixName('longpress');\n  var sandboxClose = prefixName('sandbox.close');\n  var typeaheadCancel = prefixName('typeahead.cancel');\n  var systemInit = prefixName('system.init');\n  var documentTouchmove = prefixName('system.touchmove');\n  var documentTouchend = prefixName('system.touchend');\n  var windowScroll = prefixName('system.scroll');\n  var windowResize = prefixName('system.resize');\n  var attachedToDom = prefixName('system.attached');\n  var detachedFromDom = prefixName('system.detached');\n  var dismissRequested = prefixName('system.dismissRequested');\n  var repositionRequested = prefixName('system.repositionRequested');\n  var focusShifted = prefixName('focusmanager.shifted');\n  var slotVisibility = prefixName('slotcontainer.visibility');\n  var changeTab = prefixName('change.tab');\n  var dismissTab = prefixName('dismiss.tab');\n  var highlight = prefixName('highlight');\n  var dehighlight = prefixName('dehighlight');\n\n  var emit = function (component, event) {\n    dispatchWith(component, component.element, event, {});\n  };\n\n  var emitWith = function (component, event, properties) {\n    dispatchWith(component, component.element, event, properties);\n  };\n\n  var emitExecute = function (component) {\n    emit(component, execute());\n  };\n\n  var dispatch = function (component, target, event) {\n    dispatchWith(component, target, event, {});\n  };\n\n  var dispatchWith = function (component, target, event, properties) {\n    var data = __assign({\n      target: target\n    }, properties);\n\n    component.getSystem().triggerEvent(event, target, data);\n  };\n\n  var dispatchEvent = function (component, target, event, simulatedEvent) {\n    component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n  };\n\n  var derive = function (configs) {\n    return wrapAll$1(configs);\n  };\n\n  var abort = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$4({\n        abort: predicate\n      })\n    };\n  };\n\n  var can = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$4({\n        can: predicate\n      })\n    };\n  };\n\n  var preventDefault = function (name) {\n    return {\n      key: name,\n      value: nu$4({\n        run: function (component, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        }\n      })\n    };\n  };\n\n  var run = function (name, handler) {\n    return {\n      key: name,\n      value: nu$4({\n        run: handler\n      })\n    };\n  };\n\n  var runActionExtra = function (name, action, extra) {\n    return {\n      key: name,\n      value: nu$4({\n        run: function (component, simulatedEvent) {\n          action.apply(undefined, [component, simulatedEvent].concat(extra));\n        }\n      })\n    };\n  };\n\n  var runOnName = function (name) {\n    return function (handler) {\n      return run(name, handler);\n    };\n  };\n\n  var runOnSourceName = function (name) {\n    return function (handler) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            if (isSource(component, simulatedEvent)) {\n              handler(component, simulatedEvent);\n            }\n          }\n        })\n      };\n    };\n  };\n\n  var redirectToUid = function (name, uid) {\n    return run(name, function (component, simulatedEvent) {\n      component.getSystem().getByUid(uid).each(function (redirectee) {\n        dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n      });\n    });\n  };\n\n  var redirectToPart = function (name, detail, partName) {\n    var uid = detail.partUids[partName];\n    return redirectToUid(name, uid);\n  };\n\n  var runWithTarget = function (name, f) {\n    return run(name, function (component, simulatedEvent) {\n      var ev = simulatedEvent.event;\n      var target = component.getSystem().getByDom(ev.target).fold(function () {\n        var closest$1 = closest(ev.target, function (el) {\n          return component.getSystem().getByDom(el).toOptional();\n        }, never);\n        return closest$1.getOr(component);\n      }, function (c) {\n        return c;\n      });\n      f(component, target, simulatedEvent);\n    });\n  };\n\n  var cutter = function (name) {\n    return run(name, function (component, simulatedEvent) {\n      simulatedEvent.cut();\n    });\n  };\n\n  var stopper = function (name) {\n    return run(name, function (component, simulatedEvent) {\n      simulatedEvent.stop();\n    });\n  };\n\n  var runOnSource = function (name, f) {\n    return runOnSourceName(name)(f);\n  };\n\n  var runOnAttached = runOnSourceName(attachedToDom());\n  var runOnDetached = runOnSourceName(detachedFromDom());\n  var runOnInit = runOnSourceName(systemInit());\n  var runOnExecute = runOnName(execute());\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType$1 = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isElement = isType$1(ELEMENT);\n  var isText = isType$1(TEXT);\n  var isDocument = isType$1(DOCUMENT);\n  var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n  var owner = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parentNode = function (element) {\n    return parent(element);\n  };\n\n  var offsetParent = function (element) {\n    return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child(element, 0);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append(v, element);\n      });\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var appendAt = function (parent, element, index) {\n    child(parent, index).fold(function () {\n      append(parent, element);\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var before$1 = function (marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each(children(element), function (rogue) {\n      remove(rogue);\n    });\n  };\n\n  var remove = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove(wrapper);\n  };\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var get$1 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set = function (element, content) {\n    var owner$1 = owner(element);\n    var docDom = owner$1.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml$1(content, docDom);\n    append$1(fragment, contentElements);\n    empty(element);\n    append(element, fragment);\n  };\n\n  var getOuter = function (element) {\n    var container = SugarElement.fromTag('div');\n    var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n    append(container, clone);\n    return get$1(container);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set$1 = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$2 = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$2(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$1 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow$1 = function (original) {\n    return clone(original, false);\n  };\n\n  var getHtml = function (element) {\n    var clone = shallow$1(element);\n    return getOuter(clone);\n  };\n\n  var element = function (elem) {\n    return getHtml(elem);\n  };\n\n  var isRecursive = function (component, originator, target) {\n    return eq$1(originator, component.element) && !eq$1(originator, target);\n  };\n\n  var events = derive([can(focus(), function (component, simulatedEvent) {\n    var event = simulatedEvent.event;\n    var originator = event.originator;\n    var target = event.target;\n\n    if (isRecursive(component, originator, target)) {\n      console.warn(focus() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus() + ' event handlers');\n      return false;\n    } else {\n      return true;\n    }\n  })]);\n  var DefaultEvents = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events\n  });\n  var unique = 0;\n\n  var generate$1 = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var prefix = constant('alloy-id-');\n  var idAttr = constant('data-alloy-id');\n  var prefix$1 = prefix();\n  var idAttr$1 = idAttr();\n\n  var write = function (label, elem) {\n    var id = generate$1(prefix$1 + label);\n    writeOnly(elem, id);\n    return id;\n  };\n\n  var writeOnly = function (elem, uid) {\n    Object.defineProperty(elem.dom, idAttr$1, {\n      value: uid,\n      writable: true\n    });\n  };\n\n  var read$1 = function (elem) {\n    var id = isElement(elem) ? elem.dom[idAttr$1] : null;\n    return Optional.from(id);\n  };\n\n  var generate$2 = function (prefix) {\n    return generate$1(prefix);\n  };\n\n  var make = identity;\n\n  var NoContextApi = function (getComp) {\n    var fail = function (event) {\n      return function () {\n        throw new Error('The component must be in a context to send: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : ''));\n      };\n    };\n\n    return {\n      debugInfo: constant('fake'),\n      triggerEvent: fail('triggerEvent'),\n      triggerFocus: fail('triggerFocus'),\n      triggerEscape: fail('triggerEscape'),\n      build: fail('build'),\n      addToWorld: fail('addToWorld'),\n      removeFromWorld: fail('removeFromWorld'),\n      addToGui: fail('addToGui'),\n      removeFromGui: fail('removeFromGui'),\n      getByUid: fail('getByUid'),\n      getByDom: fail('getByDom'),\n      broadcast: fail('broadcast'),\n      broadcastOn: fail('broadcastOn'),\n      broadcastEvent: fail('broadcastEvent'),\n      isConnected: never\n    };\n  };\n\n  var singleton = NoContextApi();\n\n  var markAsBehaviourApi = function (f, apiName, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: apiName,\n        parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n      };\n    };\n\n    return f;\n  };\n\n  var cleanParameters = function (parameters) {\n    return map(parameters, function (p) {\n      return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n    });\n  };\n\n  var markAsExtraApi = function (f, extraName) {\n    var delegate = f.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: extraName,\n        parameters: cleanParameters(parameters)\n      };\n    };\n\n    return f;\n  };\n\n  var markAsSketchApi = function (f, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: 'OVERRIDE',\n        parameters: cleanParameters(parameters.slice(1))\n      };\n    };\n\n    return f;\n  };\n\n  var premadeTag = generate$1('alloy-premade');\n\n  var premade = function (comp) {\n    return wrap$1(premadeTag, comp);\n  };\n\n  var getPremade = function (spec) {\n    return get(spec, premadeTag);\n  };\n\n  var makeApi = function (f) {\n    return markAsSketchApi(function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      return f.apply(void 0, __spreadArrays([component.getApis(), component], rest));\n    }, f);\n  };\n\n  var NoState = {\n    init: function () {\n      return nu$5({\n        readState: function () {\n          return 'No State required';\n        }\n      });\n    }\n  };\n\n  var nu$5 = function (spec) {\n    return spec;\n  };\n\n  var generateFrom = function (spec, all) {\n    var schema = map(all, function (a) {\n      return optionObjOf(a.name(), [strict$1('config'), defaulted$1('state', NoState)]);\n    });\n    var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n      throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n    }, function (v) {\n      return v;\n    });\n    return {\n      list: all,\n      data: map$2(validated, function (optBlobThunk) {\n        var output = optBlobThunk.map(function (blob) {\n          return {\n            config: blob.config,\n            state: blob.state.init(blob.config)\n          };\n        });\n        return function () {\n          return output;\n        };\n      })\n    };\n  };\n\n  var getBehaviours = function (bData) {\n    return bData.list;\n  };\n\n  var getData = function (bData) {\n    return bData.data;\n  };\n\n  var byInnerKey = function (data, tuple) {\n    var r = {};\n    each$1(data, function (detail, key) {\n      each$1(detail, function (value, indexKey) {\n        var chain = get(r, indexKey).getOr([]);\n        r[indexKey] = chain.concat([tuple(key, value)]);\n      });\n    });\n    return r;\n  };\n\n  var nu$6 = function (s) {\n    return {\n      classes: s.classes !== undefined ? s.classes : [],\n      attributes: s.attributes !== undefined ? s.attributes : {},\n      styles: s.styles !== undefined ? s.styles : {}\n    };\n  };\n\n  var merge$1 = function (defnA, mod) {\n    return __assign(__assign({}, defnA), {\n      attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n      styles: __assign(__assign({}, defnA.styles), mod.styles),\n      classes: defnA.classes.concat(mod.classes)\n    });\n  };\n\n  var combine = function (info, baseMod, behaviours, base) {\n    var modsByBehaviour = __assign({}, baseMod);\n\n    each(behaviours, function (behaviour) {\n      modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n    });\n    var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n      return {\n        name: name,\n        modification: modification\n      };\n    });\n\n    var combineObjects = function (objects) {\n      return foldr(objects, function (b, a) {\n        return __assign(__assign({}, a.modification), b);\n      }, {});\n    };\n\n    var combinedClasses = foldr(byAspect.classes, function (b, a) {\n      return a.modification.concat(b);\n    }, []);\n    var combinedAttributes = combineObjects(byAspect.attributes);\n    var combinedStyles = combineObjects(byAspect.styles);\n    return nu$6({\n      classes: combinedClasses,\n      attributes: combinedAttributes,\n      styles: combinedStyles\n    });\n  };\n\n  var sortKeys = function (label, keyName, array, order) {\n    try {\n      var sorted = sort(array, function (a, b) {\n        var aKey = a[keyName];\n        var bKey = b[keyName];\n        var aIndex = order.indexOf(aKey);\n        var bIndex = order.indexOf(bKey);\n\n        if (aIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (bIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (aIndex < bIndex) {\n          return -1;\n        } else if (bIndex < aIndex) {\n          return 1;\n        } else {\n          return 0;\n        }\n      });\n      return Result.value(sorted);\n    } catch (err) {\n      return Result.error([err]);\n    }\n  };\n\n  var uncurried = function (handler, purpose) {\n    return {\n      handler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curried = function (handler, purpose) {\n    return {\n      cHandler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curryArgs = function (descHandler, extraArgs) {\n    return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n  };\n\n  var getCurried = function (descHandler) {\n    return descHandler.cHandler;\n  };\n\n  var behaviourTuple = function (name, handler) {\n    return {\n      name: name,\n      handler: handler\n    };\n  };\n\n  var nameToHandlers = function (behaviours, info) {\n    var r = {};\n    each(behaviours, function (behaviour) {\n      r[behaviour.name()] = behaviour.handlers(info);\n    });\n    return r;\n  };\n\n  var groupByEvents = function (info, behaviours, base) {\n    var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n\n    return byInnerKey(behaviourEvents, behaviourTuple);\n  };\n\n  var combine$1 = function (info, eventOrder, behaviours, base) {\n    var byEventName = groupByEvents(info, behaviours, base);\n    return combineGroups(byEventName, eventOrder);\n  };\n\n  var assemble = function (rawHandler) {\n    var handler = read(rawHandler);\n    return function (component, simulatedEvent) {\n      var rest = [];\n\n      for (var _i = 2; _i < arguments.length; _i++) {\n        rest[_i - 2] = arguments[_i];\n      }\n\n      var args = [component, simulatedEvent].concat(rest);\n\n      if (handler.abort.apply(undefined, args)) {\n        simulatedEvent.stop();\n      } else if (handler.can.apply(undefined, args)) {\n        handler.run.apply(undefined, args);\n      }\n    };\n  };\n\n  var missingOrderError = function (eventName, tuples) {\n    return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map(tuples, function (c) {\n      return c.name;\n    }), null, 2)]);\n  };\n\n  var fuse$1 = function (tuples, eventOrder, eventName) {\n    var order = eventOrder[eventName];\n\n    if (!order) {\n      return missingOrderError(eventName, tuples);\n    } else {\n      return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n        var handlers = map(sortedTuples, function (tuple) {\n          return tuple.handler;\n        });\n        return fuse(handlers);\n      });\n    }\n  };\n\n  var combineGroups = function (byEventName, eventOrder) {\n    var r = mapToArray(byEventName, function (tuples, eventName) {\n      var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse$1(tuples, eventOrder, eventName);\n      return combined.map(function (handler) {\n        var assembled = assemble(handler);\n        var purpose = tuples.length > 1 ? filter(eventOrder[eventName], function (o) {\n          return exists(tuples, function (t) {\n            return t.name === o;\n          });\n        }).join(' > ') : tuples[0].name;\n        return wrap$1(eventName, uncurried(assembled, purpose));\n      });\n    });\n    return consolidate(r, {});\n  };\n\n  var baseBehaviour = 'alloy.base.behaviour';\n\n  var toInfo = function (spec) {\n    var _a;\n\n    return asRaw('custom.definition', objOf([field('dom', 'dom', strict(), objOf([strict$1('tag'), defaulted$1('styles', {}), defaulted$1('classes', []), defaulted$1('attributes', {}), option('value'), option('innerHtml')])), strict$1('components'), strict$1('uid'), defaulted$1('events', {}), defaulted$1('apis', {}), field('eventOrder', 'eventOrder', mergeWith((_a = {}, _a[execute()] = ['disabling', baseBehaviour, 'toggling', 'typeaheadevents'], _a[focus()] = [baseBehaviour, 'focusing', 'keying'], _a[systemInit()] = [baseBehaviour, 'disabling', 'toggling', 'representing'], _a[input()] = [baseBehaviour, 'representing', 'streaming', 'invalidating'], _a[detachedFromDom()] = [baseBehaviour, 'representing', 'item-events', 'tooltipping'], _a[mousedown()] = ['focusing', baseBehaviour, 'item-type-events'], _a[touchstart()] = ['focusing', baseBehaviour, 'item-type-events'], _a[mouseover()] = ['item-type-events', 'tooltipping'], _a[receive()] = ['receiving', 'reflecting', 'tooltipping'], _a)), anyValue$1()), option('domModification')]), spec);\n  };\n\n  var toDefinition = function (detail) {\n    return __assign(__assign({}, detail.dom), {\n      uid: detail.uid,\n      domChildren: map(detail.components, function (comp) {\n        return comp.element;\n      })\n    });\n  };\n\n  var toModification = function (detail) {\n    return detail.domModification.fold(function () {\n      return nu$6({});\n    }, nu$6);\n  };\n\n  var toEvents = function (info) {\n    return info.events;\n  };\n\n  var read$2 = function (element, attr) {\n    var value = get$2(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add = function (element, attr, id) {\n    var old = read$2(element, attr);\n    var nu = old.concat([id]);\n    set$1(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$2 = function (element, attr, id) {\n    var nu = filter(read$2(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set$1(element, attr, nu.join(' '));\n    } else {\n      remove$1(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$3 = function (element) {\n    return read$2(element, 'class');\n  };\n\n  var add$1 = function (element, clazz) {\n    return add(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$2(element, 'class', clazz);\n  };\n\n  var add$2 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$1(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$3(element);\n\n    if (classList.length === 0) {\n      remove$1(element, 'class');\n    }\n  };\n\n  var remove$4 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has$2 = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var add$3 = function (element, classes) {\n    each(classes, function (x) {\n      add$2(element, x);\n    });\n  };\n\n  var remove$5 = function (element, classes) {\n    each(classes, function (x) {\n      remove$4(element, x);\n    });\n  };\n\n  var isSupported = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported$1 = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getContentContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported$1() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var inBody = function (element) {\n    var dom = isText(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var body = function () {\n    return getBody(SugarElement.fromDom(document));\n  };\n\n  var getBody = function (doc) {\n    var b = doc.dom.body;\n\n    if (b === null || b === undefined) {\n      throw new Error('Body is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var internalRemove = function (dom, property) {\n    if (isSupported(dom)) {\n      dom.style.removeProperty(property);\n    }\n  };\n\n  var set$2 = function (element, property, value) {\n    var dom = element.dom;\n    internalSet(dom, property, value);\n  };\n\n  var setAll$1 = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var setOptions = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      v.fold(function () {\n        internalRemove(dom, k);\n      }, function (value) {\n        internalSet(dom, k, value);\n      });\n    });\n  };\n\n  var get$4 = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var isValidValue = function (tag, property, value) {\n    var element = SugarElement.fromTag(tag);\n    set$2(element, property, value);\n    var style = getRaw(element, property);\n    return style.isSome();\n  };\n\n  var remove$6 = function (element, property) {\n    var dom = element.dom;\n    internalRemove(dom, property);\n\n    if (getOpt(element, 'style').map(trim).is('')) {\n      remove$1(element, 'style');\n    }\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var get$5 = function (element) {\n    return element.dom.value;\n  };\n\n  var set$3 = function (element, value) {\n    if (value === undefined) {\n      throw new Error('Value.set was undefined');\n    }\n\n    element.dom.value = value;\n  };\n\n  var renderToDom = function (definition) {\n    var subject = SugarElement.fromTag(definition.tag);\n    setAll(subject, definition.attributes);\n    add$3(subject, definition.classes);\n    setAll$1(subject, definition.styles);\n    definition.innerHtml.each(function (html) {\n      return set(subject, html);\n    });\n    var children = definition.domChildren;\n    append$1(subject, children);\n    definition.value.each(function (value) {\n      set$3(subject, value);\n    });\n\n    if (!definition.uid) {\n      debugger;\n    }\n\n    writeOnly(subject, definition.uid);\n    return subject;\n  };\n\n  var getBehaviours$1 = function (spec) {\n    var behaviours = get(spec, 'behaviours').getOr({});\n    var keys$1 = filter(keys(behaviours), function (k) {\n      return behaviours[k] !== undefined;\n    });\n    return map(keys$1, function (k) {\n      return behaviours[k].me;\n    });\n  };\n\n  var generateFrom$1 = function (spec, all) {\n    return generateFrom(spec, all);\n  };\n\n  var generate$3 = function (spec) {\n    var all = getBehaviours$1(spec);\n    return generateFrom$1(spec, all);\n  };\n\n  var getDomDefinition = function (info, bList, bData) {\n    var definition = toDefinition(info);\n    var infoModification = toModification(info);\n    var baseModification = {\n      'alloy.base.modification': infoModification\n    };\n    var modification = bList.length > 0 ? combine(bData, baseModification, bList, definition) : infoModification;\n    return merge$1(definition, modification);\n  };\n\n  var getEvents = function (info, bList, bData) {\n    var baseEvents = {\n      'alloy.base.behaviour': toEvents(info)\n    };\n    return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n  };\n\n  var build = function (spec) {\n    var getMe = function () {\n      return me;\n    };\n\n    var systemApi = Cell(singleton);\n    var info = getOrDie(toInfo(spec));\n    var bBlob = generate$3(spec);\n    var bList = getBehaviours(bBlob);\n    var bData = getData(bBlob);\n    var modDefinition = getDomDefinition(info, bList, bData);\n    var item = renderToDom(modDefinition);\n    var events = getEvents(info, bList, bData);\n    var subcomponents = Cell(info.components);\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(getMe));\n    };\n\n    var syncComponents = function () {\n      var children$1 = children(item);\n      var subs = bind(children$1, function (child) {\n        return systemApi.get().getByDom(child).fold(function () {\n          return [];\n        }, function (c) {\n          return [c];\n        });\n      });\n      subcomponents.set(subs);\n    };\n\n    var config = function (behaviour) {\n      var b = bData;\n      var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n        throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n      };\n      return f();\n    };\n\n    var hasConfigured = function (behaviour) {\n      return isFunction(bData[behaviour.name()]);\n    };\n\n    var getApis = function () {\n      return info.apis;\n    };\n\n    var readState = function (behaviourName) {\n      return bData[behaviourName]().map(function (b) {\n        return b.state.readState();\n      }).getOr('not enabled');\n    };\n\n    var me = {\n      getSystem: systemApi.get,\n      config: config,\n      hasConfigured: hasConfigured,\n      spec: spec,\n      readState: readState,\n      getApis: getApis,\n      connect: connect,\n      disconnect: disconnect,\n      element: item,\n      syncComponents: syncComponents,\n      components: subcomponents.get,\n      events: events\n    };\n    return me;\n  };\n\n  var buildSubcomponents = function (spec) {\n    var components = get(spec, 'components').getOr([]);\n    return map(components, build$1);\n  };\n\n  var buildFromSpec = function (userSpec) {\n    var _a = make(userSpec),\n        specEvents = _a.events,\n        spec = __rest(_a, ['events']);\n\n    var components = buildSubcomponents(spec);\n\n    var completeSpec = __assign(__assign({}, spec), {\n      events: __assign(__assign({}, DefaultEvents), specEvents),\n      components: components\n    });\n\n    return Result.value(build(completeSpec));\n  };\n\n  var text = function (textContent) {\n    var element = SugarElement.fromText(textContent);\n    return external({\n      element: element\n    });\n  };\n\n  var external = function (spec) {\n    var extSpec = asRawOrDie('external.component', objOfOnly([strict$1('element'), option('uid')]), spec);\n    var systemApi = Cell(NoContextApi());\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(function () {\n        return me;\n      }));\n    };\n\n    extSpec.uid.each(function (uid) {\n      writeOnly(extSpec.element, uid);\n    });\n    var me = {\n      getSystem: systemApi.get,\n      config: Optional.none,\n      hasConfigured: never,\n      connect: connect,\n      disconnect: disconnect,\n      getApis: function () {\n        return {};\n      },\n      element: extSpec.element,\n      spec: spec,\n      readState: constant('No state'),\n      syncComponents: noop,\n      components: constant([]),\n      events: {}\n    };\n    return premade(me);\n  };\n\n  var uids = generate$2;\n\n  var build$1 = function (spec) {\n    return getPremade(spec).fold(function () {\n      var userSpecWithUid = spec.hasOwnProperty('uid') ? spec : __assign({\n        uid: uids('')\n      }, spec);\n      return buildFromSpec(userSpecWithUid).getOrDie();\n    }, function (prebuilt) {\n      return prebuilt;\n    });\n  };\n\n  var premade$1 = premade;\n\n  function Dimension(name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$4(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$4(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  }\n\n  var api = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$6 = function (element) {\n    return api.get(element);\n  };\n\n  var getOuter$1 = function (element) {\n    return api.getOuter(element);\n  };\n\n  var setMax = function (element, value) {\n    var inclusions = ['margin-top', 'border-top-width', 'padding-top', 'padding-bottom', 'border-bottom-width', 'margin-bottom'];\n    var absMax = api.max(element, value, inclusions);\n    set$2(element, 'max-height', absMax + 'px');\n  };\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var api$1 = Dimension('width', function (element) {\n    return element.dom.offsetWidth;\n  });\n\n  var set$4 = function (element, h) {\n    return api$1.set(element, h);\n  };\n\n  var get$7 = function (element) {\n    return api$1.get(element);\n  };\n\n  var getOuter$2 = function (element) {\n    return api$1.getOuter(element);\n  };\n\n  var setMax$1 = function (element, value) {\n    var inclusions = ['margin-left', 'border-left-width', 'padding-left', 'padding-right', 'border-right-width', 'margin-right'];\n    var absMax = api$1.max(element, value, inclusions);\n    set$2(element, 'max-width', absMax + 'px');\n  };\n\n  var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n    return {\n      target: target,\n      x: x,\n      y: y,\n      stop: stop,\n      prevent: prevent,\n      kill: kill,\n      raw: raw\n    };\n  };\n\n  var fromRawEvent = function (rawEvent) {\n    var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n\n    var stop = function () {\n      return rawEvent.stopPropagation();\n    };\n\n    var prevent = function () {\n      return rawEvent.preventDefault();\n    };\n\n    var kill = compose(prevent, stop);\n    return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n  };\n\n  var handle = function (filter, handler) {\n    return function (rawEvent) {\n      if (filter(rawEvent)) {\n        handler(fromRawEvent(rawEvent));\n      }\n    };\n  };\n\n  var binder = function (element, event, filter, handler, useCapture) {\n    var wrapped = handle(filter, handler);\n    element.dom.addEventListener(event, wrapped, useCapture);\n    return {\n      unbind: curry(unbind, element, event, wrapped, useCapture)\n    };\n  };\n\n  var bind$2 = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, false);\n  };\n\n  var capture = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, true);\n  };\n\n  var unbind = function (element, event, handler, useCapture) {\n    element.dom.removeEventListener(event, handler, useCapture);\n  };\n\n  var get$8 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var get$9 = function (_win) {\n    var win = _win === undefined ? window : _win;\n    return Optional.from(win['visualViewport']);\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$8(SugarElement.fromDom(doc));\n    return get$9(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    var paths = walkUp(navigation, d);\n    return Optional.some(paths);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner$1 = function (element) {\n    return owner(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner$1\n  });\n\n  var find$3 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$8(doc);\n    var path = pathTo(element, Navigation);\n    return path.fold(curry(absolute, element), function (frames) {\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    });\n  };\n\n  var pointed = function (point, width, height) {\n    return {\n      point: point,\n      width: width,\n      height: height\n    };\n  };\n\n  var rect = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var bounds$1 = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var box = function (element) {\n    var xy = absolute(element);\n    var w = getOuter$2(element);\n    var h = getOuter$1(element);\n    return bounds$1(xy.left, xy.top, w, h);\n  };\n\n  var absolute$1 = function (element) {\n    var position = find$3(element);\n    var width = getOuter$2(element);\n    var height = getOuter$1(element);\n    return bounds$1(position.left, position.top, width, height);\n  };\n\n  var win = function () {\n    return getBounds(window);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    return is(scope, a) ? Optional.some(scope) : isFunction(isRoot) && isRoot(scope) ? Optional.none() : ancestor(scope, a, isRoot);\n  }\n\n  var ancestor$1 = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$1 = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n  };\n\n  var descendant = function (scope, predicate) {\n    var descend = function (node) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var child_1 = SugarElement.fromDom(node.childNodes[i]);\n\n        if (predicate(child_1)) {\n          return Optional.some(child_1);\n        }\n\n        var res = descend(node.childNodes[i]);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope.dom);\n  };\n\n  var closest$2 = function (scope, predicate, isRoot) {\n    return closest$1(scope, predicate, isRoot).isSome();\n  };\n\n  var ancestor$2 = function (scope, selector, isRoot) {\n    return ancestor$1(scope, function (e) {\n      return is(e, selector);\n    }, isRoot);\n  };\n\n  var descendant$1 = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$3 = function (scope, selector, isRoot) {\n    var is$1 = function (element, selector) {\n      return is(element, selector);\n    };\n\n    return ClosestOrAncestor(is$1, ancestor$2, scope, selector, isRoot);\n  };\n\n  var find$4 = function (queryElem) {\n    var dependent = closest$1(queryElem, function (elem) {\n      if (!isElement(elem)) {\n        return false;\n      }\n\n      var id = get$2(elem, 'id');\n      return id !== undefined && id.indexOf('aria-owns') > -1;\n    });\n    return dependent.bind(function (dep) {\n      var id = get$2(dep, 'id');\n      var dos = getRootNode(dep);\n      return descendant$1(dos, '[aria-owns=\"' + id + '\"]');\n    });\n  };\n\n  var manager = function () {\n    var ariaId = generate$1('aria-owns');\n\n    var link = function (elem) {\n      set$1(elem, 'aria-owns', ariaId);\n    };\n\n    var unlink = function (elem) {\n      remove$1(elem, 'aria-owns');\n    };\n\n    return {\n      id: ariaId,\n      link: link,\n      unlink: unlink\n    };\n  };\n\n  var isAriaPartOf = function (component, queryElem) {\n    return find$4(queryElem).exists(function (owner) {\n      return isPartOf(component, owner);\n    });\n  };\n\n  var isPartOf = function (component, queryElem) {\n    return closest$2(queryElem, function (el) {\n      return eq$1(el, component.element);\n    }, never) || isAriaPartOf(component, queryElem);\n  };\n\n  var unknown$3 = 'unknown';\n  var EventConfiguration;\n\n  (function (EventConfiguration) {\n    EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n    EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n    EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n  })(EventConfiguration || (EventConfiguration = {}));\n\n  var eventConfig = Cell({});\n\n  var makeEventLogger = function (eventName, initialTarget) {\n    var sequence = [];\n    var startTime = new Date().getTime();\n    return {\n      logEventCut: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'cut',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventStopped: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'stopped',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logNoParent: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'no-parent',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventNoHandlers: function (_name, target) {\n        sequence.push({\n          outcome: 'no-handlers-left',\n          target: target\n        });\n      },\n      logEventResponse: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'response',\n          purpose: purpose,\n          target: target\n        });\n      },\n      write: function () {\n        var finishTime = new Date().getTime();\n\n        if (contains(['mousemove', 'mouseover', 'mouseout', systemInit()], eventName)) {\n          return;\n        }\n\n        console.log(eventName, {\n          event: eventName,\n          time: finishTime - startTime,\n          target: initialTarget.dom,\n          sequence: map(sequence, function (s) {\n            if (!contains(['cut', 'stopped', 'response'], s.outcome)) {\n              return s.outcome;\n            } else {\n              return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n            }\n          })\n        });\n      }\n    };\n  };\n\n  var processEvent = function (eventName, initialTarget, f) {\n    var status = get(eventConfig.get(), eventName).orThunk(function () {\n      var patterns = keys(eventConfig.get());\n      return findMap(patterns, function (p) {\n        return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n      });\n    }).getOr(EventConfiguration.NORMAL);\n\n    switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n\n      case EventConfiguration.LOGGING:\n        {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n\n      case EventConfiguration.STOP:\n        return true;\n    }\n  };\n\n  var path = ['alloy/data/Fields', 'alloy/debugging/Debugging'];\n\n  var getTrace = function () {\n    var err = new Error();\n\n    if (err.stack !== undefined) {\n      var lines = err.stack.split('\\n');\n      return find(lines, function (line) {\n        return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n          return line.indexOf(p) > -1;\n        });\n      }).getOr(unknown$3);\n    } else {\n      return unknown$3;\n    }\n  };\n\n  var ignoreEvent = {\n    logEventCut: noop,\n    logEventStopped: noop,\n    logNoParent: noop,\n    logEventNoHandlers: noop,\n    logEventResponse: noop,\n    write: noop\n  };\n\n  var monitorEvent = function (eventName, initialTarget, f) {\n    return processEvent(eventName, initialTarget, f);\n  };\n\n  var noLogger = constant(ignoreEvent);\n  var menuFields = constant([strict$1('menu'), strict$1('selectedMenu')]);\n  var itemFields = constant([strict$1('item'), strict$1('selectedItem')]);\n  var schema = constant(objOf(itemFields().concat(menuFields())));\n  var itemSchema = constant(objOf(itemFields()));\n\n  var _initSize = strictObjOf('initSize', [strict$1('numColumns'), strict$1('numRows')]);\n\n  var itemMarkers = function () {\n    return strictOf('markers', itemSchema());\n  };\n\n  var tieredMenuMarkers = function () {\n    return strictObjOf('markers', [strict$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n  };\n\n  var markers = function (required) {\n    return strictObjOf('markers', map(required, strict$1));\n  };\n\n  var onPresenceHandler = function (label, fieldName, presence) {\n    var trace = getTrace();\n    return field(fieldName, fieldName, presence, valueOf(function (f) {\n      return Result.value(function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f.apply(undefined, args);\n      });\n    }));\n  };\n\n  var onHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, defaulted(noop));\n  };\n\n  var onKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, defaulted(Optional.none));\n  };\n\n  var onStrictHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, strict());\n  };\n\n  var onStrictKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, strict());\n  };\n\n  var output = function (name, value) {\n    return state$1(name, constant(value));\n  };\n\n  var snapshot = function (name) {\n    return state$1(name, identity);\n  };\n\n  var initSize = constant(_initSize);\n\n  var nu$7 = function (x, y, bubble, direction, boundsRestriction, label) {\n    return {\n      x: x,\n      y: y,\n      bubble: bubble,\n      direction: direction,\n      boundsRestriction: boundsRestriction,\n      label: label\n    };\n  };\n\n  var adt$2 = Adt.generate([{\n    southeast: []\n  }, {\n    southwest: []\n  }, {\n    northeast: []\n  }, {\n    northwest: []\n  }, {\n    south: []\n  }, {\n    north: []\n  }, {\n    east: []\n  }, {\n    west: []\n  }]);\n\n  var cata = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n    return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n  };\n\n  var cataVertical = function (subject, south, middle, north) {\n    return subject.fold(south, south, north, north, south, north, middle, middle);\n  };\n\n  var cataHorizontal = function (subject, east, middle, west) {\n    return subject.fold(east, west, east, west, middle, middle, east, west);\n  };\n\n  var southeast = adt$2.southeast;\n  var southwest = adt$2.southwest;\n  var northeast = adt$2.northeast;\n  var northwest = adt$2.northwest;\n  var south = adt$2.south;\n  var north = adt$2.north;\n  var east = adt$2.east;\n  var west = adt$2.west;\n\n  var getRestriction = function (anchor, restriction) {\n    switch (restriction) {\n      case 1:\n        return anchor.x;\n\n      case 0:\n        return anchor.x + anchor.width;\n\n      case 2:\n        return anchor.y;\n\n      case 3:\n        return anchor.y + anchor.height;\n    }\n  };\n\n  var boundsRestriction = function (anchor, restrictions) {\n    return mapToObject(['left', 'right', 'top', 'bottom'], function (dir) {\n      return get(restrictions, dir).map(function (restriction) {\n        return getRestriction(anchor, restriction);\n      });\n    });\n  };\n\n  var adjustBounds = function (bounds, boundsRestrictions, bubbleOffsets) {\n    var applyRestriction = function (dir, current) {\n      var bubbleOffset = dir === 'top' || dir === 'bottom' ? bubbleOffsets.top : bubbleOffsets.left;\n      return get(boundsRestrictions, dir).bind(identity).bind(function (restriction) {\n        if (dir === 'left' || dir === 'top') {\n          return restriction >= current ? Optional.some(restriction) : Optional.none();\n        } else {\n          return restriction <= current ? Optional.some(restriction) : Optional.none();\n        }\n      }).map(function (restriction) {\n        return restriction + bubbleOffset;\n      }).getOr(current);\n    };\n\n    var adjustedLeft = applyRestriction('left', bounds.x);\n    var adjustedTop = applyRestriction('top', bounds.y);\n    var adjustedRight = applyRestriction('right', bounds.right);\n    var adjustedBottom = applyRestriction('bottom', bounds.bottom);\n    return bounds$1(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n  };\n\n  var eastX = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var westX = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY = function (anchor, element) {\n    return anchor.y - element.height;\n  };\n\n  var southY = function (anchor) {\n    return anchor.y + anchor.height;\n  };\n\n  var centreY = function (anchor, element) {\n    return anchor.y + anchor.height / 2 - element.height / 2;\n  };\n\n  var eastEdgeX = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westEdgeX = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var southeast$1 = function (anchor, element, bubbles) {\n    return nu$7(eastX(anchor), southY(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n      left: 1,\n      top: 3\n    }), 'layout-se');\n  };\n\n  var southwest$1 = function (anchor, element, bubbles) {\n    return nu$7(westX(anchor, element), southY(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n      right: 0,\n      top: 3\n    }), 'layout-sw');\n  };\n\n  var northeast$1 = function (anchor, element, bubbles) {\n    return nu$7(eastX(anchor), northY(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n      left: 1,\n      bottom: 2\n    }), 'layout-ne');\n  };\n\n  var northwest$1 = function (anchor, element, bubbles) {\n    return nu$7(westX(anchor, element), northY(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n      right: 0,\n      bottom: 2\n    }), 'layout-nw');\n  };\n\n  var north$1 = function (anchor, element, bubbles) {\n    return nu$7(middleX(anchor, element), northY(anchor, element), bubbles.north(), north(), boundsRestriction(anchor, {\n      bottom: 2\n    }), 'layout-n');\n  };\n\n  var south$1 = function (anchor, element, bubbles) {\n    return nu$7(middleX(anchor, element), southY(anchor), bubbles.south(), south(), boundsRestriction(anchor, {\n      top: 3\n    }), 'layout-s');\n  };\n\n  var east$1 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX(anchor), centreY(anchor, element), bubbles.east(), east(), boundsRestriction(anchor, {\n      left: 0\n    }), 'layout-e');\n  };\n\n  var west$1 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX(anchor, element), centreY(anchor, element), bubbles.west(), west(), boundsRestriction(anchor, {\n      right: 1\n    }), 'layout-w');\n  };\n\n  var all$2 = function () {\n    return [southeast$1, southwest$1, northeast$1, northwest$1, south$1, north$1, east$1, west$1];\n  };\n\n  var allRtl = function () {\n    return [southwest$1, southeast$1, northwest$1, northeast$1, south$1, north$1, east$1, west$1];\n  };\n\n  var aboveOrBelow = function () {\n    return [northeast$1, northwest$1, southeast$1, southwest$1, north$1, south$1];\n  };\n\n  var aboveOrBelowRtl = function () {\n    return [northwest$1, northeast$1, southwest$1, southeast$1, north$1, south$1];\n  };\n\n  var belowOrAbove = function () {\n    return [southeast$1, southwest$1, northeast$1, northwest$1, south$1, north$1];\n  };\n\n  var belowOrAboveRtl = function () {\n    return [southwest$1, southeast$1, northwest$1, northeast$1, south$1, north$1];\n  };\n\n  var chooseChannels = function (channels, message) {\n    return message.universal ? channels : filter(channels, function (ch) {\n      return contains(message.channels, ch);\n    });\n  };\n\n  var events$1 = function (receiveConfig) {\n    return derive([run(receive(), function (component, message) {\n      var channelMap = receiveConfig.channels;\n      var channels = keys(channelMap);\n      var receivingData = message;\n      var targetChannels = chooseChannels(channels, receivingData);\n      each(targetChannels, function (ch) {\n        var channelInfo = channelMap[ch];\n        var channelSchema = channelInfo.schema;\n        var data = asRawOrDie('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n        channelInfo.onReceive(component, data);\n      });\n    })]);\n  };\n\n  var ActiveReceiving = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$1\n  });\n  var ReceivingSchema = [strictOf('channels', setOf$1(Result.value, objOfOnly([onStrictHandler('onReceive'), defaulted$1('schema', anyValue$1())])))];\n\n  var executeEvent = function (bConfig, bState, executor) {\n    return runOnExecute(function (component) {\n      executor(component, bConfig, bState);\n    });\n  };\n\n  var loadEvent = function (bConfig, bState, f) {\n    return runOnInit(function (component, _simulatedEvent) {\n      f(component, bConfig, bState);\n    });\n  };\n\n  var create = function (schema, name, active, apis, extra, state) {\n    var configSchema = objOfOnly(schema);\n    var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var createModes = function (modes, name, active, apis, extra, state) {\n    var configSchema = modes;\n    var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var wrapApi = function (bName, apiFunction, apiName) {\n    var f = function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      var args = [component].concat(rest);\n      return component.config({\n        name: constant(bName)\n      }).fold(function () {\n        throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n      }, function (info) {\n        var rest = Array.prototype.slice.call(args, 1);\n        return apiFunction.apply(undefined, [component, info.config, info.state].concat(rest));\n      });\n    };\n\n    return markAsBehaviourApi(f, apiName, apiFunction);\n  };\n\n  var revokeBehaviour = function (name) {\n    return {\n      key: name,\n      value: undefined\n    };\n  };\n\n  var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n    var getConfig = function (info) {\n      return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n    };\n\n    var wrappedApis = map$2(apis, function (apiF, apiName) {\n      return wrapApi(name, apiF, apiName);\n    });\n    var wrappedExtra = map$2(extra, function (extraF, extraName) {\n      return markAsExtraApi(extraF, extraName);\n    });\n\n    var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n      revoke: curry(revokeBehaviour, name),\n      config: function (spec) {\n        var prepared = asRawOrDie(name + '-config', configSchema, spec);\n        return {\n          key: name,\n          value: {\n            config: prepared,\n            me: me,\n            configAsRaw: cached(function () {\n              return asRawOrDie(name + '-config', configSchema, spec);\n            }),\n            initialConfig: spec,\n            state: state\n          }\n        };\n      },\n      schema: function () {\n        return schemaSchema;\n      },\n      exhibit: function (info, base) {\n        return getConfig(info).bind(function (behaviourInfo) {\n          return get(active, 'exhibit').map(function (exhibitor) {\n            return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n          });\n        }).getOr(nu$6({}));\n      },\n      name: function () {\n        return name;\n      },\n      handlers: function (info) {\n        return getConfig(info).map(function (behaviourInfo) {\n          var getEvents = get(active, 'events').getOr(function () {\n            return {};\n          });\n          return getEvents(behaviourInfo.config, behaviourInfo.state);\n        }).getOr({});\n      }\n    });\n\n    return me;\n  };\n\n  var derive$1 = function (capabilities) {\n    return wrapAll$1(capabilities);\n  };\n\n  var simpleSchema = objOfOnly([strict$1('fields'), strict$1('name'), defaulted$1('active', {}), defaulted$1('apis', {}), defaulted$1('state', NoState), defaulted$1('extra', {})]);\n\n  var create$1 = function (data) {\n    var value = asRawOrDie('Creating behaviour: ' + data.name, simpleSchema, data);\n    return create(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var modeSchema = objOfOnly([strict$1('branchKey'), strict$1('branches'), strict$1('name'), defaulted$1('active', {}), defaulted$1('apis', {}), defaulted$1('state', NoState), defaulted$1('extra', {})]);\n\n  var createModes$1 = function (data) {\n    var value = asRawOrDie('Creating behaviour: ' + data.name, modeSchema, data);\n    return createModes(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var revoke = constant(undefined);\n  var Receiving = create$1({\n    fields: ReceivingSchema,\n    name: 'receiving',\n    active: ActiveReceiving\n  });\n\n  var exhibit = function (base, posConfig) {\n    return nu$6({\n      classes: [],\n      styles: posConfig.useFixed() ? {} : {\n        position: 'relative'\n      }\n    });\n  };\n\n  var ActivePosition = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit\n  });\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus$1 = function (element) {\n    return element.dom.focus();\n  };\n\n  var blur = function (element) {\n    return element.dom.blur();\n  };\n\n  var hasFocus = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var preserve = function (f, container) {\n    var dos = getRootNode(container);\n    var refocus = active(dos).bind(function (focused) {\n      var hasFocus = function (elem) {\n        return eq$1(focused, elem);\n      };\n\n      return hasFocus(container) ? Optional.some(container) : descendant(container, hasFocus);\n    });\n    var result = f(container);\n    refocus.each(function (oldFocus) {\n      active(dos).filter(function (newFocus) {\n        return eq$1(newFocus, oldFocus);\n      }).fold(function () {\n        focus$1(oldFocus);\n      }, noop);\n    });\n    return result;\n  };\n\n  var NuPositionCss = function (position, left, top, right, bottom) {\n    return {\n      position: position,\n      left: left,\n      top: top,\n      right: right,\n      bottom: bottom\n    };\n  };\n\n  var applyPositionCss = function (element, position) {\n    var addPx = function (num) {\n      return num + 'px';\n    };\n\n    setOptions(element, {\n      position: Optional.some(position.position),\n      left: position.left.map(addPx),\n      top: position.top.map(addPx),\n      right: position.right.map(addPx),\n      bottom: position.bottom.map(addPx)\n    });\n  };\n\n  var adt$3 = Adt.generate([{\n    none: []\n  }, {\n    relative: ['x', 'y', 'width', 'height']\n  }, {\n    fixed: ['x', 'y', 'width', 'height']\n  }]);\n\n  var positionWithDirection = function (posName, decision, x, y, width, height) {\n    var decisionX = decision.x - x;\n    var decisionY = decision.y - y;\n    var decisionWidth = decision.width;\n    var decisionHeight = decision.height;\n    var decisionRight = width - (decisionX + decisionWidth);\n    var decisionBottom = height - (decisionY + decisionHeight);\n    var left = Optional.some(decisionX);\n    var top = Optional.some(decisionY);\n    var right = Optional.some(decisionRight);\n    var bottom = Optional.some(decisionBottom);\n    var none = Optional.none();\n    return cata(decision.direction, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, none, none, right, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    });\n  };\n\n  var reposition = function (origin, decision) {\n    return origin.fold(function () {\n      return NuPositionCss('absolute', Optional.some(decision.x), Optional.some(decision.y), Optional.none(), Optional.none());\n    }, function (x, y, width, height) {\n      return positionWithDirection('absolute', decision, x, y, width, height);\n    }, function (x, y, width, height) {\n      return positionWithDirection('fixed', decision, x, y, width, height);\n    });\n  };\n\n  var toBox = function (origin, element) {\n    var rel = curry(find$3, element);\n    var position = origin.fold(rel, rel, function () {\n      var scroll = get$8();\n      return find$3(element).translate(-scroll.left, -scroll.top);\n    });\n    var width = getOuter$2(element);\n    var height = getOuter$1(element);\n    return bounds$1(position.left, position.top, width, height);\n  };\n\n  var viewport$1 = function (origin, getBounds) {\n    return getBounds.fold(function () {\n      return origin.fold(win, win, bounds$1);\n    }, function (b) {\n      return origin.fold(b, b, function () {\n        var bounds = b();\n        var pos = translate(origin, bounds.x, bounds.y);\n        return bounds$1(pos.left, pos.top, bounds.width, bounds.height);\n      });\n    });\n  };\n\n  var translate = function (origin, x, y) {\n    var pos = SugarPosition(x, y);\n\n    var removeScroll = function () {\n      var outerScroll = get$8();\n      return pos.translate(-outerScroll.left, -outerScroll.top);\n    };\n\n    return origin.fold(constant(pos), constant(pos), removeScroll);\n  };\n\n  var cata$1 = function (subject, onNone, onRelative, onFixed) {\n    return subject.fold(onNone, onRelative, onFixed);\n  };\n\n  var none$1 = adt$3.none;\n  var relative = adt$3.relative;\n  var fixed = adt$3.fixed;\n\n  var anchor = function (anchorBox, origin) {\n    return {\n      anchorBox: anchorBox,\n      origin: origin\n    };\n  };\n\n  var box$1 = function (anchorBox, origin) {\n    return anchor(anchorBox, origin);\n  };\n\n  var cycleBy = function (value, delta, min, max) {\n    var r = value + delta;\n    return r > max ? min : r < min ? max : r;\n  };\n\n  var clamp = function (value, min, max) {\n    return Math.min(Math.max(value, min), max);\n  };\n\n  var adt$4 = Adt.generate([{\n    fit: ['reposition']\n  }, {\n    nofit: ['reposition', 'deltaW', 'deltaH']\n  }]);\n\n  var calcReposition = function (newX, newY, width, height, bounds) {\n    var boundsX = bounds.x;\n    var boundsY = bounds.y;\n    var boundsWidth = bounds.width;\n    var boundsHeight = bounds.height;\n    var xInBounds = newX >= boundsX;\n    var yInBounds = newY >= boundsY;\n    var originInBounds = xInBounds && yInBounds;\n    var xFit = newX + width <= boundsX + boundsWidth;\n    var yFit = newY + height <= boundsY + boundsHeight;\n    var sizeInBounds = xFit && yFit;\n    var deltaW = Math.abs(Math.min(width, xInBounds ? boundsX + boundsWidth - newX : boundsX - (newX + width)));\n    var deltaH = Math.abs(Math.min(height, yInBounds ? boundsY + boundsHeight - newY : boundsY - (newY + height)));\n    var maxX = Math.max(bounds.x, bounds.right - width);\n    var maxY = Math.max(bounds.y, bounds.bottom - height);\n    var limitX = clamp(newX, bounds.x, maxX);\n    var limitY = clamp(newY, bounds.y, maxY);\n    return {\n      originInBounds: originInBounds,\n      sizeInBounds: sizeInBounds,\n      limitX: limitX,\n      limitY: limitY,\n      deltaW: deltaW,\n      deltaH: deltaH\n    };\n  };\n\n  var attempt = function (candidate, width, height, bounds) {\n    var candidateX = candidate.x;\n    var candidateY = candidate.y;\n    var bubbleOffsets = candidate.bubble.offset;\n    var bubbleLeft = bubbleOffsets.left;\n    var bubbleTop = bubbleOffsets.top;\n    var adjustedBounds = adjustBounds(bounds, candidate.boundsRestriction, bubbleOffsets);\n    var boundsY = adjustedBounds.y;\n    var boundsBottom = adjustedBounds.bottom;\n    var boundsX = adjustedBounds.x;\n    var boundsRight = adjustedBounds.right;\n    var newX = candidateX + bubbleLeft;\n    var newY = candidateY + bubbleTop;\n\n    var _a = calcReposition(newX, newY, width, height, adjustedBounds),\n        originInBounds = _a.originInBounds,\n        sizeInBounds = _a.sizeInBounds,\n        limitX = _a.limitX,\n        limitY = _a.limitY,\n        deltaW = _a.deltaW,\n        deltaH = _a.deltaH;\n\n    var upAvailable = constant(limitY + deltaH - boundsY);\n    var downAvailable = constant(boundsBottom - limitY);\n    var maxHeight = cataVertical(candidate.direction, downAvailable, downAvailable, upAvailable);\n    var westAvailable = constant(limitX + deltaW - boundsX);\n    var eastAvailable = constant(boundsRight - limitX);\n    var maxWidth = cataHorizontal(candidate.direction, eastAvailable, eastAvailable, westAvailable);\n    var reposition = {\n      x: limitX,\n      y: limitY,\n      width: deltaW,\n      height: deltaH,\n      maxHeight: maxHeight,\n      maxWidth: maxWidth,\n      direction: candidate.direction,\n      classes: {\n        on: candidate.bubble.classesOn,\n        off: candidate.bubble.classesOff\n      },\n      label: candidate.label,\n      candidateYforTest: newY\n    };\n    return originInBounds && sizeInBounds ? adt$4.fit(reposition) : adt$4.nofit(reposition, deltaW, deltaH);\n  };\n\n  var attempts = function (candidates, anchorBox, elementBox, bubbles, bounds) {\n    var panelWidth = elementBox.width;\n    var panelHeight = elementBox.height;\n\n    var attemptBestFit = function (layout, reposition, deltaW, deltaH) {\n      var next = layout(anchorBox, elementBox, bubbles);\n      var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n      return attemptLayout.fold(adt$4.fit, function (newReposition, newDeltaW, newDeltaH) {\n        var improved = newDeltaH > deltaH || newDeltaW > deltaW;\n        return improved ? adt$4.nofit(newReposition, newDeltaW, newDeltaH) : adt$4.nofit(reposition, deltaW, deltaH);\n      });\n    };\n\n    var abc = foldl(candidates, function (b, a) {\n      var bestNext = curry(attemptBestFit, a);\n      return b.fold(adt$4.fit, bestNext);\n    }, adt$4.nofit({\n      x: anchorBox.x,\n      y: anchorBox.y,\n      width: elementBox.width,\n      height: elementBox.height,\n      maxHeight: elementBox.height,\n      maxWidth: elementBox.width,\n      direction: southeast(),\n      classes: {\n        on: [],\n        off: []\n      },\n      label: 'none',\n      candidateYforTest: anchorBox.y\n    }, -1, -1));\n    return abc.fold(identity, identity);\n  };\n\n  var elementSize = function (p) {\n    return {\n      width: getOuter$2(p),\n      height: getOuter$1(p)\n    };\n  };\n\n  var layout = function (anchorBox, element, bubbles, options) {\n    remove$6(element, 'max-height');\n    remove$6(element, 'max-width');\n    var elementBox = elementSize(element);\n    return attempts(options.preference, anchorBox, elementBox, bubbles, options.bounds);\n  };\n\n  var setClasses = function (element, decision) {\n    var classInfo = decision.classes;\n    remove$5(element, classInfo.off);\n    add$3(element, classInfo.on);\n  };\n\n  var setHeight = function (element, decision, options) {\n    var maxHeightFunction = options.maxHeightFunction;\n    maxHeightFunction(element, decision.maxHeight);\n  };\n\n  var setWidth = function (element, decision, options) {\n    var maxWidthFunction = options.maxWidthFunction;\n    maxWidthFunction(element, decision.maxWidth);\n  };\n\n  var position = function (element, decision, options) {\n    applyPositionCss(element, reposition(options.origin, decision));\n  };\n\n  var setMaxHeight = function (element, maxHeight) {\n    setMax(element, Math.floor(maxHeight));\n  };\n\n  var anchored = constant(function (element, available) {\n    setMaxHeight(element, available);\n    setAll$1(element, {\n      'overflow-x': 'hidden',\n      'overflow-y': 'auto'\n    });\n  });\n  var expandable = constant(function (element, available) {\n    setMaxHeight(element, available);\n  });\n\n  var defaultOr = function (options, key, dephault) {\n    return options[key] === undefined ? dephault : options[key];\n  };\n\n  var simple = function (anchor, element, bubble, layouts, getBounds, overrideOptions) {\n    var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n    var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n    var anchorBox = anchor.anchorBox;\n    var origin = anchor.origin;\n    var options = {\n      bounds: viewport$1(origin, getBounds),\n      origin: origin,\n      preference: layouts,\n      maxHeightFunction: maxHeightFunction,\n      maxWidthFunction: maxWidthFunction\n    };\n    go(anchorBox, element, bubble, options);\n  };\n\n  var go = function (anchorBox, element, bubble, options) {\n    var decision = layout(anchorBox, element, bubble, options);\n    position(element, decision, options);\n    setClasses(element, decision);\n    setHeight(element, decision, options);\n    setWidth(element, decision, options);\n  };\n\n  var allAlignments = ['valignCentre', 'alignLeft', 'alignRight', 'alignCentre', 'top', 'bottom', 'left', 'right'];\n\n  var nu$8 = function (width, yoffset, classes) {\n    var getClasses = function (prop) {\n      return get(classes, prop).getOr([]);\n    };\n\n    var make = function (xDelta, yDelta, alignmentsOn) {\n      var alignmentsOff = difference(allAlignments, alignmentsOn);\n      return {\n        offset: SugarPosition(xDelta, yDelta),\n        classesOn: bind(alignmentsOn, getClasses),\n        classesOff: bind(alignmentsOff, getClasses)\n      };\n    };\n\n    return {\n      southeast: function () {\n        return make(-width, yoffset, ['top', 'alignLeft']);\n      },\n      southwest: function () {\n        return make(width, yoffset, ['top', 'alignRight']);\n      },\n      south: function () {\n        return make(-width / 2, yoffset, ['top', 'alignCentre']);\n      },\n      northeast: function () {\n        return make(-width, -yoffset, ['bottom', 'alignLeft']);\n      },\n      northwest: function () {\n        return make(width, -yoffset, ['bottom', 'alignRight']);\n      },\n      north: function () {\n        return make(-width / 2, -yoffset, ['bottom', 'alignCentre']);\n      },\n      east: function () {\n        return make(width, -yoffset / 2, ['valignCentre', 'left']);\n      },\n      west: function () {\n        return make(-width, -yoffset / 2, ['valignCentre', 'right']);\n      },\n      innerNorthwest: function () {\n        return make(-width, yoffset, ['top', 'alignRight']);\n      },\n      innerNortheast: function () {\n        return make(width, yoffset, ['top', 'alignLeft']);\n      },\n      innerNorth: function () {\n        return make(-width / 2, yoffset, ['top', 'alignCentre']);\n      },\n      innerSouthwest: function () {\n        return make(-width, -yoffset, ['bottom', 'alignRight']);\n      },\n      innerSoutheast: function () {\n        return make(width, -yoffset, ['bottom', 'alignLeft']);\n      },\n      innerSouth: function () {\n        return make(-width / 2, -yoffset, ['bottom', 'alignCentre']);\n      },\n      innerWest: function () {\n        return make(width, -yoffset / 2, ['valignCentre', 'right']);\n      },\n      innerEast: function () {\n        return make(-width, -yoffset / 2, ['valignCentre', 'left']);\n      }\n    };\n  };\n\n  var fallback = function () {\n    return nu$8(0, 0, {});\n  };\n\n  var nu$9 = function (x) {\n    return x;\n  };\n\n  var onDirection = function (isLtr, isRtl) {\n    return function (element) {\n      return getDirection(element) === 'rtl' ? isRtl : isLtr;\n    };\n  };\n\n  var getDirection = function (element) {\n    return get$4(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n  };\n\n  var AttributeValue;\n\n  (function (AttributeValue) {\n    AttributeValue['TopToBottom'] = 'toptobottom';\n    AttributeValue['BottomToTop'] = 'bottomtotop';\n  })(AttributeValue || (AttributeValue = {}));\n\n  var Attribute = 'data-alloy-vertical-dir';\n\n  var isBottomToTopDir = function (el) {\n    return closest$2(el, function (current) {\n      return isElement(current) && get$2(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n    });\n  };\n\n  var schema$1 = function () {\n    return optionObjOf('layouts', [strict$1('onLtr'), strict$1('onRtl'), option('onBottomLtr'), option('onBottomRtl')]);\n  };\n\n  var get$a = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n    var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n    var customLtr = info.layouts.map(function (ls) {\n      return ls.onLtr(elem);\n    });\n    var customRtl = info.layouts.map(function (ls) {\n      return ls.onRtl(elem);\n    });\n    var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomLtr.map(function (f) {\n        return f(elem);\n      });\n    }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n    var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomRtl.map(function (f) {\n        return f(elem);\n      });\n    }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n    var f = onDirection(ltr, rtl);\n    return f(elem);\n  };\n\n  var placement = function (component, anchorInfo, origin) {\n    var hotspot = anchorInfo.hotspot;\n    var anchorBox = toBox(origin, hotspot.element);\n    var layouts = get$a(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble.getOr(fallback()),\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var HotspotAnchor = [strict$1('hotspot'), option('bubble'), defaulted$1('overrides', {}), schema$1(), output('placement', placement)];\n\n  var placement$1 = function (component, anchorInfo, origin) {\n    var pos = translate(origin, anchorInfo.x, anchorInfo.y);\n    var anchorBox = bounds$1(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n    var layouts = get$a(component.element, anchorInfo, all$2(), allRtl(), all$2(), allRtl(), Optional.none());\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble,\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var MakeshiftAnchor = [strict$1('x'), strict$1('y'), defaulted$1('height', 0), defaulted$1('width', 0), defaulted$1('bubble', fallback()), defaulted$1('overrides', {}), schema$1(), output('placement', placement$1)];\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var create$2 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$2\n  };\n  var adt$5 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata$2 = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$2 = adt$5.before;\n  var on = adt$5.on;\n  var after$1 = adt$5.after;\n  var Situ = {\n    before: before$2,\n    on: on,\n    after: after$1,\n    cata: cata$2,\n    getStart: getStart\n  };\n  var adt$6 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$6.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart$1 = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$6.domRange;\n  var relative$1 = adt$6.relative;\n  var exact = adt$6.exact;\n\n  var getWin = function (selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range$1 = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative$1,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range$1\n  };\n\n  var setStart = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setStartBefore(e.dom);\n    }, function (e, o) {\n      rng.setStart(e.dom, o);\n    }, function (e) {\n      rng.setStartAfter(e.dom);\n    });\n  };\n\n  var setFinish = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setEndBefore(e.dom);\n    }, function (e, o) {\n      rng.setEnd(e.dom, o);\n    }, function (e) {\n      rng.setEndAfter(e.dom);\n    });\n  };\n\n  var relativeToNative = function (win, startSitu, finishSitu) {\n    var range = win.document.createRange();\n    setStart(range, startSitu);\n    setFinish(range, finishSitu);\n    return range;\n  };\n\n  var exactToNative = function (win, start, soffset, finish, foffset) {\n    var rng = win.document.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var toRect = function (rect) {\n    return {\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      width: rect.width,\n      height: rect.height\n    };\n  };\n\n  var getFirstRect = function (rng) {\n    var rects = rng.getClientRects();\n    var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n  };\n\n  var adt$7 = Adt.generate([{\n    ltr: ['start', 'soffset', 'finish', 'foffset']\n  }, {\n    rtl: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var fromRange = function (win, type, range) {\n    return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n  };\n\n  var getRanges = function (win, selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return {\n          ltr: constant(rng),\n          rtl: Optional.none\n        };\n      },\n      relative: function (startSitu, finishSitu) {\n        return {\n          ltr: cached(function () {\n            return relativeToNative(win, startSitu, finishSitu);\n          }),\n          rtl: cached(function () {\n            return Optional.some(relativeToNative(win, finishSitu, startSitu));\n          })\n        };\n      },\n      exact: function (start, soffset, finish, foffset) {\n        return {\n          ltr: cached(function () {\n            return exactToNative(win, start, soffset, finish, foffset);\n          }),\n          rtl: cached(function () {\n            return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n          })\n        };\n      }\n    });\n  };\n\n  var doDiagnose = function (win, ranges) {\n    var rng = ranges.ltr();\n\n    if (rng.collapsed) {\n      var reversed = ranges.rtl().filter(function (rev) {\n        return rev.collapsed === false;\n      });\n      return reversed.map(function (rev) {\n        return adt$7.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n      }).getOrThunk(function () {\n        return fromRange(win, adt$7.ltr, rng);\n      });\n    } else {\n      return fromRange(win, adt$7.ltr, rng);\n    }\n  };\n\n  var diagnose = function (win, selection) {\n    var ranges = getRanges(win, selection);\n    return doDiagnose(win, ranges);\n  };\n\n  var asLtrRange = function (win, selection) {\n    var diagnosis = diagnose(win, selection);\n    return diagnosis.match({\n      ltr: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(start.dom, soffset);\n        rng.setEnd(finish.dom, foffset);\n        return rng;\n      },\n      rtl: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(finish.dom, foffset);\n        rng.setEnd(start.dom, soffset);\n        return rng;\n      }\n    });\n  };\n\n  var ltr = adt$7.ltr;\n  var rtl = adt$7.rtl;\n\n  function NodeValue(is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  }\n\n  var api$2 = NodeValue(isText, 'text');\n\n  var get$b = function (element) {\n    return api$2.get(element);\n  };\n\n  var getOption = function (element) {\n    return api$2.getOption(element);\n  };\n\n  var getEnd = function (element) {\n    return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n      return children(element).length;\n    }, function (v) {\n      return v.length;\n    });\n  };\n\n  var isTextNodeWithCursorPosition = function (el) {\n    return getOption(el).filter(function (text) {\n      return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n    }).isSome();\n  };\n\n  var elementsWithCursorPosition = ['img', 'br'];\n\n  var isCursorPosition = function (elem) {\n    var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n    return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n  };\n\n  var last$1 = function (element) {\n    return descendantRtl(element, isCursorPosition);\n  };\n\n  var descendantRtl = function (scope, predicate) {\n    var descend = function (element) {\n      var children$1 = children(element);\n\n      for (var i = children$1.length - 1; i >= 0; i--) {\n        var child = children$1[i];\n\n        if (predicate(child)) {\n          return Optional.some(child);\n        }\n\n        var res = descend(child);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope);\n  };\n\n  var descendants = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var makeRange = function (start, soffset, finish, foffset) {\n    var doc = owner(start);\n    var rng = doc.dom.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var after$2 = function (start, soffset, finish, foffset) {\n    var r = makeRange(start, soffset, finish, foffset);\n    var same = eq$1(start, finish) && soffset === foffset;\n    return r.collapsed && !same;\n  };\n\n  var getNativeSelection = function (win) {\n    return Optional.from(win.getSelection());\n  };\n\n  var readRange = function (selection) {\n    if (selection.rangeCount > 0) {\n      var firstRng = selection.getRangeAt(0);\n      var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n      return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var doGetExact = function (selection) {\n    if (selection.anchorNode === null || selection.focusNode === null) {\n      return readRange(selection);\n    } else {\n      var anchor = SugarElement.fromDom(selection.anchorNode);\n      var focus_1 = SugarElement.fromDom(selection.focusNode);\n      return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n    }\n  };\n\n  var getExact = function (win) {\n    return getNativeSelection(win).filter(function (sel) {\n      return sel.rangeCount > 0;\n    }).bind(doGetExact);\n  };\n\n  var getFirstRect$1 = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getFirstRect(rng);\n  };\n\n  var point = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var descendOnce = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0) {\n      return point(element, offset);\n    } else if (offset < children$1.length) {\n      return point(children$1[offset], 0);\n    } else {\n      var last = children$1[children$1.length - 1];\n      var len = isText(last) ? get$b(last).length : children(last).length;\n      return point(last, len);\n    }\n  };\n\n  var adt$8 = Adt.generate([{\n    screen: ['point']\n  }, {\n    absolute: ['point', 'scrollLeft', 'scrollTop']\n  }]);\n\n  var toFixed = function (pos) {\n    return pos.fold(identity, function (point, scrollLeft, scrollTop) {\n      return point.translate(-scrollLeft, -scrollTop);\n    });\n  };\n\n  var toAbsolute = function (pos) {\n    return pos.fold(identity, identity);\n  };\n\n  var sum = function (points) {\n    return foldl(points, function (b, a) {\n      return b.translate(a.left, a.top);\n    }, SugarPosition(0, 0));\n  };\n\n  var sumAsFixed = function (positions) {\n    var points = map(positions, toFixed);\n    return sum(points);\n  };\n\n  var sumAsAbsolute = function (positions) {\n    var points = map(positions, toAbsolute);\n    return sum(points);\n  };\n\n  var screen = adt$8.screen;\n  var absolute$2 = adt$8.absolute;\n\n  var getOffset = function (component, origin, anchorInfo) {\n    var win = defaultView(anchorInfo.root).dom;\n\n    var hasSameOwner = function (frame) {\n      var frameOwner = owner(frame);\n      var compOwner = owner(component.element);\n      return eq$1(frameOwner, compOwner);\n    };\n\n    return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute);\n  };\n\n  var getRootPoint = function (component, origin, anchorInfo) {\n    var doc = owner(component.element);\n    var outerScroll = get$8(doc);\n    var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n    return absolute$2(offset, outerScroll.left, outerScroll.top);\n  };\n\n  var capRect = function (left, top, width, height) {\n    var newLeft = left,\n        newTop = top,\n        newWidth = width,\n        newHeight = height;\n\n    if (left < 0) {\n      newLeft = 0;\n      newWidth = width + left;\n    }\n\n    if (top < 0) {\n      newTop = 0;\n      newHeight = height + top;\n    }\n\n    var point = screen(SugarPosition(newLeft, newTop));\n    return Optional.some(pointed(point, newWidth, newHeight));\n  };\n\n  var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n    return optBox.map(function (box) {\n      var points = [rootPoint, box.point];\n      var topLeft = cata$1(origin, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsFixed(points);\n      });\n      var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n      var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n      var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n      var layouts = get$a(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n      return nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      });\n    });\n  };\n\n  var point$1 = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var descendOnce$1 = function (element, offset) {\n    return isText(element) ? point$1(element, offset) : descendOnce(element, offset);\n  };\n\n  var getAnchorSelection = function (win, anchorInfo) {\n    var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n      return function () {\n        return getExact(win);\n      };\n    });\n    return getSelection().map(function (sel) {\n      var modStart = descendOnce$1(sel.start, sel.soffset);\n      var modFinish = descendOnce$1(sel.finish, sel.foffset);\n      return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n    });\n  };\n\n  var placement$2 = function (component, anchorInfo, origin) {\n    var win = defaultView(anchorInfo.root).dom;\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      var optRect = getFirstRect$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n        var x = SugarElement.fromText(zeroWidth);\n        before(sel.start, x);\n        return getFirstRect$1(win, SimSelection.exact(x, 0, x, 1)).map(function (rect) {\n          remove(x);\n          return rect;\n        });\n      });\n      return optRect.bind(function (rawRect) {\n        return capRect(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n      });\n    });\n    var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      return isElement(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n    });\n    var elem = targetElement.getOr(component.element);\n    return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n  };\n\n  var SelectionAnchor = [option('getSelection'), strict$1('root'), option('bubble'), schema$1(), defaulted$1('overrides', {}), defaulted$1('showAbove', false), output('placement', placement$2)];\n\n  var placement$3 = function (component, anchorInfo, origin) {\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    return anchorInfo.node.bind(function (target) {\n      var rect = target.dom.getBoundingClientRect();\n      var nodeBox = capRect(rect.left, rect.top, rect.width, rect.height);\n      var elem = anchorInfo.node.getOr(component.element);\n      return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n    });\n  };\n\n  var NodeAnchor = [strict$1('node'), strict$1('root'), option('bubble'), schema$1(), defaulted$1('overrides', {}), defaulted$1('showAbove', false), output('placement', placement$3)];\n\n  var eastX$1 = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westX$1 = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var northY$1 = function (anchor, element) {\n    return anchor.y - element.height + anchor.height;\n  };\n\n  var southY$1 = function (anchor) {\n    return anchor.y;\n  };\n\n  var southeast$2 = function (anchor, element, bubbles) {\n    return nu$7(eastX$1(anchor), southY$1(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n      left: 0,\n      top: 2\n    }), 'link-layout-se');\n  };\n\n  var southwest$2 = function (anchor, element, bubbles) {\n    return nu$7(westX$1(anchor, element), southY$1(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n      right: 1,\n      top: 2\n    }), 'link-layout-sw');\n  };\n\n  var northeast$2 = function (anchor, element, bubbles) {\n    return nu$7(eastX$1(anchor), northY$1(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n      left: 0,\n      bottom: 3\n    }), 'link-layout-ne');\n  };\n\n  var northwest$2 = function (anchor, element, bubbles) {\n    return nu$7(westX$1(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n      right: 1,\n      bottom: 3\n    }), 'link-layout-nw');\n  };\n\n  var all$3 = function () {\n    return [southeast$2, southwest$2, northeast$2, northwest$2];\n  };\n\n  var allRtl$1 = function () {\n    return [southwest$2, southeast$2, northwest$2, northeast$2];\n  };\n\n  var placement$4 = function (component, submenuInfo, origin) {\n    var anchorBox = toBox(origin, submenuInfo.item.element);\n    var layouts = get$a(component.element, submenuInfo, all$3(), allRtl$1(), all$3(), allRtl$1(), Optional.none());\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: fallback(),\n      overrides: submenuInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var SubmenuAnchor = [strict$1('item'), schema$1(), defaulted$1('overrides', {}), output('placement', placement$4)];\n  var AnchorSchema = choose$1('anchor', {\n    selection: SelectionAnchor,\n    node: NodeAnchor,\n    hotspot: HotspotAnchor,\n    submenu: SubmenuAnchor,\n    makeshift: MakeshiftAnchor\n  });\n\n  var getFixedOrigin = function () {\n    var html = document.documentElement;\n    return fixed(0, 0, html.clientWidth, html.clientHeight);\n  };\n\n  var getRelativeOrigin = function (component) {\n    var position = absolute(component.element);\n    var bounds = component.element.dom.getBoundingClientRect();\n    return relative(position.left, position.top, bounds.width, bounds.height);\n  };\n\n  var place = function (component, origin, anchoring, getBounds, placee) {\n    var anchor = box$1(anchoring.anchorBox, origin);\n    simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, getBounds, anchoring.overrides);\n  };\n\n  var position$1 = function (component, posConfig, posState, anchor, placee) {\n    positionWithin(component, posConfig, posState, anchor, placee, Optional.none());\n  };\n\n  var positionWithin = function (component, posConfig, posState, anchor, placee, boxElement) {\n    var boundsBox = boxElement.map(box);\n    return positionWithinBounds(component, posConfig, posState, anchor, placee, boundsBox);\n  };\n\n  var positionWithinBounds = function (component, posConfig, posState, anchor, placee, bounds) {\n    var anchorage = asRawOrDie('positioning anchor.info', AnchorSchema, anchor);\n    preserve(function () {\n      set$2(placee.element, 'position', 'fixed');\n      var oldVisibility = getRaw(placee.element, 'visibility');\n      set$2(placee.element, 'visibility', 'hidden');\n      var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n      var placer = anchorage.placement;\n      var getBounds = bounds.map(constant).or(posConfig.getBounds);\n      placer(component, anchorage, origin).each(function (anchoring) {\n        var doPlace = anchoring.placer.getOr(place);\n        doPlace(component, origin, anchoring, getBounds, placee);\n      });\n      oldVisibility.fold(function () {\n        remove$6(placee.element, 'visibility');\n      }, function (vis) {\n        set$2(placee.element, 'visibility', vis);\n      });\n\n      if (getRaw(placee.element, 'left').isNone() && getRaw(placee.element, 'top').isNone() && getRaw(placee.element, 'right').isNone() && getRaw(placee.element, 'bottom').isNone() && getRaw(placee.element, 'position').is('fixed')) {\n        remove$6(placee.element, 'position');\n      }\n    }, placee.element);\n  };\n\n  var getMode = function (component, pConfig, _pState) {\n    return pConfig.useFixed() ? 'fixed' : 'absolute';\n  };\n\n  var PositionApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    position: position$1,\n    positionWithin: positionWithin,\n    positionWithinBounds: positionWithinBounds,\n    getMode: getMode\n  });\n  var PositionSchema = [defaulted$1('useFixed', never), option('getBounds')];\n  var Positioning = create$1({\n    fields: PositionSchema,\n    name: 'positioning',\n    active: ActivePosition,\n    apis: PositionApis\n  });\n\n  var fireDetaching = function (component) {\n    emit(component, detachedFromDom());\n    var children = component.components();\n    each(children, fireDetaching);\n  };\n\n  var fireAttaching = function (component) {\n    var children = component.components();\n    each(children, fireAttaching);\n    emit(component, attachedToDom());\n  };\n\n  var attach = function (parent, child) {\n    append(parent.element, child.element);\n  };\n\n  var detachChildren = function (component) {\n    each(component.components(), function (childComp) {\n      return remove(childComp.element);\n    });\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var replaceChildren = function (component, newChildren) {\n    var subs = component.components();\n    detachChildren(component);\n    var deleted = difference(subs, newChildren);\n    each(deleted, function (comp) {\n      fireDetaching(comp);\n      component.getSystem().removeFromWorld(comp);\n    });\n    each(newChildren, function (childComp) {\n      if (!childComp.getSystem().isConnected()) {\n        component.getSystem().addToWorld(childComp);\n        attach(component, childComp);\n\n        if (inBody(component.element)) {\n          fireAttaching(childComp);\n        }\n      } else {\n        attach(component, childComp);\n      }\n\n      component.syncComponents();\n    });\n  };\n\n  var attach$1 = function (parent, child) {\n    attachWith(parent, child, append);\n  };\n\n  var attachWith = function (parent, child, insertion) {\n    parent.getSystem().addToWorld(child);\n    insertion(parent.element, child.element);\n\n    if (inBody(parent.element)) {\n      fireAttaching(child);\n    }\n\n    parent.syncComponents();\n  };\n\n  var doDetach = function (component) {\n    fireDetaching(component);\n    remove(component.element);\n    component.getSystem().removeFromWorld(component);\n  };\n\n  var detach = function (component) {\n    var parent$1 = parent(component.element).bind(function (p) {\n      return component.getSystem().getByDom(p).toOptional();\n    });\n    doDetach(component);\n    parent$1.each(function (p) {\n      p.syncComponents();\n    });\n  };\n\n  var detachChildren$1 = function (component) {\n    var subs = component.components();\n    each(subs, doDetach);\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var attachSystem = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, append);\n  };\n\n  var attachSystemAfter = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, after);\n  };\n\n  var attachSystemWith = function (element, guiSystem, inserter) {\n    inserter(element, guiSystem.element);\n    var children$1 = children(guiSystem.element);\n    each(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireAttaching);\n    });\n  };\n\n  var detachSystem = function (guiSystem) {\n    var children$1 = children(guiSystem.element);\n    each(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireDetaching);\n    });\n    remove(guiSystem.element);\n  };\n\n  var rebuild = function (sandbox, sConfig, sState, data) {\n    sState.get().each(function (_data) {\n      detachChildren$1(sandbox);\n    });\n    var point = sConfig.getAttachPoint(sandbox);\n    attach$1(point, sandbox);\n    var built = sandbox.getSystem().build(data);\n    attach$1(sandbox, built);\n    sState.set(built);\n    return built;\n  };\n\n  var open = function (sandbox, sConfig, sState, data) {\n    var newState = rebuild(sandbox, sConfig, sState, data);\n    sConfig.onOpen(sandbox, newState);\n    return newState;\n  };\n\n  var setContent = function (sandbox, sConfig, sState, data) {\n    return sState.get().map(function () {\n      return rebuild(sandbox, sConfig, sState, data);\n    });\n  };\n\n  var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n    cloak(sandbox, sConfig);\n    open(sandbox, sConfig, sState, data);\n    transaction();\n    decloak(sandbox, sConfig);\n  };\n\n  var close = function (sandbox, sConfig, sState) {\n    sState.get().each(function (data) {\n      detachChildren$1(sandbox);\n      detach(sandbox);\n      sConfig.onClose(sandbox, data);\n      sState.clear();\n    });\n  };\n\n  var isOpen = function (_sandbox, _sConfig, sState) {\n    return sState.isOpen();\n  };\n\n  var isPartOf$1 = function (sandbox, sConfig, sState, queryElem) {\n    return isOpen(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n      return sConfig.isPartOf(sandbox, data, queryElem);\n    });\n  };\n\n  var getState = function (_sandbox, _sConfig, sState) {\n    return sState.get();\n  };\n\n  var store = function (sandbox, cssKey, attr, newValue) {\n    getRaw(sandbox.element, cssKey).fold(function () {\n      remove$1(sandbox.element, attr);\n    }, function (v) {\n      set$1(sandbox.element, attr, v);\n    });\n    set$2(sandbox.element, cssKey, newValue);\n  };\n\n  var restore = function (sandbox, cssKey, attr) {\n    getOpt(sandbox.element, attr).fold(function () {\n      return remove$6(sandbox.element, cssKey);\n    }, function (oldValue) {\n      return set$2(sandbox.element, cssKey, oldValue);\n    });\n  };\n\n  var cloak = function (sandbox, sConfig, _sState) {\n    var sink = sConfig.getAttachPoint(sandbox);\n    set$2(sandbox.element, 'position', Positioning.getMode(sink));\n    store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n  };\n\n  var hasPosition = function (element) {\n    return exists(['top', 'left', 'right', 'bottom'], function (pos) {\n      return getRaw(element, pos).isSome();\n    });\n  };\n\n  var decloak = function (sandbox, sConfig, _sState) {\n    if (!hasPosition(sandbox.element)) {\n      remove$6(sandbox.element, 'position');\n    }\n\n    restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n  };\n\n  var SandboxApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    cloak: cloak,\n    decloak: decloak,\n    open: open,\n    openWhileCloaked: openWhileCloaked,\n    close: close,\n    isOpen: isOpen,\n    isPartOf: isPartOf$1,\n    getState: getState,\n    setContent: setContent\n  });\n\n  var events$2 = function (sandboxConfig, sandboxState) {\n    return derive([run(sandboxClose(), function (sandbox, _simulatedEvent) {\n      close(sandbox, sandboxConfig, sandboxState);\n    })]);\n  };\n\n  var ActiveSandbox = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$2\n  });\n  var SandboxSchema = [onHandler('onOpen'), onHandler('onClose'), strict$1('isPartOf'), strict$1('getAttachPoint'), defaulted$1('cloakVisibilityAttr', 'data-precloak-visibility')];\n\n  var init = function () {\n    var contents = Cell(Optional.none());\n    var readState = constant('not-implemented');\n\n    var isOpen = function () {\n      return contents.get().isSome();\n    };\n\n    var set = function (comp) {\n      contents.set(Optional.some(comp));\n    };\n\n    var get = function () {\n      return contents.get();\n    };\n\n    var clear = function () {\n      contents.set(Optional.none());\n    };\n\n    return nu$5({\n      readState: readState,\n      isOpen: isOpen,\n      clear: clear,\n      set: set,\n      get: get\n    });\n  };\n\n  var SandboxState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init\n  });\n  var Sandboxing = create$1({\n    fields: SandboxSchema,\n    name: 'sandboxing',\n    active: ActiveSandbox,\n    apis: SandboxApis,\n    state: SandboxState\n  });\n  var dismissPopups = constant('dismiss.popups');\n  var repositionPopups = constant('reposition.popups');\n  var mouseReleased = constant('mouse.released');\n  var schema$2 = objOfOnly([defaulted$1('isExtraPart', never), optionObjOf('fireEventInstead', [defaulted$1('event', dismissRequested())])]);\n\n  var receivingChannel = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie('Dismissal', schema$2, rawSpec);\n    return _a = {}, _a[dismissPopups()] = {\n      schema: objOfOnly([strict$1('target')]),\n      onReceive: function (sandbox, data) {\n        if (Sandboxing.isOpen(sandbox)) {\n          var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n\n          if (!isPart) {\n            detail.fireEventInstead.fold(function () {\n              return Sandboxing.close(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }\n    }, _a;\n  };\n\n  var schema$3 = objOfOnly([optionObjOf('fireEventInstead', [defaulted$1('event', repositionRequested())]), strictFunction('doReposition')]);\n\n  var receivingChannel$1 = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie('Reposition', schema$3, rawSpec);\n    return _a = {}, _a[repositionPopups()] = {\n      onReceive: function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          detail.fireEventInstead.fold(function () {\n            return detail.doReposition(sandbox);\n          }, function (fe) {\n            return emit(sandbox, fe.event);\n          });\n        }\n      }\n    }, _a;\n  };\n\n  var onLoad = function (component, repConfig, repState) {\n    repConfig.store.manager.onLoad(component, repConfig, repState);\n  };\n\n  var onUnload = function (component, repConfig, repState) {\n    repConfig.store.manager.onUnload(component, repConfig, repState);\n  };\n\n  var setValue = function (component, repConfig, repState, data) {\n    repConfig.store.manager.setValue(component, repConfig, repState, data);\n  };\n\n  var getValue = function (component, repConfig, repState) {\n    return repConfig.store.manager.getValue(component, repConfig, repState);\n  };\n\n  var getState$1 = function (component, repConfig, repState) {\n    return repState;\n  };\n\n  var RepresentApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad,\n    onUnload: onUnload,\n    setValue: setValue,\n    getValue: getValue,\n    getState: getState$1\n  });\n\n  var events$3 = function (repConfig, repState) {\n    var es = repConfig.resetOnDom ? [runOnAttached(function (comp, _se) {\n      onLoad(comp, repConfig, repState);\n    }), runOnDetached(function (comp, _se) {\n      onUnload(comp, repConfig, repState);\n    })] : [loadEvent(repConfig, repState, onLoad)];\n    return derive(es);\n  };\n\n  var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$3\n  });\n\n  var memory = function () {\n    var data = Cell(null);\n\n    var readState = function () {\n      return {\n        mode: 'memory',\n        value: data.get()\n      };\n    };\n\n    var isNotSet = function () {\n      return data.get() === null;\n    };\n\n    var clear = function () {\n      data.set(null);\n    };\n\n    return nu$5({\n      set: data.set,\n      get: data.get,\n      isNotSet: isNotSet,\n      clear: clear,\n      readState: readState\n    });\n  };\n\n  var manual = function () {\n    var readState = function () {};\n\n    return nu$5({\n      readState: readState\n    });\n  };\n\n  var dataset = function () {\n    var dataByValue = Cell({});\n    var dataByText = Cell({});\n\n    var readState = function () {\n      return {\n        mode: 'dataset',\n        dataByValue: dataByValue.get(),\n        dataByText: dataByText.get()\n      };\n    };\n\n    var clear = function () {\n      dataByValue.set({});\n      dataByText.set({});\n    };\n\n    var lookup = function (itemString) {\n      return get(dataByValue.get(), itemString).orThunk(function () {\n        return get(dataByText.get(), itemString);\n      });\n    };\n\n    var update = function (items) {\n      var currentDataByValue = dataByValue.get();\n      var currentDataByText = dataByText.get();\n      var newDataByValue = {};\n      var newDataByText = {};\n      each(items, function (item) {\n        newDataByValue[item.value] = item;\n        get(item, 'meta').each(function (meta) {\n          get(meta, 'text').each(function (text) {\n            newDataByText[text] = item;\n          });\n        });\n      });\n      dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n      dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n    };\n\n    return nu$5({\n      readState: readState,\n      lookup: lookup,\n      update: update,\n      clear: clear\n    });\n  };\n\n  var init$1 = function (spec) {\n    return spec.store.manager.state(spec);\n  };\n\n  var RepresentState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    memory: memory,\n    dataset: dataset,\n    manual: manual,\n    init: init$1\n  });\n\n  var setValue$1 = function (component, repConfig, repState, data) {\n    var store = repConfig.store;\n    repState.update([data]);\n    store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue$1 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    var key = store.getDataKey(component);\n    return repState.lookup(key).fold(function () {\n      return store.getFallbackEntry(key);\n    }, function (data) {\n      return data;\n    });\n  };\n\n  var onLoad$1 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    store.initialValue.each(function (data) {\n      setValue$1(component, repConfig, repState, data);\n    });\n  };\n\n  var onUnload$1 = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var DatasetStore = [option('initialValue'), strict$1('getFallbackEntry'), strict$1('getDataKey'), strict$1('setValue'), output('manager', {\n    setValue: setValue$1,\n    getValue: getValue$1,\n    onLoad: onLoad$1,\n    onUnload: onUnload$1,\n    state: dataset\n  })];\n\n  var getValue$2 = function (component, repConfig, _repState) {\n    return repConfig.store.getValue(component);\n  };\n\n  var setValue$2 = function (component, repConfig, _repState, data) {\n    repConfig.store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var onLoad$2 = function (component, repConfig, _repState) {\n    repConfig.store.initialValue.each(function (data) {\n      repConfig.store.setValue(component, data);\n    });\n  };\n\n  var ManualStore = [strict$1('getValue'), defaulted$1('setValue', noop), option('initialValue'), output('manager', {\n    setValue: setValue$2,\n    getValue: getValue$2,\n    onLoad: onLoad$2,\n    onUnload: noop,\n    state: NoState.init\n  })];\n\n  var setValue$3 = function (component, repConfig, repState, data) {\n    repState.set(data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue$3 = function (component, repConfig, repState) {\n    return repState.get();\n  };\n\n  var onLoad$3 = function (component, repConfig, repState) {\n    repConfig.store.initialValue.each(function (initVal) {\n      if (repState.isNotSet()) {\n        repState.set(initVal);\n      }\n    });\n  };\n\n  var onUnload$2 = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var MemoryStore = [option('initialValue'), output('manager', {\n    setValue: setValue$3,\n    getValue: getValue$3,\n    onLoad: onLoad$3,\n    onUnload: onUnload$2,\n    state: memory\n  })];\n  var RepresentSchema = [defaultedOf('store', {\n    mode: 'memory'\n  }, choose$1('mode', {\n    memory: MemoryStore,\n    manual: ManualStore,\n    dataset: DatasetStore\n  })), onHandler('onSetValue'), defaulted$1('resetOnDom', false)];\n  var Representing = create$1({\n    fields: RepresentSchema,\n    name: 'representing',\n    active: ActiveRepresenting,\n    apis: RepresentApis,\n    extra: {\n      setValueFrom: function (component, source) {\n        var value = Representing.getValue(source);\n        Representing.setValue(component, value);\n      }\n    },\n    state: RepresentState\n  });\n\n  var field$1 = function (name, forbidden) {\n    return defaultedObjOf(name, {}, map(forbidden, function (f) {\n      return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n    }).concat([state$1('dump', identity)]));\n  };\n\n  var get$c = function (data) {\n    return data.dump;\n  };\n\n  var augment = function (data, original) {\n    return __assign(__assign({}, data.dump), derive$1(original));\n  };\n\n  var SketchBehaviours = {\n    field: field$1,\n    augment: augment,\n    get: get$c\n  };\n  var _placeholder = 'placeholder';\n  var adt$9 = Adt.generate([{\n    single: ['required', 'valueThunk']\n  }, {\n    multiple: ['required', 'valueThunks']\n  }]);\n\n  var isSubstituted = function (spec) {\n    return has(spec, 'uiType');\n  };\n\n  var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n    if (owner.exists(function (o) {\n      return o !== compSpec.owner;\n    })) {\n      return adt$9.single(true, constant(compSpec));\n    }\n\n    return get(placeholders, compSpec.name).fold(function () {\n      throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n    }, function (newSpec) {\n      return newSpec.replace();\n    });\n  };\n\n  var scan = function (owner, detail, compSpec, placeholders) {\n    if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n      return subPlaceholder(owner, detail, compSpec, placeholders);\n    } else {\n      return adt$9.single(false, constant(compSpec));\n    }\n  };\n\n  var substitute = function (owner, detail, compSpec, placeholders) {\n    var base = scan(owner, detail, compSpec, placeholders);\n    return base.fold(function (req, valueThunk) {\n      var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n      var childSpecs = get(value, 'components').getOr([]);\n      var substituted = bind(childSpecs, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n      return [__assign(__assign({}, value), {\n        components: substituted\n      })];\n    }, function (req, valuesThunk) {\n      if (isSubstituted(compSpec)) {\n        var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n        var preprocessor = compSpec.validated.preprocess.getOr(identity);\n        return preprocessor(values);\n      } else {\n        return valuesThunk(detail);\n      }\n    });\n  };\n\n  var substituteAll = function (owner, detail, components, placeholders) {\n    return bind(components, function (c) {\n      return substitute(owner, detail, c, placeholders);\n    });\n  };\n\n  var oneReplace = function (label, replacements) {\n    var called = false;\n\n    var used = function () {\n      return called;\n    };\n\n    var replace = function () {\n      if (called) {\n        throw new Error('Trying to use the same placeholder more than once: ' + label);\n      }\n\n      called = true;\n      return replacements;\n    };\n\n    var required = function () {\n      return replacements.fold(function (req, _) {\n        return req;\n      }, function (req, _) {\n        return req;\n      });\n    };\n\n    return {\n      name: constant(label),\n      required: required,\n      used: used,\n      replace: replace\n    };\n  };\n\n  var substitutePlaces = function (owner, detail, components, placeholders) {\n    var ps = map$2(placeholders, function (ph, name) {\n      return oneReplace(name, ph);\n    });\n    var outcome = substituteAll(owner, detail, components, ps);\n    each$1(ps, function (p) {\n      if (p.used() === false && p.required()) {\n        throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n      }\n    });\n    return outcome;\n  };\n\n  var single = adt$9.single;\n  var multiple = adt$9.multiple;\n  var placeholder = constant(_placeholder);\n  var adt$a = Adt.generate([{\n    required: ['data']\n  }, {\n    external: ['data']\n  }, {\n    optional: ['data']\n  }, {\n    group: ['data']\n  }]);\n  var fFactory = defaulted$1('factory', {\n    sketch: identity\n  });\n  var fSchema = defaulted$1('schema', []);\n  var fName = strict$1('name');\n  var fPname = field('pname', 'pname', defaultedThunk(function (typeSpec) {\n    return '<alloy.' + generate$1(typeSpec.name) + '>';\n  }), anyValue$1());\n  var fGroupSchema = state$1('schema', function () {\n    return [option('preprocess')];\n  });\n  var fDefaults = defaulted$1('defaults', constant({}));\n  var fOverrides = defaulted$1('overrides', constant({}));\n  var requiredSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var externalSpec = objOf([fFactory, fSchema, fName, fDefaults, fOverrides]);\n  var optionalSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var groupSpec = objOf([fFactory, fGroupSchema, fName, strict$1('unit'), fPname, fDefaults, fOverrides]);\n\n  var asNamedPart = function (part) {\n    return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n  };\n\n  var name$1 = function (part) {\n    var get = function (data) {\n      return data.name;\n    };\n\n    return part.fold(get, get, get, get);\n  };\n\n  var asCommon = function (part) {\n    return part.fold(identity, identity, identity, identity);\n  };\n\n  var convert = function (adtConstructor, partSchema) {\n    return function (spec) {\n      var data = asRawOrDie('Converting part type', partSchema, spec);\n      return adtConstructor(data);\n    };\n  };\n\n  var required = convert(adt$a.required, requiredSpec);\n  var external$1 = convert(adt$a.external, externalSpec);\n  var optional = convert(adt$a.optional, optionalSpec);\n  var group = convert(adt$a.group, groupSpec);\n  var original = constant('entirety');\n  var PartType = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    required: required,\n    external: external$1,\n    optional: optional,\n    group: group,\n    asNamedPart: asNamedPart,\n    name: name$1,\n    asCommon: asCommon,\n    original: original\n  });\n\n  var combine$2 = function (detail, data, partSpec, partValidated) {\n    return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, {\n      uid: detail.partUids[data.name]\n    }, data.overrides(detail, partSpec, partValidated));\n  };\n\n  var subs = function (owner, detail, parts) {\n    var internals = {};\n    var externals = {};\n    each(parts, function (part) {\n      part.fold(function (data) {\n        internals[data.pname] = single(true, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        var partSpec = detail.parts[data.name];\n        externals[data.name] = constant(data.factory.sketch(combine$2(detail, data, partSpec[original()]), partSpec));\n      }, function (data) {\n        internals[data.pname] = single(false, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n          var units = detail[data.name];\n          return map(units, function (u) {\n            return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n          });\n        });\n      });\n    });\n    return {\n      internals: constant(internals),\n      externals: constant(externals)\n    };\n  };\n\n  var generate$4 = function (owner, parts) {\n    var r = {};\n    each(parts, function (part) {\n      asNamedPart(part).each(function (np) {\n        var g = doGenerateOne(owner, np.pname);\n\n        r[np.name] = function (config) {\n          var validated = asRawOrDie('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n          return __assign(__assign({}, g), {\n            config: config,\n            validated: validated\n          });\n        };\n      });\n    });\n    return r;\n  };\n\n  var doGenerateOne = function (owner, pname) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname\n    };\n  };\n\n  var generateOne = function (owner, pname, config) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname,\n      config: config,\n      validated: {}\n    };\n  };\n\n  var schemas = function (parts) {\n    return bind(parts, function (part) {\n      return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n        return strictObjOf(data.name, data.schema.concat([snapshot(original())]));\n      }).toArray();\n    });\n  };\n\n  var names = function (parts) {\n    return map(parts, name$1);\n  };\n\n  var substitutes = function (owner, detail, parts) {\n    return subs(owner, detail, parts);\n  };\n\n  var components = function (owner, detail, internals) {\n    return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n  };\n\n  var getPart = function (component, detail, partKey) {\n    var uid = detail.partUids[partKey];\n    return component.getSystem().getByUid(uid).toOptional();\n  };\n\n  var getPartOrDie = function (component, detail, partKey) {\n    return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n  };\n\n  var getParts = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each(partKeys, function (pk) {\n      r[pk] = constant(system.getByUid(uids[pk]));\n    });\n    return r;\n  };\n\n  var getAllParts = function (component, detail) {\n    var system = component.getSystem();\n    return map$2(detail.partUids, function (pUid, _k) {\n      return constant(system.getByUid(pUid));\n    });\n  };\n\n  var getAllPartNames = function (detail) {\n    return keys(detail.partUids);\n  };\n\n  var getPartsOrDie = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each(partKeys, function (pk) {\n      r[pk] = constant(system.getByUid(uids[pk]).getOrDie());\n    });\n    return r;\n  };\n\n  var defaultUids = function (baseUid, partTypes) {\n    var partNames = names(partTypes);\n    return wrapAll$1(map(partNames, function (pn) {\n      return {\n        key: pn,\n        value: baseUid + '-' + pn\n      };\n    }));\n  };\n\n  var defaultUidsSchema = function (partTypes) {\n    return field('partUids', 'partUids', mergeWithThunk(function (spec) {\n      return defaultUids(spec.uid, partTypes);\n    }), anyValue$1());\n  };\n\n  var AlloyParts = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    generate: generate$4,\n    generateOne: generateOne,\n    schemas: schemas,\n    names: names,\n    substitutes: substitutes,\n    components: components,\n    defaultUids: defaultUids,\n    defaultUidsSchema: defaultUidsSchema,\n    getAllParts: getAllParts,\n    getAllPartNames: getAllPartNames,\n    getPart: getPart,\n    getPartOrDie: getPartOrDie,\n    getParts: getParts,\n    getPartsOrDie: getPartsOrDie\n  });\n\n  var base = function (partSchemas, partUidsSchemas) {\n    var ps = partSchemas.length > 0 ? [strictObjOf('parts', partSchemas)] : [];\n    return ps.concat([strict$1('uid'), defaulted$1('dom', {}), defaulted$1('components', []), snapshot('originalSpec'), defaulted$1('debug.sketcher', {})]).concat(partUidsSchemas);\n  };\n\n  var asRawOrDie$1 = function (label, schema, spec, partSchemas, partUidsSchemas) {\n    var baseS = base(partSchemas, partUidsSchemas);\n    return asRawOrDie(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n  };\n\n  var single$1 = function (owner, schema, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var detail = asRawOrDie$1(owner, schema, specWithUid, [], []);\n    return factory(detail, specWithUid);\n  };\n\n  var composite = function (owner, schema, partTypes, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var partSchemas = schemas(partTypes);\n    var partUidsSchema = defaultUidsSchema(partTypes);\n    var detail = asRawOrDie$1(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n    var subs = substitutes(owner, detail, partTypes);\n    var components$1 = components(owner, detail, subs.internals());\n    return factory(detail, components$1, specWithUid, subs.externals());\n  };\n\n  var hasUid = function (spec) {\n    return has(spec, 'uid');\n  };\n\n  var supplyUid = function (spec) {\n    return hasUid(spec) ? spec : __assign(__assign({}, spec), {\n      uid: generate$2('uid')\n    });\n  };\n\n  function isSketchSpec(spec) {\n    return spec.uid !== undefined;\n  }\n\n  var singleSchema = objOfOnly([strict$1('name'), strict$1('factory'), strict$1('configFields'), defaulted$1('apis', {}), defaulted$1('extraApis', {})]);\n  var compositeSchema = objOfOnly([strict$1('name'), strict$1('factory'), strict$1('configFields'), strict$1('partFields'), defaulted$1('apis', {}), defaulted$1('extraApis', {})]);\n\n  var single$2 = function (rawConfig) {\n    var config = asRawOrDie('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return single$1(config.name, config.configFields, config.factory, spec);\n    };\n\n    var apis = map$2(config.apis, makeApi);\n    var extraApis = map$2(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      configFields: config.configFields,\n      sketch: sketch\n    }, apis), extraApis);\n  };\n\n  var composite$1 = function (rawConfig) {\n    var config = asRawOrDie('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return composite(config.name, config.configFields, config.partFields, config.factory, spec);\n    };\n\n    var parts = generate$4(config.name, config.partFields);\n    var apis = map$2(config.apis, makeApi);\n    var extraApis = map$2(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      partFields: config.partFields,\n      configFields: config.configFields,\n      sketch: sketch,\n      parts: parts\n    }, apis), extraApis);\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var sequence = function (arr) {\n    var r = [];\n\n    for (var i = 0; i < arr.length; i++) {\n      var x = arr[i];\n\n      if (x.isSome()) {\n        r.push(x.getOrDie());\n      } else {\n        return Optional.none();\n      }\n    }\n\n    return Optional.some(r);\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var mapFrom = function (a, f) {\n    return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var inside = function (target) {\n    return name(target) === 'input' && get$2(target, 'type') !== 'radio' || name(target) === 'textarea';\n  };\n\n  var getCurrent = function (component, composeConfig, _composeState) {\n    return composeConfig.find(component);\n  };\n\n  var ComposeApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCurrent: getCurrent\n  });\n  var ComposeSchema = [strict$1('find')];\n  var Composing = create$1({\n    fields: ComposeSchema,\n    name: 'composing',\n    apis: ComposeApis\n  });\n\n  var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n    var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n    each(highlighted, function (h) {\n      if (!exists(skip, function (skipComp) {\n        return skipComp.element === h;\n      })) {\n        remove$4(h, hConfig.highlightClass);\n        component.getSystem().getByDom(h).each(function (target) {\n          hConfig.onDehighlight(component, target);\n          emit(target, dehighlight());\n        });\n      }\n    });\n  };\n\n  var dehighlightAll = function (component, hConfig, hState) {\n    return dehighlightAllExcept(component, hConfig, hState, []);\n  };\n\n  var dehighlight$1 = function (component, hConfig, hState, target) {\n    if (isHighlighted(component, hConfig, hState, target)) {\n      remove$4(target.element, hConfig.highlightClass);\n      hConfig.onDehighlight(component, target);\n      emit(target, dehighlight());\n    }\n  };\n\n  var highlight$1 = function (component, hConfig, hState, target) {\n    dehighlightAllExcept(component, hConfig, hState, [target]);\n\n    if (!isHighlighted(component, hConfig, hState, target)) {\n      add$2(target.element, hConfig.highlightClass);\n      hConfig.onHighlight(component, target);\n      emit(target, highlight());\n    }\n  };\n\n  var highlightFirst = function (component, hConfig, hState) {\n    getFirst(component, hConfig).each(function (firstComp) {\n      highlight$1(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightLast = function (component, hConfig, hState) {\n    getLast(component, hConfig).each(function (lastComp) {\n      highlight$1(component, hConfig, hState, lastComp);\n    });\n  };\n\n  var highlightAt = function (component, hConfig, hState, index) {\n    getByIndex(component, hConfig, hState, index).fold(function (err) {\n      throw new Error(err);\n    }, function (firstComp) {\n      highlight$1(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightBy = function (component, hConfig, hState, predicate) {\n    var candidates = getCandidates(component, hConfig);\n    var targetComp = find(candidates, predicate);\n    targetComp.each(function (c) {\n      highlight$1(component, hConfig, hState, c);\n    });\n  };\n\n  var isHighlighted = function (component, hConfig, hState, queryTarget) {\n    return has$2(queryTarget.element, hConfig.highlightClass);\n  };\n\n  var getHighlighted = function (component, hConfig, _hState) {\n    return descendant$1(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getByIndex = function (component, hConfig, hState, index) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return Optional.from(items[index]).fold(function () {\n      return Result.error('No element found with index ' + index);\n    }, component.getSystem().getByDom);\n  };\n\n  var getFirst = function (component, hConfig, _hState) {\n    return descendant$1(component.element, '.' + hConfig.itemClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getLast = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n    return last.bind(function (c) {\n      return component.getSystem().getByDom(c).toOptional();\n    });\n  };\n\n  var getDelta = function (component, hConfig, hState, delta) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var current = findIndex(items, function (item) {\n      return has$2(item, hConfig.highlightClass);\n    });\n    return current.bind(function (selected) {\n      var dest = cycleBy(selected, delta, 0, items.length - 1);\n      return component.getSystem().getByDom(items[dest]).toOptional();\n    });\n  };\n\n  var getPrevious = function (component, hConfig, hState) {\n    return getDelta(component, hConfig, hState, -1);\n  };\n\n  var getNext = function (component, hConfig, hState) {\n    return getDelta(component, hConfig, hState, +1);\n  };\n\n  var getCandidates = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return cat(map(items, function (i) {\n      return component.getSystem().getByDom(i).toOptional();\n    }));\n  };\n\n  var HighlightApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    dehighlightAll: dehighlightAll,\n    dehighlight: dehighlight$1,\n    highlight: highlight$1,\n    highlightFirst: highlightFirst,\n    highlightLast: highlightLast,\n    highlightAt: highlightAt,\n    highlightBy: highlightBy,\n    isHighlighted: isHighlighted,\n    getHighlighted: getHighlighted,\n    getFirst: getFirst,\n    getLast: getLast,\n    getPrevious: getPrevious,\n    getNext: getNext,\n    getCandidates: getCandidates\n  });\n  var HighlightSchema = [strict$1('highlightClass'), strict$1('itemClass'), onHandler('onHighlight'), onHandler('onDehighlight')];\n  var Highlighting = create$1({\n    fields: HighlightSchema,\n    name: 'highlighting',\n    apis: HighlightApis\n  });\n  var BACKSPACE = [8];\n  var TAB = [9];\n  var ENTER = [13];\n  var ESCAPE = [27];\n  var SPACE = [32];\n  var LEFT = [37];\n  var UP = [38];\n  var RIGHT = [39];\n  var DOWN = [40];\n\n  var cyclePrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    var after = reverse(values.slice(index + 1));\n    return find(before.concat(after), predicate);\n  };\n\n  var tryPrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    return find(before, predicate);\n  };\n\n  var cycleNext = function (values, index, predicate) {\n    var before = values.slice(0, index);\n    var after = values.slice(index + 1);\n    return find(after.concat(before), predicate);\n  };\n\n  var tryNext = function (values, index, predicate) {\n    var after = values.slice(index + 1);\n    return find(after, predicate);\n  };\n\n  var inSet = function (keys) {\n    return function (event) {\n      var raw = event.raw;\n      return contains(keys, raw.which);\n    };\n  };\n\n  var and = function (preds) {\n    return function (event) {\n      return forall(preds, function (pred) {\n        return pred(event);\n      });\n    };\n  };\n\n  var isShift = function (event) {\n    var raw = event.raw;\n    return raw.shiftKey === true;\n  };\n\n  var isControl = function (event) {\n    var raw = event.raw;\n    return raw.ctrlKey === true;\n  };\n\n  var isNotShift = not(isShift);\n\n  var rule = function (matches, action) {\n    return {\n      matches: matches,\n      classification: action\n    };\n  };\n\n  var choose$2 = function (transitions, event) {\n    var transition = find(transitions, function (t) {\n      return t.matches(event);\n    });\n    return transition.map(function (t) {\n      return t.classification;\n    });\n  };\n\n  var reportFocusShifting = function (component, prevFocus, newFocus) {\n    var noChange = prevFocus.exists(function (p) {\n      return newFocus.exists(function (n) {\n        return eq$1(n, p);\n      });\n    });\n\n    if (!noChange) {\n      emitWith(component, focusShifted(), {\n        prevFocus: prevFocus,\n        newFocus: newFocus\n      });\n    }\n  };\n\n  var dom = function () {\n    var get = function (component) {\n      return search(component.element);\n    };\n\n    var set = function (component, focusee) {\n      var prevFocus = get(component);\n      component.getSystem().triggerFocus(focusee, component.element);\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var highlights = function () {\n    var get = function (component) {\n      return Highlighting.getHighlighted(component).map(function (item) {\n        return item.element;\n      });\n    };\n\n    var set = function (component, element) {\n      var prevFocus = get(component);\n      component.getSystem().getByDom(element).fold(noop, function (item) {\n        Highlighting.highlight(component, item);\n      });\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var FocusInsideModes;\n\n  (function (FocusInsideModes) {\n    FocusInsideModes['OnFocusMode'] = 'onFocus';\n    FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n    FocusInsideModes['OnApiMode'] = 'onApi';\n  })(FocusInsideModes || (FocusInsideModes = {}));\n\n  var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n    var schema = function () {\n      return infoSchema.concat([defaulted$1('focusManager', dom()), defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n        return contains(['onFocus', 'onEnterOrSpace', 'onApi'], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n      })), output('handler', me), output('state', stateInit), output('sendFocusIn', optFocusIn)]);\n    };\n\n    var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n      var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n      return choose$2(rules, simulatedEvent.event).bind(function (rule) {\n        return rule(component, simulatedEvent, keyingConfig, keyingState);\n      });\n    };\n\n    var toEvents = function (keyingConfig, keyingState) {\n      var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n        return run(focus(), function (component, simulatedEvent) {\n          focusIn(component, keyingConfig, keyingState);\n          simulatedEvent.stop();\n        });\n      });\n\n      var tryGoInsideComponent = function (component, simulatedEvent) {\n        var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n\n        if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n          optFocusIn(keyingConfig).each(function (focusIn) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        }\n      };\n\n      var keyboardEvents = [run(keydown(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n          tryGoInsideComponent(component, simulatedEvent);\n        }, function (_) {\n          simulatedEvent.stop();\n        });\n      }), run(keyup(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n          simulatedEvent.stop();\n        });\n      })];\n      return derive(onFocusHandler.toArray().concat(keyboardEvents));\n    };\n\n    var me = {\n      schema: schema,\n      processKey: processKey,\n      toEvents: toEvents\n    };\n    return me;\n  };\n\n  var create$3 = function (cyclicField) {\n    var schema = [option('onEscape'), option('onEnter'), defaulted$1('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'), defaulted$1('firstTabstop', 0), defaulted$1('useTabstopAt', always), option('visibilitySelector')].concat([cyclicField]);\n\n    var isVisible = function (tabbingConfig, element) {\n      var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n        return closest$3(element, sel);\n      }).getOr(element);\n      return get$6(target) > 0;\n    };\n\n    var findInitial = function (component, tabbingConfig) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      var visibles = filter(tabstops, function (elem) {\n        return isVisible(tabbingConfig, elem);\n      });\n      return Optional.from(visibles[tabbingConfig.firstTabstop]);\n    };\n\n    var findCurrent = function (component, tabbingConfig) {\n      return tabbingConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, tabbingConfig.selector);\n      });\n    };\n\n    var isTabstop = function (tabbingConfig, element) {\n      return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n    };\n\n    var focusIn = function (component, tabbingConfig, _tabbingState) {\n      findInitial(component, tabbingConfig).each(function (target) {\n        tabbingConfig.focusManager.set(component, target);\n      });\n    };\n\n    var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n      return cycle(tabstops, stopIndex, function (elem) {\n        return isTabstop(tabbingConfig, elem);\n      }).fold(function () {\n        return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n      }, function (target) {\n        tabbingConfig.focusManager.set(component, target);\n        return Optional.some(true);\n      });\n    };\n\n    var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n        var optStopIndex = findIndex(tabstops, curry(eq$1, tabstop));\n        return optStopIndex.bind(function (stopIndex) {\n          return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n        });\n      });\n    };\n\n    var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var goForwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var execute = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEnter.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var exit = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEscape.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var getKeydownRules = constant([rule(and([isShift, inSet(TAB)]), goBackwards), rule(inSet(TAB), goForwards), rule(inSet(ESCAPE), exit), rule(and([isNotShift, inSet(ENTER)]), execute)]);\n    var getKeyupRules = constant([]);\n    return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Optional.some(focusIn);\n    });\n  };\n\n  var AcyclicType = create$3(state$1('cyclic', never));\n  var CyclicType = create$3(state$1('cyclic', always));\n\n  var doDefaultExecute = function (component, _simulatedEvent, focused) {\n    dispatch(component, focused, execute());\n    return Optional.some(true);\n  };\n\n  var defaultExecute = function (component, simulatedEvent, focused) {\n    var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n    return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n  };\n\n  var stopEventForFirefox = function (_component, _simulatedEvent) {\n    return Optional.some(true);\n  };\n\n  var schema$4 = [defaulted$1('execute', defaultExecute), defaulted$1('useSpace', false), defaulted$1('useEnter', true), defaulted$1('useControlEnter', false), defaulted$1('useDown', false)];\n\n  var execute$1 = function (component, simulatedEvent, executeConfig) {\n    return executeConfig.execute(component, simulatedEvent, component.element);\n  };\n\n  var getKeydownRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n    var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n    var enterExec = executeConfig.useEnter ? ENTER : [];\n    var downExec = executeConfig.useDown ? DOWN : [];\n    var execKeys = spaceExec.concat(enterExec).concat(downExec);\n    return [rule(inSet(execKeys), execute$1)].concat(executeConfig.useControlEnter ? [rule(and([isControl, inSet(ENTER)]), execute$1)] : []);\n  };\n\n  var getKeyupRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n    return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var ExecutionType = typical(schema$4, NoState.init, getKeydownRules, getKeyupRules, function () {\n    return Optional.none();\n  });\n\n  var flatgrid = function () {\n    var dimensions = Cell(Optional.none());\n\n    var setGridSize = function (numRows, numColumns) {\n      dimensions.set(Optional.some({\n        numRows: numRows,\n        numColumns: numColumns\n      }));\n    };\n\n    var getNumRows = function () {\n      return dimensions.get().map(function (d) {\n        return d.numRows;\n      });\n    };\n\n    var getNumColumns = function () {\n      return dimensions.get().map(function (d) {\n        return d.numColumns;\n      });\n    };\n\n    return nu$5({\n      readState: function () {\n        return dimensions.get().map(function (d) {\n          return {\n            numRows: String(d.numRows),\n            numColumns: String(d.numColumns)\n          };\n        }).getOr({\n          numRows: '?',\n          numColumns: '?'\n        });\n      },\n      setGridSize: setGridSize,\n      getNumRows: getNumRows,\n      getNumColumns: getNumColumns\n    });\n  };\n\n  var init$2 = function (spec) {\n    return spec.state(spec);\n  };\n\n  var KeyingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    flatgrid: flatgrid,\n    init: init$2\n  });\n\n  var useH = function (movement) {\n    return function (component, simulatedEvent, config, state) {\n      var move = movement(component.element);\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var west$2 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveLeft, moveRight);\n    return useH(movement);\n  };\n\n  var east$2 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveRight, moveLeft);\n    return useH(movement);\n  };\n\n  var useV = function (move) {\n    return function (component, simulatedEvent, config, state) {\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var use = function (move, component, simulatedEvent, config, state) {\n    var outcome = config.focusManager.get(component).bind(function (focused) {\n      return move(component.element, focused, config, state);\n    });\n    return outcome.map(function (newFocus) {\n      config.focusManager.set(component, newFocus);\n      return true;\n    });\n  };\n\n  var north$2 = useV;\n  var south$2 = useV;\n  var move = useV;\n\n  var isHidden = function (dom) {\n    return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n  };\n\n  var isVisible = function (element) {\n    return !isHidden(element.dom);\n  };\n\n  var locate = function (candidates, predicate) {\n    return findIndex(candidates, predicate).map(function (index) {\n      return {\n        index: index,\n        candidates: candidates\n      };\n    });\n  };\n\n  var locateVisible = function (container, current, selector) {\n    var predicate = function (x) {\n      return eq$1(x, current);\n    };\n\n    var candidates = descendants(container, selector);\n    var visible = filter(candidates, isVisible);\n    return locate(visible, predicate);\n  };\n\n  var findIndex$1 = function (elements, target) {\n    return findIndex(elements, function (elem) {\n      return eq$1(target, elem);\n    });\n  };\n\n  var withGrid = function (values, index, numCols, f) {\n    var oldRow = Math.floor(index / numCols);\n    var oldColumn = index % numCols;\n    return f(oldRow, oldColumn).bind(function (address) {\n      var newIndex = address.row * numCols + address.column;\n      return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n    });\n  };\n\n  var cycleHorizontal = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var onLastRow = oldRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n      var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n      return Optional.some({\n        row: oldRow,\n        column: newColumn\n      });\n    });\n  };\n\n  var cycleVertical = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n      var onLastRow = newRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n      var newCol = clamp(oldColumn, 0, colsInRow - 1);\n      return Optional.some({\n        row: newRow,\n        column: newCol\n      });\n    });\n  };\n\n  var cycleRight = function (values, index, numRows, numCols) {\n    return cycleHorizontal(values, index, numRows, numCols, +1);\n  };\n\n  var cycleLeft = function (values, index, numRows, numCols) {\n    return cycleHorizontal(values, index, numRows, numCols, -1);\n  };\n\n  var cycleUp = function (values, index, numRows, numCols) {\n    return cycleVertical(values, index, numRows, numCols, -1);\n  };\n\n  var cycleDown = function (values, index, numRows, numCols) {\n    return cycleVertical(values, index, numRows, numCols, +1);\n  };\n\n  var schema$5 = [strict$1('selector'), defaulted$1('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted$1('captureTab', false), initSize()];\n\n  var focusIn = function (component, gridConfig, _gridState) {\n    descendant$1(component.element, gridConfig.selector).each(function (first) {\n      gridConfig.focusManager.set(component, first);\n    });\n  };\n\n  var findCurrent = function (component, gridConfig) {\n    return gridConfig.focusManager.get(component).bind(function (elem) {\n      return closest$3(elem, gridConfig.selector);\n    });\n  };\n\n  var execute$2 = function (component, simulatedEvent, gridConfig, _gridState) {\n    return findCurrent(component, gridConfig).bind(function (focused) {\n      return gridConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var doMove = function (cycle) {\n    return function (element, focused, gridConfig, gridState) {\n      return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n        return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n      });\n    };\n  };\n\n  var handleTab = function (_component, _simulatedEvent, gridConfig) {\n    return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n  };\n\n  var doEscape = function (component, simulatedEvent, gridConfig) {\n    return gridConfig.onEscape(component, simulatedEvent);\n  };\n\n  var moveLeft = doMove(cycleLeft);\n  var moveRight = doMove(cycleRight);\n  var moveNorth = doMove(cycleUp);\n  var moveSouth = doMove(cycleDown);\n  var getKeydownRules$1 = constant([rule(inSet(LEFT), west$2(moveLeft, moveRight)), rule(inSet(RIGHT), east$2(moveLeft, moveRight)), rule(inSet(UP), north$2(moveNorth)), rule(inSet(DOWN), south$2(moveSouth)), rule(and([isShift, inSet(TAB)]), handleTab), rule(and([isNotShift, inSet(TAB)]), handleTab), rule(inSet(ESCAPE), doEscape), rule(inSet(SPACE.concat(ENTER)), execute$2)]);\n  var getKeyupRules$1 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlatgridType = typical(schema$5, flatgrid, getKeydownRules$1, getKeyupRules$1, function () {\n    return Optional.some(focusIn);\n  });\n\n  var horizontal = function (container, selector, current, delta) {\n    var isDisabledButton = function (candidate) {\n      return name(candidate) === 'button' && get$2(candidate, 'disabled') === 'disabled';\n    };\n\n    var tryCycle = function (initial, index, candidates) {\n      var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n\n      if (newIndex === initial) {\n        return Optional.none();\n      } else {\n        return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n      }\n    };\n\n    return locateVisible(container, current, selector).bind(function (identified) {\n      var index = identified.index;\n      var candidates = identified.candidates;\n      return tryCycle(index, index, candidates);\n    });\n  };\n\n  var schema$6 = [strict$1('selector'), defaulted$1('getInitial', Optional.none), defaulted$1('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted$1('executeOnMove', false), defaulted$1('allowVertical', true)];\n\n  var findCurrent$1 = function (component, flowConfig) {\n    return flowConfig.focusManager.get(component).bind(function (elem) {\n      return closest$3(elem, flowConfig.selector);\n    });\n  };\n\n  var execute$3 = function (component, simulatedEvent, flowConfig) {\n    return findCurrent$1(component, flowConfig).bind(function (focused) {\n      return flowConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn$1 = function (component, flowConfig, _state) {\n    flowConfig.getInitial(component).orThunk(function () {\n      return descendant$1(component.element, flowConfig.selector);\n    }).each(function (first) {\n      flowConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveLeft$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveRight$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var doMove$1 = function (movement) {\n    return function (component, simulatedEvent, flowConfig, flowState) {\n      return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n        return flowConfig.executeOnMove ? execute$3(component, simulatedEvent, flowConfig) : Optional.some(true);\n      });\n    };\n  };\n\n  var doEscape$1 = function (component, simulatedEvent, flowConfig) {\n    return flowConfig.onEscape(component, simulatedEvent);\n  };\n\n  var getKeydownRules$2 = function (_component, _se, flowConfig, _flowState) {\n    var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n    var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n    return [rule(inSet(westMovers), doMove$1(west$2(moveLeft$1, moveRight$1))), rule(inSet(eastMovers), doMove$1(east$2(moveLeft$1, moveRight$1))), rule(inSet(ENTER), execute$3), rule(inSet(SPACE), execute$3), rule(inSet(ESCAPE), doEscape$1)];\n  };\n\n  var getKeyupRules$2 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlowType = typical(schema$6, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n    return Optional.some(focusIn$1);\n  });\n\n  var toCell = function (matrix, rowIndex, columnIndex) {\n    return Optional.from(matrix[rowIndex]).bind(function (row) {\n      return Optional.from(row[columnIndex]).map(function (cell) {\n        return {\n          rowIndex: rowIndex,\n          columnIndex: columnIndex,\n          cell: cell\n        };\n      });\n    });\n  };\n\n  var cycleHorizontal$1 = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var cycleVertical$1 = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = clamp(startCol + deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = clamp(startRow + deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var cycleRight$1 = function (matrix, startRow, startCol) {\n    return cycleHorizontal$1(matrix, startRow, startCol, +1);\n  };\n\n  var cycleLeft$1 = function (matrix, startRow, startCol) {\n    return cycleHorizontal$1(matrix, startRow, startCol, -1);\n  };\n\n  var cycleUp$1 = function (matrix, startRow, startCol) {\n    return cycleVertical$1(matrix, startCol, startRow, -1);\n  };\n\n  var cycleDown$1 = function (matrix, startRow, startCol) {\n    return cycleVertical$1(matrix, startCol, startRow, +1);\n  };\n\n  var moveLeft$2 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, -1);\n  };\n\n  var moveRight$2 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, +1);\n  };\n\n  var moveUp = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, -1);\n  };\n\n  var moveDown = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, +1);\n  };\n\n  var schema$7 = [strictObjOf('selectors', [strict$1('row'), strict$1('cell')]), defaulted$1('cycles', true), defaulted$1('previousSelector', Optional.none), defaulted$1('execute', defaultExecute)];\n\n  var focusIn$2 = function (component, matrixConfig, _state) {\n    var focused = matrixConfig.previousSelector(component).orThunk(function () {\n      var selectors = matrixConfig.selectors;\n      return descendant$1(component.element, selectors.cell);\n    });\n    focused.each(function (cell) {\n      matrixConfig.focusManager.set(component, cell);\n    });\n  };\n\n  var execute$4 = function (component, simulatedEvent, matrixConfig) {\n    return search(component.element).bind(function (focused) {\n      return matrixConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var toMatrix = function (rows, matrixConfig) {\n    return map(rows, function (row) {\n      return descendants(row, matrixConfig.selectors.cell);\n    });\n  };\n\n  var doMove$2 = function (ifCycle, ifMove) {\n    return function (element, focused, matrixConfig) {\n      var move = matrixConfig.cycles ? ifCycle : ifMove;\n      return closest$3(focused, matrixConfig.selectors.row).bind(function (inRow) {\n        var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n        return findIndex$1(cellsInRow, focused).bind(function (colIndex) {\n          var allRows = descendants(element, matrixConfig.selectors.row);\n          return findIndex$1(allRows, inRow).bind(function (rowIndex) {\n            var matrix = toMatrix(allRows, matrixConfig);\n            return move(matrix, rowIndex, colIndex).map(function (next) {\n              return next.cell;\n            });\n          });\n        });\n      });\n    };\n  };\n\n  var moveLeft$3 = doMove$2(cycleLeft$1, moveLeft$2);\n  var moveRight$3 = doMove$2(cycleRight$1, moveRight$2);\n  var moveNorth$1 = doMove$2(cycleUp$1, moveUp);\n  var moveSouth$1 = doMove$2(cycleDown$1, moveDown);\n  var getKeydownRules$3 = constant([rule(inSet(LEFT), west$2(moveLeft$3, moveRight$3)), rule(inSet(RIGHT), east$2(moveLeft$3, moveRight$3)), rule(inSet(UP), north$2(moveNorth$1)), rule(inSet(DOWN), south$2(moveSouth$1)), rule(inSet(SPACE.concat(ENTER)), execute$4)]);\n  var getKeyupRules$3 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MatrixType = typical(schema$7, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n    return Optional.some(focusIn$2);\n  });\n  var schema$8 = [strict$1('selector'), defaulted$1('execute', defaultExecute), defaulted$1('moveOnTab', false)];\n\n  var execute$5 = function (component, simulatedEvent, menuConfig) {\n    return menuConfig.focusManager.get(component).bind(function (focused) {\n      return menuConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn$3 = function (component, menuConfig, _state) {\n    descendant$1(component.element, menuConfig.selector).each(function (first) {\n      menuConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveUp$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveDown$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move(moveUp$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move(moveDown$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var getKeydownRules$4 = constant([rule(inSet(UP), move(moveUp$1)), rule(inSet(DOWN), move(moveDown$1)), rule(and([isShift, inSet(TAB)]), fireShiftTab), rule(and([isNotShift, inSet(TAB)]), fireTab), rule(inSet(ENTER), execute$5), rule(inSet(SPACE), execute$5)]);\n  var getKeyupRules$4 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MenuType = typical(schema$8, NoState.init, getKeydownRules$4, getKeyupRules$4, function () {\n    return Optional.some(focusIn$3);\n  });\n  var schema$9 = [onKeyboardHandler('onSpace'), onKeyboardHandler('onEnter'), onKeyboardHandler('onShiftEnter'), onKeyboardHandler('onLeft'), onKeyboardHandler('onRight'), onKeyboardHandler('onTab'), onKeyboardHandler('onShiftTab'), onKeyboardHandler('onUp'), onKeyboardHandler('onDown'), onKeyboardHandler('onEscape'), defaulted$1('stopSpaceKeyup', false), option('focusIn')];\n\n  var getKeydownRules$5 = function (component, simulatedEvent, specialInfo) {\n    return [rule(inSet(SPACE), specialInfo.onSpace), rule(and([isNotShift, inSet(ENTER)]), specialInfo.onEnter), rule(and([isShift, inSet(ENTER)]), specialInfo.onShiftEnter), rule(and([isShift, inSet(TAB)]), specialInfo.onShiftTab), rule(and([isNotShift, inSet(TAB)]), specialInfo.onTab), rule(inSet(UP), specialInfo.onUp), rule(inSet(DOWN), specialInfo.onDown), rule(inSet(LEFT), specialInfo.onLeft), rule(inSet(RIGHT), specialInfo.onRight), rule(inSet(SPACE), specialInfo.onSpace), rule(inSet(ESCAPE), specialInfo.onEscape)];\n  };\n\n  var getKeyupRules$5 = function (component, simulatedEvent, specialInfo) {\n    return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var SpecialType = typical(schema$9, NoState.init, getKeydownRules$5, getKeyupRules$5, function (specialInfo) {\n    return specialInfo.focusIn;\n  });\n  var acyclic = AcyclicType.schema();\n  var cyclic = CyclicType.schema();\n  var flow = FlowType.schema();\n  var flatgrid$1 = FlatgridType.schema();\n  var matrix = MatrixType.schema();\n  var execution = ExecutionType.schema();\n  var menu = MenuType.schema();\n  var special = SpecialType.schema();\n  var KeyboardBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    acyclic: acyclic,\n    cyclic: cyclic,\n    flow: flow,\n    flatgrid: flatgrid$1,\n    matrix: matrix,\n    execution: execution,\n    menu: menu,\n    special: special\n  });\n\n  var isFlatgridState = function (keyState) {\n    return hasNonNullableKey(keyState, 'setGridSize');\n  };\n\n  var Keying = createModes$1({\n    branchKey: 'mode',\n    branches: KeyboardBranches,\n    name: 'keying',\n    active: {\n      events: function (keyingConfig, keyingState) {\n        var handler = keyingConfig.handler;\n        return handler.toEvents(keyingConfig, keyingState);\n      }\n    },\n    apis: {\n      focusIn: function (component, keyConfig, keyState) {\n        keyConfig.sendFocusIn(keyConfig).fold(function () {\n          component.getSystem().triggerFocus(component.element, component.element);\n        }, function (sendFocusIn) {\n          sendFocusIn(component, keyConfig, keyState);\n        });\n      },\n      setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n        if (!isFlatgridState(keyState)) {\n          console.error('Layout does not support setGridSize');\n        } else {\n          keyState.setGridSize(numRows, numColumns);\n        }\n      }\n    },\n    state: KeyingState\n  });\n\n  var set$5 = function (component, replaceConfig, replaceState, data) {\n    preserve(function () {\n      var newChildren = map(data, component.getSystem().build);\n      replaceChildren(component, newChildren);\n    }, component.element);\n  };\n\n  var insert = function (component, replaceConfig, insertion, childSpec) {\n    var child = component.getSystem().build(childSpec);\n    attachWith(component, child, insertion);\n  };\n\n  var append$2 = function (component, replaceConfig, replaceState, appendee) {\n    insert(component, replaceConfig, append, appendee);\n  };\n\n  var prepend$1 = function (component, replaceConfig, replaceState, prependee) {\n    insert(component, replaceConfig, prepend, prependee);\n  };\n\n  var remove$7 = function (component, replaceConfig, replaceState, removee) {\n    var children = contents(component);\n    var foundChild = find(children, function (child) {\n      return eq$1(removee.element, child.element);\n    });\n    foundChild.each(detach);\n  };\n\n  var contents = function (component, _replaceConfig) {\n    return component.components();\n  };\n\n  var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n    var children = contents(component);\n    return Optional.from(children[replaceeIndex]).map(function (replacee) {\n      remove$7(component, replaceConfig, replaceState, replacee);\n      replacer.each(function (r) {\n        insert(component, replaceConfig, function (p, c) {\n          appendAt(p, c, replaceeIndex);\n        }, r);\n      });\n      return replacee;\n    });\n  };\n\n  var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n    var children = contents(component);\n    return findIndex(children, replaceePred).bind(function (replaceeIndex) {\n      return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n    });\n  };\n\n  var ReplaceApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    append: append$2,\n    prepend: prepend$1,\n    remove: remove$7,\n    replaceAt: replaceAt,\n    replaceBy: replaceBy,\n    set: set$5,\n    contents: contents\n  });\n  var Replacing = create$1({\n    fields: [],\n    name: 'replacing',\n    apis: ReplaceApis\n  });\n\n  var events$4 = function (name, eventHandlers) {\n    var events = derive(eventHandlers);\n    return create$1({\n      fields: [strict$1('enabled')],\n      name: name,\n      active: {\n        events: constant(events)\n      }\n    });\n  };\n\n  var config = function (name, eventHandlers) {\n    var me = events$4(name, eventHandlers);\n    return {\n      key: name,\n      value: {\n        config: {},\n        me: me,\n        configAsRaw: constant({}),\n        initialConfig: {},\n        state: NoState\n      }\n    };\n  };\n\n  var focus$2 = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      focus$1(component.element);\n      focusConfig.onFocus(component);\n    }\n  };\n\n  var blur$1 = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      blur(component.element);\n    }\n  };\n\n  var isFocused = function (component) {\n    return hasFocus(component.element);\n  };\n\n  var FocusApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    focus: focus$2,\n    blur: blur$1,\n    isFocused: isFocused\n  });\n\n  var exhibit$1 = function (base, focusConfig) {\n    var mod = focusConfig.ignore ? {} : {\n      attributes: {\n        tabindex: '-1'\n      }\n    };\n    return nu$6(mod);\n  };\n\n  var events$5 = function (focusConfig) {\n    return derive([run(focus(), function (component, simulatedEvent) {\n      focus$2(component, focusConfig);\n      simulatedEvent.stop();\n    })].concat(focusConfig.stopMousedown ? [run(mousedown(), function (_, simulatedEvent) {\n      simulatedEvent.event.prevent();\n    })] : []));\n  };\n\n  var ActiveFocus = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$1,\n    events: events$5\n  });\n  var FocusSchema = [onHandler('onFocus'), defaulted$1('stopMousedown', false), defaulted$1('ignore', false)];\n  var Focusing = create$1({\n    fields: FocusSchema,\n    name: 'focusing',\n    active: ActiveFocus,\n    apis: FocusApis\n  });\n\n  var SetupBehaviourCellState = function (initialState) {\n    var init = function () {\n      var cell = Cell(initialState);\n\n      var get = function () {\n        return cell.get();\n      };\n\n      var set = function (newState) {\n        return cell.set(newState);\n      };\n\n      var clear = function () {\n        return cell.set(initialState);\n      };\n\n      var readState = function () {\n        return cell.get();\n      };\n\n      return {\n        get: get,\n        set: set,\n        clear: clear,\n        readState: readState\n      };\n    };\n\n    return {\n      init: init\n    };\n  };\n\n  var updateAriaState = function (component, toggleConfig, toggleState) {\n    var ariaInfo = toggleConfig.aria;\n    ariaInfo.update(component, ariaInfo, toggleState.get());\n  };\n\n  var updateClass = function (component, toggleConfig, toggleState) {\n    toggleConfig.toggleClass.each(function (toggleClass) {\n      if (toggleState.get()) {\n        add$2(component.element, toggleClass);\n      } else {\n        remove$4(component.element, toggleClass);\n      }\n    });\n  };\n\n  var toggle = function (component, toggleConfig, toggleState) {\n    set$6(component, toggleConfig, toggleState, !toggleState.get());\n  };\n\n  var on$1 = function (component, toggleConfig, toggleState) {\n    toggleState.set(true);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var off = function (component, toggleConfig, toggleState) {\n    toggleState.set(false);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var set$6 = function (component, toggleConfig, toggleState, state) {\n    var action = state ? on$1 : off;\n    action(component, toggleConfig, toggleState);\n  };\n\n  var isOn = function (component, toggleConfig, toggleState) {\n    return toggleState.get();\n  };\n\n  var onLoad$4 = function (component, toggleConfig, toggleState) {\n    set$6(component, toggleConfig, toggleState, toggleConfig.selected);\n  };\n\n  var ToggleApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad$4,\n    toggle: toggle,\n    isOn: isOn,\n    on: on$1,\n    off: off,\n    set: set$6\n  });\n\n  var exhibit$2 = function () {\n    return nu$6({});\n  };\n\n  var events$6 = function (toggleConfig, toggleState) {\n    var execute = executeEvent(toggleConfig, toggleState, toggle);\n    var load = loadEvent(toggleConfig, toggleState, onLoad$4);\n    return derive(flatten([toggleConfig.toggleOnExecute ? [execute] : [], [load]]));\n  };\n\n  var ActiveToggle = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$2,\n    events: events$6\n  });\n\n  var updatePressed = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-pressed', status);\n\n    if (ariaInfo.syncWithExpanded) {\n      updateExpanded(component, ariaInfo, status);\n    }\n  };\n\n  var updateSelected = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-selected', status);\n  };\n\n  var updateChecked = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-checked', status);\n  };\n\n  var updateExpanded = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-expanded', status);\n  };\n\n  var ToggleSchema = [defaulted$1('selected', false), option('toggleClass'), defaulted$1('toggleOnExecute', true), defaultedOf('aria', {\n    mode: 'none'\n  }, choose$1('mode', {\n    pressed: [defaulted$1('syncWithExpanded', false), output('update', updatePressed)],\n    checked: [output('update', updateChecked)],\n    expanded: [output('update', updateExpanded)],\n    selected: [output('update', updateSelected)],\n    none: [output('update', noop)]\n  }))];\n  var Toggling = create$1({\n    fields: ToggleSchema,\n    name: 'toggling',\n    active: ActiveToggle,\n    apis: ToggleApis,\n    state: SetupBehaviourCellState(false)\n  });\n\n  var pointerEvents = function () {\n    var onClick = function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      emitExecute(component);\n    };\n\n    return [run(click(), onClick), run(tap(), onClick), cutter(touchstart()), cutter(mousedown())];\n  };\n\n  var events$7 = function (optAction) {\n    var executeHandler = function (action) {\n      return runOnExecute(function (component, simulatedEvent) {\n        action(component);\n        simulatedEvent.stop();\n      });\n    };\n\n    return derive(flatten([optAction.map(executeHandler).toArray(), pointerEvents()]));\n  };\n\n  var hoverEvent = 'alloy.item-hover';\n  var focusEvent = 'alloy.item-focus';\n\n  var onHover = function (item) {\n    if (search(item.element).isNone() || Focusing.isFocused(item)) {\n      if (!Focusing.isFocused(item)) {\n        Focusing.focus(item);\n      }\n\n      emitWith(item, hoverEvent, {\n        item: item\n      });\n    }\n  };\n\n  var onFocus = function (item) {\n    emitWith(item, focusEvent, {\n      item: item\n    });\n  };\n\n  var hover = constant(hoverEvent);\n  var focus$3 = constant(focusEvent);\n\n  var builder = function (detail) {\n    return {\n      dom: detail.dom,\n      domModification: __assign(__assign({}, detail.domModification), {\n        attributes: __assign(__assign(__assign({\n          'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem'\n        }, detail.domModification.attributes), {\n          'aria-haspopup': detail.hasSubmenu\n        }), detail.hasSubmenu ? {\n          'aria-expanded': false\n        } : {})\n      }),\n      behaviours: SketchBehaviours.augment(detail.itemBehaviours, [detail.toggling.fold(Toggling.revoke, function (tConfig) {\n        return Toggling.config(__assign({\n          aria: {\n            mode: 'checked'\n          }\n        }, tConfig));\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        stopMousedown: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus(component);\n        }\n      }), Keying.config({\n        mode: 'execution'\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), config('item-type-events', __spreadArrays(pointerEvents(), [run(mouseover(), onHover), run(focusItem(), Focusing.focus)]))]),\n      components: detail.components,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$a = [strict$1('data'), strict$1('components'), strict$1('dom'), defaulted$1('hasSubmenu', false), option('toggling'), SketchBehaviours.field('itemBehaviours', [Toggling, Focusing, Keying, Representing]), defaulted$1('ignoreFocus', false), defaulted$1('domModification', {}), output('builder', builder), defaulted$1('eventOrder', {})];\n\n  var builder$1 = function (detail) {\n    return {\n      dom: detail.dom,\n      components: detail.components,\n      events: derive([stopper(focusItem())])\n    };\n  };\n\n  var schema$b = [strict$1('dom'), strict$1('components'), output('builder', builder$1)];\n\n  var owner$2 = function () {\n    return 'item-widget';\n  };\n\n  var parts = constant([required({\n    name: 'widget',\n    overrides: function (detail) {\n      return {\n        behaviours: derive$1([Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (_component) {\n              return detail.data;\n            },\n            setValue: function () {}\n          }\n        })])\n      };\n    }\n  })]);\n\n  var builder$2 = function (detail) {\n    var subs = substitutes(owner$2(), detail, parts());\n    var components$1 = components(owner$2(), detail, subs.internals());\n\n    var focusWidget = function (component) {\n      return getPart(component, detail, 'widget').map(function (widget) {\n        Keying.focusIn(widget);\n        return widget;\n      });\n    };\n\n    var onHorizontalArrow = function (component, simulatedEvent) {\n      return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n        if (detail.autofocus) {\n          simulatedEvent.setSource(component.element);\n          return Optional.none();\n        } else {\n          return Optional.none();\n        }\n      }();\n    };\n\n    return {\n      dom: detail.dom,\n      components: components$1,\n      domModification: detail.domModification,\n      events: derive([runOnExecute(function (component, simulatedEvent) {\n        focusWidget(component).each(function (_widget) {\n          simulatedEvent.stop();\n        });\n      }), run(mouseover(), onHover), run(focusItem(), function (component, _simulatedEvent) {\n        if (detail.autofocus) {\n          focusWidget(component);\n        } else {\n          Focusing.focus(component);\n        }\n      })]),\n      behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus(component);\n        }\n      }), Keying.config({\n        mode: 'special',\n        focusIn: detail.autofocus ? function (component) {\n          focusWidget(component);\n        } : revoke(),\n        onLeft: onHorizontalArrow,\n        onRight: onHorizontalArrow,\n        onEscape: function (component, simulatedEvent) {\n          if (!Focusing.isFocused(component) && !detail.autofocus) {\n            Focusing.focus(component);\n            return Optional.some(true);\n          } else if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }\n      })])\n    };\n  };\n\n  var schema$c = [strict$1('uid'), strict$1('data'), strict$1('components'), strict$1('dom'), defaulted$1('autofocus', false), defaulted$1('ignoreFocus', false), SketchBehaviours.field('widgetBehaviours', [Representing, Focusing, Keying]), defaulted$1('domModification', {}), defaultUidsSchema(parts()), output('builder', builder$2)];\n  var itemSchema$1 = choose$1('type', {\n    widget: schema$c,\n    item: schema$a,\n    separator: schema$b\n  });\n\n  var configureGrid = function (detail, movementInfo) {\n    return {\n      mode: 'flatgrid',\n      selector: '.' + detail.markers.item,\n      initSize: {\n        numColumns: movementInfo.initSize.numColumns,\n        numRows: movementInfo.initSize.numRows\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMatrix = function (detail, movementInfo) {\n    return {\n      mode: 'matrix',\n      selectors: {\n        row: movementInfo.rowSelector,\n        cell: '.' + detail.markers.item\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMenu = function (detail, movementInfo) {\n    return {\n      mode: 'menu',\n      selector: '.' + detail.markers.item,\n      moveOnTab: movementInfo.moveOnTab,\n      focusManager: detail.focusManager\n    };\n  };\n\n  var parts$1 = constant([group({\n    factory: {\n      sketch: function (spec) {\n        var itemInfo = asRawOrDie('menu.spec item', itemSchema$1, spec);\n        return itemInfo.builder(itemInfo);\n      }\n    },\n    name: 'items',\n    unit: 'item',\n    defaults: function (detail, u) {\n      return u.hasOwnProperty('uid') ? u : __assign(__assign({}, u), {\n        uid: generate$2('item')\n      });\n    },\n    overrides: function (detail, u) {\n      return {\n        type: u.type,\n        ignoreFocus: detail.fakeFocus,\n        domModification: {\n          classes: [detail.markers.item]\n        }\n      };\n    }\n  })]);\n  var schema$d = constant([strict$1('value'), strict$1('items'), strict$1('dom'), strict$1('components'), defaulted$1('eventOrder', {}), field$1('menuBehaviours', [Highlighting, Representing, Composing, Keying]), defaultedOf('movement', {\n    mode: 'menu',\n    moveOnTab: true\n  }, choose$1('mode', {\n    grid: [initSize(), output('config', configureGrid)],\n    matrix: [output('config', configureMatrix), strict$1('rowSelector')],\n    menu: [defaulted$1('moveOnTab', true), output('config', configureMenu)]\n  })), itemMarkers(), defaulted$1('fakeFocus', false), defaulted$1('focusManager', dom()), onHandler('onHighlight')]);\n  var focus$4 = constant('alloy.menu-focus');\n\n  var make$1 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.menuBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedItem,\n        itemClass: detail.markers.item,\n        onHighlight: detail.onHighlight\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      }), Composing.config({\n        find: Optional.some\n      }), Keying.config(detail.movement.config(detail, detail.movement))]),\n      events: derive([run(focus$3(), function (menu, simulatedEvent) {\n        var event = simulatedEvent.event;\n        menu.getSystem().getByDom(event.target).each(function (item) {\n          Highlighting.highlight(menu, item);\n          simulatedEvent.stop();\n          emitWith(menu, focus$4(), {\n            menu: menu,\n            item: item\n          });\n        });\n      }), run(hover(), function (menu, simulatedEvent) {\n        var item = simulatedEvent.event.item;\n        Highlighting.highlight(menu, item);\n      })]),\n      components: components,\n      eventOrder: detail.eventOrder,\n      domModification: {\n        attributes: {\n          role: 'menu'\n        }\n      }\n    };\n  };\n\n  var Menu = composite$1({\n    name: 'Menu',\n    configFields: schema$d(),\n    partFields: parts$1(),\n    factory: make$1\n  });\n\n  var transpose = function (obj) {\n    return tupleMap(obj, function (v, k) {\n      return {\n        k: v,\n        v: k\n      };\n    });\n  };\n\n  var trace = function (items, byItem, byMenu, finish) {\n    return get(byMenu, finish).bind(function (triggerItem) {\n      return get(items, triggerItem).bind(function (triggerMenu) {\n        var rest = trace(items, byItem, byMenu, triggerMenu);\n        return Optional.some([triggerMenu].concat(rest));\n      });\n    }).getOr([]);\n  };\n\n  var generate$5 = function (menus, expansions) {\n    var items = {};\n    each$1(menus, function (menuItems, menu) {\n      each(menuItems, function (item) {\n        items[item] = menu;\n      });\n    });\n    var byItem = expansions;\n    var byMenu = transpose(expansions);\n    var menuPaths = map$2(byMenu, function (_triggerItem, submenu) {\n      return [submenu].concat(trace(items, byItem, byMenu, submenu));\n    });\n    return map$2(items, function (menu) {\n      return get(menuPaths, menu).getOr([menu]);\n    });\n  };\n\n  var init$3 = function () {\n    var expansions = Cell({});\n    var menus = Cell({});\n    var paths = Cell({});\n    var primary = Cell(Optional.none());\n    var directory = Cell({});\n\n    var clear = function () {\n      expansions.set({});\n      menus.set({});\n      paths.set({});\n      primary.set(Optional.none());\n    };\n\n    var isClear = function () {\n      return primary.get().isNone();\n    };\n\n    var setMenuBuilt = function (menuName, built) {\n      var _a;\n\n      menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n        type: 'prepared',\n        menu: built\n      }, _a)));\n    };\n\n    var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n      primary.set(Optional.some(sPrimary));\n      expansions.set(sExpansions);\n      menus.set(sMenus);\n      directory.set(dir);\n      var sPaths = generate$5(dir, sExpansions);\n      paths.set(sPaths);\n    };\n\n    var getTriggeringItem = function (menuValue) {\n      return find$1(expansions.get(), function (v, _k) {\n        return v === menuValue;\n      });\n    };\n\n    var getTriggerData = function (menuValue, getItemByValue, path) {\n      return getPreparedMenu(menuValue).bind(function (menu) {\n        return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n          return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n            return {\n              triggeredMenu: menu,\n              triggeringItem: triggeredItem,\n              triggeringPath: path\n            };\n          });\n        });\n      });\n    };\n\n    var getTriggeringPath = function (itemValue, getItemByValue) {\n      var extraPath = filter(lookupItem(itemValue).toArray(), function (menuValue) {\n        return getPreparedMenu(menuValue).isSome();\n      });\n      return get(paths.get(), itemValue).bind(function (path) {\n        var revPath = reverse(extraPath.concat(path));\n        var triggers = bind(revPath, function (menuValue, menuIndex) {\n          return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n            return primary.get().is(menuValue) ? [] : [Optional.none()];\n          }, function (data) {\n            return [Optional.some(data)];\n          });\n        });\n        return sequence(triggers);\n      });\n    };\n\n    var expand = function (itemValue) {\n      return get(expansions.get(), itemValue).map(function (menu) {\n        var current = get(paths.get(), itemValue).getOr([]);\n        return [menu].concat(current);\n      });\n    };\n\n    var collapse = function (itemValue) {\n      return get(paths.get(), itemValue).bind(function (path) {\n        return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n      });\n    };\n\n    var refresh = function (itemValue) {\n      return get(paths.get(), itemValue);\n    };\n\n    var getPreparedMenu = function (menuValue) {\n      return lookupMenu(menuValue).bind(extractPreparedMenu);\n    };\n\n    var lookupMenu = function (menuValue) {\n      return get(menus.get(), menuValue);\n    };\n\n    var lookupItem = function (itemValue) {\n      return get(expansions.get(), itemValue);\n    };\n\n    var otherMenus = function (path) {\n      var menuValues = directory.get();\n      return difference(keys(menuValues), path);\n    };\n\n    var getPrimary = function () {\n      return primary.get().bind(getPreparedMenu);\n    };\n\n    var getMenus = function () {\n      return menus.get();\n    };\n\n    return {\n      setMenuBuilt: setMenuBuilt,\n      setContents: setContents,\n      expand: expand,\n      refresh: refresh,\n      collapse: collapse,\n      lookupMenu: lookupMenu,\n      lookupItem: lookupItem,\n      otherMenus: otherMenus,\n      getPrimary: getPrimary,\n      getMenus: getMenus,\n      clear: clear,\n      isClear: isClear,\n      getTriggeringPath: getTriggeringPath\n    };\n  };\n\n  var extractPreparedMenu = function (prep) {\n    return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n  };\n\n  var LayeredState = {\n    init: init$3,\n    extractPreparedMenu: extractPreparedMenu\n  };\n\n  var make$2 = function (detail, _rawUiSpec) {\n    var submenuParentItems = Cell(Optional.none());\n\n    var buildMenus = function (container, primaryName, menus) {\n      return map$2(menus, function (spec, name) {\n        var makeSketch = function () {\n          return Menu.sketch(__assign(__assign({}, spec), {\n            value: name,\n            markers: detail.markers,\n            fakeFocus: detail.fakeFocus,\n            onHighlight: detail.onHighlight,\n            focusManager: detail.fakeFocus ? highlights() : dom()\n          }));\n        };\n\n        return name === primaryName ? {\n          type: 'prepared',\n          menu: container.getSystem().build(makeSketch())\n        } : {\n          type: 'notbuilt',\n          nbMenu: makeSketch\n        };\n      });\n    };\n\n    var layeredState = LayeredState.init();\n\n    var setup = function (container) {\n      var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n      var directory = toDirectory();\n      layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n      return layeredState.getPrimary();\n    };\n\n    var getItemValue = function (item) {\n      return Representing.getValue(item).value;\n    };\n\n    var getItemByValue = function (_container, menus, itemValue) {\n      return findMap(menus, function (menu) {\n        if (!menu.getSystem().isConnected()) {\n          return Optional.none();\n        }\n\n        var candidates = Highlighting.getCandidates(menu);\n        return find(candidates, function (c) {\n          return getItemValue(c) === itemValue;\n        });\n      });\n    };\n\n    var toDirectory = function (_container) {\n      return map$2(detail.data.menus, function (data, _menuName) {\n        return bind(data.items, function (item) {\n          return item.type === 'separator' ? [] : [item.data.value];\n        });\n      });\n    };\n\n    var setActiveMenu = function (container, menu) {\n      Highlighting.highlight(container, menu);\n      Highlighting.getHighlighted(menu).orThunk(function () {\n        return Highlighting.getFirst(menu);\n      }).each(function (item) {\n        dispatch(container, item.element, focusItem());\n      });\n    };\n\n    var getMenus = function (state, menuValues) {\n      return cat(map(menuValues, function (mv) {\n        return state.lookupMenu(mv).bind(function (prep) {\n          return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n        });\n      }));\n    };\n\n    var closeOthers = function (container, state, path) {\n      var others = getMenus(state, state.otherMenus(path));\n      each(others, function (o) {\n        remove$5(o.element, [detail.markers.backgroundMenu]);\n\n        if (!detail.stayInDom) {\n          Replacing.remove(container, o);\n        }\n      });\n    };\n\n    var getSubmenuParents = function (container) {\n      return submenuParentItems.get().getOrThunk(function () {\n        var r = {};\n        var items = descendants(container.element, '.' + detail.markers.item);\n        var parentItems = filter(items, function (i) {\n          return get$2(i, 'aria-haspopup') === 'true';\n        });\n        each(parentItems, function (i) {\n          container.getSystem().getByDom(i).each(function (itemComp) {\n            var key = getItemValue(itemComp);\n            r[key] = itemComp;\n          });\n        });\n        submenuParentItems.set(Optional.some(r));\n        return r;\n      });\n    };\n\n    var updateAriaExpansions = function (container, path) {\n      var parentItems = getSubmenuParents(container);\n      each$1(parentItems, function (v, k) {\n        var expanded = contains(path, k);\n        set$1(v.element, 'aria-expanded', expanded);\n      });\n    };\n\n    var updateMenuPath = function (container, state, path) {\n      return Optional.from(path[0]).bind(function (latestMenuName) {\n        return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n          if (menuPrep.type === 'notbuilt') {\n            return Optional.none();\n          } else {\n            var activeMenu = menuPrep.menu;\n            var rest = getMenus(state, path.slice(1));\n            each(rest, function (r) {\n              add$2(r.element, detail.markers.backgroundMenu);\n            });\n\n            if (!inBody(activeMenu.element)) {\n              Replacing.append(container, premade$1(activeMenu));\n            }\n\n            remove$5(activeMenu.element, [detail.markers.backgroundMenu]);\n            setActiveMenu(container, activeMenu);\n            closeOthers(container, state, path);\n            return Optional.some(activeMenu);\n          }\n        });\n      });\n    };\n\n    var ExpandHighlightDecision;\n\n    (function (ExpandHighlightDecision) {\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n    })(ExpandHighlightDecision || (ExpandHighlightDecision = {}));\n\n    var buildIfRequired = function (container, menuName, menuPrep) {\n      if (menuPrep.type === 'notbuilt') {\n        var menu = container.getSystem().build(menuPrep.nbMenu());\n        layeredState.setMenuBuilt(menuName, menu);\n        return menu;\n      } else {\n        return menuPrep.menu;\n      }\n    };\n\n    var expandRight = function (container, item, decision) {\n      if (decision === void 0) {\n        decision = ExpandHighlightDecision.HighlightSubmenu;\n      }\n\n      var value = getItemValue(item);\n      return layeredState.expand(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return Optional.from(path[0]).bind(function (menuName) {\n          return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n            var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n\n            if (!inBody(activeMenu.element)) {\n              Replacing.append(container, premade$1(activeMenu));\n            }\n\n            detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n\n            if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n              Highlighting.highlightFirst(activeMenu);\n              return updateMenuPath(container, layeredState, path);\n            } else {\n              Highlighting.dehighlightAll(activeMenu);\n              return Optional.some(item);\n            }\n          });\n        });\n      });\n    };\n\n    var collapseLeft = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.collapse(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n          detail.onCollapseMenu(container, item, activeMenu);\n          return activeMenu;\n        });\n      });\n    };\n\n    var updateView = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.refresh(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path);\n      });\n    };\n\n    var onRight = function (container, item) {\n      return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n    };\n\n    var onLeft = function (container, item) {\n      return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n    };\n\n    var onEscape = function (container, item) {\n      return collapseLeft(container, item).orThunk(function () {\n        return detail.onEscape(container, item).map(function () {\n          return container;\n        });\n      });\n    };\n\n    var keyOnItem = function (f) {\n      return function (container, simulatedEvent) {\n        return closest$3(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n          return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n            return f(container, item).map(function () {\n              return true;\n            });\n          });\n        });\n      };\n    };\n\n    var events = derive([run(focus$4(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      layeredState.lookupItem(getItemValue(item)).each(function () {\n        var menu = simulatedEvent.event.menu;\n        Highlighting.highlight(sandbox, menu);\n        var value = getItemValue(simulatedEvent.event.item);\n        layeredState.refresh(value).each(function (path) {\n          return closeOthers(sandbox, layeredState, path);\n        });\n      });\n    }), runOnExecute(function (component, simulatedEvent) {\n      var target = simulatedEvent.event.target;\n      component.getSystem().getByDom(target).each(function (item) {\n        var itemValue = getItemValue(item);\n\n        if (itemValue.indexOf('collapse-item') === 0) {\n          collapseLeft(component, item);\n        }\n\n        expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n          detail.onExecute(component, item);\n        }, function () {});\n      });\n    }), runOnAttached(function (container, _simulatedEvent) {\n      setup(container).each(function (primary) {\n        Replacing.append(container, premade$1(primary));\n        detail.onOpenMenu(container, primary);\n\n        if (detail.highlightImmediately) {\n          setActiveMenu(container, primary);\n        }\n      });\n    })].concat(detail.navigateOnHover ? [run(hover(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      updateView(sandbox, item);\n      expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n      detail.onHover(sandbox, item);\n    })] : []));\n\n    var getActiveItem = function (container) {\n      return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n    };\n\n    var collapseMenuApi = function (container) {\n      getActiveItem(container).each(function (currentItem) {\n        collapseLeft(container, currentItem);\n      });\n    };\n\n    var highlightPrimary = function (container) {\n      layeredState.getPrimary().each(function (primary) {\n        setActiveMenu(container, primary);\n      });\n    };\n\n    var extractMenuFromContainer = function (container) {\n      return Optional.from(container.components()[0]).filter(function (comp) {\n        return get$2(comp.element, 'role') === 'menu';\n      });\n    };\n\n    var repositionMenus = function (container) {\n      var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n        return getActiveItem(container).bind(function (currentItem) {\n          var itemValue = getItemValue(currentItem);\n          var allMenus = values(layeredState.getMenus());\n          var preparedMenus = cat(map(allMenus, LayeredState.extractPreparedMenu));\n          return layeredState.getTriggeringPath(itemValue, function (v) {\n            return getItemByValue(container, preparedMenus, v);\n          });\n        }).map(function (triggeringPath) {\n          return {\n            primary: primary,\n            triggeringPath: triggeringPath\n          };\n        });\n      });\n      maybeActivePrimary.fold(function () {\n        extractMenuFromContainer(container).each(function (primaryMenu) {\n          detail.onRepositionMenu(container, primaryMenu, []);\n        });\n      }, function (_a) {\n        var primary = _a.primary,\n            triggeringPath = _a.triggeringPath;\n        detail.onRepositionMenu(container, primary, triggeringPath);\n      });\n    };\n\n    var apis = {\n      collapseMenu: collapseMenuApi,\n      highlightPrimary: highlightPrimary,\n      repositionMenus: repositionMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.tmenuBehaviours, [Keying.config({\n        mode: 'special',\n        onRight: keyOnItem(onRight),\n        onLeft: keyOnItem(onLeft),\n        onEscape: keyOnItem(onEscape),\n        focusIn: function (container, _keyInfo) {\n          layeredState.getPrimary().each(function (primary) {\n            dispatch(container, primary.element, focusItem());\n          });\n        }\n      }), Highlighting.config({\n        highlightClass: detail.markers.selectedMenu,\n        itemClass: detail.markers.menu\n      }), Composing.config({\n        find: function (container) {\n          return Highlighting.getHighlighted(container);\n        }\n      }), Replacing.config({})]),\n      eventOrder: detail.eventOrder,\n      apis: apis,\n      events: events\n    };\n  };\n\n  var collapseItem = constant('collapse-item');\n\n  var tieredData = function (primary, menus, expansions) {\n    return {\n      primary: primary,\n      menus: menus,\n      expansions: expansions\n    };\n  };\n\n  var singleData = function (name, menu) {\n    return {\n      primary: name,\n      menus: wrap$1(name, menu),\n      expansions: {}\n    };\n  };\n\n  var collapseItem$1 = function (text) {\n    return {\n      value: generate$1(collapseItem()),\n      meta: {\n        text: text\n      }\n    };\n  };\n\n  var tieredMenu = single$2({\n    name: 'TieredMenu',\n    configFields: [onStrictKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape'), onStrictHandler('onOpenMenu'), onStrictHandler('onOpenSubmenu'), onHandler('onRepositionMenu'), onHandler('onCollapseMenu'), defaulted$1('highlightImmediately', true), strictObjOf('data', [strict$1('primary'), strict$1('menus'), strict$1('expansions')]), defaulted$1('fakeFocus', false), onHandler('onHighlight'), onHandler('onHover'), tieredMenuMarkers(), strict$1('dom'), defaulted$1('navigateOnHover', true), defaulted$1('stayInDom', false), field$1('tmenuBehaviours', [Keying, Highlighting, Composing, Replacing]), defaulted$1('eventOrder', {})],\n    apis: {\n      collapseMenu: function (apis, tmenu) {\n        apis.collapseMenu(tmenu);\n      },\n      highlightPrimary: function (apis, tmenu) {\n        apis.highlightPrimary(tmenu);\n      },\n      repositionMenus: function (apis, tmenu) {\n        apis.repositionMenus(tmenu);\n      }\n    },\n    factory: make$2,\n    extraApis: {\n      tieredData: tieredData,\n      singleData: singleData,\n      collapseItem: collapseItem$1\n    }\n  });\n\n  var makeMenu = function (detail, menuSandbox, anchor, menuSpec, getBounds) {\n    var lazySink = function () {\n      return detail.lazySink(menuSandbox);\n    };\n\n    var layouts = menuSpec.type === 'horizontal' ? {\n      layouts: {\n        onLtr: function () {\n          return belowOrAbove();\n        },\n        onRtl: function () {\n          return belowOrAboveRtl();\n        }\n      }\n    } : {};\n\n    var isFirstTierSubmenu = function (triggeringPaths) {\n      return triggeringPaths.length === 2;\n    };\n\n    var getSubmenuLayouts = function (triggeringPaths) {\n      return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n    };\n\n    return tieredMenu.sketch({\n      dom: {\n        tag: 'div'\n      },\n      data: menuSpec.data,\n      markers: menuSpec.menu.markers,\n      highlightImmediately: menuSpec.menu.highlightImmediately,\n      onEscape: function () {\n        Sandboxing.close(menuSandbox);\n        detail.onEscape.map(function (handler) {\n          return handler(menuSandbox);\n        });\n        return Optional.some(true);\n      },\n      onExecute: function () {\n        return Optional.some(true);\n      },\n      onOpenMenu: function (tmenu, menu) {\n        Positioning.positionWithinBounds(lazySink().getOrDie(), anchor, menu, getBounds());\n      },\n      onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n        var sink = lazySink().getOrDie();\n        Positioning.position(sink, __assign({\n          anchor: 'submenu',\n          item: item\n        }, getSubmenuLayouts(triggeringPaths)), submenu);\n      },\n      onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n        var sink = lazySink().getOrDie();\n        Positioning.positionWithinBounds(sink, anchor, primaryMenu, getBounds());\n        each(submenuTriggers, function (st) {\n          var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n          Positioning.position(sink, __assign({\n            anchor: 'submenu',\n            item: st.triggeringItem\n          }, submenuLayouts), st.triggeredMenu);\n        });\n      }\n    });\n  };\n\n  var factory = function (detail, spec) {\n    var isPartOfRelated = function (sandbox, queryElem) {\n      var related = detail.getRelated(sandbox);\n      return related.exists(function (rel) {\n        return isPartOf(rel, queryElem);\n      });\n    };\n\n    var setContent = function (sandbox, thing) {\n      Sandboxing.setContent(sandbox, thing);\n    };\n\n    var showAt = function (sandbox, anchor, thing) {\n      showWithin(sandbox, anchor, thing, Optional.none());\n    };\n\n    var showWithin = function (sandbox, anchor, thing, boxElement) {\n      showWithinBounds(sandbox, anchor, thing, function () {\n        return boxElement.map(function (elem) {\n          return box(elem);\n        });\n      });\n    };\n\n    var showWithinBounds = function (sandbox, anchor, thing, getBounds) {\n      var sink = detail.lazySink(sandbox).getOrDie();\n      Sandboxing.openWhileCloaked(sandbox, thing, function () {\n        return Positioning.positionWithinBounds(sink, anchor, sandbox, getBounds());\n      });\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'position',\n        anchor: anchor,\n        getBounds: getBounds\n      }));\n    };\n\n    var showMenuAt = function (sandbox, anchor, menuSpec) {\n      showMenuWithinBounds(sandbox, anchor, menuSpec, function () {\n        return Optional.none();\n      });\n    };\n\n    var showMenuWithinBounds = function (sandbox, anchor, menuSpec, getBounds) {\n      var menu = makeMenu(detail, sandbox, anchor, menuSpec, getBounds);\n      Sandboxing.open(sandbox, menu);\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'menu',\n        menu: menu\n      }));\n    };\n\n    var hide = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.setValue(sandbox, Optional.none());\n        Sandboxing.close(sandbox);\n      }\n    };\n\n    var getContent = function (sandbox) {\n      return Sandboxing.getState(sandbox);\n    };\n\n    var reposition = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.getValue(sandbox).each(function (state) {\n          switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(function (tmenu) {\n                tieredMenu.repositionMenus(tmenu);\n              });\n              break;\n\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, state.anchor, sandbox, state.getBounds());\n              break;\n          }\n        });\n      }\n    };\n\n    var apis = {\n      setContent: setContent,\n      showAt: showAt,\n      showWithin: showWithin,\n      showWithinBounds: showWithinBounds,\n      showMenuAt: showMenuAt,\n      showMenuWithinBounds: showMenuWithinBounds,\n      hide: hide,\n      getContent: getContent,\n      reposition: reposition,\n      isOpen: Sandboxing.isOpen\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.inlineBehaviours, [Sandboxing.config({\n        isPartOf: function (sandbox, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n        },\n        getAttachPoint: function (sandbox) {\n          return detail.lazySink(sandbox).getOrDie();\n        },\n        onOpen: function (sandbox) {\n          detail.onShow(sandbox);\n        },\n        onClose: function (sandbox) {\n          detail.onHide(sandbox);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: Optional.none()\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel(__assign({\n          isExtraPart: spec.isExtraPart\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel$1(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})), {\n          doReposition: reposition\n        })))\n      })]),\n      eventOrder: detail.eventOrder,\n      apis: apis\n    };\n  };\n\n  var InlineView = single$2({\n    name: 'InlineView',\n    configFields: [strict$1('lazySink'), onHandler('onShow'), onHandler('onHide'), optionFunction('onEscape'), field$1('inlineBehaviours', [Sandboxing, Representing, Receiving]), optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]), optionObjOf('fireRepositionEventInstead', [defaulted$1('event', repositionRequested())]), defaulted$1('getRelated', Optional.none), defaulted$1('isExtraPart', never), defaulted$1('eventOrder', Optional.none)],\n    factory: factory,\n    apis: {\n      showAt: function (apis, component, anchor, thing) {\n        apis.showAt(component, anchor, thing);\n      },\n      showWithin: function (apis, component, anchor, thing, boxElement) {\n        apis.showWithin(component, anchor, thing, boxElement);\n      },\n      showWithinBounds: function (apis, component, anchor, thing, bounds) {\n        apis.showWithinBounds(component, anchor, thing, bounds);\n      },\n      showMenuAt: function (apis, component, anchor, menuSpec) {\n        apis.showMenuAt(component, anchor, menuSpec);\n      },\n      showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n        apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n      },\n      hide: function (apis, component) {\n        apis.hide(component);\n      },\n      isOpen: function (apis, component) {\n        return apis.isOpen(component);\n      },\n      getContent: function (apis, component) {\n        return apis.getContent(component);\n      },\n      setContent: function (apis, component, thing) {\n        apis.setContent(component, thing);\n      },\n      reposition: function (apis, component) {\n        apis.reposition(component);\n      }\n    }\n  });\n\n  var westEdgeX$1 = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX$1 = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var eastEdgeX$1 = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY$2 = function (anchor) {\n    return anchor.y;\n  };\n\n  var southY$2 = function (anchor, element) {\n    return anchor.y + anchor.height - element.height;\n  };\n\n  var southeast$3 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX$1(anchor, element), southY$2(anchor, element), bubbles.innerSoutheast(), northwest(), boundsRestriction(anchor, {\n      right: 0,\n      bottom: 3\n    }), 'layout-inner-se');\n  };\n\n  var southwest$3 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX$1(anchor), southY$2(anchor, element), bubbles.innerSouthwest(), northeast(), boundsRestriction(anchor, {\n      left: 1,\n      bottom: 3\n    }), 'layout-inner-sw');\n  };\n\n  var northeast$3 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX$1(anchor, element), northY$2(anchor), bubbles.innerNortheast(), southwest(), boundsRestriction(anchor, {\n      right: 0,\n      top: 2\n    }), 'layout-inner-ne');\n  };\n\n  var northwest$3 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX$1(anchor), northY$2(anchor), bubbles.innerNorthwest(), southeast(), boundsRestriction(anchor, {\n      left: 1,\n      top: 2\n    }), 'layout-inner-nw');\n  };\n\n  var north$3 = function (anchor, element, bubbles) {\n    return nu$7(middleX$1(anchor, element), northY$2(anchor), bubbles.innerNorth(), south(), boundsRestriction(anchor, {\n      top: 2\n    }), 'layout-inner-n');\n  };\n\n  var south$3 = function (anchor, element, bubbles) {\n    return nu$7(middleX$1(anchor, element), southY$2(anchor, element), bubbles.innerSouth(), north(), boundsRestriction(anchor, {\n      bottom: 3\n    }), 'layout-inner-s');\n  };\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n  var factory$1 = function (detail) {\n    var events = events$7(detail.action);\n    var tag = detail.dom.tag;\n\n    var lookupAttr = function (attr) {\n      return get(detail.dom, 'attributes').bind(function (attrs) {\n        return get(attrs, attr);\n      });\n    };\n\n    var getModAttributes = function () {\n      if (tag === 'button') {\n        var type = lookupAttr('type').getOr('button');\n        var roleAttrs = lookupAttr('role').map(function (role) {\n          return {\n            role: role\n          };\n        }).getOr({});\n        return __assign({\n          type: type\n        }, roleAttrs);\n      } else {\n        var role = lookupAttr('role').getOr('button');\n        return {\n          role: role\n        };\n      }\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events,\n      behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      })]),\n      domModification: {\n        attributes: getModAttributes()\n      },\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Button = single$2({\n    name: 'Button',\n    factory: factory$1,\n    configFields: [defaulted$1('uid', undefined), strict$1('dom'), defaulted$1('components', []), SketchBehaviours.field('buttonBehaviours', [Focusing, Keying]), option('action'), option('role'), defaulted$1('eventOrder', {})]\n  });\n\n  var record = function (spec) {\n    var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$2('memento');\n\n    var get = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).getOrDie();\n    };\n\n    var getOpt = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).toOptional();\n    };\n\n    var asSpec = function () {\n      return __assign(__assign({}, spec), {\n        uid: uid\n      });\n    };\n\n    return {\n      get: get,\n      getOpt: getOpt,\n      asSpec: asSpec\n    };\n  };\n\n  var defaultIcon = function (icons) {\n    return Optional.from(icons()['temporary-placeholder']).getOr('!not found!');\n  };\n\n  var get$d = function (name, icons) {\n    return Optional.from(icons()[name.toLowerCase()]).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var getOr = function (name, icons, fallback) {\n    return Optional.from(icons()[name.toLowerCase()]).or(fallback).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var getFirst$1 = function (names, icons) {\n    return findMap(names, function (name) {\n      return Optional.from(icons()[name.toLowerCase()]);\n    }).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var notificationIconMap = {\n    success: 'checkmark',\n    error: 'warning',\n    err: 'error',\n    warning: 'warning',\n    warn: 'warning',\n    info: 'info'\n  };\n\n  var factory$2 = function (detail) {\n    var memBannerText = record({\n      dom: {\n        tag: 'p',\n        innerHtml: detail.translationProvider(detail.text)\n      },\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var renderPercentBar = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar'],\n          attributes: {\n            style: 'width: ' + percent + '%'\n          }\n        }\n      };\n    };\n\n    var renderPercentText = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-text'],\n          innerHtml: percent + '%'\n        }\n      };\n    };\n\n    var memBannerProgress = record({\n      dom: {\n        tag: 'div',\n        classes: detail.progress ? ['tox-progress-bar', 'tox-progress-indicator'] : ['tox-progress-bar']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar-container']\n        },\n        components: [renderPercentBar(0)]\n      }, renderPercentText(0)],\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var updateProgress = function (comp, percent) {\n      if (comp.getSystem().isConnected()) {\n        memBannerProgress.getOpt(comp).each(function (progress) {\n          Replacing.set(progress, [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(percent)]\n          }, renderPercentText(percent)]);\n        });\n      }\n    };\n\n    var updateText = function (comp, text$1) {\n      if (comp.getSystem().isConnected()) {\n        var banner = memBannerText.get(comp);\n        Replacing.set(banner, [text(text$1)]);\n      }\n    };\n\n    var apis = {\n      updateProgress: updateProgress,\n      updateText: updateText\n    };\n    var iconChoices = flatten([detail.icon.toArray(), detail.level.toArray(), detail.level.bind(function (level) {\n      return Optional.from(notificationIconMap[level]);\n    }).toArray()]);\n    var memButton = record(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-notification__dismiss', 'tox-button', 'tox-button--naked', 'tox-button--icon']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon'],\n          innerHtml: get$d('close', detail.iconProvider),\n          attributes: {\n            'aria-label': detail.translationProvider('Close')\n          }\n        }\n      }],\n      action: function (comp) {\n        detail.onAction(comp);\n      }\n    }));\n    var components = [{\n      dom: {\n        tag: 'div',\n        classes: ['tox-notification__icon'],\n        innerHtml: getFirst$1(iconChoices, detail.iconProvider)\n      }\n    }, {\n      dom: {\n        tag: 'div',\n        classes: ['tox-notification__body']\n      },\n      components: [memBannerText.asSpec()],\n      behaviours: derive$1([Replacing.config({})])\n    }];\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: detail.level.map(function (level) {\n          return ['tox-notification', 'tox-notification--in', 'tox-notification--' + level];\n        }).getOr(['tox-notification', 'tox-notification--in'])\n      },\n      behaviours: derive$1([Focusing.config({}), config('notification-events', [run(focusin(), function (comp) {\n        memButton.getOpt(comp).each(Focusing.focus);\n      })])]),\n      components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n      apis: apis\n    };\n  };\n\n  var Notification = single$2({\n    name: 'Notification',\n    factory: factory$2,\n    configFields: [option('level'), strict$1('progress'), strict$1('icon'), strict$1('onAction'), strict$1('text'), strict$1('iconProvider'), strict$1('translationProvider'), defaultedBoolean('closeButton', true)],\n    apis: {\n      updateProgress: function (apis, comp, percent) {\n        apis.updateProgress(comp, percent);\n      },\n      updateText: function (apis, comp, text) {\n        apis.updateText(comp, text);\n      }\n    }\n  });\n\n  function NotificationManagerImpl(editor, extras, uiMothership) {\n    var backstage = extras.backstage;\n\n    var getLayoutDirection = function (rel) {\n      switch (rel) {\n        case 'bc-bc':\n          return south$3;\n\n        case 'tc-tc':\n          return north$3;\n\n        case 'tc-bc':\n          return north$1;\n\n        case 'bc-tc':\n        default:\n          return south$1;\n      }\n    };\n\n    var prePositionNotifications = function (notifications) {\n      each(notifications, function (notification) {\n        return notification.moveTo(0, 0);\n      });\n    };\n\n    var positionNotifications = function (notifications) {\n      if (notifications.length > 0) {\n        head(notifications).each(function (firstItem) {\n          return firstItem.moveRel(null, 'banner');\n        });\n        each(notifications, function (notification, index) {\n          if (index > 0) {\n            notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n          }\n        });\n      }\n    };\n\n    var reposition = function (notifications) {\n      prePositionNotifications(notifications);\n      positionNotifications(notifications);\n    };\n\n    var open = function (settings, closeCallback) {\n      var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n\n      var close = function () {\n        closeCallback();\n        InlineView.hide(notificationWrapper);\n      };\n\n      var notification = build$1(Notification.sketch({\n        text: settings.text,\n        level: contains(['success', 'error', 'warning', 'warn', 'info'], settings.type) ? settings.type : undefined,\n        progress: settings.progressBar === true,\n        icon: Optional.from(settings.icon),\n        closeButton: !hideCloseButton,\n        onAction: close,\n        iconProvider: backstage.shared.providers.icons,\n        translationProvider: backstage.shared.providers.translate\n      }));\n      var notificationWrapper = build$1(InlineView.sketch(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-notifications-container']\n        },\n        lazySink: extras.backstage.shared.getSink,\n        fireDismissalEventInstead: {}\n      }, backstage.shared.header.isPositionedAtTop() ? {} : {\n        fireRepositionEventInstead: {}\n      })));\n      uiMothership.add(notificationWrapper);\n\n      if (settings.timeout > 0) {\n        global$2.setTimeout(function () {\n          close();\n        }, settings.timeout);\n      }\n\n      return {\n        close: close,\n        moveTo: function (x, y) {\n          InlineView.showAt(notificationWrapper, {\n            anchor: 'makeshift',\n            x: x,\n            y: y\n          }, premade$1(notification));\n        },\n        moveRel: function (element, rel) {\n          if (rel !== 'banner') {\n            var layoutDirection_1 = getLayoutDirection(rel);\n            var nodeAnchor = {\n              anchor: 'node',\n              root: body(),\n              node: Optional.some(SugarElement.fromDom(element)),\n              layouts: {\n                onRtl: function () {\n                  return [layoutDirection_1];\n                },\n                onLtr: function () {\n                  return [layoutDirection_1];\n                }\n              }\n            };\n            InlineView.showAt(notificationWrapper, nodeAnchor, premade$1(notification));\n          } else {\n            InlineView.showAt(notificationWrapper, extras.backstage.shared.anchors.banner(), premade$1(notification));\n          }\n        },\n        text: function (nuText) {\n          Notification.updateText(notification, nuText);\n        },\n        settings: settings,\n        getEl: function () {\n          return notification.element.dom;\n        },\n        progressBar: {\n          value: function (percent) {\n            Notification.updateProgress(notification, percent);\n          }\n        }\n      };\n    };\n\n    var close = function (notification) {\n      notification.close();\n    };\n\n    var getArgs = function (notification) {\n      return notification.settings;\n    };\n\n    return {\n      open: open,\n      close: close,\n      reposition: reposition,\n      getArgs: getArgs\n    };\n  }\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer === null) {\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last$2 = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer !== null) {\n        clearTimeout(timer);\n      }\n\n      timer = setTimeout(function () {\n        fn.apply(null, args);\n        timer = null;\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n  var isBoundary = function (dom, node) {\n    return dom.isBlock(node) || contains(['BR', 'IMG', 'HR', 'INPUT'], node.nodeName) || dom.getContentEditable(node) === 'false';\n  };\n\n  var repeatLeft = function (dom, node, offset, process, rootNode) {\n    var search = global$3(dom, function (node) {\n      return isBoundary(dom, node);\n    });\n    return Optional.from(search.backwards(node, offset, process, rootNode));\n  };\n\n  var autocompleteSelector = '[data-mce-autocompleter]';\n\n  var create$4 = function (editor, range) {\n    return detect$4(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n      var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n      append(wrapper, SugarElement.fromDom(range.extractContents()));\n      range.insertNode(wrapper.dom);\n      parent(wrapper).each(function (elm) {\n        return elm.dom.normalize();\n      });\n      last$1(wrapper).map(function (last) {\n        editor.selection.setCursorLocation(last.dom, getEnd(last));\n      });\n      return wrapper;\n    });\n  };\n\n  var detect$4 = function (elm) {\n    return closest$3(elm, autocompleteSelector);\n  };\n\n  var isValidTextRange = function (rng) {\n    return rng.collapsed && rng.startContainer.nodeType === 3;\n  };\n\n  var getText = function (rng) {\n    return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n  };\n\n  var isWhitespace = function (chr) {\n    return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var stripTriggerChar = function (text, triggerCh) {\n    return text.substring(triggerCh.length);\n  };\n\n  var findChar = function (text, index, ch) {\n    var i;\n\n    for (i = index - 1; i >= 0; i--) {\n      var char = text.charAt(i);\n\n      if (isWhitespace(char)) {\n        return Optional.none();\n      }\n\n      if (char === ch) {\n        break;\n      }\n    }\n\n    return Optional.some(i);\n  };\n\n  var findStart = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    if (!isValidTextRange(initRange)) {\n      return Optional.none();\n    }\n\n    var findTriggerChIndex = function (element, offset, text) {\n      return findChar(text, offset, ch).getOr(offset);\n    };\n\n    var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n    return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n      var range = initRange.cloneRange();\n      range.setStart(spot.container, spot.offset);\n      range.setEnd(initRange.endContainer, initRange.endOffset);\n\n      if (range.collapsed) {\n        return Optional.none();\n      }\n\n      var text = getText(range);\n      var triggerCharIndex = text.lastIndexOf(ch);\n\n      if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n        return Optional.none();\n      } else {\n        return Optional.some({\n          text: stripTriggerChar(text, ch),\n          range: range,\n          triggerChar: ch\n        });\n      }\n    });\n  };\n\n  var getContext = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    return detect$4(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n      return findStart(dom, initRange, ch, minChars);\n    }, function (elm) {\n      var range = dom.createRng();\n      range.selectNode(elm.dom);\n      var text = getText(range);\n      return Optional.some({\n        range: range,\n        text: stripTriggerChar(text, ch),\n        triggerChar: ch\n      });\n    });\n  };\n\n  var setup = function (api, editor) {\n    editor.on('keypress compositionend', api.onKeypress.throttle);\n    editor.on('remove', api.onKeypress.cancel);\n\n    var redirectKeyToItem = function (item, e) {\n      emitWith(item, keydown(), {\n        raw: e\n      });\n    };\n\n    editor.on('keydown', function (e) {\n      var getItem = function () {\n        return api.getView().bind(Highlighting.getHighlighted);\n      };\n\n      if (e.which === 8) {\n        api.onKeypress.throttle(e);\n      }\n\n      if (api.isActive()) {\n        if (e.which === 27) {\n          api.cancelIfNecessary();\n        }\n\n        if (api.isMenuOpen()) {\n          if (e.which === 13) {\n            getItem().each(emitExecute);\n            e.preventDefault();\n          } else if (e.which === 40) {\n            getItem().fold(function () {\n              api.getView().each(Highlighting.highlightFirst);\n            }, function (item) {\n              redirectKeyToItem(item, e);\n            });\n            e.preventDefault();\n            e.stopImmediatePropagation();\n          } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n            getItem().each(function (item) {\n              redirectKeyToItem(item, e);\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            });\n          }\n        } else {\n          if (e.which === 13 || e.which === 38 || e.which === 40) {\n            api.cancelIfNecessary();\n          }\n        }\n      }\n    });\n    editor.on('NodeChange', function (e) {\n      if (api.isActive() && !api.isProcessingAction() && detect$4(SugarElement.fromDom(e.element)).isNone()) {\n        api.cancelIfNecessary();\n      }\n    });\n  };\n\n  var AutocompleterEditorEvents = {\n    setup: setup\n  };\n  var global$4 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var point$2 = function (container, offset) {\n    return {\n      container: container,\n      offset: offset\n    };\n  };\n\n  var isText$1 = function (node) {\n    return node.nodeType === TEXT;\n  };\n\n  var isElement$1 = function (node) {\n    return node.nodeType === ELEMENT;\n  };\n\n  var toLast = function (node) {\n    if (isText$1(node)) {\n      return point$2(node, node.data.length);\n    } else {\n      var children = node.childNodes;\n      return children.length > 0 ? toLast(children[children.length - 1]) : point$2(node, children.length);\n    }\n  };\n\n  var toLeaf = function (node, offset) {\n    var children = node.childNodes;\n\n    if (children.length > 0 && offset < children.length) {\n      return toLeaf(children[offset], 0);\n    } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n      return toLast(children[children.length - 1]);\n    } else {\n      return point$2(node, offset);\n    }\n  };\n\n  var isPreviousCharContent = function (dom, leaf) {\n    return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n      return offset === 0 ? -1 : offset;\n    }, dom.getRoot()).filter(function (spot) {\n      var char = spot.container.data.charAt(spot.offset - 1);\n      return !isWhitespace(char);\n    }).isSome();\n  };\n\n  var isStartOfWord = function (dom) {\n    return function (rng) {\n      var leaf = toLeaf(rng.startContainer, rng.startOffset);\n      return !isPreviousCharContent(dom, leaf);\n    };\n  };\n\n  var getTriggerContext = function (dom, initRange, database) {\n    return findMap(database.triggerChars, function (ch) {\n      return getContext(dom, initRange, ch);\n    });\n  };\n\n  var lookup = function (editor, getDatabase) {\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n      return lookupWithContext(editor, getDatabase, context);\n    });\n  };\n\n  var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n    if (fetchOptions === void 0) {\n      fetchOptions = {};\n    }\n\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    var startText = rng.startContainer.nodeValue;\n    var autocompleters = filter(database.lookupByChar(context.triggerChar), function (autocompleter) {\n      return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n        return isStartOfWord(editor.dom);\n      })(context.range, startText, context.text);\n    });\n\n    if (autocompleters.length === 0) {\n      return Optional.none();\n    }\n\n    var lookupData = global$4.all(map(autocompleters, function (ac) {\n      var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n      return fetchResult.then(function (results) {\n        return {\n          matchText: context.text,\n          items: results,\n          columns: ac.columns,\n          onAction: ac.onAction\n        };\n      });\n    }));\n    return Optional.some({\n      lookupData: lookupData,\n      context: context\n    });\n  };\n\n  var separatorMenuItemSchema = objOf([strictString('type'), optionString('text')]);\n\n  var createSeparatorMenuItem = function (spec) {\n    return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n  };\n\n  var autocompleterItemSchema = objOf([defaulted$1('type', 'autocompleteitem'), defaulted$1('active', false), defaulted$1('disabled', false), defaulted$1('meta', {}), strictString('value'), optionString('text'), optionString('icon')]);\n  var autocompleterSchema = objOf([strictString('type'), strictString('ch'), defaultedNumber('minChars', 1), defaulted$1('columns', 1), defaultedNumber('maxResults', 10), optionFunction('matches'), strictFunction('fetch'), strictFunction('onAction')]);\n\n  var createSeparatorItem = function (spec) {\n    return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n  };\n\n  var createAutocompleterItem = function (spec) {\n    return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n  };\n\n  var createAutocompleter = function (spec) {\n    return asRaw('Autocompleter', autocompleterSchema, spec);\n  };\n\n  var baseToolbarButtonFields = [defaultedBoolean('disabled', false), optionString('tooltip'), optionString('icon'), optionString('text'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var toolbarButtonSchema = objOf([strictString('type'), strictFunction('onAction')].concat(baseToolbarButtonFields));\n\n  var createToolbarButton = function (spec) {\n    return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n  };\n\n  var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n  var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([strictString('type'), strictFunction('onAction')]));\n\n  var createToggleButton = function (spec) {\n    return asRaw('ToggleButton', toggleButtonSchema, spec);\n  };\n\n  var contextBarFields = [defaultedFunction('predicate', function () {\n    return false;\n  }), defaultedStringEnum('scope', 'node', ['node', 'editor']), defaultedStringEnum('position', 'selection', ['node', 'selection', 'line'])];\n  var contextButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton'), defaulted$1('primary', false), strictFunction('onAction'), state$1('original', identity)]);\n  var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformbutton'), defaulted$1('primary', false), strictFunction('onAction'), state$1('original', identity)]);\n  var launchButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton')]);\n  var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformtogglebutton')]);\n  var toggleOrNormal = choose$1('type', {\n    contextformbutton: contextButtonFields,\n    contextformtogglebutton: contextToggleButtonFields\n  });\n  var contextFormSchema = objOf([defaulted$1('type', 'contextform'), defaultedFunction('initValue', function () {\n    return '';\n  }), optionString('label'), strictArrayOf('commands', toggleOrNormal), optionOf('launch', choose$1('type', {\n    contextformbutton: launchButtonFields,\n    contextformtogglebutton: launchToggleButtonFields\n  }))].concat(contextBarFields));\n\n  var createContextForm = function (spec) {\n    return asRaw('ContextForm', contextFormSchema, spec);\n  };\n\n  var contextToolbarSchema = objOf([defaulted$1('type', 'contexttoolbar'), strictString('items')].concat(contextBarFields));\n\n  var createContextToolbar = function (spec) {\n    return asRaw('ContextToolbar', contextToolbarSchema, spec);\n  };\n\n  var stringArray = function (a) {\n    var all = {};\n    each(a, function (key) {\n      all[key] = {};\n    });\n    return keys(all);\n  };\n\n  var register = function (editor) {\n    var popups = editor.ui.registry.getAll().popups;\n    var dataset = map$2(popups, function (popup) {\n      return createAutocompleter(popup).fold(function (err) {\n        throw new Error(formatError(err));\n      }, function (x) {\n        return x;\n      });\n    });\n    var triggerChars = stringArray(mapToArray(dataset, function (v) {\n      return v.ch;\n    }));\n    var datasetValues = values(dataset);\n\n    var lookupByChar = function (ch) {\n      return filter(datasetValues, function (dv) {\n        return dv.ch === ch;\n      });\n    };\n\n    return {\n      dataset: dataset,\n      triggerChars: triggerChars,\n      lookupByChar: lookupByChar\n    };\n  };\n\n  var ItemResponse;\n\n  (function (ItemResponse) {\n    ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n    ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n  })(ItemResponse || (ItemResponse = {}));\n\n  var ItemResponse$1 = ItemResponse;\n  var navClass = 'tox-menu-nav__js';\n  var selectableClass = 'tox-collection__item';\n  var colorClass = 'tox-swatch';\n  var presetClasses = {\n    normal: navClass,\n    color: colorClass\n  };\n  var tickedClass = 'tox-collection__item--enabled';\n  var groupHeadingClass = 'tox-collection__group-heading';\n  var iconClass = 'tox-collection__item-icon';\n  var textClass = 'tox-collection__item-label';\n  var accessoryClass = 'tox-collection__item-accessory';\n  var caretClass = 'tox-collection__item-caret';\n  var checkmarkClass = 'tox-collection__item-checkmark';\n  var activeClass = 'tox-collection__item--active';\n  var iconClassRtl = 'tox-collection__item-icon-rtl';\n\n  var classForPreset = function (presets) {\n    return get(presetClasses, presets).getOr(navClass);\n  };\n\n  var forMenu = function (presets) {\n    if (presets === 'color') {\n      return 'tox-swatches';\n    } else {\n      return 'tox-menu';\n    }\n  };\n\n  var classes = function (presets) {\n    return {\n      backgroundMenu: 'tox-background-menu',\n      selectedMenu: 'tox-selected-menu',\n      selectedItem: 'tox-collection__item--active',\n      hasIcons: 'tox-menu--has-icons',\n      menu: forMenu(presets),\n      tieredMenu: 'tox-tiered-menu'\n    };\n  };\n\n  var markers$1 = function (presets) {\n    var menuClasses = classes(presets);\n    return {\n      backgroundMenu: menuClasses.backgroundMenu,\n      selectedMenu: menuClasses.selectedMenu,\n      menu: menuClasses.menu,\n      selectedItem: menuClasses.selectedItem,\n      item: classForPreset(presets)\n    };\n  };\n\n  var dom$1 = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    return {\n      tag: 'div',\n      classes: flatten([[menuClasses.menu, 'tox-menu-' + columns + '-column'], hasIcons ? [menuClasses.hasIcons] : []])\n    };\n  };\n\n  var components$1 = [Menu.parts.items({})];\n\n  var part = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    var d = {\n      tag: 'div',\n      classes: flatten([[menuClasses.tieredMenu]])\n    };\n    return {\n      dom: d,\n      markers: markers$1(presets)\n    };\n  };\n\n  var chunk$1 = function (rowDom, numColumns) {\n    return function (items) {\n      var chunks = chunk(items, numColumns);\n      return map(chunks, function (c) {\n        return {\n          dom: rowDom,\n          components: c\n        };\n      });\n    };\n  };\n\n  var forSwatch = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-swatches-menu']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-swatches']\n        },\n        components: [Menu.parts.items({\n          preprocess: columns !== 'auto' ? chunk$1({\n            tag: 'div',\n            classes: ['tox-swatches__row']\n          }, columns) : identity\n        })]\n      }]\n    };\n  };\n\n  var forToolbar = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection', 'tox-collection--toolbar', 'tox-collection--toolbar-lg']\n      },\n      components: [Menu.parts.items({\n        preprocess: chunk$1({\n          tag: 'div',\n          classes: ['tox-collection__group']\n        }, columns)\n      })]\n    };\n  };\n\n  var preprocessCollection = function (items, isSeparator) {\n    var allSplits = [];\n    var currentSplit = [];\n    each(items, function (item, i) {\n      if (isSeparator(item, i)) {\n        if (currentSplit.length > 0) {\n          allSplits.push(currentSplit);\n        }\n\n        currentSplit = [];\n\n        if (has(item.dom, 'innerHtml')) {\n          currentSplit.push(item);\n        }\n      } else {\n        currentSplit.push(item);\n      }\n    });\n\n    if (currentSplit.length > 0) {\n      allSplits.push(currentSplit);\n    }\n\n    return map(allSplits, function (s) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection__group']\n        },\n        components: s\n      };\n    });\n  };\n\n  var forCollection = function (columns, initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection'].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          if (columns !== 'auto' && columns > 1) {\n            return chunk$1({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)(items);\n          } else {\n            return preprocessCollection(items, function (_item, i) {\n              return initItems[i].type === 'separator';\n            });\n          }\n        }\n      })]\n    };\n  };\n\n  var forHorizontalCollection = function (initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection', 'tox-collection--horizontal']\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          return preprocessCollection(items, function (_item, i) {\n            return initItems[i].type === 'separator';\n          });\n        }\n      })]\n    };\n  };\n\n  var menuHasIcons = function (xs) {\n    return exists(xs, function (item) {\n      return 'icon' in item && item.icon !== undefined;\n    });\n  };\n\n  var handleError = function (error) {\n    console.error(formatError(error));\n    console.log(error);\n    return Optional.none();\n  };\n\n  var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n    var structure = forHorizontalCollection(items);\n    return {\n      value: value,\n      dom: structure.dom,\n      components: structure.components,\n      items: items\n    };\n  };\n\n  var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n    if (presets === 'color') {\n      var structure = forSwatch(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 'auto') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 1) {\n      var structure = forCollection(1, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'listpreview' && columns !== 'auto') {\n      var structure = forToolbar(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    return {\n      value: value,\n      dom: dom$1(hasIcons, columns, presets),\n      components: components$1,\n      items: items\n    };\n  };\n\n  var commonMenuItemFields = [defaultedBoolean('disabled', false), optionString('text'), optionString('shortcut'), field('value', 'value', defaultedThunk(function () {\n    return generate$1('menuitem-value');\n  }), anyValue$1()), defaulted$1('meta', {})];\n  var choiceMenuItemSchema = objOf([strictString('type'), defaultedBoolean('active', false), optionString('icon')].concat(commonMenuItemFields));\n\n  var createChoiceMenuItem = function (spec) {\n    return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n  };\n\n  var fancyTypes = ['inserttable', 'colorswatch'];\n  var fancyMenuItemSchema = objOf([strictString('type'), strictStringEnum('fancytype', fancyTypes), defaultedFunction('onAction', noop)]);\n\n  var createFancyMenuItem = function (spec) {\n    return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n  };\n\n  var menuItemSchema = objOf([strictString('type'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedFunction('onAction', noop), optionString('icon')].concat(commonMenuItemFields));\n\n  var createMenuItem = function (spec) {\n    return asRaw('menuitem', menuItemSchema, spec);\n  };\n\n  var nestedMenuItemSchema = objOf([strictString('type'), strictFunction('getSubmenuItems'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), optionString('icon')].concat(commonMenuItemFields));\n\n  var createNestedMenuItem = function (spec) {\n    return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n  };\n\n  var toggleMenuItemSchema = objOf([strictString('type'), optionString('icon'), defaultedBoolean('active', false), defaultedFunction('onSetup', function () {\n    return noop;\n  }), strictFunction('onAction')].concat(commonMenuItemFields));\n\n  var createToggleMenuItem = function (spec) {\n    return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n  };\n\n  var detectSize = function (comp, margin, selectorClass) {\n    var descendants$1 = descendants(comp.element, '.' + selectorClass);\n\n    if (descendants$1.length > 0) {\n      var columnLength = findIndex(descendants$1, function (c) {\n        var thisTop = c.dom.getBoundingClientRect().top;\n        var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n        return Math.abs(thisTop - cTop) > margin;\n      }).getOr(descendants$1.length);\n      return Optional.some({\n        numColumns: columnLength,\n        numRows: Math.ceil(descendants$1.length / columnLength)\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var namedEvents = function (name, handlers) {\n    return derive$1([config(name, handlers)]);\n  };\n\n  var unnamedEvents = function (handlers) {\n    return namedEvents(generate$1('unnamed-events'), handlers);\n  };\n\n  var SimpleBehaviours = {\n    namedEvents: namedEvents,\n    unnamedEvents: unnamedEvents\n  };\n  var TooltippingSchema = [strict$1('lazySink'), strict$1('tooltipDom'), defaulted$1('exclusive', true), defaulted$1('tooltipComponents', []), defaulted$1('delay', 300), defaultedStringEnum('mode', 'normal', ['normal', 'follow-highlight']), defaulted$1('anchor', function (comp) {\n    return {\n      anchor: 'hotspot',\n      hotspot: comp,\n      layouts: {\n        onLtr: constant([south$1, north$1, southeast$1, northeast$1, southwest$1, northwest$1]),\n        onRtl: constant([south$1, north$1, southeast$1, northeast$1, southwest$1, northwest$1])\n      }\n    };\n  }), onHandler('onHide'), onHandler('onShow')];\n\n  var init$4 = function () {\n    var timer = Cell(Optional.none());\n    var popup = Cell(Optional.none());\n\n    var getTooltip = function () {\n      return popup.get();\n    };\n\n    var setTooltip = function (comp) {\n      popup.set(Optional.some(comp));\n    };\n\n    var clearTooltip = function () {\n      popup.set(Optional.none());\n    };\n\n    var clearTimer = function () {\n      timer.get().each(function (t) {\n        clearTimeout(t);\n      });\n    };\n\n    var resetTimer = function (f, delay) {\n      clearTimer();\n      timer.set(Optional.some(setTimeout(function () {\n        f();\n      }, delay)));\n    };\n\n    var isShowing = function () {\n      return popup.get().isSome();\n    };\n\n    var readState = constant('not-implemented');\n    return nu$5({\n      getTooltip: getTooltip,\n      isShowing: isShowing,\n      setTooltip: setTooltip,\n      clearTooltip: clearTooltip,\n      clearTimer: clearTimer,\n      resetTimer: resetTimer,\n      readState: readState\n    });\n  };\n\n  var TooltippingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$4\n  });\n  var ExclusivityChannel = generate$1('tooltip.exclusive');\n  var ShowTooltipEvent = generate$1('tooltip.show');\n  var HideTooltipEvent = generate$1('tooltip.hide');\n\n  var hideAllExclusive = function (component, _tConfig, _tState) {\n    component.getSystem().broadcastOn([ExclusivityChannel], {});\n  };\n\n  var setComponents = function (component, tConfig, tState, specs) {\n    tState.getTooltip().each(function (tooltip) {\n      if (tooltip.getSystem().isConnected()) {\n        Replacing.set(tooltip, specs);\n      }\n    });\n  };\n\n  var TooltippingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    hideAllExclusive: hideAllExclusive,\n    setComponents: setComponents\n  });\n\n  var events$8 = function (tooltipConfig, state) {\n    var hide = function (comp) {\n      state.getTooltip().each(function (p) {\n        detach(p);\n        tooltipConfig.onHide(comp, p);\n        state.clearTooltip();\n      });\n      state.clearTimer();\n    };\n\n    var show = function (comp) {\n      if (!state.isShowing()) {\n        hideAllExclusive(comp);\n        var sink = tooltipConfig.lazySink(comp).getOrDie();\n        var popup = comp.getSystem().build({\n          dom: tooltipConfig.tooltipDom,\n          components: tooltipConfig.tooltipComponents,\n          events: derive(tooltipConfig.mode === 'normal' ? [run(mouseover(), function (_) {\n            emit(comp, ShowTooltipEvent);\n          }), run(mouseout(), function (_) {\n            emit(comp, HideTooltipEvent);\n          })] : []),\n          behaviours: derive$1([Replacing.config({})])\n        });\n        state.setTooltip(popup);\n        attach$1(sink, popup);\n        tooltipConfig.onShow(comp, popup);\n        Positioning.position(sink, tooltipConfig.anchor(comp), popup);\n      }\n    };\n\n    return derive(flatten([[run(ShowTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        show(comp);\n      }, tooltipConfig.delay);\n    }), run(HideTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        hide(comp);\n      }, tooltipConfig.delay);\n    }), run(receive(), function (comp, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        if (contains(receivingData.channels, ExclusivityChannel)) {\n          hide(comp);\n        }\n      }\n    }), runOnDetached(function (comp) {\n      hide(comp);\n    })], tooltipConfig.mode === 'normal' ? [run(focusin(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run(postBlur(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    }), run(mouseover(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run(mouseout(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })] : [run(highlight(), function (comp, _se) {\n      emit(comp, ShowTooltipEvent);\n    }), run(dehighlight(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })]]));\n  };\n\n  var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$8\n  });\n  var Tooltipping = create$1({\n    fields: TooltippingSchema,\n    name: 'tooltipping',\n    active: ActiveTooltipping,\n    state: TooltippingState,\n    apis: TooltippingApis\n  });\n  var global$5 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$6 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n  var nativeDisabled = ['input', 'button', 'textarea', 'select'];\n\n  var onLoad$5 = function (component, disableConfig, disableState) {\n    var f = disableConfig.disabled() ? disable : enable;\n    f(component, disableConfig);\n  };\n\n  var hasNative = function (component, config) {\n    return config.useNative === true && contains(nativeDisabled, name(component.element));\n  };\n\n  var nativeIsDisabled = function (component) {\n    return has$1(component.element, 'disabled');\n  };\n\n  var nativeDisable = function (component) {\n    set$1(component.element, 'disabled', 'disabled');\n  };\n\n  var nativeEnable = function (component) {\n    remove$1(component.element, 'disabled');\n  };\n\n  var ariaIsDisabled = function (component) {\n    return get$2(component.element, 'aria-disabled') === 'true';\n  };\n\n  var ariaDisable = function (component) {\n    set$1(component.element, 'aria-disabled', 'true');\n  };\n\n  var ariaEnable = function (component) {\n    set$1(component.element, 'aria-disabled', 'false');\n  };\n\n  var disable = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      add$2(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n    f(component);\n    disableConfig.onDisabled(component);\n  };\n\n  var enable = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      remove$4(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n    f(component);\n    disableConfig.onEnabled(component);\n  };\n\n  var isDisabled = function (component, disableConfig) {\n    return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n  };\n\n  var set$7 = function (component, disableConfig, disableState, disabled) {\n    var f = disabled ? disable : enable;\n    f(component, disableConfig);\n  };\n\n  var DisableApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    enable: enable,\n    disable: disable,\n    isDisabled: isDisabled,\n    onLoad: onLoad$5,\n    set: set$7\n  });\n\n  var exhibit$3 = function (base, disableConfig) {\n    return nu$6({\n      classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : []\n    });\n  };\n\n  var events$9 = function (disableConfig, disableState) {\n    return derive([abort(execute(), function (component, _simulatedEvent) {\n      return isDisabled(component, disableConfig);\n    }), loadEvent(disableConfig, disableState, onLoad$5)]);\n  };\n\n  var ActiveDisable = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$3,\n    events: events$9\n  });\n  var DisableSchema = [defaultedFunction('disabled', never), defaulted$1('useNative', true), option('disableClass'), onHandler('onDisabled'), onHandler('onEnabled')];\n  var Disabling = create$1({\n    fields: DisableSchema,\n    name: 'disabling',\n    active: ActiveDisable,\n    apis: DisableApis\n  });\n  var global$7 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n  var getSkinUrl = function (editor) {\n    var skin = editor.getParam('skin');\n    var skinUrl = editor.getParam('skin_url');\n\n    if (skin !== false) {\n      var skinName = skin ? skin : 'oxide';\n\n      if (skinUrl) {\n        skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n      } else {\n        skinUrl = global$7.baseURL + '/skins/ui/' + skinName;\n      }\n    }\n\n    return skinUrl;\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.getParam('readonly', false, 'boolean');\n  };\n\n  var isSkinDisabled = function (editor) {\n    return editor.getParam('skin') === false;\n  };\n\n  var getHeightSetting = function (editor) {\n    return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n  };\n\n  var getWidthSetting = function (editor) {\n    return editor.getParam('width', global$5.DOM.getStyle(editor.getElement(), 'width'));\n  };\n\n  var getMinWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('min_width')).filter(isNumber);\n  };\n\n  var getMinHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('min_height')).filter(isNumber);\n  };\n\n  var getMaxWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('max_width')).filter(isNumber);\n  };\n\n  var getMaxHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('max_height')).filter(isNumber);\n  };\n\n  var getUserStyleFormats = function (editor) {\n    return Optional.from(editor.getParam('style_formats')).filter(isArray);\n  };\n\n  var isMergeStyleFormats = function (editor) {\n    return editor.getParam('style_formats_merge', false, 'boolean');\n  };\n\n  var getLineHeightFormats = function (editor) {\n    return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n  };\n\n  var getRemovedMenuItems = function (editor) {\n    return editor.getParam('removed_menuitems', '');\n  };\n\n  var isMenubarEnabled = function (editor) {\n    return editor.getParam('menubar', true, 'boolean') !== false;\n  };\n\n  var isToolbarEnabled = function (editor) {\n    var toolbar = editor.getParam('toolbar', true);\n    var isToolbarTrue = toolbar === true;\n    var isToolbarString = isString(toolbar);\n    var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n    return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n  };\n\n  var getMultipleToolbarsSetting = function (editor) {\n    var toolbars = range(9, function (num) {\n      return editor.getParam('toolbar' + (num + 1), false, 'string');\n    });\n    var toolbarArray = filter(toolbars, function (toolbar) {\n      return typeof toolbar === 'string';\n    });\n    return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n  };\n\n  var isMultipleToolbars = function (editor) {\n    return getMultipleToolbarsSetting(editor).fold(function () {\n      var toolbar = editor.getParam('toolbar', [], 'string[]');\n      return toolbar.length > 0;\n    }, function () {\n      return true;\n    });\n  };\n\n  var ToolbarMode;\n\n  (function (ToolbarMode) {\n    ToolbarMode['default'] = 'wrap';\n    ToolbarMode['floating'] = 'floating';\n    ToolbarMode['sliding'] = 'sliding';\n    ToolbarMode['scrolling'] = 'scrolling';\n  })(ToolbarMode || (ToolbarMode = {}));\n\n  var getToolbarMode = function (editor) {\n    return editor.getParam('toolbar_mode', '', 'string');\n  };\n\n  var ToolbarLocation;\n\n  (function (ToolbarLocation) {\n    ToolbarLocation['auto'] = 'auto';\n    ToolbarLocation['top'] = 'top';\n    ToolbarLocation['bottom'] = 'bottom';\n  })(ToolbarLocation || (ToolbarLocation = {}));\n\n  var getToolbarGroups = function (editor) {\n    return editor.getParam('toolbar_groups', {}, 'object');\n  };\n\n  var getToolbarLocation = function (editor) {\n    return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n  };\n\n  var isToolbarLocationBottom = function (editor) {\n    return getToolbarLocation(editor) === ToolbarLocation.bottom;\n  };\n\n  var fixedContainerSelector = function (editor) {\n    return editor.getParam('fixed_toolbar_container', '', 'string');\n  };\n\n  var isToolbarPersist = function (editor) {\n    return editor.getParam('toolbar_persist', false, 'boolean');\n  };\n\n  var fixedContainerElement = function (editor) {\n    var selector = fixedContainerSelector(editor);\n    return selector.length > 0 && editor.inline ? descendant$1(body(), selector) : Optional.none();\n  };\n\n  var useFixedContainer = function (editor) {\n    return editor.inline && fixedContainerElement(editor).isSome();\n  };\n\n  var getUiContainer = function (editor) {\n    var fixedContainer = fixedContainerElement(editor);\n    return fixedContainer.getOrThunk(function () {\n      return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n    });\n  };\n\n  var isDistractionFree = function (editor) {\n    return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n  };\n\n  var isStickyToolbar = function (editor) {\n    var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n    return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n  };\n\n  var isDraggableModal = function (editor) {\n    return editor.getParam('draggable_modal', false, 'boolean');\n  };\n\n  var getMenus = function (editor) {\n    var menu = editor.getParam('menu');\n\n    if (menu) {\n      return map$2(menu, function (menu) {\n        return __assign(__assign({}, menu), {\n          items: menu.items\n        });\n      });\n    } else {\n      return {};\n    }\n  };\n\n  var getMenubar = function (editor) {\n    return editor.getParam('menubar');\n  };\n\n  var getToolbar = function (editor) {\n    return editor.getParam('toolbar', true);\n  };\n\n  var getFilePickerCallback = function (editor) {\n    return editor.getParam('file_picker_callback');\n  };\n\n  var getFilePickerTypes = function (editor) {\n    return editor.getParam('file_picker_types');\n  };\n\n  var getFileBrowserCallbackTypes = function (editor) {\n    return editor.getParam('file_browser_callback_types');\n  };\n\n  var noTypeaheadUrls = function (editor) {\n    return editor.getParam('typeahead_urls') === false;\n  };\n\n  var getAnchorTop = function (editor) {\n    return editor.getParam('anchor_top', '#top');\n  };\n\n  var getAnchorBottom = function (editor) {\n    return editor.getParam('anchor_bottom', '#bottom');\n  };\n\n  var getFilePickerValidatorHandler = function (editor) {\n    var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n\n    if (handler === undefined) {\n      return editor.getParam('filepicker_validator_handler', undefined, 'function');\n    } else {\n      return handler;\n    }\n  };\n\n  var ReadOnlyChannel = 'silver.readonly';\n  var ReadOnlyDataSchema = objOf([strictBoolean('readonly')]);\n\n  var broadcastReadonly = function (uiComponents, readonly) {\n    var outerContainer = uiComponents.outerContainer;\n    var target = outerContainer.element;\n\n    if (readonly) {\n      uiComponents.mothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n      uiComponents.uiMothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n    }\n\n    uiComponents.mothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n    uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n  };\n\n  var setupReadonlyModeSwitch = function (editor, uiComponents) {\n    editor.on('init', function () {\n      if (editor.mode.isReadOnly()) {\n        broadcastReadonly(uiComponents, true);\n      }\n    });\n    editor.on('SwitchMode', function () {\n      return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n    });\n\n    if (isReadOnly(editor)) {\n      editor.setMode('readonly');\n    }\n  };\n\n  var receivingConfig = function () {\n    var _a;\n\n    return Receiving.config({\n      channels: (_a = {}, _a[ReadOnlyChannel] = {\n        schema: ReadOnlyDataSchema,\n        onReceive: function (comp, data) {\n          Disabling.set(comp, data.readonly);\n        }\n      }, _a)\n    });\n  };\n\n  var item = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-collection__item--state-disabled'\n    });\n  };\n\n  var button = function (disabled) {\n    return Disabling.config({\n      disabled: disabled\n    });\n  };\n\n  var splitButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled'\n    });\n  };\n\n  var toolbarButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled',\n      useNative: false\n    });\n  };\n\n  var DisablingConfigs = {\n    item: item,\n    button: button,\n    splitButton: splitButton,\n    toolbarButton: toolbarButton\n  };\n\n  var runWithApi = function (info, comp) {\n    var api = info.getApi(comp);\n    return function (f) {\n      f(api);\n    };\n  };\n\n  var onControlAttached = function (info, editorOffCell) {\n    return runOnAttached(function (comp) {\n      var run = runWithApi(info, comp);\n      run(function (api) {\n        var onDestroy = info.onSetup(api);\n\n        if (onDestroy !== null && onDestroy !== undefined) {\n          editorOffCell.set(onDestroy);\n        }\n      });\n    });\n  };\n\n  var onControlDetached = function (getApi, editorOffCell) {\n    return runOnDetached(function (comp) {\n      return runWithApi(getApi, comp)(editorOffCell.get());\n    });\n  };\n\n  var _a;\n\n  var onMenuItemExecute = function (info, itemResponse) {\n    return runOnExecute(function (comp, simulatedEvent) {\n      runWithApi(info, comp)(info.onAction);\n\n      if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n        emit(comp, sandboxClose());\n        simulatedEvent.stop();\n      }\n    });\n  };\n\n  var menuItemEventOrder = (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'item-events'], _a);\n\n  var componentRenderPipeline = function (xs) {\n    return bind(xs, function (o) {\n      return o.toArray();\n    });\n  };\n\n  var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n    var editorOffCell = Cell(noop);\n    return {\n      type: 'item',\n      dom: structure.dom,\n      components: componentRenderPipeline(structure.optComponents),\n      data: spec.data,\n      eventOrder: menuItemEventOrder,\n      hasSubmenu: spec.triggersSubmenu,\n      itemBehaviours: derive$1([config('item-events', [onMenuItemExecute(spec, itemResponse), onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), DisablingConfigs.item(function () {\n        return spec.disabled || providersbackstage.isReadOnly();\n      }), receivingConfig(), Replacing.config({})].concat(spec.itemBehaviours))\n    };\n  };\n\n  var buildData = function (source) {\n    return {\n      value: source.value,\n      meta: __assign({\n        text: source.text.getOr('')\n      }, source.meta)\n    };\n  };\n\n  var global$8 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var convertText = function (source) {\n    var mac = {\n      alt: '&#x2325;',\n      ctrl: '&#x2303;',\n      shift: '&#x21E7;',\n      meta: '&#x2318;',\n      access: '&#x2303;&#x2325;'\n    };\n    var other = {\n      meta: 'Ctrl',\n      access: 'Shift+Alt'\n    };\n    var replace = global$8.mac ? mac : other;\n    var shortcut = source.split('+');\n    var updated = map(shortcut, function (segment) {\n      var search = segment.toLowerCase().trim();\n      return has(replace, search) ? replace[search] : segment;\n    });\n    return global$8.mac ? updated.join('') : updated.join('+');\n  };\n\n  var renderIcon = function (iconHtml) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [iconClass],\n        innerHtml: iconHtml\n      }\n    };\n  };\n\n  var renderText = function (text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [text(global$6.translate(text$1))]\n    };\n  };\n\n  var renderHtml = function (html) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass],\n        innerHtml: html\n      }\n    };\n  };\n\n  var renderStyledText = function (style, text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [{\n        dom: {\n          tag: style.tag,\n          styles: style.styles\n        },\n        components: [text(global$6.translate(text$1))]\n      }]\n    };\n  };\n\n  var renderShortcut = function (shortcut) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [accessoryClass],\n        innerHtml: convertText(shortcut)\n      }\n    };\n  };\n\n  var renderCheckmark = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [checkmarkClass],\n        innerHtml: get$d('checkmark', icons)\n      }\n    };\n  };\n\n  var renderSubmenuCaret = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [caretClass],\n        innerHtml: get$d('chevron-right', icons)\n      }\n    };\n  };\n\n  var renderDownwardsCaret = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [caretClass],\n        innerHtml: get$d('chevron-down', icons)\n      }\n    };\n  };\n\n  var renderColorStructure = function (itemText, itemValue, iconSvg, providerBackstage) {\n    var colorPickerCommand = 'custom';\n    var removeColorCommand = 'remove';\n\n    var getDom = function () {\n      var common = colorClass;\n      var icon = iconSvg.getOr('');\n      var attributes = itemText.map(function (text) {\n        return {\n          title: providerBackstage.translate(text)\n        };\n      }).getOr({});\n      var baseDom = {\n        tag: 'div',\n        attributes: attributes,\n        classes: [common]\n      };\n\n      if (itemValue === colorPickerCommand) {\n        return __assign(__assign({}, baseDom), {\n          tag: 'button',\n          classes: __spreadArrays(baseDom.classes, ['tox-swatches__picker-btn']),\n          innerHtml: icon\n        });\n      } else if (itemValue === removeColorCommand) {\n        return __assign(__assign({}, baseDom), {\n          classes: __spreadArrays(baseDom.classes, ['tox-swatch--remove']),\n          innerHtml: icon\n        });\n      } else {\n        return __assign(__assign({}, baseDom), {\n          attributes: __assign(__assign({}, baseDom.attributes), {\n            'data-mce-color': itemValue\n          }),\n          styles: {\n            'background-color': itemValue\n          }\n        });\n      }\n    };\n\n    return {\n      dom: getDom(),\n      optComponents: []\n    };\n  };\n\n  var renderNormalItemStructure = function (info, icon, renderIcons, textRender, rtlClass) {\n    var leftIcon = renderIcons ? icon.or(Optional.some('')).map(renderIcon) : Optional.none();\n    var checkmark = info.checkMark;\n    var domTitle = info.ariaLabel.map(function (label) {\n      return {\n        attributes: {\n          title: global$6.translate(label)\n        }\n      };\n    }).getOr({});\n\n    var dom = __assign({\n      tag: 'div',\n      classes: [navClass, selectableClass].concat(rtlClass ? [iconClassRtl] : [])\n    }, domTitle);\n\n    var content = info.htmlContent.fold(function () {\n      return info.textContent.map(textRender);\n    }, function (html) {\n      return Optional.some(renderHtml(html));\n    });\n    var menuItem = {\n      dom: dom,\n      optComponents: [leftIcon, content, info.shortcutContent.map(renderShortcut), checkmark, info.caret]\n    };\n    return menuItem;\n  };\n\n  var rtlIcon = ['list-num-default', 'list-num-lower-alpha', 'list-num-lower-greek', 'list-num-lower-roman', 'list-num-upper-alpha', 'list-num-upper-roman'];\n  var rtlTransform = ['list-bull-circle', 'list-bull-default', 'list-bull-square'];\n\n  var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n    if (fallbackIcon === void 0) {\n      fallbackIcon = Optional.none();\n    }\n\n    var getIconName = function (iconName) {\n      return iconName.map(function (name) {\n        return global$6.isRtl() && contains(rtlIcon, name) ? name + '-rtl' : name;\n      });\n    };\n\n    var needRtlClass = global$6.isRtl() && info.iconContent.exists(function (name) {\n      return contains(rtlTransform, name);\n    });\n    var icon = getIconName(info.iconContent).map(function (iconName) {\n      return getOr(iconName, providersBackstage.icons, fallbackIcon);\n    });\n    var textRender = Optional.from(info.meta).fold(function () {\n      return renderText;\n    }, function (meta) {\n      return has(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n    });\n\n    if (info.presets === 'color') {\n      return renderColorStructure(info.ariaLabel, info.value, icon, providersBackstage);\n    } else {\n      return renderNormalItemStructure(info, icon, renderIcons, textRender, needRtlClass);\n    }\n  };\n\n  var tooltipBehaviour = function (meta, sharedBackstage) {\n    return get(meta, 'tooltipWorker').map(function (tooltipWorker) {\n      return [Tooltipping.config({\n        lazySink: sharedBackstage.getSink,\n        tooltipDom: {\n          tag: 'div',\n          classes: ['tox-tooltip-worker-container']\n        },\n        tooltipComponents: [],\n        anchor: function (comp) {\n          return {\n            anchor: 'submenu',\n            item: comp,\n            overrides: {\n              maxHeightFunction: expandable\n            }\n          };\n        },\n        mode: 'follow-highlight',\n        onShow: function (component, _tooltip) {\n          tooltipWorker(function (elm) {\n            Tooltipping.setComponents(component, [external({\n              element: SugarElement.fromDom(elm)\n            })]);\n          });\n        }\n      })];\n    }).getOr([]);\n  };\n\n  var escapeRegExp = function (text) {\n    return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  };\n\n  var encodeText = function (text) {\n    return global$5.DOM.encode(text);\n  };\n\n  var replaceText = function (text, matchText) {\n    var translated = global$6.translate(text);\n    var encoded = encodeText(translated);\n\n    if (matchText.length > 0) {\n      var escapedMatchRegex = new RegExp(escapeRegExp(matchText), 'gi');\n      return encoded.replace(escapedMatchRegex, function (match) {\n        return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n      });\n    } else {\n      return encoded;\n    }\n  };\n\n  var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: Optional.none(),\n      htmlContent: useText ? spec.text.map(function (text) {\n        return replaceText(text, matchText);\n      }) : Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: Optional.none(),\n      checkMark: Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, sharedBackstage.providers, renderIcons, spec.icon);\n    return renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: function () {\n        return {};\n      },\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value, spec.meta);\n      },\n      onSetup: function () {\n        return function () {};\n      },\n      triggersSubmenu: false,\n      itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n    }, structure, itemResponse, sharedBackstage.providers);\n  };\n\n  var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: useText ? spec.text : Optional.none(),\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: useText ? spec.shortcut : Optional.none(),\n      checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value);\n      },\n      onSetup: function (api) {\n        api.setActive(isSelected);\n        return function () {};\n      },\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var parts$2 = generate$4(owner$2(), parts());\n\n  var hexColour = function (value) {\n    return {\n      value: value\n    };\n  };\n\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n\n  var isHexString = function (hex) {\n    return shorthandRegex.test(hex) || longformRegex.test(hex);\n  };\n\n  var getLongForm = function (hex) {\n    var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n      return r + r + g + g + b + b;\n    });\n    return {\n      value: hexString\n    };\n  };\n\n  var extractValues = function (hex) {\n    var longForm = getLongForm(hex);\n    var splitForm = longformRegex.exec(longForm.value);\n    return splitForm === null ? ['FFFFFF', 'FF', 'FF', 'FF'] : splitForm;\n  };\n\n  var toHex = function (component) {\n    var hex = component.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  };\n\n  var fromRgba = function (rgbaColour) {\n    var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n    return hexColour(value);\n  };\n\n  var min = Math.min;\n  var max = Math.max;\n  var round = Math.round;\n  var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n  var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n\n  var rgbaColour = function (red, green, blue, alpha) {\n    return {\n      red: red,\n      green: green,\n      blue: blue,\n      alpha: alpha\n    };\n  };\n\n  var isRgbaComponent = function (value) {\n    var num = parseInt(value, 10);\n    return num.toString() === value && num >= 0 && num <= 255;\n  };\n\n  var fromHsv = function (hsv) {\n    var r;\n    var g;\n    var b;\n    var hue = (hsv.hue || 0) % 360;\n    var saturation = hsv.saturation / 100;\n    var brightness = hsv.value / 100;\n    saturation = max(0, min(saturation, 1));\n    brightness = max(0, min(brightness, 1));\n\n    if (saturation === 0) {\n      r = g = b = round(255 * brightness);\n      return rgbaColour(r, g, b, 1);\n    }\n\n    var side = hue / 60;\n    var chroma = brightness * saturation;\n    var x = chroma * (1 - Math.abs(side % 2 - 1));\n    var match = brightness - chroma;\n\n    switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n\n      default:\n        r = g = b = 0;\n    }\n\n    r = round(255 * (r + match));\n    g = round(255 * (g + match));\n    b = round(255 * (b + match));\n    return rgbaColour(r, g, b, 1);\n  };\n\n  var fromHex = function (hexColour) {\n    var result = extractValues(hexColour);\n    var red = parseInt(result[1], 16);\n    var green = parseInt(result[2], 16);\n    var blue = parseInt(result[3], 16);\n    return rgbaColour(red, green, blue, 1);\n  };\n\n  var fromStringValues = function (red, green, blue, alpha) {\n    var r = parseInt(red, 10);\n    var g = parseInt(green, 10);\n    var b = parseInt(blue, 10);\n    var a = parseFloat(alpha);\n    return rgbaColour(r, g, b, a);\n  };\n\n  var fromString = function (rgbaString) {\n    if (rgbaString === 'transparent') {\n      return Optional.some(rgbaColour(0, 0, 0, 0));\n    }\n\n    var rgbMatch = rgbRegex.exec(rgbaString);\n\n    if (rgbMatch !== null) {\n      return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n    }\n\n    var rgbaMatch = rgbaRegex.exec(rgbaString);\n\n    if (rgbaMatch !== null) {\n      return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n    }\n\n    return Optional.none();\n  };\n\n  var toString = function (rgba) {\n    return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n  };\n\n  var red = rgbaColour(255, 0, 0, 1);\n\n  var fireSkinLoaded = function (editor) {\n    return editor.fire('SkinLoaded');\n  };\n\n  var fireSkinLoadError = function (editor, error) {\n    return editor.fire('SkinLoadError', error);\n  };\n\n  var fireResizeEditor = function (editor) {\n    return editor.fire('ResizeEditor');\n  };\n\n  var fireResizeContent = function (editor, e) {\n    return editor.fire('ResizeContent', e);\n  };\n\n  var fireScrollContent = function (editor, e) {\n    return editor.fire('ScrollContent', e);\n  };\n\n  var fireTextColorChange = function (editor, data) {\n    return editor.fire('TextColorChange', data);\n  };\n\n  var global$9 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n  var storageName = 'tinymce-custom-colors';\n\n  function ColorCache(max) {\n    if (max === void 0) {\n      max = 10;\n    }\n\n    var storageString = global$9.getItem(storageName);\n    var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n\n    var prune = function (list) {\n      var diff = max - list.length;\n      return diff < 0 ? list.slice(0, max) : list;\n    };\n\n    var cache = prune(localstorage);\n\n    var add = function (key) {\n      indexOf(cache, key).each(remove);\n      cache.unshift(key);\n\n      if (cache.length > max) {\n        cache.pop();\n      }\n\n      global$9.setItem(storageName, JSON.stringify(cache));\n    };\n\n    var remove = function (idx) {\n      cache.splice(idx, 1);\n    };\n\n    var state = function () {\n      return cache.slice(0);\n    };\n\n    return {\n      add: add,\n      state: state\n    };\n  }\n\n  var choiceItem = 'choiceitem';\n  var defaultColors = [{\n    type: choiceItem,\n    text: 'Light Green',\n    value: '#BFEDD2'\n  }, {\n    type: choiceItem,\n    text: 'Light Yellow',\n    value: '#FBEEB8'\n  }, {\n    type: choiceItem,\n    text: 'Light Red',\n    value: '#F8CAC6'\n  }, {\n    type: choiceItem,\n    text: 'Light Purple',\n    value: '#ECCAFA'\n  }, {\n    type: choiceItem,\n    text: 'Light Blue',\n    value: '#C2E0F4'\n  }, {\n    type: choiceItem,\n    text: 'Green',\n    value: '#2DC26B'\n  }, {\n    type: choiceItem,\n    text: 'Yellow',\n    value: '#F1C40F'\n  }, {\n    type: choiceItem,\n    text: 'Red',\n    value: '#E03E2D'\n  }, {\n    type: choiceItem,\n    text: 'Purple',\n    value: '#B96AD9'\n  }, {\n    type: choiceItem,\n    text: 'Blue',\n    value: '#3598DB'\n  }, {\n    type: choiceItem,\n    text: 'Dark Turquoise',\n    value: '#169179'\n  }, {\n    type: choiceItem,\n    text: 'Orange',\n    value: '#E67E23'\n  }, {\n    type: choiceItem,\n    text: 'Dark Red',\n    value: '#BA372A'\n  }, {\n    type: choiceItem,\n    text: 'Dark Purple',\n    value: '#843FA1'\n  }, {\n    type: choiceItem,\n    text: 'Dark Blue',\n    value: '#236FA1'\n  }, {\n    type: choiceItem,\n    text: 'Light Gray',\n    value: '#ECF0F1'\n  }, {\n    type: choiceItem,\n    text: 'Medium Gray',\n    value: '#CED4D9'\n  }, {\n    type: choiceItem,\n    text: 'Gray',\n    value: '#95A5A6'\n  }, {\n    type: choiceItem,\n    text: 'Dark Gray',\n    value: '#7E8C8D'\n  }, {\n    type: choiceItem,\n    text: 'Navy Blue',\n    value: '#34495E'\n  }, {\n    type: choiceItem,\n    text: 'Black',\n    value: '#000000'\n  }, {\n    type: choiceItem,\n    text: 'White',\n    value: '#ffffff'\n  }];\n  var colorCache = ColorCache(10);\n\n  var mapColors = function (colorMap) {\n    var colors = [];\n    var canvas = document.createElement('canvas');\n    canvas.height = 1;\n    canvas.width = 1;\n    var ctx = canvas.getContext('2d');\n\n    var byteAsHex = function (colorByte, alphaByte) {\n      var bg = 255;\n      var alpha = alphaByte / 255;\n      var colorByteWithWhiteBg = Math.round(colorByte * alpha + bg * (1 - alpha));\n      return ('0' + colorByteWithWhiteBg.toString(16)).slice(-2).toUpperCase();\n    };\n\n    var asHexColor = function (color) {\n      if (/^[0-9A-Fa-f]{6}$/.test(color)) {\n        return '#' + color.toUpperCase();\n      }\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.fillStyle = '#FFFFFF';\n      ctx.fillStyle = color;\n      ctx.fillRect(0, 0, 1, 1);\n      var rgba = ctx.getImageData(0, 0, 1, 1).data;\n      var r = rgba[0],\n          g = rgba[1],\n          b = rgba[2],\n          a = rgba[3];\n      return '#' + byteAsHex(r, a) + byteAsHex(g, a) + byteAsHex(b, a);\n    };\n\n    for (var i = 0; i < colorMap.length; i += 2) {\n      colors.push({\n        text: colorMap[i + 1],\n        value: asHexColor(colorMap[i]),\n        type: 'choiceitem'\n      });\n    }\n\n    return colors;\n  };\n\n  var getColorCols = function (editor, defaultCols) {\n    return editor.getParam('color_cols', defaultCols, 'number');\n  };\n\n  var hasCustomColors = function (editor) {\n    return editor.getParam('custom_colors') !== false;\n  };\n\n  var getColorMap = function (editor) {\n    return editor.getParam('color_map');\n  };\n\n  var getColors = function (editor) {\n    var unmapped = getColorMap(editor);\n    return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n  };\n\n  var getCurrentColors = function () {\n    return map(colorCache.state(), function (color) {\n      return {\n        type: choiceItem,\n        text: color,\n        value: color\n      };\n    });\n  };\n\n  var addColor = function (color) {\n    colorCache.add(color);\n  };\n\n  var getCurrentColor = function (editor, format) {\n    var color;\n    editor.dom.getParents(editor.selection.getStart(), function (elm) {\n      var value;\n\n      if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n        color = color ? color : value;\n      }\n    });\n    return color;\n  };\n\n  var applyFormat = function (editor, format, value) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.apply(format, {\n        value: value\n      });\n      editor.nodeChanged();\n    });\n  };\n\n  var removeFormat = function (editor, format) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.remove(format, {\n        value: null\n      }, null, true);\n      editor.nodeChanged();\n    });\n  };\n\n  var registerCommands = function (editor) {\n    editor.addCommand('mceApplyTextcolor', function (format, value) {\n      applyFormat(editor, format, value);\n    });\n    editor.addCommand('mceRemoveTextcolor', function (format) {\n      removeFormat(editor, format);\n    });\n  };\n\n  var calcCols = function (colors) {\n    return Math.max(5, Math.ceil(Math.sqrt(colors)));\n  };\n\n  var getColorCols$1 = function (editor) {\n    var colors = getColors(editor);\n    var defaultCols = calcCols(colors.length);\n    return getColorCols(editor, defaultCols);\n  };\n\n  var getAdditionalColors = function (hasCustom) {\n    var type = 'choiceitem';\n    var remove = {\n      type: type,\n      text: 'Remove color',\n      icon: 'color-swatch-remove-color',\n      value: 'remove'\n    };\n    var custom = {\n      type: type,\n      text: 'Custom color',\n      icon: 'color-picker',\n      value: 'custom'\n    };\n    return hasCustom ? [remove, custom] : [remove];\n  };\n\n  var applyColor = function (editor, format, value, onChoice) {\n    if (value === 'custom') {\n      var dialog = colorPickerDialog(editor);\n      dialog(function (colorOpt) {\n        colorOpt.each(function (color) {\n          addColor(color);\n          editor.execCommand('mceApplyTextcolor', format, color);\n          onChoice(color);\n        });\n      }, '#000000');\n    } else if (value === 'remove') {\n      onChoice('');\n      editor.execCommand('mceRemoveTextcolor', format);\n    } else {\n      onChoice(value);\n      editor.execCommand('mceApplyTextcolor', format, value);\n    }\n  };\n\n  var getColors$1 = function (colors, hasCustom) {\n    return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n  };\n\n  var getFetch = function (colors, hasCustom) {\n    return function (callback) {\n      callback(getColors$1(colors, hasCustom));\n    };\n  };\n\n  var setIconColor = function (splitButtonApi, name, newColor) {\n    var setIconFillAndStroke = function (pathId, color) {\n      splitButtonApi.setIconFill(pathId, color);\n      splitButtonApi.setIconStroke(pathId, color);\n    };\n\n    var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n    setIconFillAndStroke(id, newColor);\n  };\n\n  var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n    editor.ui.registry.addSplitButton(name, {\n      tooltip: tooltip,\n      presets: 'color',\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      select: function (value) {\n        var optCurrentRgb = Optional.from(getCurrentColor(editor, format));\n        return optCurrentRgb.bind(function (currentRgb) {\n          return fromString(currentRgb).map(function (rgba) {\n            var currentHex = fromRgba(rgba).value;\n            return contains$1(value.toLowerCase(), currentHex);\n          });\n        }).getOr(false);\n      },\n      columns: getColorCols$1(editor),\n      fetch: getFetch(getColors(editor), hasCustomColors(editor)),\n      onAction: function (_splitButtonApi) {\n        if (lastColor.get() !== null) {\n          applyColor(editor, format, lastColor.get(), function () {});\n        }\n      },\n      onItemAction: function (_splitButtonApi, value) {\n        applyColor(editor, format, value, function (newColor) {\n          lastColor.set(newColor);\n          fireTextColorChange(editor, {\n            name: name,\n            color: newColor\n          });\n        });\n      },\n      onSetup: function (splitButtonApi) {\n        if (lastColor.get() !== null) {\n          setIconColor(splitButtonApi, name, lastColor.get());\n        }\n\n        var handler = function (e) {\n          if (e.name === name) {\n            setIconColor(splitButtonApi, e.name, e.color);\n          }\n        };\n\n        editor.on('TextColorChange', handler);\n        return function () {\n          editor.off('TextColorChange', handler);\n        };\n      }\n    });\n  };\n\n  var registerTextColorMenuItem = function (editor, name, format, text) {\n    editor.ui.registry.addNestedMenuItem(name, {\n      text: text,\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      getSubmenuItems: function () {\n        return [{\n          type: 'fancymenuitem',\n          fancytype: 'colorswatch',\n          onAction: function (data) {\n            applyColor(editor, format, data.value, noop);\n          }\n        }];\n      }\n    });\n  };\n\n  var colorPickerDialog = function (editor) {\n    return function (callback, value) {\n      var getOnSubmit = function (callback) {\n        return function (api) {\n          var data = api.getData();\n          callback(Optional.from(data.colorpicker));\n          api.close();\n        };\n      };\n\n      var onAction = function (api, details) {\n        if (details.name === 'hex-valid') {\n          if (details.value) {\n            api.enable('ok');\n          } else {\n            api.disable('ok');\n          }\n        }\n      };\n\n      var initialData = {\n        colorpicker: value\n      };\n      var submit = getOnSubmit(callback);\n      editor.windowManager.open({\n        title: 'Color Picker',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [{\n            type: 'colorpicker',\n            name: 'colorpicker',\n            label: 'Color'\n          }]\n        },\n        buttons: [{\n          type: 'cancel',\n          name: 'cancel',\n          text: 'Cancel'\n        }, {\n          type: 'submit',\n          name: 'save',\n          text: 'Save',\n          primary: true\n        }],\n        initialData: initialData,\n        onAction: onAction,\n        onSubmit: submit,\n        onClose: function () {},\n        onCancel: function () {\n          callback(Optional.none());\n        }\n      });\n    };\n  };\n\n  var register$1 = function (editor) {\n    registerCommands(editor);\n    var lastForeColor = Cell(null);\n    var lastBackColor = Cell(null);\n    registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n    registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n    registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n    registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n  };\n\n  var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n    var hasIcons = menuHasIcons(items);\n    var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n    var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n    return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n  };\n\n  var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n    return cat(map(items, function (item) {\n      if (item.type === 'choiceitem') {\n        return createChoiceMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n        });\n      } else {\n        return Optional.none();\n      }\n    }));\n  };\n\n  var deriveMenuMovement = function (columns, presets) {\n    var menuMarkers = markers$1(presets);\n\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: true\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'grid',\n        selector: '.' + menuMarkers.item,\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n      return {\n        mode: 'matrix',\n        rowSelector: '.' + rowClass\n      };\n    }\n  };\n\n  var deriveCollectionMovement = function (columns, presets) {\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: false,\n        selector: '.tox-collection__item'\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + 'tox-collection__item',\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n          cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n        }\n      };\n    }\n  };\n\n  function renderColorSwatchItem(spec, backstage) {\n    var items = getColors$1(backstage.colorinput.getColors(), backstage.colorinput.hasCustomColors());\n    var columns = backstage.colorinput.getColorCols();\n    var presets = 'color';\n    var menuSpec = createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n      spec.onAction({\n        value: value\n      });\n    }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, function () {\n      return false;\n    }, backstage.shared.providers);\n\n    var widgetSpec = __assign(__assign({}, menuSpec), {\n      markers: markers$1(presets),\n      movement: deriveMenuMovement(columns, presets)\n    });\n\n    return {\n      type: 'widget',\n      data: {\n        value: generate$1('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$2.widget(Menu.sketch(widgetSpec))]\n    };\n  }\n\n  var cellOverEvent = generate$1('cell-over');\n  var cellExecuteEvent = generate$1('cell-execute');\n\n  var makeCell = function (row, col, labelId) {\n    var _a;\n\n    var emitCellOver = function (c) {\n      return emitWith(c, cellOverEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var emitExecute = function (c) {\n      return emitWith(c, cellExecuteEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var onClick = function (c, se) {\n      se.stop();\n      emitExecute(c);\n    };\n\n    return build$1({\n      dom: {\n        tag: 'div',\n        attributes: (_a = {\n          role: 'button'\n        }, _a['aria-labelledby'] = labelId, _a)\n      },\n      behaviours: derive$1([config('insert-table-picker-cell', [run(mouseover(), Focusing.focus), run(execute(), emitExecute), run(click(), onClick), run(tap(), onClick)]), Toggling.config({\n        toggleClass: 'tox-insert-table-picker__selected',\n        toggleOnExecute: false\n      }), Focusing.config({\n        onFocus: emitCellOver\n      })])\n    });\n  };\n\n  var makeCells = function (labelId, numRows, numCols) {\n    var cells = [];\n\n    for (var i = 0; i < numRows; i++) {\n      var row = [];\n\n      for (var j = 0; j < numCols; j++) {\n        row.push(makeCell(i, j, labelId));\n      }\n\n      cells.push(row);\n    }\n\n    return cells;\n  };\n\n  var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n    for (var i = 0; i < numRows; i++) {\n      for (var j = 0; j < numColumns; j++) {\n        Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n      }\n    }\n  };\n\n  var makeComponents = function (cells) {\n    return bind(cells, function (cellRow) {\n      return map(cellRow, premade$1);\n    });\n  };\n\n  var makeLabelText = function (row, col) {\n    return text(col + 1 + 'x' + (row + 1));\n  };\n\n  var renderInsertTableMenuItem = function (spec) {\n    var numRows = 10;\n    var numColumns = 10;\n    var sizeLabelId = generate$1('size-label');\n    var cells = makeCells(sizeLabelId, numRows, numColumns);\n    var memLabel = record({\n      dom: {\n        tag: 'span',\n        classes: ['tox-insert-table-picker__label'],\n        attributes: {\n          id: sizeLabelId\n        }\n      },\n      components: [text('0x0')],\n      behaviours: derive$1([Replacing.config({})])\n    });\n    return {\n      type: 'widget',\n      data: {\n        value: generate$1('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$2.widget({\n        dom: {\n          tag: 'div',\n          classes: ['tox-insert-table-picker']\n        },\n        components: makeComponents(cells).concat(memLabel.asSpec()),\n        behaviours: derive$1([config('insert-table-picker', [runWithTarget(cellOverEvent, function (c, t, e) {\n          var row = e.event.row;\n          var col = e.event.col;\n          selectCells(cells, row, col, numRows, numColumns);\n          Replacing.set(memLabel.get(c), [makeLabelText(row, col)]);\n        }), runWithTarget(cellExecuteEvent, function (c, _, e) {\n          spec.onAction({\n            numRows: e.event.row + 1,\n            numColumns: e.event.col + 1\n          });\n          emit(c, sandboxClose());\n        })]), Keying.config({\n          initSize: {\n            numRows: numRows,\n            numColumns: numColumns\n          },\n          mode: 'flatgrid',\n          selector: '[role=\"button\"]'\n        })])\n      })]\n    };\n  };\n\n  var fancyMenuItems = {\n    inserttable: renderInsertTableMenuItem,\n    colorswatch: renderColorSwatchItem\n  };\n\n  var valueOpt = function (obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key) ? Optional.some(obj[key]) : Optional.none();\n  };\n\n  var renderFancyMenuItem = function (spec, backstage) {\n    return valueOpt(fancyMenuItems, spec.fancytype).map(function (render) {\n      return render(spec, backstage);\n    });\n  };\n\n  var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    if (downwardsCaret === void 0) {\n      downwardsCaret = false;\n    }\n\n    var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.some(caret),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: noop,\n      onSetup: spec.onSetup,\n      triggersSubmenu: true,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.none(),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderSeparatorItem = function (spec) {\n    var innerHtml = spec.text.fold(function () {\n      return {};\n    }, function (text) {\n      return {\n        innerHtml: text\n      };\n    });\n    return {\n      type: 'separator',\n      dom: __assign({\n        tag: 'div',\n        classes: [selectableClass, groupHeadingClass]\n      }, innerHtml),\n      components: []\n    };\n  };\n\n  var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n      caret: Optional.none(),\n      shortcutContent: spec.shortcut,\n      presets: 'normal',\n      meta: spec.meta\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var autocomplete = renderAutocompleteItem;\n  var separator = renderSeparatorItem;\n  var normal = renderNormalItem;\n  var nested = renderNestedItem;\n  var toggle$1 = renderToggleMenuItem;\n  var fancy = renderFancyMenuItem;\n  var FocusMode;\n\n  (function (FocusMode) {\n    FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n    FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n  })(FocusMode || (FocusMode = {}));\n\n  var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n    var providersBackstage = backstage.shared.providers;\n\n    var parseForHorizontalMenu = function (menuitem) {\n      return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n        shortcut: Optional.none(),\n        icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n      });\n    };\n\n    switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator(d));\n        });\n\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n\n      default:\n        {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n    }\n  };\n\n  var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage) {\n    var renderText = columns === 1;\n    var renderIcons = !renderText || menuHasIcons(items);\n    return cat(map(items, function (item) {\n      if (item.type === 'separator') {\n        return createSeparatorItem(item).fold(handleError, function (d) {\n          return Optional.some(separator(d));\n        });\n      } else {\n        return createAutocompleterItem(item).fold(handleError, function (d) {\n          return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n        });\n      }\n    }));\n  };\n\n  var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n    var hasIcons = menuHasIcons(items);\n    var alloyItems = cat(map(items, function (item) {\n      var itemHasIcon = function (i) {\n        return isHorizontalMenu ? !i.hasOwnProperty('text') : hasIcons;\n      };\n\n      var createItem = function (i) {\n        return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n      };\n\n      if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n        return createItem(__assign(__assign({}, item), {\n          disabled: true\n        }));\n      } else {\n        return createItem(item);\n      }\n    }));\n    var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n    return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n  };\n\n  var createTieredDataFrom = function (partialMenu) {\n    return tieredMenu.singleData(partialMenu.value, partialMenu);\n  };\n\n  var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n    var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom();\n    var movement = deriveMenuMovement(columns, presets);\n    var menuMarkers = markers$1(presets);\n    return {\n      dom: partialMenu.dom,\n      components: partialMenu.components,\n      items: partialMenu.items,\n      value: partialMenu.value,\n      markers: {\n        selectedItem: menuMarkers.selectedItem,\n        item: menuMarkers.item\n      },\n      movement: movement,\n      fakeFocus: focusMode === FocusMode.ContentFocus,\n      focusManager: focusManager,\n      menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n        detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n          var numColumns = _a.numColumns,\n              numRows = _a.numRows;\n          Keying.setGridSize(comp, numRows, numColumns);\n        });\n      })])\n    };\n  };\n\n  var register$2 = function (editor, sharedBackstage) {\n    var activeAutocompleter = Cell(Optional.none());\n    var processingAction = Cell(false);\n    var autocompleter = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-autocompleter']\n      },\n      components: [],\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissAutocompleter', [run(dismissRequested(), function () {\n        return cancelIfNecessary();\n      })])]),\n      lazySink: sharedBackstage.getSink\n    }));\n\n    var isMenuOpen = function () {\n      return InlineView.isOpen(autocompleter);\n    };\n\n    var isActive = function () {\n      return activeAutocompleter.get().isSome();\n    };\n\n    var hideIfNecessary = function () {\n      if (isActive()) {\n        InlineView.hide(autocompleter);\n      }\n    };\n\n    var cancelIfNecessary = function () {\n      if (isActive()) {\n        var lastElement = activeAutocompleter.get().map(function (ac) {\n          return ac.element;\n        });\n        detect$4(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n        hideIfNecessary();\n        activeAutocompleter.set(Optional.none());\n        processingAction.set(false);\n      }\n    };\n\n    var getAutocompleters = cached(function () {\n      return register(editor);\n    });\n\n    var getCombinedItems = function (triggerChar, matches) {\n      var columns = findMap(matches, function (m) {\n        return Optional.from(m.columns);\n      }).getOr(1);\n      return bind(matches, function (match) {\n        var choices = match.items;\n        return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n          var nr = editor.selection.getRng();\n          getContext(editor.dom, nr, triggerChar).fold(function () {\n            return console.error('Lost context. Cursor probably moved');\n          }, function (_a) {\n            var range = _a.range;\n            var autocompleterApi = {\n              hide: function () {\n                cancelIfNecessary();\n              },\n              reload: function (fetchOptions) {\n                hideIfNecessary();\n                load(fetchOptions);\n              }\n            };\n            processingAction.set(true);\n            match.onAction(autocompleterApi, range, itemValue, itemMeta);\n            processingAction.set(false);\n          });\n        }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage);\n      });\n    };\n\n    var commenceIfNecessary = function (context) {\n      if (!isActive()) {\n        var wrapper = create$4(editor, context.range);\n        activeAutocompleter.set(Optional.some({\n          triggerChar: context.triggerChar,\n          element: wrapper,\n          matchLength: context.text.length\n        }));\n        processingAction.set(false);\n      }\n    };\n\n    var display = function (ac, context, lookupData, items) {\n      ac.matchLength = context.text.length;\n      var columns = findMap(lookupData, function (ld) {\n        return Optional.from(ld.columns);\n      }).getOr(1);\n      InlineView.showAt(autocompleter, {\n        anchor: 'node',\n        root: SugarElement.fromDom(editor.getBody()),\n        node: Optional.from(ac.element)\n      }, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')));\n      InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n    };\n\n    var doLookup = function (fetchOptions) {\n      return activeAutocompleter.get().map(function (ac) {\n        return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n          return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n        });\n      }).getOrThunk(function () {\n        return lookup(editor, getAutocompleters);\n      });\n    };\n\n    var load = function (fetchOptions) {\n      doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n        commenceIfNecessary(lookupInfo.context);\n        lookupInfo.lookupData.then(function (lookupData) {\n          activeAutocompleter.get().map(function (ac) {\n            var context = lookupInfo.context;\n\n            if (ac.triggerChar === context.triggerChar) {\n              var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n\n              if (combinedItems.length > 0) {\n                display(ac, context, lookupData, combinedItems);\n              } else if (context.text.length - ac.matchLength >= 10) {\n                cancelIfNecessary();\n              } else {\n                hideIfNecessary();\n              }\n            }\n          });\n        });\n      });\n    };\n\n    var onKeypress = last$2(function (e) {\n      if (e.which === 27) {\n        return;\n      }\n\n      load();\n    }, 50);\n    var autocompleterUiApi = {\n      onKeypress: onKeypress,\n      cancelIfNecessary: cancelIfNecessary,\n      isMenuOpen: isMenuOpen,\n      isActive: isActive,\n      isProcessingAction: processingAction.get,\n      getView: function () {\n        return InlineView.getContent(autocompleter);\n      }\n    };\n    AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n  };\n\n  var Autocompleter = {\n    register: register$2\n  };\n  var filter$2 = always;\n\n  var bind$3 = function (element, event, handler) {\n    return bind$2(element, event, filter$2, handler);\n  };\n\n  var capture$1 = function (element, event, handler) {\n    return capture(element, event, filter$2, handler);\n  };\n\n  var fromRawEvent$1 = fromRawEvent;\n\n  var closest$4 = function (scope, selector, isRoot) {\n    return closest$3(scope, selector, isRoot).isSome();\n  };\n\n  function DelayedFunction(fun, delay) {\n    var ref = null;\n\n    var schedule = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      ref = setTimeout(function () {\n        fun.apply(null, args);\n        ref = null;\n      }, delay);\n    };\n\n    var cancel = function () {\n      if (ref !== null) {\n        clearTimeout(ref);\n        ref = null;\n      }\n    };\n\n    return {\n      cancel: cancel,\n      schedule: schedule\n    };\n  }\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    var raw = event.raw;\n\n    if (raw.touches === undefined || raw.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(raw.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var monitor = function (settings) {\n    var startData = Cell(Optional.none());\n    var longpressFired = Cell(false);\n    var longpress$1 = DelayedFunction(function (event) {\n      settings.triggerEvent(longpress(), event);\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n\n    var handleTouchstart = function (event) {\n      getTouch(event).each(function (touch) {\n        longpress$1.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: event.target\n        };\n        longpress$1.schedule(event);\n        longpressFired.set(false);\n        startData.set(Optional.some(data));\n      });\n      return Optional.none();\n    };\n\n    var handleTouchmove = function (event) {\n      longpress$1.cancel();\n      getTouch(event).each(function (touch) {\n        startData.get().each(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.set(Optional.none());\n          }\n        });\n      });\n      return Optional.none();\n    };\n\n    var handleTouchend = function (event) {\n      longpress$1.cancel();\n\n      var isSame = function (data) {\n        return eq$1(data.target, event.target);\n      };\n\n      return startData.get().filter(isSame).map(function (_data) {\n        if (longpressFired.get()) {\n          event.prevent();\n          return false;\n        } else {\n          return settings.triggerEvent(tap(), event);\n        }\n      });\n    };\n\n    var handlers = wrapAll$1([{\n      key: touchstart(),\n      value: handleTouchstart\n    }, {\n      key: touchmove(),\n      value: handleTouchmove\n    }, {\n      key: touchend(),\n      value: handleTouchend\n    }]);\n\n    var fireIfReady = function (event, type) {\n      return get(handlers, type).bind(function (handler) {\n        return handler(event);\n      });\n    };\n\n    return {\n      fireIfReady: fireIfReady\n    };\n  };\n\n  var isDangerous = function (event) {\n    var keyEv = event.raw;\n    return keyEv.which === BACKSPACE[0] && !contains(['input', 'textarea'], name(event.target)) && !closest$4(event.target, '[contenteditable=\"true\"]');\n  };\n\n  var isFirefox = function () {\n    return detect$3().browser.isFirefox();\n  };\n\n  var settingsSchema = objOfOnly([strictFunction('triggerEvent'), defaulted$1('stopBackspace', true)]);\n\n  var bindFocus = function (container, handler) {\n    if (isFirefox()) {\n      return capture$1(container, 'focus', handler);\n    } else {\n      return bind$3(container, 'focusin', handler);\n    }\n  };\n\n  var bindBlur = function (container, handler) {\n    if (isFirefox()) {\n      return capture$1(container, 'blur', handler);\n    } else {\n      return bind$3(container, 'focusout', handler);\n    }\n  };\n\n  var setup$1 = function (container, rawSettings) {\n    var settings = asRawOrDie('Getting GUI events settings', settingsSchema, rawSettings);\n    var pointerEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel', 'gesturestart', 'mousedown', 'mouseup', 'mouseover', 'mousemove', 'mouseout', 'click'];\n    var tapEvent = monitor(settings);\n    var simpleEvents = map(pointerEvents.concat(['selectstart', 'input', 'contextmenu', 'change', 'transitionend', 'drag', 'dragstart', 'dragend', 'dragenter', 'dragleave', 'dragover', 'drop', 'keyup']), function (type) {\n      return bind$3(container, type, function (event) {\n        tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent(type, event);\n\n        if (stopped) {\n          event.kill();\n        }\n      });\n    });\n    var pasteTimeout = Cell(Optional.none());\n    var onPaste = bind$3(container, 'paste', function (event) {\n      tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n        if (tapStopped) {\n          event.kill();\n        }\n      });\n      var stopped = settings.triggerEvent('paste', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      pasteTimeout.set(Optional.some(setTimeout(function () {\n        settings.triggerEvent(postPaste(), event);\n      }, 0)));\n    });\n    var onKeydown = bind$3(container, 'keydown', function (event) {\n      var stopped = settings.triggerEvent('keydown', event);\n\n      if (stopped) {\n        event.kill();\n      } else if (settings.stopBackspace === true && isDangerous(event)) {\n        event.prevent();\n      }\n    });\n    var onFocusIn = bindFocus(container, function (event) {\n      var stopped = settings.triggerEvent('focusin', event);\n\n      if (stopped) {\n        event.kill();\n      }\n    });\n    var focusoutTimeout = Cell(Optional.none());\n    var onFocusOut = bindBlur(container, function (event) {\n      var stopped = settings.triggerEvent('focusout', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      focusoutTimeout.set(Optional.some(setTimeout(function () {\n        settings.triggerEvent(postBlur(), event);\n      }, 0)));\n    });\n\n    var unbind = function () {\n      each(simpleEvents, function (e) {\n        e.unbind();\n      });\n      onKeydown.unbind();\n      onFocusIn.unbind();\n      onFocusOut.unbind();\n      onPaste.unbind();\n      pasteTimeout.get().each(clearTimeout);\n      focusoutTimeout.get().each(clearTimeout);\n    };\n\n    return {\n      unbind: unbind\n    };\n  };\n\n  var derive$2 = function (rawEvent, rawTarget) {\n    var source = get(rawEvent, 'target').getOr(rawTarget);\n    return Cell(source);\n  };\n\n  var fromSource = function (event, source) {\n    var stopper = Cell(false);\n    var cutter = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    var cut = function () {\n      cutter.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: cut,\n      isStopped: stopper.get,\n      isCut: cutter.get,\n      event: event,\n      setSource: source.set,\n      getSource: source.get\n    };\n  };\n\n  var fromExternal = function (event) {\n    var stopper = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: noop,\n      isStopped: stopper.get,\n      isCut: never,\n      event: event,\n      setSource: die('Cannot set source of a broadcasted event'),\n      getSource: die('Cannot get source of a broadcasted event')\n    };\n  };\n\n  var adt$b = Adt.generate([{\n    stopped: []\n  }, {\n    resume: ['element']\n  }, {\n    complete: []\n  }]);\n\n  var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n    var handler = lookup(eventType, target);\n    var simulatedEvent = fromSource(rawEvent, source);\n    return handler.fold(function () {\n      logger.logEventNoHandlers(eventType, target);\n      return adt$b.complete();\n    }, function (handlerInfo) {\n      var descHandler = handlerInfo.descHandler;\n      var eventHandler = getCurried(descHandler);\n      eventHandler(simulatedEvent);\n\n      if (simulatedEvent.isStopped()) {\n        logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$b.stopped();\n      } else if (simulatedEvent.isCut()) {\n        logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$b.complete();\n      } else {\n        return parent(handlerInfo.element).fold(function () {\n          logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.complete();\n        }, function (parent) {\n          logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.resume(parent);\n        });\n      }\n    });\n  };\n\n  var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n    return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(function () {\n      return true;\n    }, function (parent) {\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n    }, function () {\n      return false;\n    });\n  };\n\n  var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n    var source = derive$2(rawEvent, target);\n    return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n  };\n\n  var broadcast = function (listeners, rawEvent, _logger) {\n    var simulatedEvent = fromExternal(rawEvent);\n    each(listeners, function (listener) {\n      var descHandler = listener.descHandler;\n      var handler = getCurried(descHandler);\n      handler(simulatedEvent);\n    });\n    return simulatedEvent.isStopped();\n  };\n\n  var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n    return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n  };\n\n  var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n    var source = derive$2(rawEvent, rawTarget);\n    return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n  };\n\n  var eventHandler = function (element, descHandler) {\n    return {\n      element: element,\n      descHandler: descHandler\n    };\n  };\n\n  var broadcastHandler = function (id, handler) {\n    return {\n      id: id,\n      descHandler: handler\n    };\n  };\n\n  function EventRegistry() {\n    var registry = {};\n\n    var registerId = function (extraArgs, id, events) {\n      each$1(events, function (v, k) {\n        var handlers = registry[k] !== undefined ? registry[k] : {};\n        handlers[id] = curryArgs(v, extraArgs);\n        registry[k] = handlers;\n      });\n    };\n\n    var findHandler = function (handlers, elem) {\n      return read$1(elem).fold(function () {\n        return Optional.none();\n      }, function (id) {\n        return handlers.bind(function (h) {\n          return get(h, id);\n        }).map(function (descHandler) {\n          return eventHandler(elem, descHandler);\n        });\n      });\n    };\n\n    var filterByType = function (type) {\n      return get(registry, type).map(function (handlers) {\n        return mapToArray(handlers, function (f, id) {\n          return broadcastHandler(id, f);\n        });\n      }).getOr([]);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      var handlers = get(registry, type);\n      return closest(target, function (elem) {\n        return findHandler(handlers, elem);\n      }, isAboveRoot);\n    };\n\n    var unregisterId = function (id) {\n      each$1(registry, function (handlersById, _eventName) {\n        if (handlersById.hasOwnProperty(id)) {\n          delete handlersById[id];\n        }\n      });\n    };\n\n    return {\n      registerId: registerId,\n      unregisterId: unregisterId,\n      filterByType: filterByType,\n      find: find\n    };\n  }\n\n  function Registry() {\n    var events = EventRegistry();\n    var components = {};\n\n    var readOrTag = function (component) {\n      var elem = component.element;\n      return read$1(elem).fold(function () {\n        return write('uid-', component.element);\n      }, function (uid) {\n        return uid;\n      });\n    };\n\n    var failOnDuplicate = function (component, tagId) {\n      var conflict = components[tagId];\n\n      if (conflict === component) {\n        unregister(component);\n      } else {\n        throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n      }\n    };\n\n    var register = function (component) {\n      var tagId = readOrTag(component);\n\n      if (hasNonNullableKey(components, tagId)) {\n        failOnDuplicate(component, tagId);\n      }\n\n      var extraArgs = [component];\n      events.registerId(extraArgs, tagId, component.events);\n      components[tagId] = component;\n    };\n\n    var unregister = function (component) {\n      read$1(component.element).each(function (tagId) {\n        delete components[tagId];\n        events.unregisterId(tagId);\n      });\n    };\n\n    var filter = function (type) {\n      return events.filterByType(type);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      return events.find(isAboveRoot, type, target);\n    };\n\n    var getById = function (id) {\n      return get(components, id);\n    };\n\n    return {\n      find: find,\n      filter: filter,\n      register: register,\n      unregister: unregister,\n      getById: getById\n    };\n  }\n\n  var factory$3 = function (detail) {\n    var _a = detail.dom,\n        attributes = _a.attributes,\n        domWithoutAttributes = __rest(_a, ['attributes']);\n\n    return {\n      uid: detail.uid,\n      dom: __assign({\n        tag: 'div',\n        attributes: __assign({\n          role: 'presentation'\n        }, attributes)\n      }, domWithoutAttributes),\n      components: detail.components,\n      behaviours: get$c(detail.containerBehaviours),\n      events: detail.events,\n      domModification: detail.domModification,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Container = single$2({\n    name: 'Container',\n    factory: factory$3,\n    configFields: [defaulted$1('components', []), field$1('containerBehaviours', []), defaulted$1('events', {}), defaulted$1('domModification', {}), defaulted$1('eventOrder', {})]\n  });\n\n  var takeover = function (root) {\n    var isAboveRoot = function (el) {\n      return parent(root.element).fold(function () {\n        return true;\n      }, function (parent) {\n        return eq$1(el, parent);\n      });\n    };\n\n    var registry = Registry();\n\n    var lookup = function (eventName, target) {\n      return registry.find(isAboveRoot, eventName, target);\n    };\n\n    var domEvents = setup$1(root.element, {\n      triggerEvent: function (eventName, event) {\n        return monitorEvent(eventName, event.target, function (logger) {\n          return triggerUntilStopped(lookup, eventName, event, logger);\n        });\n      }\n    });\n    var systemApi = {\n      debugInfo: constant('real'),\n      triggerEvent: function (eventName, target, data) {\n        monitorEvent(eventName, target, function (logger) {\n          return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n        });\n      },\n      triggerFocus: function (target, originator) {\n        read$1(target).fold(function () {\n          focus$1(target);\n        }, function (_alloyId) {\n          monitorEvent(focus(), target, function (logger) {\n            triggerHandler(lookup, focus(), {\n              originator: originator,\n              kill: noop,\n              prevent: noop,\n              target: target\n            }, target, logger);\n            return false;\n          });\n        });\n      },\n      triggerEscape: function (comp, simulatedEvent) {\n        systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n      },\n      getByUid: function (uid) {\n        return getByUid(uid);\n      },\n      getByDom: function (elem) {\n        return getByDom(elem);\n      },\n      build: build$1,\n      addToGui: function (c) {\n        add(c);\n      },\n      removeFromGui: function (c) {\n        remove$1(c);\n      },\n      addToWorld: function (c) {\n        addToWorld(c);\n      },\n      removeFromWorld: function (c) {\n        removeFromWorld(c);\n      },\n      broadcast: function (message) {\n        broadcast$1(message);\n      },\n      broadcastOn: function (channels, message) {\n        broadcastOn(channels, message);\n      },\n      broadcastEvent: function (eventName, event) {\n        broadcastEvent(eventName, event);\n      },\n      isConnected: always\n    };\n\n    var addToWorld = function (component) {\n      component.connect(systemApi);\n\n      if (!isText(component.element)) {\n        registry.register(component);\n        each(component.components(), addToWorld);\n        systemApi.triggerEvent(systemInit(), component.element, {\n          target: component.element\n        });\n      }\n    };\n\n    var removeFromWorld = function (component) {\n      if (!isText(component.element)) {\n        each(component.components(), removeFromWorld);\n        registry.unregister(component);\n      }\n\n      component.disconnect();\n    };\n\n    var add = function (component) {\n      attach$1(root, component);\n    };\n\n    var remove$1 = function (component) {\n      detach(component);\n    };\n\n    var destroy = function () {\n      domEvents.unbind();\n      remove(root.element);\n    };\n\n    var broadcastData = function (data) {\n      var receivers = registry.filter(receive());\n      each(receivers, function (receiver) {\n        var descHandler = receiver.descHandler;\n        var handler = getCurried(descHandler);\n        handler(data);\n      });\n    };\n\n    var broadcast$1 = function (message) {\n      broadcastData({\n        universal: true,\n        data: message\n      });\n    };\n\n    var broadcastOn = function (channels, message) {\n      broadcastData({\n        universal: false,\n        channels: channels,\n        data: message\n      });\n    };\n\n    var broadcastEvent = function (eventName, event) {\n      var listeners = registry.filter(eventName);\n      return broadcast(listeners, event);\n    };\n\n    var getByUid = function (uid) {\n      return registry.getById(uid).fold(function () {\n        return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n      }, Result.value);\n    };\n\n    var getByDom = function (elem) {\n      var uid = read$1(elem).getOr('not found');\n      return getByUid(uid);\n    };\n\n    addToWorld(root);\n    return {\n      root: root,\n      element: root.element,\n      destroy: destroy,\n      add: add,\n      remove: remove$1,\n      getByUid: getByUid,\n      getByDom: getByDom,\n      addToWorld: addToWorld,\n      removeFromWorld: removeFromWorld,\n      broadcast: broadcast$1,\n      broadcastOn: broadcastOn,\n      broadcastEvent: broadcastEvent\n    };\n  };\n\n  var renderBar = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-bar', 'tox-form__controls-h-stack']\n      },\n      components: map(spec.items, backstage.interpreter)\n    };\n  };\n\n  var schema$e = constant([defaulted$1('prefix', 'form-field'), field$1('fieldBehaviours', [Composing, Representing])]);\n  var parts$3 = constant([optional({\n    schema: [strict$1('dom')],\n    name: 'label'\n  }), optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [strict$1('text')],\n    name: 'aria-descriptor'\n  }), required({\n    factory: {\n      sketch: function (spec) {\n        var excludeFactory = exclude$1(spec, ['factory']);\n        return spec.factory.sketch(excludeFactory);\n      }\n    },\n    schema: [strict$1('factory')],\n    name: 'field'\n  })]);\n\n  var factory$4 = function (detail, components, _spec, _externals) {\n    var behaviours = augment(detail.fieldBehaviours, [Composing.config({\n      find: function (container) {\n        return getPart(container, detail, 'field');\n      }\n    }), Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (field) {\n          return Composing.getCurrent(field).bind(Representing.getValue);\n        },\n        setValue: function (field, value) {\n          Composing.getCurrent(field).each(function (current) {\n            Representing.setValue(current, value);\n          });\n        }\n      }\n    })]);\n    var events = derive([runOnAttached(function (component, _simulatedEvent) {\n      var ps = getParts(component, detail, ['label', 'field', 'aria-descriptor']);\n      ps.field().each(function (field) {\n        var id = generate$1(detail.prefix);\n        ps.label().each(function (label) {\n          set$1(label.element, 'for', id);\n          set$1(field.element, 'id', id);\n        });\n        ps['aria-descriptor']().each(function (descriptor) {\n          var descriptorId = generate$1(detail.prefix);\n          set$1(descriptor.element, 'id', descriptorId);\n          set$1(field.element, 'aria-describedby', descriptorId);\n        });\n      });\n    })]);\n    var apis = {\n      getField: function (container) {\n        return getPart(container, detail, 'field');\n      },\n      getLabel: function (container) {\n        return getPart(container, detail, 'label');\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: behaviours,\n      events: events,\n      apis: apis\n    };\n  };\n\n  var FormField = composite$1({\n    name: 'FormField',\n    configFields: schema$e(),\n    partFields: parts$3(),\n    factory: factory$4,\n    apis: {\n      getField: function (apis, comp) {\n        return apis.getField(comp);\n      },\n      getLabel: function (apis, comp) {\n        return apis.getLabel(comp);\n      }\n    }\n  });\n\n  var exhibit$4 = function (base, tabConfig) {\n    return nu$6({\n      attributes: wrapAll$1([{\n        key: tabConfig.tabAttr,\n        value: 'true'\n      }])\n    });\n  };\n\n  var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$4\n  });\n  var TabstopSchema = [defaulted$1('tabAttr', 'data-alloy-tabstop')];\n  var Tabstopping = create$1({\n    fields: TabstopSchema,\n    name: 'tabstopping',\n    active: ActiveTabstopping\n  });\n\n  var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n    return FormField.sketch(spec);\n  };\n\n  var renderFormField = function (pLabel, pField) {\n    return renderFormFieldWith(pLabel, pField, [], []);\n  };\n\n  var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    return {\n      dom: renderFormFieldDomWith(extraClasses),\n      components: pLabel.toArray().concat([pField]),\n      fieldBehaviours: derive$1(extraBehaviours)\n    };\n  };\n\n  var renderFormFieldDom = function () {\n    return renderFormFieldDomWith([]);\n  };\n\n  var renderFormFieldDomWith = function (extraClasses) {\n    return {\n      tag: 'div',\n      classes: ['tox-form__group'].concat(extraClasses)\n    };\n  };\n\n  var renderLabel = function (label, providersBackstage) {\n    return FormField.parts.label({\n      dom: {\n        tag: 'label',\n        classes: ['tox-label'],\n        innerHtml: providersBackstage.translate(label)\n      }\n    });\n  };\n\n  var formChangeEvent = generate$1('form-component-change');\n  var formCloseEvent = generate$1('form-close');\n  var formCancelEvent = generate$1('form-cancel');\n  var formActionEvent = generate$1('form-action');\n  var formSubmitEvent = generate$1('form-submit');\n  var formBlockEvent = generate$1('form-block');\n  var formUnblockEvent = generate$1('form-unblock');\n  var formTabChangeEvent = generate$1('form-tabchange');\n  var formResizeEvent = generate$1('form-resize');\n\n  var renderCollection = function (spec, providersBackstage) {\n    var _a;\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var runOnItem = function (f) {\n      return function (comp, se) {\n        closest$3(se.event.target, '[data-collection-item-value]').each(function (target) {\n          f(comp, se, target, get$2(target, 'data-collection-item-value'));\n        });\n      };\n    };\n\n    var escapeAttribute = function (ch) {\n      if (ch === '\"') {\n        return '&quot;';\n      }\n\n      return ch;\n    };\n\n    var setContents = function (comp, items) {\n      var htmlLines = map(items, function (item) {\n        var itemText = global$6.translate(item.text);\n        var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n        var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n        var mapItemName = {\n          '_': ' ',\n          ' - ': ' ',\n          '-': ' '\n        };\n        var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n          return mapItemName[match];\n        });\n        var readonlyClass = providersBackstage.isReadOnly() ? ' tox-collection__item--state-disabled' : '';\n        return '<div class=\"tox-collection__item' + readonlyClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + escapeAttribute(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n      });\n      var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk(htmlLines, spec.columns) : [htmlLines];\n      var html = map(chunks, function (ch) {\n        return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n      });\n      set(comp.element, html.join(''));\n    };\n\n    var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n      se.stop();\n\n      if (!providersBackstage.isReadOnly()) {\n        emitWith(comp, formActionEvent, {\n          name: spec.name,\n          value: itemValue\n        });\n      }\n    });\n    var collectionEvents = [run(mouseover(), runOnItem(function (comp, se, tgt) {\n      focus$1(tgt);\n    })), run(click(), onClick), run(tap(), onClick), run(focusin(), runOnItem(function (comp, se, tgt) {\n      descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$4(currentActive, activeClass);\n      });\n      add$2(tgt, activeClass);\n    })), run(focusout(), runOnItem(function (comp) {\n      descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$4(currentActive, activeClass);\n      });\n    })), runOnExecute(runOnItem(function (comp, se, tgt, itemValue) {\n      emitWith(comp, formActionEvent, {\n        name: spec.name,\n        value: itemValue\n      });\n    }))];\n\n    var iterCollectionItems = function (comp, applyAttributes) {\n      return map(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n    };\n\n    var pField = FormField.parts.field({\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n      },\n      components: [],\n      factory: {\n        sketch: identity\n      },\n      behaviours: derive$1([Disabling.config({\n        disabled: providersBackstage.isReadOnly,\n        onDisabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            add$2(childElm, 'tox-collection__item--state-disabled');\n            set$1(childElm, 'aria-disabled', true);\n          });\n        },\n        onEnabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            remove$4(childElm, 'tox-collection__item--state-disabled');\n            remove$1(childElm, 'aria-disabled');\n          });\n        }\n      }), receivingConfig(), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: []\n        },\n        onSetValue: function (comp, items) {\n          setContents(comp, items);\n\n          if (spec.columns === 'auto') {\n            detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n              var numRows = _a.numRows,\n                  numColumns = _a.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          }\n\n          emit(comp, formResizeEvent);\n        }\n      }), Tabstopping.config({}), Keying.config(deriveCollectionMovement(spec.columns, 'normal')), config('collection-events', collectionEvents)]),\n      eventOrder: (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'collection-events'], _a)\n    });\n    var extraClasses = ['tox-form__group--collection'];\n    return renderFormFieldWith(pLabel, pField, extraClasses, []);\n  };\n\n  var schema$f = constant([option('data'), defaulted$1('inputAttributes', {}), defaulted$1('inputStyles', {}), defaulted$1('tag', 'input'), defaulted$1('inputClasses', []), onHandler('onSetValue'), defaulted$1('styles', {}), defaulted$1('eventOrder', {}), field$1('inputBehaviours', [Representing, Focusing]), defaulted$1('selectOnFocus', true)]);\n\n  var focusBehaviours = function (detail) {\n    return derive$1([Focusing.config({\n      onFocus: !detail.selectOnFocus ? noop : function (component) {\n        var input = component.element;\n        var value = get$5(input);\n        input.dom.setSelectionRange(0, value.length);\n      }\n    })]);\n  };\n\n  var behaviours = function (detail) {\n    return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n      store: __assign(__assign({\n        mode: 'manual'\n      }, detail.data.map(function (data) {\n        return {\n          initialValue: data\n        };\n      }).getOr({})), {\n        getValue: function (input) {\n          return get$5(input.element);\n        },\n        setValue: function (input, data) {\n          var current = get$5(input.element);\n\n          if (current !== data) {\n            set$3(input.element, data);\n          }\n        }\n      }),\n      onSetValue: detail.onSetValue\n    })]));\n  };\n\n  var dom$2 = function (detail) {\n    return {\n      tag: detail.tag,\n      attributes: __assign({\n        type: 'text'\n      }, detail.inputAttributes),\n      styles: detail.inputStyles,\n      classes: detail.inputClasses\n    };\n  };\n\n  var factory$5 = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: dom$2(detail),\n      components: [],\n      behaviours: behaviours(detail),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Input = single$2({\n    name: 'Input',\n    configFields: schema$f(),\n    factory: factory$5\n  });\n  var exports$1 = {},\n      module = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module, undefined);\n\n  var Promise = module.exports.boltExport;\n\n  var nu$a = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$a(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function (a) {\n    return nu$a(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$a,\n    pure: pure\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make$3 = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make$3(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make$3(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make$3(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make$3(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$b = function (baseFn) {\n    return make$3(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function (a) {\n    return make$3(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$b,\n    pure: pure$1\n  };\n  var ariaElements = ['input', 'textarea'];\n\n  var isAriaElement = function (elem) {\n    var name$1 = name(elem);\n    return contains(ariaElements, name$1);\n  };\n\n  var markValid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    remove$4(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$1(component.element, 'aria-invalid', false);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set(container, notifyInfo.validHtml);\n      });\n      notifyInfo.onValid(component);\n    });\n  };\n\n  var markInvalid = function (component, invalidConfig, invalidState, text) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    add$2(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$1(component.element, 'aria-invalid', true);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set(container, text);\n      });\n      notifyInfo.onInvalid(component, text);\n    });\n  };\n\n  var query = function (component, invalidConfig, _invalidState) {\n    return invalidConfig.validator.fold(function () {\n      return Future.pure(Result.value(true));\n    }, function (validatorInfo) {\n      return validatorInfo.validate(component);\n    });\n  };\n\n  var run$1 = function (component, invalidConfig, invalidState) {\n    invalidConfig.notify.each(function (notifyInfo) {\n      notifyInfo.onValidate(component);\n    });\n    return query(component, invalidConfig).map(function (valid) {\n      if (component.getSystem().isConnected()) {\n        return valid.fold(function (err) {\n          markInvalid(component, invalidConfig, invalidState, err);\n          return Result.error(err);\n        }, function (v) {\n          markValid(component, invalidConfig);\n          return Result.value(v);\n        });\n      } else {\n        return Result.error('No longer in system');\n      }\n    });\n  };\n\n  var isInvalid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    return has$2(elem, invalidConfig.invalidClass);\n  };\n\n  var InvalidateApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    markValid: markValid,\n    markInvalid: markInvalid,\n    query: query,\n    run: run$1,\n    isInvalid: isInvalid\n  });\n\n  var events$a = function (invalidConfig, invalidState) {\n    return invalidConfig.validator.map(function (validatorInfo) {\n      return derive([run(validatorInfo.onEvent, function (component) {\n        run$1(component, invalidConfig, invalidState).get(identity);\n      })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n        run$1(component, invalidConfig, invalidState).get(noop);\n      })] : []));\n    }).getOr({});\n  };\n\n  var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$a\n  });\n  var InvalidateSchema = [strict$1('invalidClass'), defaulted$1('getRoot', Optional.none), optionObjOf('notify', [defaulted$1('aria', 'alert'), defaulted$1('getContainer', Optional.none), defaulted$1('validHtml', ''), onHandler('onValid'), onHandler('onInvalid'), onHandler('onValidate')]), optionObjOf('validator', [strict$1('validate'), defaulted$1('onEvent', 'input'), defaulted$1('validateOnLoad', true)])];\n  var Invalidating = create$1({\n    fields: InvalidateSchema,\n    name: 'invalidating',\n    active: ActiveInvalidate,\n    apis: InvalidateApis,\n    extra: {\n      validation: function (validator) {\n        return function (component) {\n          var v = Representing.getValue(component);\n          return Future.pure(validator(v));\n        };\n      }\n    }\n  });\n\n  var getCoupled = function (component, coupleConfig, coupleState, name) {\n    return coupleState.getOrCreate(component, coupleConfig, name);\n  };\n\n  var CouplingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCoupled: getCoupled\n  });\n  var CouplingSchema = [strictOf('others', setOf$1(Result.value, anyValue$1()))];\n\n  var init$5 = function () {\n    var coupled = {};\n\n    var getOrCreate = function (component, coupleConfig, name) {\n      var available = keys(coupleConfig.others);\n\n      if (!available) {\n        throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n      } else {\n        return get(coupled, name).getOrThunk(function () {\n          var builder = get(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n          var spec = builder(component);\n          var built = component.getSystem().build(spec);\n          coupled[name] = built;\n          return built;\n        });\n      }\n    };\n\n    var readState = constant({});\n    return nu$5({\n      readState: readState,\n      getOrCreate: getOrCreate\n    });\n  };\n\n  var CouplingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$5\n  });\n  var Coupling = create$1({\n    fields: CouplingSchema,\n    name: 'coupling',\n    apis: CouplingApis,\n    state: CouplingState\n  });\n  var suffix = constant('sink');\n  var partType = constant(optional({\n    name: suffix(),\n    overrides: constant({\n      dom: {\n        tag: 'div'\n      },\n      behaviours: derive$1([Positioning.config({\n        useFixed: always\n      })]),\n      events: derive([cutter(keydown()), cutter(mousedown()), cutter(click())])\n    })\n  }));\n  var HighlightOnOpen;\n\n  (function (HighlightOnOpen) {\n    HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n    HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n  })(HighlightOnOpen || (HighlightOnOpen = {}));\n\n  var getAnchor = function (detail, component) {\n    var hotspot = detail.getHotspot(component).getOr(component);\n    var anchor = 'hotspot';\n    var overrides = detail.getAnchorOverrides();\n    return detail.layouts.fold(function () {\n      return {\n        anchor: anchor,\n        hotspot: hotspot,\n        overrides: overrides\n      };\n    }, function (layouts) {\n      return {\n        anchor: anchor,\n        hotspot: hotspot,\n        overrides: overrides,\n        layouts: layouts\n      };\n    });\n  };\n\n  var fetch = function (detail, mapFetch, component) {\n    var fetcher = detail.fetch;\n    return fetcher(component).map(mapFetch);\n  };\n\n  var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n    var futureData = fetch(detail, mapFetch, component);\n    var getLazySink = getSink(component, detail);\n    return futureData.map(function (tdata) {\n      return tdata.bind(function (data) {\n        return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n          uid: generate$2(''),\n          data: data,\n          highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n          onOpenMenu: function (tmenu, menu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, anchor, menu);\n            Sandboxing.decloak(sandbox);\n          },\n          onOpenSubmenu: function (tmenu, item, submenu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, {\n              anchor: 'submenu',\n              item: item\n            }, submenu);\n            Sandboxing.decloak(sandbox);\n          },\n          onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, anchor, primaryMenu);\n            each(submenuTriggers, function (st) {\n              Positioning.position(sink, {\n                anchor: 'submenu',\n                item: st.triggeringItem\n              }, st.triggeredMenu);\n            });\n          },\n          onEscape: function () {\n            Focusing.focus(component);\n            Sandboxing.close(sandbox);\n            return Optional.some(true);\n          }\n        })));\n      });\n    });\n  };\n\n  var open$1 = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n    var anchor = getAnchor(detail, hotspot);\n    var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n    return processed.map(function (tdata) {\n      tdata.fold(function () {\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n        }\n      }, function (data) {\n        Sandboxing.cloak(sandbox);\n        Sandboxing.open(sandbox, data);\n        onOpenSync(sandbox);\n      });\n      return sandbox;\n    });\n  };\n\n  var close$1 = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n    Sandboxing.close(sandbox);\n    return Future.pure(sandbox);\n  };\n\n  var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n    var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n    var showing = Sandboxing.isOpen(sandbox);\n    var action = showing ? close$1 : open$1;\n    return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n  };\n\n  var matchWidth = function (hotspot, container, useMinWidth) {\n    var menu = Composing.getCurrent(container).getOr(container);\n    var buttonWidth = get$7(hotspot.element);\n\n    if (useMinWidth) {\n      set$2(menu.element, 'min-width', buttonWidth + 'px');\n    } else {\n      set$4(menu.element, buttonWidth);\n    }\n  };\n\n  var getSink = function (anyInSystem, sinkDetail) {\n    return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n      return function () {\n        return Result.value(internalSink);\n      };\n    }).getOrThunk(function () {\n      return sinkDetail.lazySink.fold(function () {\n        return function () {\n          return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n        };\n      }, function (lazySinkFn) {\n        return function () {\n          return lazySinkFn(anyInSystem);\n        };\n      });\n    });\n  };\n\n  var doRepositionMenus = function (sandbox) {\n    Sandboxing.getState(sandbox).each(function (tmenu) {\n      tieredMenu.repositionMenus(tmenu);\n    });\n  };\n\n  var makeSandbox = function (detail, hotspot, extras) {\n    var ariaOwner = manager();\n\n    var onOpen = function (component, menu) {\n      var anchor = getAnchor(detail, hotspot);\n      ariaOwner.link(hotspot.element);\n\n      if (detail.matchWidth) {\n        matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n      }\n\n      detail.onOpen(anchor, component, menu);\n\n      if (extras !== undefined && extras.onOpen !== undefined) {\n        extras.onOpen(component, menu);\n      }\n    };\n\n    var onClose = function (component, menu) {\n      ariaOwner.unlink(hotspot.element);\n\n      if (extras !== undefined && extras.onClose !== undefined) {\n        extras.onClose(component, menu);\n      }\n    };\n\n    var lazySink = getSink(hotspot, detail);\n    return {\n      dom: {\n        tag: 'div',\n        classes: detail.sandboxClasses,\n        attributes: {\n          id: ariaOwner.id,\n          role: 'listbox'\n        }\n      },\n      behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: hotspot\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOf(hotspot, queryElem);\n        },\n        getAttachPoint: function () {\n          return lazySink().getOrDie();\n        }\n      }), Composing.config({\n        find: function (sandbox) {\n          return Sandboxing.getState(sandbox).bind(function (menu) {\n            return Composing.getCurrent(menu);\n          });\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel({\n          isExtraPart: never\n        })), receivingChannel$1({\n          doReposition: doRepositionMenus\n        }))\n      })])\n    };\n  };\n\n  var repositionMenus = function (comp) {\n    var sandbox = Coupling.getCoupled(comp, 'sandbox');\n    doRepositionMenus(sandbox);\n  };\n\n  var sandboxFields = function () {\n    return [defaulted$1('sandboxClasses', []), SketchBehaviours.field('sandboxBehaviours', [Composing, Receiving, Sandboxing, Representing])];\n  };\n\n  var schema$g = constant([strict$1('dom'), strict$1('fetch'), onHandler('onOpen'), onKeyboardHandler('onExecute'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), schema$1(), field$1('dropdownBehaviours', [Toggling, Coupling, Keying, Focusing]), strict$1('toggleClass'), defaulted$1('eventOrder', {}), option('lazySink'), defaulted$1('matchWidth', false), defaulted$1('useMinWidth', false), option('role')].concat(sandboxFields()));\n  var parts$4 = constant([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: detail.onExecute\n      };\n    }\n  }), partType()]);\n\n  var factory$6 = function (detail, components, _spec, externals) {\n    var _a;\n\n    var lookupAttr = function (attr) {\n      return get(detail.dom, 'attributes').bind(function (attrs) {\n        return get(attrs, attr);\n      });\n    };\n\n    var switchToMenu = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.highlightPrimary(tmenu);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, function (x) {\n        return x;\n      }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var apis = {\n      expand: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n        }\n      },\n      open: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      isOpen: Toggling.isOn,\n      close: function (comp) {\n        if (Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n\n    var triggerExecute = function (comp, _se) {\n      emitExecute(comp);\n      return Optional.some(true);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.dropdownBehaviours, [Toggling.config({\n        toggleClass: detail.toggleClass,\n        aria: {\n          mode: 'expanded'\n        }\n      }), Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            return makeSandbox(detail, hotspot, {\n              onOpen: function () {\n                Toggling.on(hotspot);\n              },\n              onClose: function () {\n                Toggling.off(hotspot);\n              }\n            });\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: triggerExecute,\n        onEnter: triggerExecute,\n        onDown: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            switchToMenu(sandbox);\n          } else {\n            Dropdown.open(comp);\n          }\n\n          return Optional.some(true);\n        },\n        onEscape: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            Dropdown.close(comp);\n            return Optional.some(true);\n          } else {\n            return Optional.none();\n          }\n        }\n      }), Focusing.config({})]),\n      events: events$7(Optional.some(action)),\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      apis: apis,\n      domModification: {\n        attributes: __assign(__assign({\n          'aria-haspopup': 'true'\n        }, detail.role.fold(function () {\n          return {};\n        }, function (role) {\n          return {\n            role: role\n          };\n        })), detail.dom.tag === 'button' ? {\n          type: lookupAttr('type').getOr('button')\n        } : {})\n      }\n    };\n  };\n\n  var Dropdown = composite$1({\n    name: 'Dropdown',\n    configFields: schema$g(),\n    partFields: parts$4(),\n    factory: factory$6,\n    apis: {\n      open: function (apis, comp) {\n        return apis.open(comp);\n      },\n      expand: function (apis, comp) {\n        return apis.expand(comp);\n      },\n      close: function (apis, comp) {\n        return apis.close(comp);\n      },\n      isOpen: function (apis, comp) {\n        return apis.isOpen(comp);\n      },\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var exhibit$5 = function () {\n    return nu$6({\n      styles: {\n        '-webkit-user-select': 'none',\n        'user-select': 'none',\n        '-ms-user-select': 'none',\n        '-moz-user-select': '-moz-none'\n      },\n      attributes: {\n        unselectable: 'on'\n      }\n    });\n  };\n\n  var events$b = function () {\n    return derive([abort(selectstart(), always)]);\n  };\n\n  var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$b,\n    exhibit: exhibit$5\n  });\n  var Unselecting = create$1({\n    fields: [],\n    name: 'unselecting',\n    active: ActiveUnselecting\n  });\n\n  var renderPanelButton = function (spec, sharedBackstage) {\n    return Dropdown.sketch({\n      dom: spec.dom,\n      components: spec.components,\n      toggleClass: 'mce-active',\n      dropdownBehaviours: derive$1([DisablingConfigs.button(sharedBackstage.providers.isReadOnly), receivingConfig(), Unselecting.config({}), Tabstopping.config({})]),\n      layouts: spec.layouts,\n      sandboxClasses: ['tox-dialog__popups'],\n      lazySink: sharedBackstage.getSink,\n      fetch: function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n            spec.onItemAction(comp, value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, function () {\n            return false;\n          }, sharedBackstage.providers), {\n            movement: deriveMenuMovement(spec.columns, spec.presets)\n          })));\n        });\n      },\n      parts: {\n        menu: part(false, 1, spec.presets)\n      }\n    });\n  };\n\n  var colorInputChangeEvent = generate$1('color-input-change');\n  var colorSwatchChangeEvent = generate$1('color-swatch-change');\n  var colorPickerCancelEvent = generate$1('color-picker-cancel');\n\n  var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n    var pField = FormField.parts.field({\n      factory: Input,\n      inputClasses: ['tox-textfield'],\n      onSetValue: function (c) {\n        return Invalidating.run(c).get(function () {});\n      },\n      inputBehaviours: derive$1([Disabling.config({\n        disabled: sharedBackstage.providers.isReadOnly\n      }), receivingConfig(), Tabstopping.config({}), Invalidating.config({\n        invalidClass: 'tox-textbox-field-invalid',\n        getRoot: function (comp) {\n          return parent(comp.element);\n        },\n        notify: {\n          onValid: function (comp) {\n            var val = Representing.getValue(comp);\n            emitWith(comp, colorInputChangeEvent, {\n              color: val\n            });\n          }\n        },\n        validator: {\n          validateOnLoad: false,\n          validate: function (input) {\n            var inputValue = Representing.getValue(input);\n\n            if (inputValue.length === 0) {\n              return Future.pure(Result.value(true));\n            } else {\n              var span = SugarElement.fromTag('span');\n              set$2(span, 'background-color', inputValue);\n              var res = getRaw(span, 'background-color').fold(function () {\n                return Result.error('blah');\n              }, function (_) {\n                return Result.value(inputValue);\n              });\n              return Future.pure(res);\n            }\n          }\n        }\n      })]),\n      selectOnFocus: false\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, sharedBackstage.providers);\n    });\n\n    var emitSwatchChange = function (colorBit, value) {\n      emitWith(colorBit, colorSwatchChangeEvent, {\n        value: value\n      });\n    };\n\n    var onItemAction = function (comp, value) {\n      memColorButton.getOpt(comp).each(function (colorBit) {\n        if (value === 'custom') {\n          colorInputBackstage.colorPicker(function (valueOpt) {\n            valueOpt.fold(function () {\n              return emit(colorBit, colorPickerCancelEvent);\n            }, function (value) {\n              emitSwatchChange(colorBit, value);\n              addColor(value);\n            });\n          }, '#ffffff');\n        } else if (value === 'remove') {\n          emitSwatchChange(colorBit, '');\n        } else {\n          emitSwatchChange(colorBit, value);\n        }\n      });\n    };\n\n    var memColorButton = record(renderPanelButton({\n      dom: {\n        tag: 'span',\n        attributes: {\n          'aria-label': sharedBackstage.providers.translate('Color swatch')\n        }\n      },\n      layouts: {\n        onRtl: function () {\n          return [southwest$1, southeast$1, south$1];\n        },\n        onLtr: function () {\n          return [southeast$1, southwest$1, south$1];\n        }\n      },\n      components: [],\n      fetch: getFetch(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n      columns: colorInputBackstage.getColorCols(),\n      presets: 'color',\n      onItemAction: onItemAction\n    }, sharedBackstage));\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: pLabel.toArray().concat([{\n        dom: {\n          tag: 'div',\n          classes: ['tox-color-input']\n        },\n        components: [pField, memColorButton.asSpec()]\n      }]),\n      fieldBehaviours: derive$1([config('form-field-events', [run(colorInputChangeEvent, function (comp, se) {\n        memColorButton.getOpt(comp).each(function (colorButton) {\n          set$2(colorButton.element, 'background-color', se.event.color);\n        });\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      }), run(colorSwatchChangeEvent, function (comp, se) {\n        FormField.getField(comp).each(function (field) {\n          Representing.setValue(field, se.event.value);\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      }), run(colorPickerCancelEvent, function (comp, _se) {\n        FormField.getField(comp).each(function (_field) {\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      })])])\n    });\n  };\n\n  var hsvColour = function (hue, saturation, value) {\n    return {\n      hue: hue,\n      saturation: saturation,\n      value: value\n    };\n  };\n\n  var fromRgb = function (rgbaColour) {\n    var h = 0;\n    var s = 0;\n    var v = 0;\n    var r = rgbaColour.red / 255;\n    var g = rgbaColour.green / 255;\n    var b = rgbaColour.blue / 255;\n    var minRGB = Math.min(r, Math.min(g, b));\n    var maxRGB = Math.max(r, Math.max(g, b));\n\n    if (minRGB === maxRGB) {\n      v = minRGB;\n      return hsvColour(0, 0, v * 100);\n    }\n\n    var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n    h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n    h = 60 * (h - d / (maxRGB - minRGB));\n    s = (maxRGB - minRGB) / maxRGB;\n    v = maxRGB;\n    return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n  };\n\n  var calcHex = function (value) {\n    var hue = (100 - value) / 100 * 360;\n    var hsv = hsvColour(hue, 100, 100);\n    var rgb = fromHsv(hsv);\n    return fromRgba(rgb);\n  };\n\n  var fieldsUpdate = generate$1('rgb-hex-update');\n  var sliderUpdate = generate$1('slider-update');\n  var paletteUpdate = generate$1('palette-update');\n  var labelPart = optional({\n    schema: [strict$1('dom')],\n    name: 'label'\n  });\n\n  var edgePart = function (name) {\n    return optional({\n      name: '' + name + '-edge',\n      overrides: function (detail) {\n        var action = detail.model.manager.edgeActions[name];\n        return action.fold(function () {\n          return {};\n        }, function (a) {\n          return {\n            events: derive([runActionExtra(touchstart(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousedown(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousemove(), function (comp, se, det) {\n              if (det.mouseIsDown.get()) {\n                a(comp, det);\n              }\n            }, [detail])])\n          };\n        });\n      }\n    });\n  };\n\n  var tlEdgePart = edgePart('top-left');\n  var tedgePart = edgePart('top');\n  var trEdgePart = edgePart('top-right');\n  var redgePart = edgePart('right');\n  var brEdgePart = edgePart('bottom-right');\n  var bedgePart = edgePart('bottom');\n  var blEdgePart = edgePart('bottom-left');\n  var ledgePart = edgePart('left');\n  var thumbPart = required({\n    name: 'thumb',\n    defaults: constant({\n      dom: {\n        styles: {\n          position: 'absolute'\n        }\n      }\n    }),\n    overrides: function (detail) {\n      return {\n        events: derive([redirectToPart(touchstart(), detail, 'spectrum'), redirectToPart(touchmove(), detail, 'spectrum'), redirectToPart(touchend(), detail, 'spectrum'), redirectToPart(mousedown(), detail, 'spectrum'), redirectToPart(mousemove(), detail, 'spectrum'), redirectToPart(mouseup(), detail, 'spectrum')])\n      };\n    }\n  });\n  var spectrumPart = required({\n    schema: [state$1('mouseIsDown', function () {\n      return Cell(false);\n    })],\n    name: 'spectrum',\n    overrides: function (detail) {\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n\n      var setValueFrom = function (component, simulatedEvent) {\n        return model.getValueFromEvent(simulatedEvent).map(function (value) {\n          return model.setValueFrom(component, detail, value);\n        });\n      };\n\n      return {\n        behaviours: derive$1([Keying.config({\n          mode: 'special',\n          onLeft: function (spectrum) {\n            return model.onLeft(spectrum, detail);\n          },\n          onRight: function (spectrum) {\n            return model.onRight(spectrum, detail);\n          },\n          onUp: function (spectrum) {\n            return model.onUp(spectrum, detail);\n          },\n          onDown: function (spectrum) {\n            return model.onDown(spectrum, detail);\n          }\n        }), Focusing.config({})]),\n        events: derive([run(touchstart(), setValueFrom), run(touchmove(), setValueFrom), run(mousedown(), setValueFrom), run(mousemove(), function (spectrum, se) {\n          if (detail.mouseIsDown.get()) {\n            setValueFrom(spectrum, se);\n          }\n        })])\n      };\n    }\n  });\n  var SliderParts = [labelPart, ledgePart, redgePart, tedgePart, bedgePart, tlEdgePart, trEdgePart, blEdgePart, brEdgePart, thumbPart, spectrumPart];\n  var _sliderChangeEvent = 'slider.change.value';\n  var sliderChangeEvent = constant(_sliderChangeEvent);\n\n  var isTouchEvent = function (evt) {\n    return evt.type.indexOf('touch') !== -1;\n  };\n\n  var getEventSource = function (simulatedEvent) {\n    var evt = simulatedEvent.event.raw;\n\n    if (isTouchEvent(evt)) {\n      var touchEvent = evt;\n      return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n        return SugarPosition(t.clientX, t.clientY);\n      }) : Optional.none();\n    } else {\n      var mouseEvent = evt;\n      return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n        return SugarPosition(me.clientX, me.clientY);\n      }) : Optional.none();\n    }\n  };\n\n  var t = 'top',\n      r$1 = 'right',\n      b = 'bottom',\n      l = 'left';\n\n  var minX = function (detail) {\n    return detail.model.minX;\n  };\n\n  var minY = function (detail) {\n    return detail.model.minY;\n  };\n\n  var min1X = function (detail) {\n    return detail.model.minX - 1;\n  };\n\n  var min1Y = function (detail) {\n    return detail.model.minY - 1;\n  };\n\n  var maxX = function (detail) {\n    return detail.model.maxX;\n  };\n\n  var maxY = function (detail) {\n    return detail.model.maxY;\n  };\n\n  var max1X = function (detail) {\n    return detail.model.maxX + 1;\n  };\n\n  var max1Y = function (detail) {\n    return detail.model.maxY + 1;\n  };\n\n  var range$2 = function (detail, max, min) {\n    return max(detail) - min(detail);\n  };\n\n  var xRange = function (detail) {\n    return range$2(detail, maxX, minX);\n  };\n\n  var yRange = function (detail) {\n    return range$2(detail, maxY, minY);\n  };\n\n  var halfX = function (detail) {\n    return xRange(detail) / 2;\n  };\n\n  var halfY = function (detail) {\n    return yRange(detail) / 2;\n  };\n\n  var step = function (detail) {\n    return detail.stepSize;\n  };\n\n  var snap = function (detail) {\n    return detail.snapToGrid;\n  };\n\n  var snapStart = function (detail) {\n    return detail.snapStart;\n  };\n\n  var rounded = function (detail) {\n    return detail.rounded;\n  };\n\n  var hasEdge = function (detail, edgeName) {\n    return detail[edgeName + '-edge'] !== undefined;\n  };\n\n  var hasLEdge = function (detail) {\n    return hasEdge(detail, l);\n  };\n\n  var hasREdge = function (detail) {\n    return hasEdge(detail, r$1);\n  };\n\n  var hasTEdge = function (detail) {\n    return hasEdge(detail, t);\n  };\n\n  var hasBEdge = function (detail) {\n    return hasEdge(detail, b);\n  };\n\n  var currentValue = function (detail) {\n    return detail.model.value.get();\n  };\n\n  var xValue = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var yValue = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var xyValue = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var fireSliderChange = function (component, value) {\n    emitWith(component, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var setToTLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), min1Y(detail)));\n  };\n\n  var setToTEdge = function (edge, detail) {\n    fireSliderChange(edge, yValue(min1Y(detail)));\n  };\n\n  var setToTEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(halfX(detail), min1Y(detail)));\n  };\n\n  var setToTREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), min1Y(detail)));\n  };\n\n  var setToREdge = function (edge, detail) {\n    fireSliderChange(edge, xValue(max1X(detail)));\n  };\n\n  var setToREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), halfY(detail)));\n  };\n\n  var setToBREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), max1Y(detail)));\n  };\n\n  var setToBEdge = function (edge, detail) {\n    fireSliderChange(edge, yValue(max1Y(detail)));\n  };\n\n  var setToBEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(halfX(detail), max1Y(detail)));\n  };\n\n  var setToBLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), max1Y(detail)));\n  };\n\n  var setToLEdge = function (edge, detail) {\n    fireSliderChange(edge, xValue(min1X(detail)));\n  };\n\n  var setToLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), halfY(detail)));\n  };\n\n  var reduceBy = function (value, min, max, step) {\n    if (value < min) {\n      return value;\n    } else if (value > max) {\n      return max;\n    } else if (value === min) {\n      return min - 1;\n    } else {\n      return Math.max(min, value - step);\n    }\n  };\n\n  var increaseBy = function (value, min, max, step) {\n    if (value > max) {\n      return value;\n    } else if (value < min) {\n      return min;\n    } else if (value === max) {\n      return max + 1;\n    } else {\n      return Math.min(max, value + step);\n    }\n  };\n\n  var capValue = function (value, min, max) {\n    return Math.max(min, Math.min(max, value));\n  };\n\n  var snapValueOf = function (value, min, max, step, snapStart) {\n    return snapStart.fold(function () {\n      var initValue = value - min;\n      var extraValue = Math.round(initValue / step) * step;\n      return capValue(min + extraValue, min - 1, max + 1);\n    }, function (start) {\n      var remainder = (value - start) % step;\n      var adjustment = Math.round(remainder / step);\n      var rawSteps = Math.floor((value - start) / step);\n      var maxSteps = Math.floor((max - start) / step);\n      var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n      var r = start + numSteps * step;\n      return Math.max(start, r);\n    });\n  };\n\n  var findOffsetOf = function (value, min, max) {\n    return Math.min(max, Math.max(value, min)) - min;\n  };\n\n  var findValueOf = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        step = args.step,\n        snap = args.snap,\n        snapStart = args.snapStart,\n        rounded = args.rounded,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        minBound = args.minBound,\n        maxBound = args.maxBound,\n        screenRange = args.screenRange;\n    var capMin = hasMinEdge ? min - 1 : min;\n    var capMax = hasMaxEdge ? max + 1 : max;\n\n    if (value < minBound) {\n      return capMin;\n    } else if (value > maxBound) {\n      return capMax;\n    } else {\n      var offset = findOffsetOf(value, minBound, maxBound);\n      var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n\n      if (snap && newValue >= min && newValue <= max) {\n        return snapValueOf(newValue, min, max, step, snapStart);\n      } else if (rounded) {\n        return Math.round(newValue);\n      } else {\n        return newValue;\n      }\n    }\n  };\n\n  var findOffsetOfValue = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        maxBound = args.maxBound,\n        maxOffset = args.maxOffset,\n        centerMinEdge = args.centerMinEdge,\n        centerMaxEdge = args.centerMaxEdge;\n\n    if (value < min) {\n      return hasMinEdge ? 0 : centerMinEdge;\n    } else if (value > max) {\n      return hasMaxEdge ? maxBound : centerMaxEdge;\n    } else {\n      return (value - min) / range * maxOffset;\n    }\n  };\n\n  var top = 'top',\n      right = 'right',\n      bottom = 'bottom',\n      left = 'left',\n      width = 'width',\n      height = 'height';\n\n  var getBounds$1 = function (component) {\n    return component.element.dom.getBoundingClientRect();\n  };\n\n  var getBoundsProperty = function (bounds, property) {\n    return bounds[property];\n  };\n\n  var getMinXBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, left);\n  };\n\n  var getMaxXBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, right);\n  };\n\n  var getMinYBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, top);\n  };\n\n  var getMaxYBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, bottom);\n  };\n\n  var getXScreenRange = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, width);\n  };\n\n  var getYScreenRange = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, height);\n  };\n\n  var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n    return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n  };\n\n  var getXCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds$1(component);\n    var spectrumBounds = getBounds$1(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, left);\n    var componentMaxEdge = getBoundsProperty(componentBounds, right);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var getYCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds$1(component);\n    var spectrumBounds = getBounds$1(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, top);\n    var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var fireSliderChange$1 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var findValueOfOffset = function (spectrum, detail, left) {\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: left,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      maxBound: getMaxXBounds(spectrum),\n      screenRange: getXScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset(spectrum, detail, value);\n    var sliderVal = sliderValue(xValue);\n    fireSliderChange$1(spectrum, sliderVal);\n    return xValue;\n  };\n\n  var setToMin = function (spectrum, detail) {\n    var min = minX(detail);\n    fireSliderChange$1(spectrum, sliderValue(min));\n  };\n\n  var setToMax = function (spectrum, detail) {\n    var max = maxX(detail);\n    fireSliderChange$1(spectrum, sliderValue(max));\n  };\n\n  var moveBy = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    fireSliderChange$1(spectrum, sliderValue(xValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy(direction, spectrum, detail).map(function () {\n        return true;\n      });\n    };\n  };\n\n  var getValueFromEvent = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.left;\n    });\n  };\n\n  var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getXScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: value,\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxXBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue(args);\n  };\n\n  var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n    return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n  };\n\n  var setPositionFromValue = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var thumbRadius = get$7(thumb.element) / 2;\n    set$2(thumb.element, 'left', pos - thumbRadius + 'px');\n  };\n\n  var onLeft = handleMovement(-1);\n  var onRight = handleMovement(1);\n  var onUp = Optional.none;\n  var onDown = Optional.none;\n  var edgeActions = {\n    'top-left': Optional.none(),\n    'top': Optional.none(),\n    'top-right': Optional.none(),\n    'right': Optional.some(setToREdge),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.none(),\n    'bottom-left': Optional.none(),\n    'left': Optional.some(setToLEdge)\n  };\n  var HorizontalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom,\n    setToMin: setToMin,\n    setToMax: setToMax,\n    findValueOfOffset: findValueOfOffset,\n    getValueFromEvent: getValueFromEvent,\n    findPositionOfValue: findPositionOfValue,\n    setPositionFromValue: setPositionFromValue,\n    onLeft: onLeft,\n    onRight: onRight,\n    onUp: onUp,\n    onDown: onDown,\n    edgeActions: edgeActions\n  });\n\n  var fireSliderChange$2 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$1 = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var findValueOfOffset$1 = function (spectrum, detail, top) {\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: top,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      maxBound: getMaxYBounds(spectrum),\n      screenRange: getYScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom$1 = function (spectrum, detail, value) {\n    var yValue = findValueOfOffset$1(spectrum, detail, value);\n    var sliderVal = sliderValue$1(yValue);\n    fireSliderChange$2(spectrum, sliderVal);\n    return yValue;\n  };\n\n  var setToMin$1 = function (spectrum, detail) {\n    var min = minY(detail);\n    fireSliderChange$2(spectrum, sliderValue$1(min));\n  };\n\n  var setToMax$1 = function (spectrum, detail) {\n    var max = maxY(detail);\n    fireSliderChange$2(spectrum, sliderValue$1(max));\n  };\n\n  var moveBy$1 = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange$2(spectrum, sliderValue$1(yValue));\n    return Optional.some(yValue);\n  };\n\n  var handleMovement$1 = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy$1(direction, spectrum, detail).map(function () {\n        return true;\n      });\n    };\n  };\n\n  var getValueFromEvent$1 = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.top;\n    });\n  };\n\n  var findOffsetOfValue$2 = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getYScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: value,\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxYBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue(args);\n  };\n\n  var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue$2(spectrum, detail, value, minEdge, maxEdge);\n    return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n  };\n\n  var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbRadius = get$6(thumb.element) / 2;\n    set$2(thumb.element, 'top', pos - thumbRadius + 'px');\n  };\n\n  var onLeft$1 = Optional.none;\n  var onRight$1 = Optional.none;\n  var onUp$1 = handleMovement$1(-1);\n  var onDown$1 = handleMovement$1(1);\n  var edgeActions$1 = {\n    'top-left': Optional.none(),\n    'top': Optional.some(setToTEdge),\n    'top-right': Optional.none(),\n    'right': Optional.none(),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.some(setToBEdge),\n    'bottom-left': Optional.none(),\n    'left': Optional.none()\n  };\n  var VerticalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$1,\n    setToMin: setToMin$1,\n    setToMax: setToMax$1,\n    findValueOfOffset: findValueOfOffset$1,\n    getValueFromEvent: getValueFromEvent$1,\n    findPositionOfValue: findPositionOfValue$1,\n    setPositionFromValue: setPositionFromValue$1,\n    onLeft: onLeft$1,\n    onRight: onRight$1,\n    onUp: onUp$1,\n    onDown: onDown$1,\n    edgeActions: edgeActions$1\n  });\n\n  var fireSliderChange$3 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$2 = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var setValueFrom$2 = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset(spectrum, detail, value.left);\n    var yValue = findValueOfOffset$1(spectrum, detail, value.top);\n    var val = sliderValue$2(xValue, yValue);\n    fireSliderChange$3(spectrum, val);\n    return val;\n  };\n\n  var moveBy$2 = function (direction, isVerticalMovement, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange$3(spectrum, sliderValue$2(xValue, yValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement$2 = function (direction, isVerticalMovement) {\n    return function (spectrum, detail) {\n      return moveBy$2(direction, isVerticalMovement, spectrum, detail).map(function () {\n        return true;\n      });\n    };\n  };\n\n  var setToMin$2 = function (spectrum, detail) {\n    var mX = minX(detail);\n    var mY = minY(detail);\n    fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n  };\n\n  var setToMax$2 = function (spectrum, detail) {\n    var mX = maxX(detail);\n    var mY = maxY(detail);\n    fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n  };\n\n  var getValueFromEvent$2 = function (simulatedEvent) {\n    return getEventSource(simulatedEvent);\n  };\n\n  var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var xPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var yPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbXRadius = get$7(thumb.element) / 2;\n    var thumbYRadius = get$6(thumb.element) / 2;\n    set$2(thumb.element, 'left', xPos - thumbXRadius + 'px');\n    set$2(thumb.element, 'top', yPos - thumbYRadius + 'px');\n  };\n\n  var onLeft$2 = handleMovement$2(-1, false);\n  var onRight$2 = handleMovement$2(1, false);\n  var onUp$2 = handleMovement$2(-1, true);\n  var onDown$2 = handleMovement$2(1, true);\n  var edgeActions$2 = {\n    'top-left': Optional.some(setToTLEdgeXY),\n    'top': Optional.some(setToTEdgeXY),\n    'top-right': Optional.some(setToTREdgeXY),\n    'right': Optional.some(setToREdgeXY),\n    'bottom-right': Optional.some(setToBREdgeXY),\n    'bottom': Optional.some(setToBEdgeXY),\n    'bottom-left': Optional.some(setToBLEdgeXY),\n    'left': Optional.some(setToLEdgeXY)\n  };\n  var TwoDModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$2,\n    setToMin: setToMin$2,\n    setToMax: setToMax$2,\n    getValueFromEvent: getValueFromEvent$2,\n    setPositionFromValue: setPositionFromValue$2,\n    onLeft: onLeft$2,\n    onRight: onRight$2,\n    onUp: onUp$2,\n    onDown: onDown$2,\n    edgeActions: edgeActions$2\n  });\n  var SliderSchema = [defaulted$1('stepSize', 1), defaulted$1('onChange', noop), defaulted$1('onChoose', noop), defaulted$1('onInit', noop), defaulted$1('onDragStart', noop), defaulted$1('onDragEnd', noop), defaulted$1('snapToGrid', false), defaulted$1('rounded', true), option('snapStart'), strictOf('model', choose$1('mode', {\n    x: [defaulted$1('minX', 0), defaulted$1('maxX', 100), state$1('value', function (spec) {\n      return Cell(spec.mode.minX);\n    }), strict$1('getInitialValue'), output('manager', HorizontalModel)],\n    y: [defaulted$1('minY', 0), defaulted$1('maxY', 100), state$1('value', function (spec) {\n      return Cell(spec.mode.minY);\n    }), strict$1('getInitialValue'), output('manager', VerticalModel)],\n    xy: [defaulted$1('minX', 0), defaulted$1('maxX', 100), defaulted$1('minY', 0), defaulted$1('maxY', 100), state$1('value', function (spec) {\n      return Cell({\n        x: spec.mode.minX,\n        y: spec.mode.minY\n      });\n    }), strict$1('getInitialValue'), output('manager', TwoDModel)]\n  })), field$1('sliderBehaviours', [Keying, Representing]), state$1('mouseIsDown', function () {\n    return Cell(false);\n  })];\n\n  var sketch = function (detail, components, _spec, _externals) {\n    var _a;\n\n    var getThumb = function (component) {\n      return getPartOrDie(component, detail, 'thumb');\n    };\n\n    var getSpectrum = function (component) {\n      return getPartOrDie(component, detail, 'spectrum');\n    };\n\n    var getLeftEdge = function (component) {\n      return getPart(component, detail, 'left-edge');\n    };\n\n    var getRightEdge = function (component) {\n      return getPart(component, detail, 'right-edge');\n    };\n\n    var getTopEdge = function (component) {\n      return getPart(component, detail, 'top-edge');\n    };\n\n    var getBottomEdge = function (component) {\n      return getPart(component, detail, 'bottom-edge');\n    };\n\n    var modelDetail = detail.model;\n    var model = modelDetail.manager;\n\n    var refresh = function (slider, thumb) {\n      model.setPositionFromValue(slider, thumb, detail, {\n        getLeftEdge: getLeftEdge,\n        getRightEdge: getRightEdge,\n        getTopEdge: getTopEdge,\n        getBottomEdge: getBottomEdge,\n        getSpectrum: getSpectrum\n      });\n    };\n\n    var changeValue = function (slider, newValue) {\n      modelDetail.value.set(newValue);\n      var thumb = getThumb(slider);\n      refresh(slider, thumb);\n      detail.onChange(slider, thumb, newValue);\n      return Optional.some(true);\n    };\n\n    var resetToMin = function (slider) {\n      model.setToMin(slider, detail);\n    };\n\n    var resetToMax = function (slider) {\n      model.setToMax(slider, detail);\n    };\n\n    var choose = function (slider) {\n      var fireOnChoose = function () {\n        getPart(slider, detail, 'thumb').each(function (thumb) {\n          var value = modelDetail.value.get();\n          detail.onChoose(slider, thumb, value);\n        });\n      };\n\n      var wasDown = detail.mouseIsDown.get();\n      detail.mouseIsDown.set(false);\n\n      if (wasDown) {\n        fireOnChoose();\n      }\n    };\n\n    var onDragStart = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.mouseIsDown.set(true);\n      detail.onDragStart(slider, getThumb(slider));\n    };\n\n    var onDragEnd = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.onDragEnd(slider, getThumb(slider));\n      choose(slider);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.sliderBehaviours, [Keying.config({\n        mode: 'special',\n        focusIn: function (slider) {\n          return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (_) {\n            return modelDetail.value.get();\n          }\n        }\n      }), Receiving.config({\n        channels: (_a = {}, _a[mouseReleased()] = {\n          onReceive: choose\n        }, _a)\n      })]),\n      events: derive([run(sliderChangeEvent(), function (slider, simulatedEvent) {\n        changeValue(slider, simulatedEvent.event.value);\n      }), runOnAttached(function (slider, _simulatedEvent) {\n        var getInitial = modelDetail.getInitialValue();\n        modelDetail.value.set(getInitial);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n        var spectrum = getSpectrum(slider);\n        detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n      }), run(touchstart(), onDragStart), run(touchend(), onDragEnd), run(mousedown(), onDragStart), run(mouseup(), onDragEnd)]),\n      apis: {\n        resetToMin: resetToMin,\n        resetToMax: resetToMax,\n        changeValue: changeValue,\n        refresh: refresh\n      },\n      domModification: {\n        styles: {\n          position: 'relative'\n        }\n      }\n    };\n  };\n\n  var Slider = composite$1({\n    name: 'Slider',\n    configFields: SliderSchema,\n    partFields: SliderParts,\n    factory: sketch,\n    apis: {\n      resetToMin: function (apis, slider) {\n        apis.resetToMin(slider);\n      },\n      resetToMax: function (apis, slider) {\n        apis.resetToMax(slider);\n      },\n      refresh: function (apis, slider) {\n        apis.refresh(slider);\n      }\n    }\n  });\n\n  var sliderFactory = function (translate, getClass) {\n    var spectrum = Slider.parts.spectrum({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-spectrum')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var thumb = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-thumb')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    return Slider.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      rounded: false,\n      model: {\n        mode: 'y',\n        getInitialValue: constant({\n          y: 0\n        })\n      },\n      components: [spectrum, thumb],\n      sliderBehaviours: derive$1([Focusing.config({})]),\n      onChange: function (slider, _thumb, value) {\n        emitWith(slider, sliderUpdate, {\n          value: value\n        });\n      }\n    });\n  };\n\n  var owner$3 = 'form';\n  var schema$h = [field$1('formBehaviours', [Representing])];\n\n  var getPartName = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch$1 = function (fSpec) {\n    var parts = function () {\n      var record = [];\n\n      var field = function (name, config) {\n        record.push(name);\n        return generateOne(owner$3, getPartName(name), config);\n      };\n\n      return {\n        field: field,\n        record: function () {\n          return record;\n        }\n      };\n    }();\n\n    var spec = fSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName(n)\n      });\n    });\n    return composite(owner$3, schema$h, fieldParts, make$4, spec);\n  };\n\n  var toResult$1 = function (o, e) {\n    return o.fold(function () {\n      return Result.error(e);\n    }, Result.value);\n  };\n\n  var make$4 = function (detail, components) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.formBehaviours, [Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (form) {\n            var resPs = getAllParts(form, detail);\n            return map$2(resPs, function (resPThunk, pName) {\n              return resPThunk().bind(function (v) {\n                var opt = Composing.getCurrent(v);\n                return toResult$1(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n              }).map(Representing.getValue);\n            });\n          },\n          setValue: function (form, values) {\n            each$1(values, function (newValue, key) {\n              getPart(form, detail, key).each(function (wrapper) {\n                Composing.getCurrent(wrapper).each(function (field) {\n                  Representing.setValue(field, newValue);\n                });\n              });\n            });\n          }\n        }\n      })]),\n      apis: {\n        getField: function (form, key) {\n          return getPart(form, detail, key).bind(Composing.getCurrent);\n        }\n      }\n    };\n  };\n\n  var Form = {\n    getField: makeApi(function (apis, component, key) {\n      return apis.getField(component, key);\n    }),\n    sketch: sketch$1\n  };\n  var validInput = generate$1('valid-input');\n  var invalidInput = generate$1('invalid-input');\n  var validatingInput = generate$1('validating-input');\n  var translatePrefix = 'colorcustom.rgb.';\n\n  var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n    var invalidation = function (label, isValid) {\n      return Invalidating.config({\n        invalidClass: getClass('invalid'),\n        notify: {\n          onValidate: function (comp) {\n            emitWith(comp, validatingInput, {\n              type: label\n            });\n          },\n          onValid: function (comp) {\n            emitWith(comp, validInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          },\n          onInvalid: function (comp) {\n            emitWith(comp, invalidInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          }\n        },\n        validator: {\n          validate: function (comp) {\n            var value = Representing.getValue(comp);\n            var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n            return Future.pure(res);\n          },\n          validateOnLoad: false\n        }\n      });\n    };\n\n    var renderTextField = function (isValid, name, label, description, data) {\n      var helptext = translate(translatePrefix + 'range');\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'label',\n          innerHtml: label,\n          attributes: {\n            'aria-label': description\n          }\n        }\n      });\n      var pField = FormField.parts.field({\n        data: data,\n        factory: Input,\n        inputAttributes: __assign({\n          type: 'text'\n        }, name === 'hex' ? {\n          'aria-live': 'polite'\n        } : {}),\n        inputClasses: [getClass('textfield')],\n        inputBehaviours: derive$1([invalidation(name, isValid), Tabstopping.config({})]),\n        onSetValue: function (input) {\n          if (Invalidating.isInvalid(input)) {\n            var run = Invalidating.run(input);\n            run.get(noop);\n          }\n        }\n      });\n      var comps = [pLabel, pField];\n      var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({\n        text: helptext\n      })] : [];\n      var components = comps.concat(concats);\n      return {\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        components: components\n      };\n    };\n\n    var copyRgbToHex = function (form, rgba) {\n      var hex = fromRgba(rgba);\n      Form.getField(form, 'hex').each(function (hexField) {\n        if (!Focusing.isFocused(hexField)) {\n          Representing.setValue(form, {\n            hex: hex.value\n          });\n        }\n      });\n      return hex;\n    };\n\n    var copyRgbToForm = function (form, rgb) {\n      var red = rgb.red;\n      var green = rgb.green;\n      var blue = rgb.blue;\n      Representing.setValue(form, {\n        red: red,\n        green: green,\n        blue: blue\n      });\n    };\n\n    var memPreview = record({\n      dom: {\n        tag: 'div',\n        classes: [getClass('rgba-preview')],\n        styles: {\n          'background-color': 'white'\n        },\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n\n    var updatePreview = function (anyInSystem, hex) {\n      memPreview.getOpt(anyInSystem).each(function (preview) {\n        set$2(preview.element, 'background-color', '#' + hex.value);\n      });\n    };\n\n    var factory = function () {\n      var state = {\n        red: Cell(Optional.some(255)),\n        green: Cell(Optional.some(255)),\n        blue: Cell(Optional.some(255)),\n        hex: Cell(Optional.some('ffffff'))\n      };\n\n      var copyHexToRgb = function (form, hex) {\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n      };\n\n      var get = function (prop) {\n        return state[prop].get();\n      };\n\n      var set = function (prop, value) {\n        state[prop].set(value);\n      };\n\n      var getValueRgb = function () {\n        return get('red').bind(function (red) {\n          return get('green').bind(function (green) {\n            return get('blue').map(function (blue) {\n              return rgbaColour(red, green, blue, 1);\n            });\n          });\n        });\n      };\n\n      var setValueRgb = function (rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        set('red', Optional.some(red));\n        set('green', Optional.some(green));\n        set('blue', Optional.some(blue));\n      };\n\n      var onInvalidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (data.type !== 'hex') {\n          set(data.type, Optional.none());\n        } else {\n          onInvalidHexx(form);\n        }\n      };\n\n      var onValidHex = function (form, value) {\n        onValidHexx(form);\n        var hex = hexColour(value);\n        set('hex', Optional.some(value));\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n        emitWith(form, fieldsUpdate, {\n          hex: hex\n        });\n        updatePreview(form, hex);\n      };\n\n      var onValidRgb = function (form, prop, value) {\n        var val = parseInt(value, 10);\n        set(prop, Optional.some(val));\n        getValueRgb().each(function (rgb) {\n          var hex = copyRgbToHex(form, rgb);\n          updatePreview(form, hex);\n        });\n      };\n\n      var isHexInputEvent = function (data) {\n        return data.type === 'hex';\n      };\n\n      var onValidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (isHexInputEvent(data)) {\n          onValidHex(form, data.value);\n        } else {\n          onValidRgb(form, data.type, data.value);\n        }\n      };\n\n      var formPartStrings = function (key) {\n        return {\n          label: translate(translatePrefix + key + '.label'),\n          description: translate(translatePrefix + key + '.description')\n        };\n      };\n\n      var redStrings = formPartStrings('red');\n      var greenStrings = formPartStrings('green');\n      var blueStrings = formPartStrings('blue');\n      var hexStrings = formPartStrings('hex');\n      return deepMerge(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'form',\n            classes: [getClass('rgb-form')],\n            attributes: {\n              'aria-label': translate('aria.color.picker')\n            }\n          },\n          components: [parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))), parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))), parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))), parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))), memPreview.asSpec()],\n          formBehaviours: derive$1([Invalidating.config({\n            invalidClass: getClass('form-invalid')\n          }), config('rgb-form-events', [run(validInput, onValidInput), run(invalidInput, onInvalidInput), run(validatingInput, onInvalidInput)])])\n        };\n      }), {\n        apis: {\n          updateHex: function (form, hex) {\n            Representing.setValue(form, {\n              hex: hex.value\n            });\n            copyHexToRgb(form, hex);\n            updatePreview(form, hex);\n          }\n        }\n      });\n    };\n\n    var rgbFormSketcher = single$2({\n      factory: factory,\n      name: 'RgbForm',\n      configFields: [],\n      apis: {\n        updateHex: function (apis, form, hex) {\n          apis.updateHex(form, hex);\n        }\n      },\n      extraApis: {}\n    });\n    return rgbFormSketcher;\n  };\n\n  var paletteFactory = function (_translate, getClass) {\n    var spectrumPart = Slider.parts.spectrum({\n      dom: {\n        tag: 'canvas',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-spectrum')]\n      }\n    });\n    var thumbPart = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-thumb')],\n        innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n      }\n    });\n\n    var setColour = function (canvas, rgba) {\n      var width = canvas.width,\n          height = canvas.height;\n      var ctx = canvas.getContext('2d');\n\n      if (ctx === null) {\n        return;\n      }\n\n      ctx.fillStyle = rgba;\n      ctx.fillRect(0, 0, width, height);\n      var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n      var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n    };\n\n    var setSliderColour = function (slider, rgba) {\n      var canvas = slider.components()[0].element.dom;\n      setColour(canvas, toString(rgba));\n    };\n\n    var factory = function (_detail) {\n      var getInitialValue = constant({\n        x: 0,\n        y: 0\n      });\n\n      var onChange = function (slider, _thumb, value) {\n        emitWith(slider, paletteUpdate, {\n          value: value\n        });\n      };\n\n      var onInit = function (_slider, _thumb, spectrum, _value) {\n        setColour(spectrum.element.dom, toString(red));\n      };\n\n      var sliderBehaviours = derive$1([Composing.config({\n        find: Optional.some\n      }), Focusing.config({})]);\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          },\n          classes: [getClass('sv-palette')]\n        },\n        model: {\n          mode: 'xy',\n          getInitialValue: getInitialValue\n        },\n        rounded: false,\n        components: [spectrumPart, thumbPart],\n        onChange: onChange,\n        onInit: onInit,\n        sliderBehaviours: sliderBehaviours\n      });\n    };\n\n    var saturationBrightnessPaletteSketcher = single$2({\n      factory: factory,\n      name: 'SaturationBrightnessPalette',\n      configFields: [],\n      apis: {\n        setRgba: function (_apis, slider, rgba) {\n          setSliderColour(slider, rgba);\n        }\n      },\n      extraApis: {}\n    });\n    return saturationBrightnessPaletteSketcher;\n  };\n\n  var makeFactory = function (translate, getClass) {\n    var factory = function (detail) {\n      var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n      var sbPalette = paletteFactory(translate, getClass);\n      var state = {\n        paletteRgba: Cell(red)\n      };\n      var memPalette = record(sbPalette.sketch({}));\n      var memRgb = record(rgbForm.sketch({}));\n\n      var updatePalette = function (anyInSystem, hex) {\n        memPalette.getOpt(anyInSystem).each(function (palette) {\n          var rgba = fromHex(hex);\n          state.paletteRgba.set(rgba);\n          sbPalette.setRgba(palette, rgba);\n        });\n      };\n\n      var updateFields = function (anyInSystem, hex) {\n        memRgb.getOpt(anyInSystem).each(function (form) {\n          rgbForm.updateHex(form, hex);\n        });\n      };\n\n      var runUpdates = function (anyInSystem, hex, updates) {\n        each(updates, function (update) {\n          update(anyInSystem, hex);\n        });\n      };\n\n      var paletteUpdates = function () {\n        var updates = [updateFields];\n        return function (form, simulatedEvent) {\n          var value = simulatedEvent.event.value;\n          var oldRgb = state.paletteRgba.get();\n          var hsvColour$1 = fromRgb(oldRgb);\n          var newHsvColour = hsvColour(hsvColour$1.hue, value.x, 100 - value.y);\n          var rgb = fromHsv(newHsvColour);\n          var nuHex = fromRgba(rgb);\n          runUpdates(form, nuHex, updates);\n        };\n      };\n\n      var sliderUpdates = function () {\n        var updates = [updatePalette, updateFields];\n        return function (form, simulatedEvent) {\n          var value = simulatedEvent.event.value;\n          var hex = calcHex(value.y);\n          runUpdates(form, hex, updates);\n        };\n      };\n\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [memPalette.asSpec(), sliderFactory(translate, getClass), memRgb.asSpec()],\n        behaviours: derive$1([config('colour-picker-events', [run(paletteUpdate, paletteUpdates()), run(sliderUpdate, sliderUpdates())]), Composing.config({\n          find: function (comp) {\n            return memRgb.getOpt(comp);\n          }\n        }), Keying.config({\n          mode: 'acyclic'\n        })])\n      };\n    };\n\n    var colourPickerSketcher = single$2({\n      name: 'ColourPicker',\n      configFields: [strict$1('dom'), defaulted$1('onValidHex', noop), defaulted$1('onInvalidHex', noop)],\n      factory: factory\n    });\n    return colourPickerSketcher;\n  };\n\n  var self$1 = function () {\n    return Composing.config({\n      find: Optional.some\n    });\n  };\n\n  var memento = function (mem) {\n    return Composing.config({\n      find: mem.getOpt\n    });\n  };\n\n  var childAt = function (index) {\n    return Composing.config({\n      find: function (comp) {\n        return child(comp.element, index).bind(function (element) {\n          return comp.getSystem().getByDom(element).toOptional();\n        });\n      }\n    });\n  };\n\n  var ComposingConfigs = {\n    self: self$1,\n    memento: memento,\n    childAt: childAt\n  };\n  var english = {\n    'colorcustom.rgb.red.label': 'R',\n    'colorcustom.rgb.red.description': 'Red component',\n    'colorcustom.rgb.green.label': 'G',\n    'colorcustom.rgb.green.description': 'Green component',\n    'colorcustom.rgb.blue.label': 'B',\n    'colorcustom.rgb.blue.description': 'Blue component',\n    'colorcustom.rgb.hex.label': '#',\n    'colorcustom.rgb.hex.description': 'Hex color code',\n    'colorcustom.rgb.range': 'Range 0 to 255',\n    'colorcustom.sb.saturation': 'Saturation',\n    'colorcustom.sb.brightness': 'Brightness',\n    'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n    'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n    'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n    'colorcustom.hue.hue': 'Hue',\n    'colorcustom.hue.slider': 'Hue Slider',\n    'colorcustom.hue.palette': 'Hue Palette',\n    'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n    'aria.color.picker': 'Color Picker',\n    'aria.input.invalid': 'Invalid input'\n  };\n\n  var getEnglishText = function (key) {\n    return english[key];\n  };\n\n  var translate$1 = function (key) {\n    return getEnglishText(key);\n  };\n\n  var renderColorPicker = function (_spec) {\n    var getClass = function (key) {\n      return 'tox-' + key;\n    };\n\n    var colourPickerFactory = makeFactory(translate$1, getClass);\n\n    var onValidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: true\n      });\n    };\n\n    var onInvalidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: false\n      });\n    };\n\n    var memPicker = record(colourPickerFactory.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('color-picker-container')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      onValidHex: onValidHex,\n      onInvalidHex: onInvalidHex\n    }));\n    return {\n      dom: {\n        tag: 'div'\n      },\n      components: [memPicker.asSpec()],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            var optHex = optRgbForm.bind(function (rgbForm) {\n              var formValues = Representing.getValue(rgbForm);\n              return formValues.hex;\n            });\n            return optHex.map(function (hex) {\n              return '#' + hex;\n            }).getOr('');\n          },\n          setValue: function (comp, newValue) {\n            var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n            var m = pattern.exec(newValue);\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            optRgbForm.fold(function () {\n              console.log('Can not find form');\n            }, function (rgbForm) {\n              Representing.setValue(rgbForm, {\n                hex: Optional.from(m[1]).getOr('')\n              });\n              Form.getField(rgbForm, 'hex').each(function (hexField) {\n                emit(hexField, input());\n              });\n            });\n          }\n        }\n      }), ComposingConfigs.self()])\n    };\n  };\n\n  var global$a = tinymce.util.Tools.resolve('tinymce.Resource');\n\n  var isOldCustomEditor = function (spec) {\n    return Object.prototype.hasOwnProperty.call(spec, 'init');\n  };\n\n  var renderCustomEditor = function (spec) {\n    var editorApi = Cell(Optional.none());\n    var memReplaced = record({\n      dom: {\n        tag: spec.tag\n      }\n    });\n    var initialValue = Cell(Optional.none());\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-custom-editor']\n      },\n      behaviours: derive$1([config('custom-editor-events', [runOnAttached(function (component) {\n        memReplaced.getOpt(component).each(function (ta) {\n          (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$a.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n            return init(ta.element.dom, spec.settings);\n          })).then(function (ea) {\n            initialValue.get().each(function (cvalue) {\n              ea.setValue(cvalue);\n            });\n            initialValue.set(Optional.none());\n            editorApi.set(Optional.some(ea));\n          });\n        });\n      })]), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return editorApi.get().fold(function () {\n              return initialValue.get().getOr('');\n            }, function (ed) {\n              return ed.getValue();\n            });\n          },\n          setValue: function (component, value) {\n            editorApi.get().fold(function () {\n              initialValue.set(Optional.some(value));\n            }, function (ed) {\n              return ed.setValue(value);\n            });\n          }\n        }\n      }), ComposingConfigs.self()]),\n      components: [memReplaced.asSpec()]\n    };\n  };\n\n  var processors = objOf([defaulted$1('preprocess', identity), defaulted$1('postprocess', identity)]);\n\n  var memento$1 = function (mem, rawProcessors) {\n    var ps = asRawOrDie('RepresentingConfigs.memento processors', processors, rawProcessors);\n    return Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var other = mem.get(comp);\n          var rawValue = Representing.getValue(other);\n          return ps.postprocess(rawValue);\n        },\n        setValue: function (comp, rawValue) {\n          var newValue = ps.preprocess(rawValue);\n          var other = mem.get(comp);\n          Representing.setValue(other, newValue);\n        }\n      }\n    });\n  };\n\n  var withComp = function (optInitialValue, getter, setter) {\n    return Representing.config(deepMerge({\n      store: {\n        mode: 'manual',\n        getValue: getter,\n        setValue: setter\n      }\n    }, optInitialValue.map(function (initialValue) {\n      return {\n        store: {\n          initialValue: initialValue\n        }\n      };\n    }).getOr({})));\n  };\n\n  var withElement = function (initialValue, getter, setter) {\n    return withComp(initialValue, function (c) {\n      return getter(c.element);\n    }, function (c, v) {\n      return setter(c.element, v);\n    });\n  };\n\n  var domValue = function (optInitialValue) {\n    return withElement(optInitialValue, get$5, set$3);\n  };\n\n  var domHtml = function (optInitialValue) {\n    return withElement(optInitialValue, get$1, set);\n  };\n\n  var memory$1 = function (initialValue) {\n    return Representing.config({\n      store: {\n        mode: 'memory',\n        initialValue: initialValue\n      }\n    });\n  };\n\n  var RepresentingConfigs = {\n    memento: memento$1,\n    withElement: withElement,\n    withComp: withComp,\n    domValue: domValue,\n    domHtml: domHtml,\n    memory: memory$1\n  };\n  var extensionsAccepted = '.jpg,.jpeg,.png,.gif';\n\n  var filterByExtension = function (files) {\n    var re = new RegExp('(' + extensionsAccepted.split(/\\s*,\\s*/).join('|') + ')$', 'i');\n    return filter(from$1(files), function (file) {\n      return re.test(file.name);\n    });\n  };\n\n  var renderDropZone = function (spec, providersBackstage) {\n    var stopper = function (_, se) {\n      se.stop();\n    };\n\n    var sequence = function (actions) {\n      return function (comp, se) {\n        each(actions, function (a) {\n          a(comp, se);\n        });\n      };\n    };\n\n    var onDrop = function (comp, se) {\n      if (!Disabling.isDisabled(comp)) {\n        var transferEvent = se.event.raw;\n        handleFiles(comp, transferEvent.dataTransfer.files);\n      }\n    };\n\n    var onSelect = function (component, simulatedEvent) {\n      var input = simulatedEvent.event.raw.target;\n      handleFiles(component, input.files);\n    };\n\n    var handleFiles = function (component, files) {\n      Representing.setValue(component, filterByExtension(files));\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    };\n\n    var memInput = record({\n      dom: {\n        tag: 'input',\n        attributes: {\n          type: 'file',\n          accept: 'image/*'\n        },\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([config('input-file-events', [cutter(click()), cutter(tap())])])\n    });\n\n    var renderField = function (s) {\n      return {\n        uid: s.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dropzone-container']\n        },\n        behaviours: derive$1([RepresentingConfigs.memory([]), ComposingConfigs.self(), Disabling.config({}), Toggling.config({\n          toggleClass: 'dragenter',\n          toggleOnExecute: false\n        }), config('dropzone-events', [run('dragenter', sequence([stopper, Toggling.toggle])), run('dragleave', sequence([stopper, Toggling.toggle])), run('dragover', stopper), run('drop', sequence([stopper, onDrop])), run(change(), onSelect)])]),\n        components: [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone'],\n            styles: {}\n          },\n          components: [{\n            dom: {\n              tag: 'p',\n              innerHtml: providersBackstage.translate('Drop an image here')\n            }\n          }, Button.sketch({\n            dom: {\n              tag: 'button',\n              innerHtml: providersBackstage.translate('Browse for an image'),\n              styles: {\n                position: 'relative'\n              },\n              classes: ['tox-button', 'tox-button--secondary']\n            },\n            components: [memInput.asSpec()],\n            action: function (comp) {\n              var inputComp = memInput.get(comp);\n              inputComp.element.dom.click();\n            },\n            buttonBehaviours: derive$1([Tabstopping.config({}), DisablingConfigs.button(providersBackstage.isReadOnly), receivingConfig()])\n          })]\n        }]\n      };\n    };\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: renderField\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  var renderGrid = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__grid', 'tox-form__grid--' + spec.columns + 'col']\n      },\n      components: map(spec.items, backstage.interpreter)\n    };\n  };\n\n  var beforeObject = generate$1('alloy-fake-before-tabstop');\n  var afterObject = generate$1('alloy-fake-after-tabstop');\n\n  var craftWithClasses = function (classes) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          width: '1px',\n          height: '1px',\n          outline: 'none'\n        },\n        attributes: {\n          tabindex: '0'\n        },\n        classes: classes\n      },\n      behaviours: derive$1([Focusing.config({\n        ignore: true\n      }), Tabstopping.config({})])\n    };\n  };\n\n  var craft = function (spec) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-navobj']\n      },\n      components: [craftWithClasses([beforeObject]), spec, craftWithClasses([afterObject])],\n      behaviours: derive$1([ComposingConfigs.childAt(1)])\n    };\n  };\n\n  var triggerTab = function (placeholder, shiftKey) {\n    emitWith(placeholder, keydown(), {\n      raw: {\n        which: 9,\n        shiftKey: shiftKey\n      }\n    });\n  };\n\n  var onFocus$1 = function (container, targetComp) {\n    var target = targetComp.element;\n\n    if (has$2(target, beforeObject)) {\n      triggerTab(container, true);\n    } else if (has$2(target, afterObject)) {\n      triggerTab(container, false);\n    }\n  };\n\n  var isPseudoStop = function (element) {\n    return closest$4(element, ['.' + beforeObject, '.' + afterObject].join(','), never);\n  };\n\n  var platformNeedsSandboxing = !(detect$3().browser.isIE() || detect$3().browser.isEdge());\n\n  var getDynamicSource = function (isSandbox) {\n    var cachedValue = Cell('');\n    return {\n      getValue: function (_frameComponent) {\n        return cachedValue.get();\n      },\n      setValue: function (frameComponent, html) {\n        if (!isSandbox) {\n          set$1(frameComponent.element, 'src', 'javascript:\\'\\'');\n          var doc = frameComponent.element.dom.contentWindow.document;\n          doc.open();\n          doc.write(html);\n          doc.close();\n        } else {\n          set$1(frameComponent.element, 'srcdoc', html);\n        }\n\n        cachedValue.set(html);\n      }\n    };\n  };\n\n  var renderIFrame = function (spec, providersBackstage) {\n    var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n\n    var attributes = __assign(__assign({}, spec.label.map(function (title) {\n      return {\n        title: title\n      };\n    }).getOr({})), isSandbox ? {\n      sandbox: 'allow-scripts allow-same-origin'\n    } : {});\n\n    var sourcing = getDynamicSource(isSandbox);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var factory = function (newSpec) {\n      return craft({\n        uid: newSpec.uid,\n        dom: {\n          tag: 'iframe',\n          attributes: attributes\n        },\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)])\n      });\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: factory\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  function create$5(width, height) {\n    return resize(document.createElement('canvas'), width, height);\n  }\n\n  function clone$1(canvas) {\n    var tCanvas = create$5(canvas.width, canvas.height);\n    var ctx = get2dContext(tCanvas);\n    ctx.drawImage(canvas, 0, 0);\n    return tCanvas;\n  }\n\n  function get2dContext(canvas) {\n    return canvas.getContext('2d');\n  }\n\n  function resize(canvas, width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  }\n\n  function getWidth(image) {\n    return image.naturalWidth || image.width;\n  }\n\n  function getHeight(image) {\n    return image.naturalHeight || image.height;\n  }\n\n  var promise = function () {\n    var Promise = function (fn) {\n      if (typeof this !== 'object') {\n        throw new TypeError('Promises must be constructed via new');\n      }\n\n      if (typeof fn !== 'function') {\n        throw new TypeError('not a function');\n      }\n\n      this._state = null;\n      this._value = null;\n      this._deferreds = [];\n      doResolve(fn, bind(resolve, this), bind(reject, this));\n    };\n\n    var anyWindow = window;\n\n    var asap = Promise.immediateFn || typeof anyWindow.setImmediate === 'function' && anyWindow.setImmediate || function (fn) {\n      setTimeout(fn, 1);\n    };\n\n    function bind(fn, thisArg) {\n      return function () {\n        return fn.apply(thisArg, arguments);\n      };\n    }\n\n    var isArray = Array.isArray || function (value) {\n      return Object.prototype.toString.call(value) === '[object Array]';\n    };\n\n    function handle(deferred) {\n      var me = this;\n\n      if (this._state === null) {\n        this._deferreds.push(deferred);\n\n        return;\n      }\n\n      asap(function () {\n        var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n\n        if (cb === null) {\n          (me._state ? deferred.resolve : deferred.reject)(me._value);\n          return;\n        }\n\n        var ret;\n\n        try {\n          ret = cb(me._value);\n        } catch (e) {\n          deferred.reject(e);\n          return;\n        }\n\n        deferred.resolve(ret);\n      });\n    }\n\n    function resolve(newValue) {\n      try {\n        if (newValue === this) {\n          throw new TypeError('A promise cannot be resolved with itself.');\n        }\n\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n          var then = newValue.then;\n\n          if (typeof then === 'function') {\n            doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n            return;\n          }\n        }\n\n        this._state = true;\n        this._value = newValue;\n        finale.call(this);\n      } catch (e) {\n        reject.call(this, e);\n      }\n    }\n\n    function reject(newValue) {\n      this._state = false;\n      this._value = newValue;\n      finale.call(this);\n    }\n\n    function finale() {\n      for (var _i = 0, _a = this._deferreds; _i < _a.length; _i++) {\n        var deferred = _a[_i];\n        handle.call(this, deferred);\n      }\n\n      this._deferreds = [];\n    }\n\n    function Handler(onFulfilled, onRejected, resolve, reject) {\n      this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n      this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n      this.resolve = resolve;\n      this.reject = reject;\n    }\n\n    function doResolve(fn, onFulfilled, onRejected) {\n      var done = false;\n\n      try {\n        fn(function (value) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onFulfilled(value);\n        }, function (reason) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onRejected(reason);\n        });\n      } catch (ex) {\n        if (done) {\n          return;\n        }\n\n        done = true;\n        onRejected(ex);\n      }\n    }\n\n    Promise.prototype.catch = function (onRejected) {\n      return this.then(null, onRejected);\n    };\n\n    Promise.prototype.then = function (onFulfilled, onRejected) {\n      var me = this;\n      return new Promise(function (resolve, reject) {\n        handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n      });\n    };\n\n    Promise.all = function () {\n      var values = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n      }\n\n      var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n      return new Promise(function (resolve, reject) {\n        if (args.length === 0) {\n          return resolve([]);\n        }\n\n        var remaining = args.length;\n\n        function res(i, val) {\n          try {\n            if (val && (typeof val === 'object' || typeof val === 'function')) {\n              var then = val.then;\n\n              if (typeof then === 'function') {\n                then.call(val, function (val) {\n                  res(i, val);\n                }, reject);\n                return;\n              }\n            }\n\n            args[i] = val;\n\n            if (--remaining === 0) {\n              resolve(args);\n            }\n          } catch (ex) {\n            reject(ex);\n          }\n        }\n\n        for (var i = 0; i < args.length; i++) {\n          res(i, args[i]);\n        }\n      });\n    };\n\n    Promise.resolve = function (value) {\n      if (value && typeof value === 'object' && value.constructor === Promise) {\n        return value;\n      }\n\n      return new Promise(function (resolve) {\n        resolve(value);\n      });\n    };\n\n    Promise.reject = function (reason) {\n      return new Promise(function (resolve, reject) {\n        reject(reason);\n      });\n    };\n\n    Promise.race = function (values) {\n      return new Promise(function (resolve, reject) {\n        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n          var value = values_1[_i];\n          value.then(resolve, reject);\n        }\n      });\n    };\n\n    return Promise;\n  };\n\n  var Promise$1 = window.Promise ? window.Promise : promise();\n\n  function blobToImage(blob) {\n    return new Promise$1(function (resolve, reject) {\n      var blobUrl = URL.createObjectURL(blob);\n      var image = new Image();\n\n      var removeListeners = function () {\n        image.removeEventListener('load', loaded);\n        image.removeEventListener('error', error);\n      };\n\n      function loaded() {\n        removeListeners();\n        resolve(image);\n      }\n\n      function error() {\n        removeListeners();\n        reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n      }\n\n      image.addEventListener('load', loaded);\n      image.addEventListener('error', error);\n      image.src = blobUrl;\n\n      if (image.complete) {\n        loaded();\n      }\n    });\n  }\n\n  function dataUriToBlobSync(uri) {\n    var data = uri.split(',');\n    var matches = /data:([^;]+)/.exec(data[0]);\n\n    if (!matches) {\n      return Optional.none();\n    }\n\n    var mimetype = matches[1];\n    var base64 = data[1];\n    var sliceSize = 1024;\n    var byteCharacters = atob(base64);\n    var bytesLength = byteCharacters.length;\n    var slicesCount = Math.ceil(bytesLength / sliceSize);\n    var byteArrays = new Array(slicesCount);\n\n    for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n      var begin = sliceIndex * sliceSize;\n      var end = Math.min(begin + sliceSize, bytesLength);\n      var bytes = new Array(end - begin);\n\n      for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n        bytes[i] = byteCharacters[offset].charCodeAt(0);\n      }\n\n      byteArrays[sliceIndex] = new Uint8Array(bytes);\n    }\n\n    return Optional.some(new Blob(byteArrays, {\n      type: mimetype\n    }));\n  }\n\n  function dataUriToBlob(uri) {\n    return new Promise$1(function (resolve, reject) {\n      dataUriToBlobSync(uri).fold(function () {\n        reject('uri is not base64: ' + uri);\n      }, resolve);\n    });\n  }\n\n  function canvasToBlob(canvas, type, quality) {\n    type = type || 'image/png';\n\n    if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n      return new Promise$1(function (resolve, reject) {\n        canvas.toBlob(function (blob) {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject();\n          }\n        }, type, quality);\n      });\n    } else {\n      return dataUriToBlob(canvas.toDataURL(type, quality));\n    }\n  }\n\n  function canvasToDataURL(canvas, type, quality) {\n    type = type || 'image/png';\n    return canvas.toDataURL(type, quality);\n  }\n\n  function blobToCanvas(blob) {\n    return blobToImage(blob).then(function (image) {\n      revokeImageUrl(image);\n      var canvas = create$5(getWidth(image), getHeight(image));\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0);\n      return canvas;\n    });\n  }\n\n  function blobToDataUri(blob) {\n    return new Promise$1(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  function revokeImageUrl(image) {\n    URL.revokeObjectURL(image.src);\n  }\n\n  function create$6(getCanvas, blob, uri) {\n    var initialType = blob.type;\n    var getType = constant(initialType);\n\n    function toBlob() {\n      return Promise$1.resolve(blob);\n    }\n\n    var toDataURL = constant(uri);\n\n    function toBase64() {\n      return uri.split(',')[1];\n    }\n\n    function toAdjustedBlob(type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToBlob(canvas, type, quality);\n      });\n    }\n\n    function toAdjustedDataURL(type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToDataURL(canvas, type, quality);\n      });\n    }\n\n    function toAdjustedBase64(type, quality) {\n      return toAdjustedDataURL(type, quality).then(function (dataurl) {\n        return dataurl.split(',')[1];\n      });\n    }\n\n    function toCanvas() {\n      return getCanvas.then(clone$1);\n    }\n\n    return {\n      getType: getType,\n      toBlob: toBlob,\n      toDataURL: toDataURL,\n      toBase64: toBase64,\n      toAdjustedBlob: toAdjustedBlob,\n      toAdjustedDataURL: toAdjustedDataURL,\n      toAdjustedBase64: toAdjustedBase64,\n      toCanvas: toCanvas\n    };\n  }\n\n  function fromBlob(blob) {\n    return blobToDataUri(blob).then(function (uri) {\n      return create$6(blobToCanvas(blob), blob, uri);\n    });\n  }\n\n  function fromCanvas(canvas, type) {\n    return canvasToBlob(canvas, type).then(function (blob) {\n      return create$6(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n    });\n  }\n\n  var blobToImageResult = function (blob) {\n    return fromBlob(blob);\n  };\n\n  function clamp$1(value, min, max) {\n    var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n\n    if (parsedValue > max) {\n      parsedValue = max;\n    } else if (parsedValue < min) {\n      parsedValue = min;\n    }\n\n    return parsedValue;\n  }\n\n  function identity$1() {\n    return [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n  }\n\n  var DELTA_INDEX = [0, 0.01, 0.02, 0.04, 0.05, 0.06, 0.07, 0.08, 0.1, 0.11, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18, 0.2, 0.21, 0.22, 0.24, 0.25, 0.27, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5, 0.53, 0.56, 0.59, 0.62, 0.65, 0.68, 0.71, 0.74, 0.77, 0.8, 0.83, 0.86, 0.89, 0.92, 0.95, 0.98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10];\n\n  function multiply(matrix1, matrix2) {\n    var col = [];\n    var out = new Array(25);\n    var val;\n\n    for (var i = 0; i < 5; i++) {\n      for (var j = 0; j < 5; j++) {\n        col[j] = matrix2[j + i * 5];\n      }\n\n      for (var j = 0; j < 5; j++) {\n        val = 0;\n\n        for (var k = 0; k < 5; k++) {\n          val += matrix1[j + k * 5] * col[k];\n        }\n\n        out[j + i * 5] = val;\n      }\n    }\n\n    return out;\n  }\n\n  function adjustContrast(matrix, value) {\n    var x;\n    value = clamp$1(value, -1, 1);\n    value *= 100;\n\n    if (value < 0) {\n      x = 127 + value / 100 * 127;\n    } else {\n      x = value % 1;\n\n      if (x === 0) {\n        x = DELTA_INDEX[value];\n      } else {\n        x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n      }\n\n      x = x * 127 + 127;\n    }\n\n    return multiply(matrix, [x / 127, 0, 0, 0, 0.5 * (127 - x), 0, x / 127, 0, 0, 0.5 * (127 - x), 0, 0, x / 127, 0, 0.5 * (127 - x), 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  }\n\n  function adjustBrightness(matrix, value) {\n    value = clamp$1(255 * value, -255, 255);\n    return multiply(matrix, [1, 0, 0, 0, value, 0, 1, 0, 0, value, 0, 0, 1, 0, value, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  }\n\n  function adjustColors(matrix, adjustR, adjustG, adjustB) {\n    adjustR = clamp$1(adjustR, 0, 2);\n    adjustG = clamp$1(adjustG, 0, 2);\n    adjustB = clamp$1(adjustB, 0, 2);\n    return multiply(matrix, [adjustR, 0, 0, 0, 0, 0, adjustG, 0, 0, 0, 0, 0, adjustB, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  }\n\n  function colorFilter(ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyColorFilter(canvas, ir.getType(), matrix);\n    });\n  }\n\n  function applyColorFilter(canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    function applyMatrix(pixelsData, m) {\n      var r, g, b, a;\n      var data = pixelsData.data,\n          m0 = m[0],\n          m1 = m[1],\n          m2 = m[2],\n          m3 = m[3],\n          m4 = m[4],\n          m5 = m[5],\n          m6 = m[6],\n          m7 = m[7],\n          m8 = m[8],\n          m9 = m[9],\n          m10 = m[10],\n          m11 = m[11],\n          m12 = m[12],\n          m13 = m[13],\n          m14 = m[14],\n          m15 = m[15],\n          m16 = m[16],\n          m17 = m[17],\n          m18 = m[18],\n          m19 = m[19];\n\n      for (var i = 0; i < data.length; i += 4) {\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n        data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n        data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n        data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n        data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n      }\n\n      return pixelsData;\n    }\n\n    var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n    context.putImageData(pixels, 0, 0);\n    return fromCanvas(canvas, type);\n  }\n\n  function convoluteFilter(ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyConvoluteFilter(canvas, ir.getType(), matrix);\n    });\n  }\n\n  function applyConvoluteFilter(canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    function applyMatrix(pIn, pOut, aMatrix) {\n      function clamp(value, min, max) {\n        if (value > max) {\n          value = max;\n        } else if (value < min) {\n          value = min;\n        }\n\n        return value;\n      }\n\n      var side = Math.round(Math.sqrt(aMatrix.length));\n      var halfSide = Math.floor(side / 2);\n      var rgba = pIn.data;\n      var drgba = pOut.data;\n      var w = pIn.width;\n      var h = pIn.height;\n\n      for (var y = 0; y < h; y++) {\n        for (var x = 0; x < w; x++) {\n          var r = 0;\n          var g = 0;\n          var b = 0;\n\n          for (var cy = 0; cy < side; cy++) {\n            for (var cx = 0; cx < side; cx++) {\n              var scx = clamp(x + cx - halfSide, 0, w - 1);\n              var scy = clamp(y + cy - halfSide, 0, h - 1);\n              var innerOffset = (scy * w + scx) * 4;\n              var wt = aMatrix[cy * side + cx];\n              r += rgba[innerOffset] * wt;\n              g += rgba[innerOffset + 1] * wt;\n              b += rgba[innerOffset + 2] * wt;\n            }\n          }\n\n          var offset = (y * w + x) * 4;\n          drgba[offset] = clamp(r, 0, 255);\n          drgba[offset + 1] = clamp(g, 0, 255);\n          drgba[offset + 2] = clamp(b, 0, 255);\n        }\n      }\n\n      return pOut;\n    }\n\n    var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n    var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n    pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n    context.putImageData(pixelsOut, 0, 0);\n    return fromCanvas(canvas, type);\n  }\n\n  function functionColorFilter(colorFn) {\n    var filterImpl = function (canvas, type, value) {\n      var context = get2dContext(canvas);\n      var lookup = new Array(256);\n\n      function applyLookup(pixelsData, lookupData) {\n        var data = pixelsData.data;\n\n        for (var i = 0; i < data.length; i += 4) {\n          data[i] = lookupData[data[i]];\n          data[i + 1] = lookupData[data[i + 1]];\n          data[i + 2] = lookupData[data[i + 2]];\n        }\n\n        return pixelsData;\n      }\n\n      for (var i = 0; i < lookup.length; i++) {\n        lookup[i] = colorFn(i, value);\n      }\n\n      var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n\n    return function (ir, value) {\n      return ir.toCanvas().then(function (canvas) {\n        return filterImpl(canvas, ir.getType(), value);\n      });\n    };\n  }\n\n  function complexAdjustableColorFilter(matrixAdjustFn) {\n    return function (ir, adjust) {\n      return colorFilter(ir, matrixAdjustFn(identity$1(), adjust));\n    };\n  }\n\n  function basicColorFilter(matrix) {\n    return function (ir) {\n      return colorFilter(ir, matrix);\n    };\n  }\n\n  function basicConvolutionFilter(kernel) {\n    return function (ir) {\n      return convoluteFilter(ir, kernel);\n    };\n  }\n\n  var invert = basicColorFilter([-1, 0, 0, 0, 255, 0, -1, 0, 0, 255, 0, 0, -1, 0, 255, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  var brightness = complexAdjustableColorFilter(adjustBrightness);\n  var contrast = complexAdjustableColorFilter(adjustContrast);\n\n  var colorize = function (ir, adjustR, adjustG, adjustB) {\n    return colorFilter(ir, adjustColors(identity$1(), adjustR, adjustG, adjustB));\n  };\n\n  var sharpen = basicConvolutionFilter([0, -1, 0, -1, 5, -1, 0, -1, 0]);\n  var gamma = functionColorFilter(function (color, value) {\n    return Math.pow(color / 255, 1 - value) * 255;\n  });\n\n  function scale(image, dW, dH) {\n    var sW = getWidth(image);\n    var sH = getHeight(image);\n    var wRatio = dW / sW;\n    var hRatio = dH / sH;\n    var scaleCapped = false;\n\n    if (wRatio < 0.5 || wRatio > 2) {\n      wRatio = wRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    if (hRatio < 0.5 || hRatio > 2) {\n      hRatio = hRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    var scaled = _scale(image, wRatio, hRatio);\n\n    return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n      return scale(tCanvas, dW, dH);\n    });\n  }\n\n  function _scale(image, wRatio, hRatio) {\n    return new Promise$1(function (resolve) {\n      var sW = getWidth(image);\n      var sH = getHeight(image);\n      var dW = Math.floor(sW * wRatio);\n      var dH = Math.floor(sH * hRatio);\n      var canvas = create$5(dW, dH);\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n      resolve(canvas);\n    });\n  }\n\n  function rotate(ir, angle) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyRotate(canvas, ir.getType(), angle);\n    });\n  }\n\n  function applyRotate(image, type, angle) {\n    var canvas = create$5(image.width, image.height);\n    var context = get2dContext(canvas);\n    var translateX = 0;\n    var translateY = 0;\n    angle = angle < 0 ? 360 + angle : angle;\n\n    if (angle === 90 || angle === 270) {\n      resize(canvas, canvas.height, canvas.width);\n    }\n\n    if (angle === 90 || angle === 180) {\n      translateX = canvas.width;\n    }\n\n    if (angle === 270 || angle === 180) {\n      translateY = canvas.height;\n    }\n\n    context.translate(translateX, translateY);\n    context.rotate(angle * Math.PI / 180);\n    context.drawImage(image, 0, 0);\n    return fromCanvas(canvas, type);\n  }\n\n  function flip(ir, axis) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyFlip(canvas, ir.getType(), axis);\n    });\n  }\n\n  function applyFlip(image, type, axis) {\n    var canvas = create$5(image.width, image.height);\n    var context = get2dContext(canvas);\n\n    if (axis === 'v') {\n      context.scale(1, -1);\n      context.drawImage(image, 0, -canvas.height);\n    } else {\n      context.scale(-1, 1);\n      context.drawImage(image, -canvas.width, 0);\n    }\n\n    return fromCanvas(canvas, type);\n  }\n\n  function crop(ir, x, y, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyCrop(canvas, ir.getType(), x, y, w, h);\n    });\n  }\n\n  function applyCrop(image, type, x, y, w, h) {\n    var canvas = create$5(w, h);\n    var context = get2dContext(canvas);\n    context.drawImage(image, -x, -y);\n    return fromCanvas(canvas, type);\n  }\n\n  function resize$1(ir, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return scale(canvas, w, h).then(function (newCanvas) {\n        return fromCanvas(newCanvas, ir.getType());\n      });\n    });\n  }\n\n  var invert$1 = function (ir) {\n    return invert(ir);\n  };\n\n  var sharpen$1 = function (ir) {\n    return sharpen(ir);\n  };\n\n  var gamma$1 = function (ir, value) {\n    return gamma(ir, value);\n  };\n\n  var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n    return colorize(ir, adjustR, adjustG, adjustB);\n  };\n\n  var brightness$1 = function (ir, adjust) {\n    return brightness(ir, adjust);\n  };\n\n  var contrast$1 = function (ir, adjust) {\n    return contrast(ir, adjust);\n  };\n\n  var flip$1 = function (ir, axis) {\n    return flip(ir, axis);\n  };\n\n  var crop$1 = function (ir, x, y, w, h) {\n    return crop(ir, x, y, w, h);\n  };\n\n  var resize$2 = function (ir, w, h) {\n    return resize$1(ir, w, h);\n  };\n\n  var rotate$1 = function (ir, angle) {\n    return rotate(ir, angle);\n  };\n\n  var renderIcon$1 = function (iconHtml, behaviours) {\n    return __assign({\n      dom: {\n        tag: 'span',\n        innerHtml: iconHtml,\n        classes: ['tox-icon', 'tox-tbtn__icon-wrap']\n      }\n    }, behaviours);\n  };\n\n  var renderIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon$1(get$d(iconName, iconsProvider), {});\n  };\n\n  var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon$1(get$d(iconName, iconsProvider), {\n      behaviours: derive$1([Replacing.config({})])\n    });\n  };\n\n  var renderLabel$1 = function (text, prefix, providersBackstage) {\n    return {\n      dom: {\n        tag: 'span',\n        innerHtml: providersBackstage.translate(text),\n        classes: [prefix + '__select-label']\n      },\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var _a$1;\n\n  var internalToolbarButtonExecute = generate$1('toolbar.button.execute');\n\n  var onToolbarButtonExecute = function (info) {\n    return runOnExecute(function (comp, _simulatedEvent) {\n      runWithApi(info, comp)(function (itemApi) {\n        emitWith(comp, internalToolbarButtonExecute, {\n          buttonApi: itemApi\n        });\n        info.onAction(itemApi);\n      });\n    });\n  };\n\n  var toolbarButtonEventOrder = (_a$1 = {}, _a$1[execute()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'toolbar-button-events'], _a$1);\n  var updateMenuText = generate$1('update-menu-text');\n  var updateMenuIcon = generate$1('update-menu-icon');\n\n  var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n    var editorOffCell = Cell(noop);\n    var optMemDisplayText = spec.text.map(function (text) {\n      return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n    });\n    var optMemDisplayIcon = spec.icon.map(function (iconName) {\n      return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n    });\n\n    var onLeftOrRightInMenu = function (comp, se) {\n      var dropdown = Representing.getValue(comp);\n      Focusing.focus(dropdown);\n      emitWith(dropdown, 'keydown', {\n        raw: se.event.raw\n      });\n      Dropdown.close(dropdown);\n      return Optional.some(true);\n    };\n\n    var role = spec.role.fold(function () {\n      return {};\n    }, function (role) {\n      return {\n        role: role\n      };\n    });\n    var tooltipAttributes = spec.tooltip.fold(function () {\n      return {};\n    }, function (tooltip) {\n      var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n      return {\n        'title': translatedTooltip,\n        'aria-label': translatedTooltip\n      };\n    });\n    var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? {\n      uid: spec.uid\n    } : {}), role), {\n      dom: {\n        tag: 'button',\n        classes: [prefix, prefix + '--select'].concat(map(spec.classes, function (c) {\n          return prefix + '--' + c;\n        })),\n        attributes: __assign({}, tooltipAttributes)\n      },\n      components: componentRenderPipeline([optMemDisplayIcon.map(function (mem) {\n        return mem.asSpec();\n      }), optMemDisplayText.map(function (mem) {\n        return mem.asSpec();\n      }), Optional.some({\n        dom: {\n          tag: 'div',\n          classes: [prefix + '__select-chevron'],\n          innerHtml: get$d('chevron-down', sharedBackstage.providers.icons)\n        }\n      })]),\n      matchWidth: true,\n      useMinWidth: true,\n      dropdownBehaviours: derive$1(__spreadArrays(spec.dropdownBehaviours, [DisablingConfigs.button(function () {\n        return spec.disabled || sharedBackstage.providers.isReadOnly();\n      }), receivingConfig(), Unselecting.config({}), Replacing.config({}), config('dropdown-events', [onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), config('menubutton-update-display-text', [run(updateMenuText, function (comp, se) {\n        optMemDisplayText.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayText) {\n          Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n        });\n      }), run(updateMenuIcon, function (comp, se) {\n        optMemDisplayIcon.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayIcon) {\n          Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n        });\n      })])])),\n      eventOrder: deepMerge(toolbarButtonEventOrder, {\n        mousedown: ['focusing', 'alloy.base.behaviour', 'item-type-events', 'normal-dropdown-events']\n      }),\n      sandboxBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onLeft: onLeftOrRightInMenu,\n        onRight: onLeftOrRightInMenu\n      })]),\n      lazySink: sharedBackstage.getSink,\n      toggleClass: prefix + '--active',\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      fetch: function (comp) {\n        return Future.nu(curry(spec.fetch, comp));\n      }\n    })));\n    return memDropdown.asSpec();\n  };\n\n  var isMenuItemReference = function (item) {\n    return isString(item);\n  };\n\n  var isSeparator = function (item) {\n    return item.type === 'separator';\n  };\n\n  var isExpandingMenuItem = function (item) {\n    return has(item, 'getSubmenuItems');\n  };\n\n  var separator$1 = {\n    type: 'separator'\n  };\n\n  var unwrapReferences = function (items, menuItems) {\n    var realItems = foldl(items, function (acc, item) {\n      if (isMenuItemReference(item)) {\n        if (item === '') {\n          return acc;\n        } else if (item === '|') {\n          return acc.length > 0 && !isSeparator(acc[acc.length - 1]) ? acc.concat([separator$1]) : acc;\n        } else if (has(menuItems, item.toLowerCase())) {\n          return acc.concat([menuItems[item.toLowerCase()]]);\n        } else {\n          return acc;\n        }\n      } else {\n        return acc.concat([item]);\n      }\n    }, []);\n\n    if (realItems.length > 0 && isSeparator(realItems[realItems.length - 1])) {\n      realItems.pop();\n    }\n\n    return realItems;\n  };\n\n  var getFromExpandingItem = function (item, menuItems) {\n    var submenuItems = item.getSubmenuItems();\n    var rest = expand(submenuItems, menuItems);\n    var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n    var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n    return {\n      item: item,\n      menus: newMenus,\n      expansions: newExpansions\n    };\n  };\n\n  var getFromItem = function (item, menuItems) {\n    return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n      item: item,\n      menus: {},\n      expansions: {}\n    };\n  };\n\n  var generateValueIfRequired = function (item) {\n    if (isSeparator(item)) {\n      return item;\n    } else {\n      var itemValue = get(item, 'value').getOrThunk(function () {\n        return generate$1('generated-menu-item');\n      });\n      return deepMerge({\n        value: itemValue\n      }, item);\n    }\n  };\n\n  var expand = function (items, menuItems) {\n    var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n    return foldr(realItems, function (acc, item) {\n      var itemWithValue = generateValueIfRequired(item);\n      var newData = getFromItem(itemWithValue, menuItems);\n      return {\n        menus: deepMerge(acc.menus, newData.menus),\n        items: [newData.item].concat(acc.items),\n        expansions: deepMerge(acc.expansions, newData.expansions)\n      };\n    }, {\n      menus: {},\n      expansions: {},\n      items: []\n    });\n  };\n\n  var build$2 = function (items, itemResponse, backstage, isHorizontalMenu) {\n    var primary = generate$1('primary-menu');\n    var data = expand(items, backstage.shared.providers.menuItems());\n\n    if (data.items.length === 0) {\n      return Optional.none();\n    }\n\n    var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n    var submenus = map$2(data.menus, function (menuItems, menuName) {\n      return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n    });\n    var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n    return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n  };\n\n  var getMenuButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      },\n      setActive: function (state) {\n        var elm = component.element;\n\n        if (state) {\n          add$2(elm, 'tox-tbtn--enabled');\n          set$1(elm, 'aria-pressed', true);\n        } else {\n          remove$4(elm, 'tox-tbtn--enabled');\n          remove$1(elm, 'aria-pressed');\n        }\n      },\n      isActive: function () {\n        return has$2(component.element, 'tox-tbtn--enabled');\n      }\n    };\n  };\n\n  var renderMenuButton = function (spec, prefix, backstage, role) {\n    return renderCommonDropdown({\n      text: spec.text,\n      icon: spec.icon,\n      tooltip: spec.tooltip,\n      role: role,\n      fetch: function (_comp, callback) {\n        spec.fetch(function (items) {\n          callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n        });\n      },\n      onSetup: spec.onSetup,\n      getApi: getMenuButtonApi,\n      columns: 1,\n      presets: 'normal',\n      classes: [],\n      dropdownBehaviours: [Tabstopping.config({})]\n    }, prefix, backstage.shared);\n  };\n\n  var getFetch$1 = function (items, getButton, backstage) {\n    var getMenuItemAction = function (item) {\n      return function (api) {\n        var newValue = !api.isActive();\n        api.setActive(newValue);\n        item.storage.set(newValue);\n        backstage.shared.getSink().each(function (sink) {\n          getButton().getOpt(sink).each(function (orig) {\n            focus$1(orig.element);\n            emitWith(orig, formActionEvent, {\n              name: item.name,\n              value: item.storage.get()\n            });\n          });\n        });\n      };\n    };\n\n    var getMenuItemSetup = function (item) {\n      return function (api) {\n        api.setActive(item.storage.get());\n      };\n    };\n\n    return function (success) {\n      success(map(items, function (item) {\n        var text = item.text.fold(function () {\n          return {};\n        }, function (text) {\n          return {\n            text: text\n          };\n        });\n        return __assign(__assign({\n          type: item.type,\n          active: false\n        }, text), {\n          onAction: getMenuItemAction(item),\n          onSetup: getMenuItemSetup(item)\n        });\n      }));\n    };\n  };\n\n  var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var action = actionOpt.fold(function () {\n      return {};\n    }, function (action) {\n      return {\n        action: action\n      };\n    });\n\n    var common = __assign({\n      buttonBehaviours: derive$1([DisablingConfigs.button(function () {\n        return spec.disabled || providersBackstage.isReadOnly();\n      }), receivingConfig(), Tabstopping.config({}), config('button press', [preventDefault('click'), preventDefault('mousedown')])].concat(extraBehaviours)),\n      eventOrder: {\n        click: ['button press', 'alloy.base.behaviour'],\n        mousedown: ['button press', 'alloy.base.behaviour']\n      }\n    }, action);\n\n    var domFinal = deepMerge(common, {\n      dom: dom\n    });\n    return deepMerge(domFinal, {\n      components: components\n    });\n  };\n\n  var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n    var dom = {\n      tag: 'button',\n      classes: ['tox-tbtn'],\n      attributes: tooltipAttributes\n    };\n    var icon = spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    });\n    var components = componentRenderPipeline([icon]);\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n    return Button.sketch(iconButtonSpec);\n  };\n\n  var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var translatedText = providersBackstage.translate(spec.text);\n    var icon = spec.icon ? spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    }) : Optional.none();\n    var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n    var innerHtml = icon.isSome() ? {} : {\n      innerHtml: translatedText\n    };\n\n    var classes = __spreadArrays(!spec.primary && !spec.borderless ? ['tox-button', 'tox-button--secondary'] : ['tox-button'], icon.isSome() ? ['tox-button--icon'] : [], spec.borderless ? ['tox-button--naked'] : [], extraClasses);\n\n    var dom = __assign(__assign({\n      tag: 'button',\n      classes: classes\n    }, innerHtml), {\n      attributes: {\n        title: translatedText\n      }\n    });\n\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n    return Button.sketch(buttonSpec);\n  };\n\n  var getAction = function (name, buttonType) {\n    return function (comp) {\n      if (buttonType === 'custom') {\n        emitWith(comp, formActionEvent, {\n          name: name,\n          value: {}\n        });\n      } else if (buttonType === 'submit') {\n        emit(comp, formSubmitEvent);\n      } else if (buttonType === 'cancel') {\n        emit(comp, formCancelEvent);\n      } else {\n        console.error('Unknown button type: ', buttonType);\n      }\n    };\n  };\n\n  var isMenuFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'menu';\n  };\n\n  var isNormalFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n  };\n\n  var renderFooterButton = function (spec, buttonType, backstage) {\n    if (isMenuFooterButtonSpec(spec, buttonType)) {\n      var getButton = function () {\n        return memButton_1;\n      };\n\n      var menuButtonSpec = spec;\n\n      var fixedSpec = __assign(__assign({}, spec), {\n        onSetup: function (api) {\n          api.setDisabled(spec.disabled);\n          return noop;\n        },\n        fetch: getFetch$1(menuButtonSpec.items, getButton, backstage)\n      });\n\n      var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n      return memButton_1.asSpec();\n    } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n      var action = getAction(spec.name, buttonType);\n\n      var buttonSpec = __assign(__assign({}, spec), {\n        borderless: false\n      });\n\n      return renderButton(buttonSpec, action, backstage.shared.providers, []);\n    } else {\n      console.error('Unknown footer button type: ', buttonType);\n    }\n  };\n\n  var renderDialogButton = function (spec, providersBackstage) {\n    var action = getAction(spec.name, 'custom');\n    return renderFormField(Optional.none(), FormField.parts.field(__assign({\n      factory: Button\n    }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [RepresentingConfigs.memory(''), ComposingConfigs.self()]))));\n  };\n\n  var schema$i = constant([defaulted$1('field1Name', 'field1'), defaulted$1('field2Name', 'field2'), onStrictHandler('onLockedChange'), markers(['lockClass']), defaulted$1('locked', false), SketchBehaviours.field('coupledFieldBehaviours', [Composing, Representing])]);\n\n  var getField = function (comp, detail, partName) {\n    return getPart(comp, detail, partName).bind(Composing.getCurrent);\n  };\n\n  var coupledPart = function (selfName, otherName) {\n    return required({\n      factory: FormField,\n      name: selfName,\n      overrides: function (detail) {\n        return {\n          fieldBehaviours: derive$1([config('coupled-input-behaviour', [run(input(), function (me) {\n            getField(me, detail, otherName).each(function (other) {\n              getPart(me, detail, 'lock').each(function (lock) {\n                if (Toggling.isOn(lock)) {\n                  detail.onLockedChange(me, other, lock);\n                }\n              });\n            });\n          })])])\n        };\n      }\n    });\n  };\n\n  var parts$5 = constant([coupledPart('field1', 'field2'), coupledPart('field2', 'field1'), required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'lock',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          selected: detail.locked,\n          toggleClass: detail.markers.lockClass,\n          aria: {\n            mode: 'pressed'\n          }\n        })])\n      };\n    }\n  })]);\n\n  var factory$7 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [Composing.config({\n        find: Optional.some\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var _a;\n\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n            return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n          },\n          setValue: function (comp, value) {\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n\n            if (hasNonNullableKey(value, detail.field1Name)) {\n              Representing.setValue(parts.field1(), value[detail.field1Name]);\n            }\n\n            if (hasNonNullableKey(value, detail.field2Name)) {\n              Representing.setValue(parts.field2(), value[detail.field2Name]);\n            }\n          }\n        }\n      })]),\n      apis: {\n        getField1: function (component) {\n          return getPart(component, detail, 'field1');\n        },\n        getField2: function (component) {\n          return getPart(component, detail, 'field2');\n        },\n        getLock: function (component) {\n          return getPart(component, detail, 'lock');\n        }\n      }\n    };\n  };\n\n  var FormCoupledInputs = composite$1({\n    name: 'FormCoupledInputs',\n    configFields: schema$i(),\n    partFields: parts$5(),\n    factory: factory$7,\n    apis: {\n      getField1: function (apis, component) {\n        return apis.getField1(component);\n      },\n      getField2: function (apis, component) {\n        return apis.getField2(component);\n      },\n      getLock: function (apis, component) {\n        return apis.getLock(component);\n      }\n    }\n  });\n\n  var formatSize = function (size) {\n    var unitDec = {\n      '': 0,\n      'px': 0,\n      'pt': 1,\n      'mm': 1,\n      'pc': 2,\n      'ex': 2,\n      'em': 2,\n      'ch': 2,\n      'rem': 2,\n      'cm': 3,\n      'in': 4,\n      '%': 4\n    };\n\n    var maxDecimal = function (unit) {\n      return unit in unitDec ? unitDec[unit] : 1;\n    };\n\n    var numText = size.value.toFixed(maxDecimal(size.unit));\n\n    if (numText.indexOf('.') !== -1) {\n      numText = numText.replace(/\\.?0*$/, '');\n    }\n\n    return numText + size.unit;\n  };\n\n  var parseSize = function (sizeText) {\n    var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n    var match = numPattern.exec(sizeText);\n\n    if (match !== null) {\n      var value = parseFloat(match[1]);\n      var unit = match[2];\n      return Result.value({\n        value: value,\n        unit: unit\n      });\n    } else {\n      return Result.error(sizeText);\n    }\n  };\n\n  var convertUnit = function (size, unit) {\n    var inInch = {\n      '': 96,\n      'px': 96,\n      'pt': 72,\n      'cm': 2.54,\n      'pc': 12,\n      'mm': 25.4,\n      'in': 1\n    };\n\n    var supported = function (u) {\n      return Object.prototype.hasOwnProperty.call(inInch, u);\n    };\n\n    if (size.unit === unit) {\n      return Optional.some(size.value);\n    } else if (supported(size.unit) && supported(unit)) {\n      if (inInch[size.unit] === inInch[unit]) {\n        return Optional.some(size.value);\n      } else {\n        return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var noSizeConversion = function (_input) {\n    return Optional.none();\n  };\n\n  var ratioSizeConversion = function (scale, unit) {\n    return function (size) {\n      return convertUnit(size, unit).map(function (value) {\n        return {\n          value: value * scale,\n          unit: unit\n        };\n      });\n    };\n  };\n\n  var makeRatioConverter = function (currentFieldText, otherFieldText) {\n    var cValue = parseSize(currentFieldText).toOptional();\n    var oValue = parseSize(otherFieldText).toOptional();\n    return lift2(cValue, oValue, function (cSize, oSize) {\n      return convertUnit(cSize, oSize.unit).map(function (val) {\n        return oSize.value / val;\n      }).map(function (r) {\n        return ratioSizeConversion(r, oSize.unit);\n      }).getOr(noSizeConversion);\n    }).getOr(noSizeConversion);\n  };\n\n  var renderSizeInput = function (spec, providersBackstage) {\n    var converter = noSizeConversion;\n    var ratioEvent = generate$1('ratio-event');\n    var pLock = FormCoupledInputs.parts.lock({\n      dom: {\n        tag: 'button',\n        classes: ['tox-lock', 'tox-button', 'tox-button--naked', 'tox-button--icon'],\n        attributes: {\n          title: providersBackstage.translate(spec.label.getOr('Constrain proportions'))\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-lock-icon__lock'],\n          innerHtml: get$d('lock', providersBackstage.icons)\n        }\n      }, {\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-lock-icon__unlock'],\n          innerHtml: get$d('unlock', providersBackstage.icons)\n        }\n      }],\n      buttonBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        }\n      }), receivingConfig(), Tabstopping.config({})])\n    });\n\n    var formGroup = function (components) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: components\n      };\n    };\n\n    var getFieldPart = function (isField1) {\n      return FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        inputBehaviours: derive$1([Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isReadOnly();\n          }\n        }), receivingConfig(), Tabstopping.config({}), config('size-input-events', [run(focusin(), function (component, _simulatedEvent) {\n          emitWith(component, ratioEvent, {\n            isField1: isField1\n          });\n        }), run(change(), function (component, _simulatedEvent) {\n          emitWith(component, formChangeEvent, {\n            name: spec.name\n          });\n        })])]),\n        selectOnFocus: false\n      });\n    };\n\n    var getLabel = function (label) {\n      return {\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      };\n    };\n\n    var widthField = FormCoupledInputs.parts.field1(formGroup([FormField.parts.label(getLabel('Width')), getFieldPart(true)]));\n    var heightField = FormCoupledInputs.parts.field2(formGroup([FormField.parts.label(getLabel('Height')), getFieldPart(false)]));\n    return FormCoupledInputs.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: [widthField, heightField, formGroup([getLabel('&nbsp;'), pLock])]\n      }],\n      field1Name: 'width',\n      field2Name: 'height',\n      locked: true,\n      markers: {\n        lockClass: 'tox-locked'\n      },\n      onLockedChange: function (current, other, _lock) {\n        parseSize(Representing.getValue(current)).each(function (size) {\n          converter(size).each(function (newSize) {\n            Representing.setValue(other, formatSize(newSize));\n          });\n        });\n      },\n      coupledFieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        },\n        onDisabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getLock(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getLock(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('size-input-events2', [run(ratioEvent, function (component, simulatedEvent) {\n        var isField1 = simulatedEvent.event.isField1;\n        var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n        var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n        var value1 = optCurrent.map(Representing.getValue).getOr('');\n        var value2 = optOther.map(Representing.getValue).getOr('');\n        converter = makeRatioConverter(value1, value2);\n      })])])\n    });\n  };\n\n  var undo = constant(generate$1('undo'));\n  var redo = constant(generate$1('redo'));\n  var zoom = constant(generate$1('zoom'));\n  var back = constant(generate$1('back'));\n  var apply = constant(generate$1('apply'));\n  var swap = constant(generate$1('swap'));\n  var transform = constant(generate$1('transform'));\n  var tempTransform = constant(generate$1('temp-transform'));\n  var transformApply = constant(generate$1('transform-apply'));\n  var internal = {\n    undo: undo,\n    redo: redo,\n    zoom: zoom,\n    back: back,\n    apply: apply,\n    swap: swap,\n    transform: transform,\n    tempTransform: tempTransform,\n    transformApply: transformApply\n  };\n  var saveState = constant('save-state');\n  var disable$1 = constant('disable');\n  var enable$1 = constant('enable');\n  var external$2 = {\n    formActionEvent: formActionEvent,\n    saveState: saveState,\n    disable: disable$1,\n    enable: enable$1\n  };\n\n  var renderEditPanel = function (imagePanel, providersBackstage) {\n    var createButton = function (text, action, disabled, primary) {\n      return record(renderButton({\n        name: text,\n        text: text,\n        disabled: disabled,\n        primary: primary,\n        icon: Optional.none(),\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var createIconButton = function (icon, tooltip, action, disabled) {\n      return record(renderIconButton({\n        name: icon,\n        icon: Optional.some(icon),\n        tooltip: Optional.some(tooltip),\n        disabled: disabled,\n        primary: false,\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var disableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.disable(component);\n        }\n      });\n    };\n\n    var enableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.enable(component);\n        }\n      });\n    };\n\n    var panelDom = {\n      tag: 'div',\n      classes: ['tox-image-tools__toolbar', 'tox-image-tools-edit-panel']\n    };\n    var noop$1 = noop;\n\n    var emit$1 = function (comp, event, data) {\n      emitWith(comp, event, data);\n    };\n\n    var emitDisable = function (component) {\n      return emit(component, external$2.disable());\n    };\n\n    var emitEnable = function (component) {\n      return emit(component, external$2.enable());\n    };\n\n    var emitTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var emitTempTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.tempTransform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var getBackSwap = function (anyInSystem) {\n      return function () {\n        memContainer.getOpt(anyInSystem).each(function (container) {\n          Replacing.set(container, [ButtonPanel]);\n        });\n      };\n    };\n\n    var emitTransformApply = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transformApply(), {\n        transform: transform,\n        swap: getBackSwap(comp)\n      });\n      emitEnable(comp);\n    };\n\n    var createBackButton = function () {\n      return createButton('Back', function (button) {\n        return emit$1(button, internal.back(), {\n          swap: getBackSwap(button)\n        });\n      }, false, false);\n    };\n\n    var createSpacer = function () {\n      return record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-spacer']\n        },\n        behaviours: derive$1([Disabling.config({})])\n      });\n    };\n\n    var createApplyButton = function () {\n      return createButton('Apply', function (button) {\n        return emit$1(button, internal.apply(), {\n          swap: getBackSwap(button)\n        });\n      }, true, true);\n    };\n\n    var makeCropTransform = function () {\n      return function (ir) {\n        var rect = imagePanel.getRect();\n        return crop$1(ir, rect.x, rect.y, rect.w, rect.h);\n      };\n    };\n\n    var cropPanelComponents = [createBackButton(), createSpacer(), createButton('Apply', function (button) {\n      var transform = makeCropTransform();\n      emitTransformApply(button, transform);\n      imagePanel.hideCrop();\n    }, false, true)];\n    var CropPanel = Container.sketch({\n      dom: panelDom,\n      components: cropPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(cropPanelComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(cropPanelComponents, comp);\n      })])])\n    });\n    var memSize = record(renderSizeInput({\n      name: 'size',\n      label: Optional.none(),\n      constrain: true,\n      disabled: false\n    }, providersBackstage));\n\n    var makeResizeTransform = function (width, height) {\n      return function (ir) {\n        return resize$2(ir, width, height);\n      };\n    };\n\n    var resizePanelComponents = [createBackButton(), createSpacer(), memSize, createSpacer(), createButton('Apply', function (button) {\n      memSize.getOpt(button).each(function (sizeInput) {\n        var value = Representing.getValue(sizeInput);\n        var width = parseInt(value.width, 10);\n        var height = parseInt(value.height, 10);\n        var transform = makeResizeTransform(width, height);\n        emitTransformApply(button, transform);\n      });\n    }, false, true)];\n    var ResizePanel = Container.sketch({\n      dom: panelDom,\n      components: resizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(resizePanelComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(resizePanelComponents, comp);\n      })])])\n    });\n\n    var makeValueTransform = function (transform, value) {\n      return function (ir) {\n        return transform(ir, value);\n      };\n    };\n\n    var horizontalFlip = makeValueTransform(flip$1, 'h');\n    var verticalFlip = makeValueTransform(flip$1, 'v');\n    var counterclockwiseRotate = makeValueTransform(rotate$1, -90);\n    var clockwiseRotate = makeValueTransform(rotate$1, 90);\n\n    var flipRotateOnAction = function (comp, operation) {\n      emitTempTransform(comp, operation);\n    };\n\n    var flipRotateComponents = [createBackButton(), createSpacer(), createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n      flipRotateOnAction(button, horizontalFlip);\n    }, false), createIconButton('flip-vertically', 'Flip vertically', function (button) {\n      flipRotateOnAction(button, verticalFlip);\n    }, false), createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n      flipRotateOnAction(button, counterclockwiseRotate);\n    }, false), createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n      flipRotateOnAction(button, clockwiseRotate);\n    }, false), createSpacer(), createApplyButton()];\n    var FlipRotatePanel = Container.sketch({\n      dom: panelDom,\n      components: flipRotateComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(flipRotateComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(flipRotateComponents, comp);\n      })])])\n    });\n\n    var makeSlider = function (label, onChoose, min, value, max) {\n      var labelPart = Slider.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__rail'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__handle'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      return record(Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider'],\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        model: {\n          mode: 'x',\n          minX: min,\n          maxX: max,\n          getInitialValue: constant({\n            x: value\n          })\n        },\n        components: [labelPart, spectrum, thumb],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChoose: onChoose\n      }));\n    };\n\n    var makeVariableSlider = function (label, transform, min, value, max) {\n      var onChoose = function (slider, _thumb, value) {\n        var valTransform = makeValueTransform(transform, value.x / 100);\n        emitTransform(slider, valTransform);\n      };\n\n      return makeSlider(label, onChoose, min, value, max);\n    };\n\n    var variableFilterPanelComponents = function (label, transform, min, value, max) {\n      return [createBackButton(), makeVariableSlider(label, transform, min, value, max), createApplyButton()];\n    };\n\n    var createVariableFilterPanel = function (label, transform, min, value, max) {\n      var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n      return Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [run(external$2.disable(), function (comp, _se) {\n          disableAllComponents(filterPanelComponents, comp);\n        }), run(external$2.enable(), function (comp, _se) {\n          enableAllComponents(filterPanelComponents, comp);\n        })])])\n      });\n    };\n\n    var filterPanelComponents = [createBackButton(), createSpacer(), createApplyButton()];\n    var FilterPanel = Container.sketch({\n      dom: panelDom,\n      components: filterPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var BrightnessPanel = createVariableFilterPanel('Brightness', brightness$1, -100, 0, 100);\n    var ContrastPanel = createVariableFilterPanel('Contrast', contrast$1, -100, 0, 100);\n    var GammaPanel = createVariableFilterPanel('Gamma', gamma$1, -100, 0, 100);\n\n    var makeColorTransform = function (red, green, blue) {\n      return function (ir) {\n        return colorize$1(ir, red, green, blue);\n      };\n    };\n\n    var makeColorSlider = function (label) {\n      var onChoose = function (slider, _thumb, _value) {\n        var redOpt = memRed.getOpt(slider);\n        var blueOpt = memBlue.getOpt(slider);\n        var greenOpt = memGreen.getOpt(slider);\n        redOpt.each(function (red) {\n          blueOpt.each(function (blue) {\n            greenOpt.each(function (green) {\n              var r = Representing.getValue(red).x / 100;\n              var g = Representing.getValue(green).x / 100;\n              var b = Representing.getValue(blue).x / 100;\n              var transform = makeColorTransform(r, g, b);\n              emitTransform(slider, transform);\n            });\n          });\n        });\n      };\n\n      return makeSlider(label, onChoose, 0, 100, 200);\n    };\n\n    var memRed = makeColorSlider('R');\n    var memGreen = makeColorSlider('G');\n    var memBlue = makeColorSlider('B');\n    var colorizePanelComponents = [createBackButton(), memRed, memGreen, memBlue, createApplyButton()];\n    var ColorizePanel = Container.sketch({\n      dom: panelDom,\n      components: colorizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n\n    var getTransformPanelEvent = function (panel, transform, update) {\n      return function (button) {\n        var swap = function () {\n          memContainer.getOpt(button).each(function (container) {\n            Replacing.set(container, [panel]);\n            update(container);\n          });\n        };\n\n        emit$1(button, internal.swap(), {\n          transform: transform,\n          swap: swap\n        });\n      };\n    };\n\n    var cropPanelUpdate = function (_anyInSystem) {\n      imagePanel.showCrop();\n    };\n\n    var resizePanelUpdate = function (anyInSystem) {\n      memSize.getOpt(anyInSystem).each(function (sizeInput) {\n        var measurements = imagePanel.getMeasurements();\n        var width = measurements.width;\n        var height = measurements.height;\n        Representing.setValue(sizeInput, {\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var sharpenTransform = Optional.some(sharpen$1);\n    var invertTransform = Optional.some(invert$1);\n    var buttonPanelComponents = [createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false), createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false), createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false), createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false), createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false), createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false), createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false), createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false), createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)];\n    var ButtonPanel = Container.sketch({\n      dom: panelDom,\n      components: buttonPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var container = Container.sketch({\n      dom: {\n        tag: 'div'\n      },\n      components: [ButtonPanel],\n      containerBehaviours: derive$1([Replacing.config({})])\n    });\n    var memContainer = record(container);\n\n    var getApplyButton = function (anyInSystem) {\n      return memContainer.getOpt(anyInSystem).map(function (container) {\n        var panel = container.components()[0];\n        return panel.components()[panel.components().length - 1];\n      });\n    };\n\n    return {\n      memContainer: memContainer,\n      getApplyButton: getApplyButton\n    };\n  };\n\n  var global$b = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n  var global$c = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n  var global$d = tinymce.util.Tools.resolve('tinymce.util.Observable');\n  var global$e = tinymce.util.Tools.resolve('tinymce.util.Tools');\n  var global$f = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  function getDocumentSize(doc) {\n    var max = Math.max;\n    var documentElement = doc.documentElement;\n    var body = doc.body;\n    var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n    var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n    var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n    var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n    var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n    var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n    return {\n      width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n      height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n    };\n  }\n\n  function updateWithTouchData(e) {\n    var keys, i;\n\n    if (e.changedTouches) {\n      keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n\n      for (i = 0; i < keys.length; i++) {\n        e[keys[i]] = e.changedTouches[0][keys[i]];\n      }\n    }\n  }\n\n  function DragHelper(id, settings) {\n    var $eventOverlay;\n    var doc = settings.document || document;\n    var downButton;\n    var startX, startY;\n    var handleElement = doc.getElementById(settings.handle || id);\n\n    var start = function (e) {\n      var docSize = getDocumentSize(doc);\n      var cursor;\n      updateWithTouchData(e);\n      e.preventDefault();\n      downButton = e.button;\n      var handleElm = handleElement;\n      startX = e.screenX;\n      startY = e.screenY;\n\n      if (window.getComputedStyle) {\n        cursor = window.getComputedStyle(handleElm, null).getPropertyValue('cursor');\n      } else {\n        cursor = handleElm.runtimeStyle.cursor;\n      }\n\n      $eventOverlay = global$c('<div></div>').css({\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: docSize.width,\n        height: docSize.height,\n        zIndex: 2147483647,\n        opacity: 0.0001,\n        cursor: cursor\n      }).appendTo(doc.body);\n      global$c(doc).on('mousemove touchmove', drag).on('mouseup touchend', stop);\n      settings.start(e);\n    };\n\n    var drag = function (e) {\n      updateWithTouchData(e);\n\n      if (e.button !== downButton) {\n        return stop(e);\n      }\n\n      e.deltaX = e.screenX - startX;\n      e.deltaY = e.screenY - startY;\n      e.preventDefault();\n      settings.drag(e);\n    };\n\n    var stop = function (e) {\n      updateWithTouchData(e);\n      global$c(doc).off('mousemove touchmove', drag).off('mouseup touchend', stop);\n      $eventOverlay.remove();\n\n      if (settings.stop) {\n        settings.stop(e);\n      }\n    };\n\n    this.destroy = function () {\n      global$c(handleElement).off();\n    };\n\n    global$c(handleElement).on('mousedown touchstart', start);\n  }\n\n  var count = 0;\n\n  var create$7 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n    var dragHelpers;\n    var prefix = 'tox-';\n    var id = prefix + 'crid-' + count++;\n    var handles = [{\n      name: 'move',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: 0,\n      deltaH: 0,\n      label: 'Crop Mask'\n    }, {\n      name: 'nw',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: -1,\n      deltaH: -1,\n      label: 'Top Left Crop Handle'\n    }, {\n      name: 'ne',\n      xMul: 1,\n      yMul: 0,\n      deltaX: 0,\n      deltaY: 1,\n      deltaW: 1,\n      deltaH: -1,\n      label: 'Top Right Crop Handle'\n    }, {\n      name: 'sw',\n      xMul: 0,\n      yMul: 1,\n      deltaX: 1,\n      deltaY: 0,\n      deltaW: -1,\n      deltaH: 1,\n      label: 'Bottom Left Crop Handle'\n    }, {\n      name: 'se',\n      xMul: 1,\n      yMul: 1,\n      deltaX: 0,\n      deltaY: 0,\n      deltaW: 1,\n      deltaH: 1,\n      label: 'Bottom Right Crop Handle'\n    }];\n    var blockers = ['top', 'right', 'bottom', 'left'];\n\n    var getAbsoluteRect = function (outerRect, relativeRect) {\n      return {\n        x: relativeRect.x + outerRect.x,\n        y: relativeRect.y + outerRect.y,\n        w: relativeRect.w,\n        h: relativeRect.h\n      };\n    };\n\n    var getRelativeRect = function (outerRect, innerRect) {\n      return {\n        x: innerRect.x - outerRect.x,\n        y: innerRect.y - outerRect.y,\n        w: innerRect.w,\n        h: innerRect.h\n      };\n    };\n\n    var getInnerRect = function () {\n      return getRelativeRect(clampRect, currentRect);\n    };\n\n    function moveRect(handle, startRect, deltaX, deltaY) {\n      var x, y, w, h, rect;\n      x = startRect.x;\n      y = startRect.y;\n      w = startRect.w;\n      h = startRect.h;\n      x += deltaX * handle.deltaX;\n      y += deltaY * handle.deltaY;\n      w += deltaX * handle.deltaW;\n      h += deltaY * handle.deltaH;\n\n      if (w < 20) {\n        w = 20;\n      }\n\n      if (h < 20) {\n        h = 20;\n      }\n\n      rect = currentRect = global$b.clamp({\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      }, clampRect, handle.name === 'move');\n      rect = getRelativeRect(clampRect, rect);\n      instance.fire('updateRect', {\n        rect: rect\n      });\n      setInnerRect(rect);\n    }\n\n    function render() {\n      function createDragHelper(handle) {\n        var startRect;\n        return new DragHelper(id, {\n          document: containerElm.ownerDocument,\n          handle: id + '-' + handle.name,\n          start: function () {\n            startRect = currentRect;\n          },\n          drag: function (e) {\n            moveRect(handle, startRect, e.deltaX, e.deltaY);\n          }\n        });\n      }\n\n      global$c('<div id=\"' + id + '\" class=\"' + prefix + 'croprect-container\"' + ' role=\"grid\" aria-dropeffect=\"execute\">').appendTo(containerElm);\n      global$e.each(blockers, function (blocker) {\n        global$c('#' + id, containerElm).append('<div id=\"' + id + '-' + blocker + '\"class=\"' + prefix + 'croprect-block\" style=\"display: none\" data-mce-bogus=\"all\">');\n      });\n      global$e.each(handles, function (handle) {\n        global$c('#' + id, containerElm).append('<div id=\"' + id + '-' + handle.name + '\" class=\"' + prefix + 'croprect-handle ' + prefix + 'croprect-handle-' + handle.name + '\"' + 'style=\"display: none\" data-mce-bogus=\"all\" role=\"gridcell\" tabindex=\"-1\"' + ' aria-label=\"' + handle.label + '\" aria-grabbed=\"false\" title=\"' + handle.label + '\">');\n      });\n      dragHelpers = global$e.map(handles, createDragHelper);\n      repaint(currentRect);\n      global$c(containerElm).on('focusin focusout', function (e) {\n        global$c(e.target).attr('aria-grabbed', e.type === 'focus' ? 'true' : 'false');\n      });\n      global$c(containerElm).on('keydown', function (e) {\n        var activeHandle;\n        global$e.each(handles, function (handle) {\n          if (e.target.id === id + '-' + handle.name) {\n            activeHandle = handle;\n            return false;\n          }\n        });\n\n        function moveAndBlock(evt, handle, startRect, deltaX, deltaY) {\n          evt.stopPropagation();\n          evt.preventDefault();\n          moveRect(activeHandle, startRect, deltaX, deltaY);\n        }\n\n        switch (e.keyCode) {\n          case global$f.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n\n          case global$f.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n\n          case global$f.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n\n          case global$f.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n\n          case global$f.ENTER:\n          case global$f.SPACEBAR:\n            e.preventDefault();\n            action();\n            break;\n        }\n      });\n    }\n\n    function toggleVisibility(state) {\n      var selectors = global$e.map(handles, function (handle) {\n        return '#' + id + '-' + handle.name;\n      }).concat(global$e.map(blockers, function (blocker) {\n        return '#' + id + '-' + blocker;\n      })).join(',');\n\n      if (state) {\n        global$c(selectors, containerElm).show();\n      } else {\n        global$c(selectors, containerElm).hide();\n      }\n    }\n\n    function repaint(rect) {\n      function updateElementRect(name, rect) {\n        if (rect.h < 0) {\n          rect.h = 0;\n        }\n\n        if (rect.w < 0) {\n          rect.w = 0;\n        }\n\n        global$c('#' + id + '-' + name, containerElm).css({\n          left: rect.x,\n          top: rect.y,\n          width: rect.w,\n          height: rect.h\n        });\n      }\n\n      global$e.each(handles, function (handle) {\n        global$c('#' + id + '-' + handle.name, containerElm).css({\n          left: rect.w * handle.xMul + rect.x,\n          top: rect.h * handle.yMul + rect.y\n        });\n      });\n      updateElementRect('top', {\n        x: viewPortRect.x,\n        y: viewPortRect.y,\n        w: viewPortRect.w,\n        h: rect.y - viewPortRect.y\n      });\n      updateElementRect('right', {\n        x: rect.x + rect.w,\n        y: rect.y,\n        w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('bottom', {\n        x: viewPortRect.x,\n        y: rect.y + rect.h,\n        w: viewPortRect.w,\n        h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n      });\n      updateElementRect('left', {\n        x: viewPortRect.x,\n        y: rect.y,\n        w: rect.x - viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('move', rect);\n    }\n\n    function setRect(rect) {\n      currentRect = rect;\n      repaint(currentRect);\n    }\n\n    function setViewPortRect(rect) {\n      viewPortRect = rect;\n      repaint(currentRect);\n    }\n\n    function setInnerRect(rect) {\n      setRect(getAbsoluteRect(clampRect, rect));\n    }\n\n    function setClampRect(rect) {\n      clampRect = rect;\n      repaint(currentRect);\n    }\n\n    function destroy() {\n      global$e.each(dragHelpers, function (helper) {\n        helper.destroy();\n      });\n      dragHelpers = [];\n    }\n\n    render();\n    var instance = global$e.extend({\n      toggleVisibility: toggleVisibility,\n      setClampRect: setClampRect,\n      setRect: setRect,\n      getInnerRect: getInnerRect,\n      setInnerRect: setInnerRect,\n      setViewPortRect: setViewPortRect,\n      destroy: destroy\n    }, global$d);\n    return instance;\n  };\n\n  var CropRect = {\n    create: create$7\n  };\n\n  var loadImage = function (image) {\n    return new global$4(function (resolve) {\n      var loaded = function () {\n        image.removeEventListener('load', loaded);\n        resolve(image);\n      };\n\n      if (image.complete) {\n        resolve(image);\n      } else {\n        image.addEventListener('load', loaded);\n      }\n    });\n  };\n\n  var renderImagePanel = function (initialUrl) {\n    var memBg = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image-bg'],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var zoomState = Cell(1);\n    var cropRect = Cell(Optional.none());\n    var rectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n    var viewRectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n\n    var repaintImg = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var zoom = zoomState.get();\n        var panelW = get$7(panel.element);\n        var panelH = get$6(panel.element);\n        var width = img.dom.naturalWidth * zoom;\n        var height = img.dom.naturalHeight * zoom;\n        var left = Math.max(0, panelW / 2 - width / 2);\n        var top = Math.max(0, panelH / 2 - height / 2);\n        var css = {\n          left: left.toString() + 'px',\n          top: top.toString() + 'px',\n          width: width.toString() + 'px',\n          height: height.toString() + 'px',\n          position: 'absolute'\n        };\n        setAll$1(img, css);\n        memBg.getOpt(panel).each(function (bg) {\n          setAll$1(bg.element, css);\n        });\n        cropRect.get().each(function (cRect) {\n          var rect = rectState.get();\n          cRect.setRect({\n            x: rect.x * zoom + left,\n            y: rect.y * zoom + top,\n            w: rect.w * zoom,\n            h: rect.h * zoom\n          });\n          cRect.setClampRect({\n            x: left,\n            y: top,\n            w: width,\n            h: height\n          });\n          cRect.setViewPortRect({\n            x: 0,\n            y: 0,\n            w: panelW,\n            h: panelH\n          });\n        });\n      });\n    };\n\n    var zoomFit = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var panelW = get$7(panel.element);\n        var panelH = get$6(panel.element);\n        var width = img.dom.naturalWidth;\n        var height = img.dom.naturalHeight;\n        var zoom = Math.min(panelW / width, panelH / height);\n\n        if (zoom >= 1) {\n          zoomState.set(1);\n        } else {\n          zoomState.set(zoom);\n        }\n      });\n    };\n\n    var updateSrc = function (anyInSystem, url) {\n      var img = SugarElement.fromTag('img');\n      set$1(img, 'src', url);\n      return loadImage(img.dom).then(function () {\n        return memContainer.getOpt(anyInSystem).map(function (panel) {\n          var aImg = external({\n            element: img\n          });\n          Replacing.replaceAt(panel, 1, Optional.some(aImg));\n          var lastViewRect = viewRectState.get();\n          var viewRect = {\n            x: 0,\n            y: 0,\n            w: img.dom.naturalWidth,\n            h: img.dom.naturalHeight\n          };\n          viewRectState.set(viewRect);\n          var rect = global$b.inflate(viewRect, -20, -20);\n          rectState.set(rect);\n\n          if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n            zoomFit(panel, img);\n          }\n\n          repaintImg(panel, img);\n          return img;\n        });\n      });\n    };\n\n    var zoom = function (anyInSystem, direction) {\n      var currentZoom = zoomState.get();\n      var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n      zoomState.set(newZoom);\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var img = panel.components()[1].element;\n        repaintImg(panel, img);\n      });\n    };\n\n    var showCrop = function () {\n      cropRect.get().each(function (cRect) {\n        cRect.toggleVisibility(true);\n      });\n    };\n\n    var hideCrop = function () {\n      cropRect.get().each(function (cRect) {\n        cRect.toggleVisibility(false);\n      });\n    };\n\n    var getRect = function () {\n      return rectState.get();\n    };\n\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image']\n      },\n      components: [memBg.asSpec(), {\n        dom: {\n          tag: 'img',\n          attributes: {\n            src: initialUrl\n          }\n        }\n      }, {\n        dom: {\n          tag: 'div'\n        },\n        behaviours: derive$1([config('image-panel-crop-events', [runOnAttached(function (comp) {\n          memContainer.getOpt(comp).each(function (container) {\n            var el = container.element.dom;\n            var cRect = CropRect.create({\n              x: 10,\n              y: 10,\n              w: 100,\n              h: 100\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, el, function () {});\n            cRect.toggleVisibility(false);\n            cRect.on('updateRect', function (e) {\n              var rect = e.rect;\n              var zoom = zoomState.get();\n              var newRect = {\n                x: Math.round(rect.x / zoom),\n                y: Math.round(rect.y / zoom),\n                w: Math.round(rect.w / zoom),\n                h: Math.round(rect.h / zoom)\n              };\n              rectState.set(newRect);\n            });\n            cropRect.set(Optional.some(cRect));\n          });\n        })])])\n      }],\n      containerBehaviours: derive$1([Replacing.config({}), config('image-panel-events', [runOnAttached(function (comp) {\n        updateSrc(comp, initialUrl);\n      })])])\n    });\n    var memContainer = record(container);\n\n    var getMeasurements = function () {\n      var viewRect = viewRectState.get();\n      return {\n        width: viewRect.w,\n        height: viewRect.h\n      };\n    };\n\n    return {\n      memContainer: memContainer,\n      updateSrc: updateSrc,\n      zoom: zoom,\n      showCrop: showCrop,\n      hideCrop: hideCrop,\n      getRect: getRect,\n      getMeasurements: getMeasurements\n    };\n  };\n\n  var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n    return renderIconButton({\n      name: innerHtml,\n      icon: Optional.some(icon),\n      disabled: disabled,\n      tooltip: Optional.some(innerHtml),\n      primary: false,\n      borderless: false\n    }, action, providersBackstage);\n  };\n\n  var setButtonEnabled = function (button, enabled) {\n    if (enabled) {\n      Disabling.enable(button);\n    } else {\n      Disabling.disable(button);\n    }\n  };\n\n  var renderSideBar = function (providersBackstage) {\n    var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n      memUndo.getOpt(anyInSystem).each(function (undo) {\n        setButtonEnabled(undo, undoEnabled);\n      });\n      memRedo.getOpt(anyInSystem).each(function (redo) {\n        setButtonEnabled(redo, redoEnabled);\n      });\n    };\n\n    var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n      emitWith(button, internal.undo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n      emitWith(button, internal.redo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__toolbar', 'tox-image-tools__sidebar']\n      },\n      components: [memUndo.asSpec(), memRedo.asSpec(), createButton('Zoom in', 'zoom-in', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: 1\n        });\n      }, providersBackstage), createButton('Zoom out', 'zoom-out', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: -1\n        });\n      }, providersBackstage)]\n    });\n    return {\n      container: container,\n      updateButtonUndoStates: updateButtonUndoStates\n    };\n  };\n\n  function UndoStack() {\n    var data = [];\n    var index = -1;\n\n    function add(state) {\n      var removed = data.splice(++index);\n      data.push(state);\n      return {\n        state: state,\n        removed: removed\n      };\n    }\n\n    function undo() {\n      if (canUndo()) {\n        return data[--index];\n      }\n    }\n\n    function redo() {\n      if (canRedo()) {\n        return data[++index];\n      }\n    }\n\n    function canUndo() {\n      return index > 0;\n    }\n\n    function canRedo() {\n      return index !== -1 && index < data.length - 1;\n    }\n\n    return {\n      data: data,\n      add: add,\n      undo: undo,\n      redo: redo,\n      canUndo: canUndo,\n      canRedo: canRedo\n    };\n  }\n\n  var makeState = function (initialState) {\n    var blobState = Cell(initialState);\n    var tempState = Cell(Optional.none());\n    var undoStack = UndoStack();\n    undoStack.add(initialState);\n\n    var getBlobState = function () {\n      return blobState.get();\n    };\n\n    var setBlobState = function (state) {\n      blobState.set(state);\n    };\n\n    var getTempState = function () {\n      return tempState.get().fold(function () {\n        return blobState.get();\n      }, function (temp) {\n        return temp;\n      });\n    };\n\n    var updateTempState = function (blob) {\n      var newTempState = createState(blob);\n      destroyTempState();\n      tempState.set(Optional.some(newTempState));\n      return newTempState.url;\n    };\n\n    var createState = function (blob) {\n      return {\n        blob: blob,\n        url: URL.createObjectURL(blob)\n      };\n    };\n\n    var destroyState = function (state) {\n      URL.revokeObjectURL(state.url);\n    };\n\n    var destroyStates = function (states) {\n      global$e.each(states, destroyState);\n    };\n\n    var destroyTempState = function () {\n      tempState.get().each(destroyState);\n      tempState.set(Optional.none());\n    };\n\n    var addBlobState = function (blob) {\n      var newState = createState(blob);\n      setBlobState(newState);\n      var removed = undoStack.add(newState).removed;\n      destroyStates(removed);\n      return newState.url;\n    };\n\n    var addTempState = function (blob) {\n      var newState = createState(blob);\n      tempState.set(Optional.some(newState));\n      return newState.url;\n    };\n\n    var applyTempState = function (postApply) {\n      return tempState.get().fold(function () {}, function (temp) {\n        addBlobState(temp.blob);\n        postApply();\n      });\n    };\n\n    var undo = function () {\n      var currentState = undoStack.undo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var redo = function () {\n      var currentState = undoStack.redo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var getHistoryStates = function () {\n      var undoEnabled = undoStack.canUndo();\n      var redoEnabled = undoStack.canRedo();\n      return {\n        undoEnabled: undoEnabled,\n        redoEnabled: redoEnabled\n      };\n    };\n\n    return {\n      getBlobState: getBlobState,\n      setBlobState: setBlobState,\n      addBlobState: addBlobState,\n      getTempState: getTempState,\n      updateTempState: updateTempState,\n      addTempState: addTempState,\n      applyTempState: applyTempState,\n      destroyTempState: destroyTempState,\n      undo: undo,\n      redo: redo,\n      getHistoryStates: getHistoryStates\n    };\n  };\n\n  var renderImageTools = function (detail, providersBackstage) {\n    var state = makeState(detail.currentState);\n\n    var zoom = function (anyInSystem, simulatedEvent) {\n      var direction = simulatedEvent.event.direction;\n      imagePanel.zoom(anyInSystem, direction);\n    };\n\n    var updateButtonUndoStates = function (anyInSystem) {\n      var historyStates = state.getHistoryStates();\n      sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.saveState(),\n        value: historyStates.undoEnabled\n      });\n    };\n\n    var disableUndoRedo = function (anyInSystem) {\n      sideBar.updateButtonUndoStates(anyInSystem, false, false);\n    };\n\n    var undo = function (anyInSystem, _simulatedEvent) {\n      var url = state.undo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var redo = function (anyInSystem, _simulatedEvent) {\n      var url = state.redo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var imageResultToBlob = function (ir) {\n      return ir.toBlob();\n    };\n\n    var block = function (anyInSystem) {\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.disable(),\n        value: {}\n      });\n    };\n\n    var unblock = function (anyInSystem) {\n      editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n        Disabling.enable(applyButton);\n      });\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.enable(),\n        value: {}\n      });\n    };\n\n    var updateSrc = function (anyInSystem, src) {\n      block(anyInSystem);\n      return imagePanel.updateSrc(anyInSystem, src);\n    };\n\n    var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n      block(anyInSystem);\n      return blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n        return updateSrc(anyInSystem, url).then(function (oImg) {\n          updateButtonUndoStates(anyInSystem);\n          swap();\n          unblock(anyInSystem);\n          return oImg;\n        });\n      }).catch(function (err) {\n        console.log(err);\n        unblock(anyInSystem);\n        return err;\n      });\n    };\n\n    var manipulate = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        return state.updateTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var tempManipulate = function (anyInSystem, filter) {\n      var blob = state.getTempState().blob;\n\n      var action = function (blob) {\n        return state.addTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, noop);\n    };\n\n    var manipulateApply = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        var url = state.addBlobState(blob);\n        destroyTempState(anyInSystem);\n        return url;\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var apply = function (anyInSystem, simulatedEvent) {\n      var postApply = function () {\n        destroyTempState(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n      };\n\n      state.applyTempState(postApply);\n    };\n\n    var destroyTempState = function (anyInSystem) {\n      var currentUrl = state.getBlobState().url;\n      state.destroyTempState();\n      updateButtonUndoStates(anyInSystem);\n      return currentUrl;\n    };\n\n    var cancel = function (anyInSystem) {\n      var currentUrl = destroyTempState(anyInSystem);\n      updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n        unblock(anyInSystem);\n      });\n    };\n\n    var back = function (anyInSystem, simulatedEvent) {\n      cancel(anyInSystem);\n      var swap = simulatedEvent.event.swap;\n      swap();\n      imagePanel.hideCrop();\n    };\n\n    var transform = function (anyInSystem, simulatedEvent) {\n      return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n    };\n\n    var tempTransform = function (anyInSystem, simulatedEvent) {\n      return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n    };\n\n    var transformApply = function (anyInSystem, simulatedEvent) {\n      return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n    };\n\n    var imagePanel = renderImagePanel(detail.currentState.url);\n    var sideBar = renderSideBar(providersBackstage);\n    var editPanel = renderEditPanel(imagePanel, providersBackstage);\n\n    var swap = function (anyInSystem, simulatedEvent) {\n      disableUndoRedo(anyInSystem);\n      var transform = simulatedEvent.event.transform;\n      var swap = simulatedEvent.event.swap;\n      transform.fold(function () {\n        swap();\n      }, function (transform) {\n        manipulate(anyInSystem, transform, swap);\n      });\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      components: [editPanel.memContainer.asSpec(), imagePanel.memContainer.asSpec(), sideBar.container],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return state.getBlobState();\n          }\n        }\n      }), config('image-tools-events', [run(internal.undo(), undo), run(internal.redo(), redo), run(internal.zoom(), zoom), run(internal.back(), back), run(internal.apply(), apply), run(internal.transform(), transform), run(internal.tempTransform(), tempTransform), run(internal.transformApply(), transformApply), run(internal.swap(), swap)]), ComposingConfigs.self()])\n    };\n  };\n\n  var renderLabel$2 = function (spec, backstageShared) {\n    var label = {\n      dom: {\n        tag: 'label',\n        innerHtml: backstageShared.providers.translate(spec.label),\n        classes: ['tox-label']\n      }\n    };\n    var comps = map(spec.items, backstageShared.interpreter);\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [label].concat(comps),\n      behaviours: derive$1([ComposingConfigs.self(), Replacing.config({}), RepresentingConfigs.domHtml(Optional.none()), Keying.config({\n        mode: 'acyclic'\n      })])\n    };\n  };\n\n  var isSingleListItem = function (item) {\n    return !has(item, 'items');\n  };\n\n  var dataAttribute = 'data-value';\n\n  var fetchItems = function (dropdownComp, name, items, selectedValue) {\n    return map(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return {\n          type: 'nestedmenuitem',\n          text: item.text,\n          getSubmenuItems: function () {\n            return fetchItems(dropdownComp, name, item.items, selectedValue);\n          }\n        };\n      } else {\n        return {\n          type: 'togglemenuitem',\n          text: item.text,\n          value: item.value,\n          active: item.value === selectedValue,\n          onAction: function () {\n            Representing.setValue(dropdownComp, item.value);\n            emitWith(dropdownComp, formChangeEvent, {\n              name: name\n            });\n            Focusing.focus(dropdownComp);\n          }\n        };\n      }\n    });\n  };\n\n  var findItemByValue = function (items, value) {\n    return findMap(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return findItemByValue(item.items, value);\n      } else {\n        return someIf(item.value === value, item);\n      }\n    });\n  };\n\n  var renderListBox = function (spec, backstage) {\n    var providersBackstage = backstage.shared.providers;\n    var initialItem = head(spec.items).filter(isSingleListItem);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      factory: {\n        sketch: function (sketchSpec) {\n          return renderCommonDropdown({\n            uid: sketchSpec.uid,\n            text: initialItem.map(function (item) {\n              return item.text;\n            }),\n            icon: Optional.none(),\n            tooltip: spec.label,\n            role: Optional.none(),\n            fetch: function (comp, callback) {\n              var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n              callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n            },\n            onSetup: constant(noop),\n            getApi: constant({}),\n            columns: 1,\n            presets: 'normal',\n            classes: [],\n            dropdownBehaviours: [Tabstopping.config({}), Representing.config({\n              store: {\n                mode: 'manual',\n                initialValue: initialItem.map(function (item) {\n                  return item.value;\n                }).getOr(''),\n                getValue: function (comp) {\n                  return get$2(comp.element, dataAttribute);\n                },\n                setValue: function (comp, data) {\n                  findItemByValue(spec.items, data).each(function (item) {\n                    set$1(comp.element, dataAttribute, item.value);\n                    emitWith(comp, updateMenuText, {\n                      text: item.text\n                    });\n                  });\n                }\n              }\n            })]\n          }, 'tox-listbox', backstage.shared);\n        }\n      }\n    });\n    var listBoxWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-listboxfield']\n      },\n      components: [pField]\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [listBoxWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: constant(spec.disabled),\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      })])\n    });\n  };\n\n  var renderPanel = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: spec.classes\n      },\n      components: map(spec.items, backstage.shared.interpreter)\n    };\n  };\n\n  var factory$8 = function (detail, _spec) {\n    var options = map(detail.options, function (option) {\n      return {\n        dom: {\n          tag: 'option',\n          value: option.value,\n          innerHtml: option.text\n        }\n      };\n    });\n    var initialValues = detail.data.map(function (v) {\n      return wrap$1('initialValue', v);\n    }).getOr({});\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'select',\n        classes: detail.selectClasses,\n        attributes: detail.selectAttributes\n      },\n      components: options,\n      behaviours: augment(detail.selectBehaviours, [Focusing.config({}), Representing.config({\n        store: __assign({\n          mode: 'manual',\n          getValue: function (select) {\n            return get$5(select.element);\n          },\n          setValue: function (select, newValue) {\n            var found = find(detail.options, function (opt) {\n              return opt.value === newValue;\n            });\n\n            if (found.isSome()) {\n              set$3(select.element, newValue);\n            }\n          }\n        }, initialValues)\n      })])\n    };\n  };\n\n  var HtmlSelect = single$2({\n    name: 'HtmlSelect',\n    configFields: [strict$1('options'), field$1('selectBehaviours', [Focusing, Representing]), defaulted$1('selectClasses', []), defaulted$1('selectAttributes', {}), option('data')],\n    factory: factory$8\n  });\n\n  var renderSelectBox = function (spec, providersBackstage) {\n    var translatedOptions = map(spec.items, function (item) {\n      return {\n        text: providersBackstage.translate(item.text),\n        value: item.value\n      };\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      selectAttributes: {\n        size: spec.size\n      },\n      options: translatedOptions,\n      factory: HtmlSelect,\n      selectBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        }\n      }), Tabstopping.config({}), config('selectbox-change', [run(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var chevron = spec.size > 1 ? Optional.none() : Optional.some({\n      dom: {\n        tag: 'div',\n        classes: ['tox-selectfield__icon-js'],\n        innerHtml: get$d('chevron-down', providersBackstage.icons)\n      }\n    });\n    var selectWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-selectfield']\n      },\n      components: flatten([[pField], chevron.toArray()])\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [selectWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderTable = function (spec, providersBackstage) {\n    var renderTh = function (text) {\n      return {\n        dom: {\n          tag: 'th',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderHeader = function (header) {\n      return {\n        dom: {\n          tag: 'thead'\n        },\n        components: [{\n          dom: {\n            tag: 'tr'\n          },\n          components: map(header, renderTh)\n        }]\n      };\n    };\n\n    var renderTd = function (text) {\n      return {\n        dom: {\n          tag: 'td',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderTr = function (row) {\n      return {\n        dom: {\n          tag: 'tr'\n        },\n        components: map(row, renderTd)\n      };\n    };\n\n    var renderRows = function (rows) {\n      return {\n        dom: {\n          tag: 'tbody'\n        },\n        components: map(rows, renderTr)\n      };\n    };\n\n    return {\n      dom: {\n        tag: 'table',\n        classes: ['tox-dialog__table']\n      },\n      components: [renderHeader(spec.header), renderRows(spec.cells)],\n      behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderTextField = function (spec, providersBackstage) {\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var baseInputBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isReadOnly();\n      }\n    }), receivingConfig(), Keying.config({\n      mode: 'execution',\n      useEnter: spec.multiline !== true,\n      useControlEnter: spec.multiline === true,\n      execute: function (comp) {\n        emit(comp, formSubmitEvent);\n        return Optional.some(true);\n      }\n    }), config('textfield-change', [run(input(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    }), run(postPaste(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    })]), Tabstopping.config({})];\n    var validatingBehaviours = spec.validation.map(function (vl) {\n      return Invalidating.config({\n        getRoot: function (input) {\n          return parent(input.element);\n        },\n        invalidClass: 'tox-invalid',\n        validator: {\n          validate: function (input) {\n            var v = Representing.getValue(input);\n            var result = vl.validator(v);\n            return Future.pure(result === true ? Result.value(v) : Result.error(result));\n          },\n          validateOnLoad: vl.validateOnLoad\n        }\n      });\n    }).toArray();\n    var placeholder = spec.placeholder.fold(constant({}), function (p) {\n      return {\n        placeholder: providersBackstage.translate(p)\n      };\n    });\n    var inputMode = spec.inputMode.fold(constant({}), function (mode) {\n      return {\n        inputmode: mode\n      };\n    });\n\n    var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n\n    var pField = FormField.parts.field({\n      tag: spec.multiline === true ? 'textarea' : 'input',\n      inputAttributes: inputAttributes,\n      inputClasses: [spec.classname],\n      inputBehaviours: derive$1(flatten([baseInputBehaviours, validatingBehaviours])),\n      selectOnFocus: false,\n      factory: Input\n    });\n    var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n    var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n    var extraBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isReadOnly();\n      },\n      onDisabled: function (comp) {\n        FormField.getField(comp).each(Disabling.disable);\n      },\n      onEnabled: function (comp) {\n        FormField.getField(comp).each(Disabling.enable);\n      }\n    }), receivingConfig()];\n    return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n  };\n\n  var renderInput = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: false,\n      label: spec.label,\n      inputMode: spec.inputMode,\n      placeholder: spec.placeholder,\n      flex: false,\n      disabled: spec.disabled,\n      classname: 'tox-textfield',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var renderTextarea = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: true,\n      label: spec.label,\n      inputMode: Optional.none(),\n      placeholder: spec.placeholder,\n      flex: true,\n      disabled: spec.disabled,\n      classname: 'tox-textarea',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var events$c = function (streamConfig, streamState) {\n    var streams = streamConfig.stream.streams;\n    var processor = streams.setup(streamConfig, streamState);\n    return derive([run(streamConfig.event, processor), runOnDetached(function () {\n      return streamState.cancel();\n    })].concat(streamConfig.cancelEvent.map(function (e) {\n      return [run(e, function () {\n        return streamState.cancel();\n      })];\n    }).getOr([])));\n  };\n\n  var ActiveStreaming = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$c\n  });\n\n  var throttle = function (_config) {\n    var state = Cell(null);\n\n    var readState = function () {\n      return {\n        timer: state.get() !== null ? 'set' : 'unset'\n      };\n    };\n\n    var setTimer = function (t) {\n      state.set(t);\n    };\n\n    var cancel = function () {\n      var t = state.get();\n\n      if (t !== null) {\n        t.cancel();\n      }\n    };\n\n    return nu$5({\n      readState: readState,\n      setTimer: setTimer,\n      cancel: cancel\n    });\n  };\n\n  var init$6 = function (spec) {\n    return spec.stream.streams.state(spec);\n  };\n\n  var StreamingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    throttle: throttle,\n    init: init$6\n  });\n\n  var setup$2 = function (streamInfo, streamState) {\n    var sInfo = streamInfo.stream;\n    var throttler = last$2(streamInfo.onStream, sInfo.delay);\n    streamState.setTimer(throttler);\n    return function (component, simulatedEvent) {\n      throttler.throttle(component, simulatedEvent);\n\n      if (sInfo.stopEvent) {\n        simulatedEvent.stop();\n      }\n    };\n  };\n\n  var StreamingSchema = [strictOf('stream', choose$1('mode', {\n    throttle: [strict$1('delay'), defaulted$1('stopEvent', true), output('streams', {\n      setup: setup$2,\n      state: throttle\n    })]\n  })), defaulted$1('event', 'input'), option('cancelEvent'), onStrictHandler('onStream')];\n  var Streaming = create$1({\n    fields: StreamingSchema,\n    name: 'streaming',\n    active: ActiveStreaming,\n    state: StreamingState\n  });\n\n  var setValueFromItem = function (model, input, item) {\n    var itemData = Representing.getValue(item);\n    Representing.setValue(input, itemData);\n    setCursorAtEnd(input);\n  };\n\n  var setSelectionOn = function (input, f) {\n    var el = input.element;\n    var value = get$5(el);\n    var node = el.dom;\n\n    if (get$2(el, 'type') !== 'number') {\n      f(node, value);\n    }\n  };\n\n  var setCursorAtEnd = function (input) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(value.length, value.length);\n    });\n  };\n\n  var setSelectionToEnd = function (input, startOffset) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(startOffset, value.length);\n    });\n  };\n\n  var attemptSelectOver = function (model, input, item) {\n    if (!model.selectsOver) {\n      return Optional.none();\n    } else {\n      var currentValue = Representing.getValue(input);\n      var inputDisplay_1 = model.getDisplayText(currentValue);\n      var itemValue = Representing.getValue(item);\n      var itemDisplay = model.getDisplayText(itemValue);\n      return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n        setValueFromItem(model, input, item);\n        setSelectionToEnd(input, inputDisplay_1.length);\n      }) : Optional.none();\n    }\n  };\n\n  var itemExecute = constant('alloy.typeahead.itemexecute');\n\n  var make$5 = function (detail, components, spec, externals) {\n    var navigateList = function (comp, simulatedEvent, highlighter) {\n      detail.previewing.set(false);\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n      if (Sandboxing.isOpen(sandbox)) {\n        Composing.getCurrent(sandbox).each(function (menu) {\n          Highlighting.getHighlighted(menu).fold(function () {\n            highlighter(menu);\n          }, function () {\n            dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n          });\n        });\n      } else {\n        var onOpenSync = function (sandbox) {\n          Composing.getCurrent(sandbox).each(highlighter);\n        };\n\n        open$1(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      }\n    };\n\n    var focusBehaviours$1 = focusBehaviours(detail);\n\n    var mapFetch = function (comp) {\n      return function (tdata) {\n        return tdata.map(function (data) {\n          var menus = values(data.menus);\n          var items = bind(menus, function (menu) {\n            return filter(menu.items, function (item) {\n              return item.type === 'item';\n            });\n          });\n          var repState = Representing.getState(comp);\n          repState.update(map(items, function (item) {\n            return item.data;\n          }));\n          return data;\n        });\n      };\n    };\n\n    var behaviours = [Focusing.config({}), Representing.config({\n      onSetValue: detail.onSetValue,\n      store: __assign({\n        mode: 'dataset',\n        getDataKey: function (comp) {\n          return get$5(comp.element);\n        },\n        getFallbackEntry: function (itemString) {\n          return {\n            value: itemString,\n            meta: {}\n          };\n        },\n        setValue: function (comp, data) {\n          set$3(comp.element, detail.model.getDisplayText(data));\n        }\n      }, detail.initialData.map(function (d) {\n        return wrap$1('initialValue', d);\n      }).getOr({}))\n    }), Streaming.config({\n      stream: {\n        mode: 'throttle',\n        delay: detail.responseTime,\n        stopEvent: false\n      },\n      onStream: function (component, _simulatedEvent) {\n        var sandbox = Coupling.getCoupled(component, 'sandbox');\n        var focusInInput = Focusing.isFocused(component);\n\n        if (focusInInput) {\n          if (get$5(component.element).length >= detail.minChars) {\n            var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n              return Highlighting.getHighlighted(menu).map(Representing.getValue);\n            });\n            detail.previewing.set(true);\n\n            var onOpenSync = function (_sandbox) {\n              Composing.getCurrent(sandbox).each(function (menu) {\n                previousValue_1.fold(function () {\n                  if (detail.model.selectsOver) {\n                    Highlighting.highlightFirst(menu);\n                  }\n                }, function (pv) {\n                  Highlighting.highlightBy(menu, function (item) {\n                    var itemData = Representing.getValue(item);\n                    return itemData.value === pv.value;\n                  });\n                  Highlighting.getHighlighted(menu).orThunk(function () {\n                    Highlighting.highlightFirst(menu);\n                    return Optional.none();\n                  });\n                });\n              });\n            };\n\n            open$1(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        }\n      },\n      cancelEvent: typeaheadCancel()\n    }), Keying.config({\n      mode: 'special',\n      onDown: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n        return Optional.some(true);\n      },\n      onEscape: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n          return Optional.some(true);\n        }\n\n        return Optional.none();\n      },\n      onUp: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n        return Optional.some(true);\n      },\n      onEnter: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n\n        if (sandboxIsOpen && !detail.previewing.get()) {\n          return Composing.getCurrent(sandbox).bind(function (menu) {\n            return Highlighting.getHighlighted(menu);\n          }).map(function (item) {\n            emitWith(comp, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        } else {\n          var currentValue = Representing.getValue(comp);\n          emit(comp, typeaheadCancel());\n          detail.onExecute(sandbox, comp, currentValue);\n\n          if (sandboxIsOpen) {\n            Sandboxing.close(sandbox);\n          }\n\n          return Optional.some(true);\n        }\n      }\n    }), Toggling.config({\n      toggleClass: detail.markers.openClass,\n      aria: {\n        mode: 'expanded'\n      }\n    }), Coupling.config({\n      others: {\n        sandbox: function (hotspot) {\n          return makeSandbox(detail, hotspot, {\n            onOpen: function () {\n              return Toggling.on(hotspot);\n            },\n            onClose: function () {\n              return Toggling.off(hotspot);\n            }\n          });\n        }\n      }\n    }), config('typeaheadevents', [runOnExecute(function (comp) {\n      var onOpenSync = noop;\n      togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    }), run(itemExecute(), function (comp, se) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      setValueFromItem(detail.model, comp, se.event.item);\n      emit(comp, typeaheadCancel());\n      detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n      Sandboxing.close(sandbox);\n      setCursorAtEnd(comp);\n    })].concat(detail.dismissOnBlur ? [run(postBlur(), function (typeahead) {\n      var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n\n      if (search(sandbox.element).isNone()) {\n        Sandboxing.close(sandbox);\n      }\n    })] : []))];\n    return {\n      uid: detail.uid,\n      dom: dom$2(deepMerge(detail, {\n        inputAttributes: {\n          'role': 'combobox',\n          'aria-autocomplete': 'list',\n          'aria-haspopup': 'true'\n        }\n      })),\n      behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$j = constant([option('lazySink'), strict$1('fetch'), defaulted$1('minChars', 5), defaulted$1('responseTime', 1000), onHandler('onOpen'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), defaulted$1('layouts', Optional.none()), defaulted$1('eventOrder', {}), defaultedObjOf('model', {}, [defaulted$1('getDisplayText', function (itemData) {\n    return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n  }), defaulted$1('selectsOver', true), defaulted$1('populateFromBrowse', true)]), onHandler('onSetValue'), onKeyboardHandler('onExecute'), onHandler('onItemExecute'), defaulted$1('inputClasses', []), defaulted$1('inputAttributes', {}), defaulted$1('inputStyles', {}), defaulted$1('matchWidth', true), defaulted$1('useMinWidth', false), defaulted$1('dismissOnBlur', true), markers(['openClass']), option('initialData'), field$1('typeaheadBehaviours', [Focusing, Representing, Streaming, Keying, Toggling, Coupling]), state$1('previewing', function () {\n    return Cell(true);\n  })].concat(schema$f()).concat(sandboxFields()));\n  var parts$6 = constant([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    overrides: function (detail) {\n      return {\n        fakeFocus: true,\n        onHighlight: function (menu, item) {\n          if (!detail.previewing.get()) {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              if (detail.model.populateFromBrowse) {\n                setValueFromItem(detail.model, input, item);\n              }\n            });\n          } else {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              attemptSelectOver(detail.model, input, item).fold(function () {\n                return Highlighting.dehighlight(menu, item);\n              }, function (fn) {\n                return fn();\n              });\n            });\n          }\n\n          detail.previewing.set(false);\n        },\n        onExecute: function (menu, item) {\n          return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n            emitWith(typeahead, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        },\n        onHover: function (menu, item) {\n          detail.previewing.set(false);\n          menu.getSystem().getByUid(detail.uid).each(function (input) {\n            if (detail.model.populateFromBrowse) {\n              setValueFromItem(detail.model, input, item);\n            }\n          });\n        }\n      };\n    }\n  })]);\n  var Typeahead = composite$1({\n    name: 'Typeahead',\n    configFields: schema$j(),\n    partFields: parts$6(),\n    factory: make$5\n  });\n\n  var wrap$2 = function (delegate) {\n    var toCached = function () {\n      return wrap$2(delegate.toCached());\n    };\n\n    var bindFuture = function (f) {\n      return wrap$2(delegate.bind(function (resA) {\n        return resA.fold(function (err) {\n          return Future.pure(Result.error(err));\n        }, function (a) {\n          return f(a);\n        });\n      }));\n    };\n\n    var bindResult = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.bind(f);\n      }));\n    };\n\n    var mapResult = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.map(f);\n      }));\n    };\n\n    var mapError = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.mapError(f);\n      }));\n    };\n\n    var foldResult = function (whenError, whenValue) {\n      return delegate.map(function (res) {\n        return res.fold(whenError, whenValue);\n      });\n    };\n\n    var withTimeout = function (timeout, errorThunk) {\n      return wrap$2(Future.nu(function (callback) {\n        var timedOut = false;\n        var timer = setTimeout(function () {\n          timedOut = true;\n          callback(Result.error(errorThunk()));\n        }, timeout);\n        delegate.get(function (result) {\n          if (!timedOut) {\n            clearTimeout(timer);\n            callback(result);\n          }\n        });\n      }));\n    };\n\n    return __assign(__assign({}, delegate), {\n      toCached: toCached,\n      bindFuture: bindFuture,\n      bindResult: bindResult,\n      mapResult: mapResult,\n      mapError: mapError,\n      foldResult: foldResult,\n      withTimeout: withTimeout\n    });\n  };\n\n  var nu$c = function (worker) {\n    return wrap$2(Future.nu(worker));\n  };\n\n  var value$2 = function (value) {\n    return wrap$2(Future.pure(Result.value(value)));\n  };\n\n  var error$1 = function (error) {\n    return wrap$2(Future.pure(Result.error(error)));\n  };\n\n  var fromResult$1 = function (result) {\n    return wrap$2(Future.pure(result));\n  };\n\n  var fromFuture = function (future) {\n    return wrap$2(future.map(Result.value));\n  };\n\n  var fromPromise = function (promise) {\n    return nu$c(function (completer) {\n      promise.then(function (value) {\n        completer(Result.value(value));\n      }, function (error) {\n        completer(Result.error(error));\n      });\n    });\n  };\n\n  var FutureResult = {\n    nu: nu$c,\n    wrap: wrap$2,\n    pure: value$2,\n    value: value$2,\n    error: error$1,\n    fromResult: fromResult$1,\n    fromFuture: fromFuture,\n    fromPromise: fromPromise\n  };\n  var separator$2 = {\n    type: 'separator'\n  };\n\n  var toMenuItem = function (target) {\n    return {\n      type: 'menuitem',\n      value: target.url,\n      text: target.title,\n      meta: {\n        attach: target.attach\n      },\n      onAction: function () {}\n    };\n  };\n\n  var staticMenuItem = function (title, url) {\n    return {\n      type: 'menuitem',\n      value: url,\n      text: title,\n      meta: {\n        attach: undefined\n      },\n      onAction: function () {}\n    };\n  };\n\n  var toMenuItems = function (targets) {\n    return map(targets, toMenuItem);\n  };\n\n  var filterLinkTargets = function (type, targets) {\n    return filter(targets, function (target) {\n      return target.type === type;\n    });\n  };\n\n  var filteredTargets = function (type, targets) {\n    return toMenuItems(filterLinkTargets(type, targets));\n  };\n\n  var headerTargets = function (linkInfo) {\n    return filteredTargets('header', linkInfo.targets);\n  };\n\n  var anchorTargets = function (linkInfo) {\n    return filteredTargets('anchor', linkInfo.targets);\n  };\n\n  var anchorTargetTop = function (linkInfo) {\n    return Optional.from(linkInfo.anchorTop).map(function (url) {\n      return staticMenuItem('<top>', url);\n    }).toArray();\n  };\n\n  var anchorTargetBottom = function (linkInfo) {\n    return Optional.from(linkInfo.anchorBottom).map(function (url) {\n      return staticMenuItem('<bottom>', url);\n    }).toArray();\n  };\n\n  var historyTargets = function (history) {\n    return map(history, function (url) {\n      return staticMenuItem(url, url);\n    });\n  };\n\n  var joinMenuLists = function (items) {\n    return foldl(items, function (a, b) {\n      var bothEmpty = a.length === 0 || b.length === 0;\n      return bothEmpty ? a.concat(b) : a.concat(separator$2, b);\n    }, []);\n  };\n\n  var filterByQuery = function (term, menuItems) {\n    var lowerCaseTerm = term.toLowerCase();\n    return filter(menuItems, function (item) {\n      var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n      return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n    });\n  };\n\n  var getItems = function (fileType, input, urlBackstage) {\n    var urlInputValue = Representing.getValue(input);\n    var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n    var info = urlBackstage.getLinkInformation();\n    return info.fold(function () {\n      return [];\n    }, function (linkInfo) {\n      var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n      return fileType === 'file' ? joinMenuLists([history, filterByQuery(term, headerTargets(linkInfo)), filterByQuery(term, flatten([anchorTargetTop(linkInfo), anchorTargets(linkInfo), anchorTargetBottom(linkInfo)]))]) : history;\n    });\n  };\n\n  var errorId = generate$1('aria-invalid');\n\n  var renderUrlInput = function (spec, backstage, urlBackstage) {\n    var _a;\n\n    var providersBackstage = backstage.shared.providers;\n\n    var updateHistory = function (component) {\n      var urlEntry = Representing.getValue(component);\n      urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n    };\n\n    var pField = FormField.parts.field({\n      factory: Typeahead,\n      dismissOnBlur: true,\n      inputClasses: ['tox-textfield'],\n      sandboxClasses: ['tox-dialog__popups'],\n      inputAttributes: {\n        'aria-errormessage': errorId,\n        'type': 'url'\n      },\n      minChars: 0,\n      responseTime: 0,\n      fetch: function (input) {\n        var items = getItems(spec.filetype, input, urlBackstage);\n        var tdata = build$2(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n        return Future.pure(tdata);\n      },\n      getHotspot: function (comp) {\n        return memUrlBox.getOpt(comp);\n      },\n      onSetValue: function (comp, _newValue) {\n        if (comp.hasConfigured(Invalidating)) {\n          Invalidating.run(comp).get(noop);\n        }\n      },\n      typeaheadBehaviours: derive$1(flatten([urlBackstage.getValidationHandler().map(function (handler) {\n        return Invalidating.config({\n          getRoot: function (comp) {\n            return parent(comp.element);\n          },\n          invalidClass: 'tox-control-wrap--status-invalid',\n          notify: {\n            onInvalid: function (comp, err) {\n              memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                set$1(invalidComp.element, 'title', providersBackstage.translate(err));\n              });\n            }\n          },\n          validator: {\n            validate: function (input) {\n              var urlEntry = Representing.getValue(input);\n              return FutureResult.nu(function (completer) {\n                handler({\n                  type: spec.filetype,\n                  url: urlEntry.value\n                }, function (validation) {\n                  if (validation.status === 'invalid') {\n                    var err = Result.error(validation.message);\n                    completer(err);\n                  } else {\n                    var val = Result.value(validation.message);\n                    completer(val);\n                  }\n                });\n              });\n            },\n            validateOnLoad: false\n          }\n        });\n      }).toArray(), [Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        }\n      }), Tabstopping.config({}), config('urlinput-events', flatten([spec.filetype === 'file' ? [run(input(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      })] : [], [run(change(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      }), run(postPaste(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      })]]))]])),\n      eventOrder: (_a = {}, _a[input()] = ['streaming', 'urlinput-events', 'invalidating'], _a),\n      model: {\n        getDisplayText: function (itemData) {\n          return itemData.value;\n        },\n        selectsOver: false,\n        populateFromBrowse: false\n      },\n      markers: {\n        openClass: 'tox-textfield--popup-open'\n      },\n      lazySink: backstage.shared.getSink,\n      parts: {\n        menu: part(false, 1, 'normal')\n      },\n      onExecute: function (_menu, component, _entry) {\n        emitWith(component, formSubmitEvent, {});\n      },\n      onItemExecute: function (typeahead, _sandbox, _item, _value) {\n        updateHistory(typeahead);\n        emitWith(typeahead, formChangeEvent, {\n          name: spec.name\n        });\n      }\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var makeIcon = function (name, errId, icon, label) {\n      if (icon === void 0) {\n        icon = name;\n      }\n\n      if (label === void 0) {\n        label = name;\n      }\n\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon', 'tox-control-wrap__status-icon-' + name],\n          innerHtml: get$d(icon, providersBackstage.icons),\n          attributes: __assign({\n            'title': providersBackstage.translate(label),\n            'aria-live': 'polite'\n          }, errId.fold(function () {\n            return {};\n          }, function (id) {\n            return {\n              id: id\n            };\n          }))\n        }\n      };\n    };\n\n    var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n    var memStatus = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap__status-icon-wrap']\n      },\n      components: [memInvalidIcon.asSpec()]\n    });\n    var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n    var browseUrlEvent = generate$1('browser.url.event');\n    var memUrlBox = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap']\n      },\n      components: [pField, memStatus.asSpec()],\n      behaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        }\n      })])\n    });\n    var memUrlPickerButton = record(renderButton({\n      name: spec.name,\n      icon: Optional.some('browse'),\n      text: spec.label.getOr(''),\n      disabled: spec.disabled,\n      primary: false,\n      borderless: true\n    }, function (component) {\n      return emit(component, browseUrlEvent);\n    }, providersBackstage, [], ['tox-browse-url']));\n\n    var controlHWrapper = function () {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: flatten([[memUrlBox.asSpec()], optUrlPicker.map(function () {\n          return memUrlPickerButton.asSpec();\n        }).toArray()])\n      };\n    };\n\n    var openUrlPicker = function (comp) {\n      Composing.getCurrent(comp).each(function (field) {\n        var componentData = Representing.getValue(field);\n\n        var urlData = __assign({\n          fieldname: spec.name\n        }, componentData);\n\n        optUrlPicker.each(function (picker) {\n          picker(urlData).get(function (chosenData) {\n            Representing.setValue(field, chosenData);\n            emitWith(comp, formChangeEvent, {\n              name: spec.name\n            });\n          });\n        });\n      });\n    };\n\n    return FormField.sketch({\n      dom: renderFormFieldDom(),\n      components: pLabel.toArray().concat([controlHWrapper()]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isReadOnly();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('url-input-events', [run(browseUrlEvent, openUrlPicker)])])\n    });\n  };\n\n  var renderAlertBanner = function (spec, providersBackstage) {\n    return Container.sketch({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: ['tox-notification', 'tox-notification--in', 'tox-notification--' + spec.level]\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__icon']\n        },\n        components: [Button.sketch({\n          dom: {\n            tag: 'button',\n            classes: ['tox-button', 'tox-button--naked', 'tox-button--icon'],\n            innerHtml: get$d(spec.icon, providersBackstage.icons),\n            attributes: {\n              title: providersBackstage.translate(spec.iconTooltip)\n            }\n          },\n          action: function (comp) {\n            emitWith(comp, formActionEvent, {\n              name: 'alert-banner',\n              value: spec.url\n            });\n          }\n        })]\n      }, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__body'],\n          innerHtml: providersBackstage.translate(spec.text)\n        }\n      }]\n    });\n  };\n\n  var renderCheckbox = function (spec, providerBackstage) {\n    var repBehaviour = Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var el = comp.element.dom;\n          return el.checked;\n        },\n        setValue: function (comp, value) {\n          var el = comp.element.dom;\n          el.checked = value;\n        }\n      }\n    });\n\n    var toggleCheckboxHandler = function (comp) {\n      comp.element.dom.click();\n      return Optional.some(true);\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: identity\n      },\n      dom: {\n        tag: 'input',\n        classes: ['tox-checkbox__input'],\n        attributes: {\n          type: 'checkbox'\n        }\n      },\n      behaviours: derive$1([ComposingConfigs.self(), Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isReadOnly();\n        }\n      }), Tabstopping.config({}), Focusing.config({}), repBehaviour, Keying.config({\n        mode: 'special',\n        onEnter: toggleCheckboxHandler,\n        onSpace: toggleCheckboxHandler,\n        stopSpaceKeyup: true\n      }), config('checkbox-events', [run(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var pLabel = FormField.parts.label({\n      dom: {\n        tag: 'span',\n        classes: ['tox-checkbox__label'],\n        innerHtml: providerBackstage.translate(spec.label)\n      },\n      behaviours: derive$1([Unselecting.config({})])\n    });\n\n    var makeIcon = function (className) {\n      var iconName = className === 'checked' ? 'selected' : 'unselected';\n      return {\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-checkbox-icon__' + className],\n          innerHtml: get$d(iconName, providerBackstage.icons)\n        }\n      };\n    };\n\n    var memIcons = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-checkbox__icons']\n      },\n      components: [makeIcon('checked'), makeIcon('unchecked')]\n    });\n    return FormField.sketch({\n      dom: {\n        tag: 'label',\n        classes: ['tox-checkbox']\n      },\n      components: [pField, memIcons.asSpec(), pLabel],\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isReadOnly();\n        },\n        disableClass: 'tox-checkbox--disabled',\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderHtmlPanel = function (spec) {\n    if (spec.presets === 'presentation') {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html\n        }\n      });\n    } else {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html,\n          attributes: {\n            role: 'document'\n          }\n        },\n        containerBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n      });\n    }\n  };\n\n  var make$6 = function (render) {\n    return function (parts, spec, backstage) {\n      return get(spec, 'name').fold(function () {\n        return render(spec, backstage);\n      }, function (fieldName) {\n        return parts.field(fieldName, render(spec, backstage));\n      });\n    };\n  };\n\n  var makeIframe = function (render) {\n    return function (parts, spec, backstage) {\n      var iframeSpec = deepMerge(spec, {\n        source: 'dynamic'\n      });\n      return make$6(render)(parts, iframeSpec, backstage);\n    };\n  };\n\n  var factories = {\n    bar: make$6(function (spec, backstage) {\n      return renderBar(spec, backstage.shared);\n    }),\n    collection: make$6(function (spec, backstage) {\n      return renderCollection(spec, backstage.shared.providers);\n    }),\n    alertbanner: make$6(function (spec, backstage) {\n      return renderAlertBanner(spec, backstage.shared.providers);\n    }),\n    input: make$6(function (spec, backstage) {\n      return renderInput(spec, backstage.shared.providers);\n    }),\n    textarea: make$6(function (spec, backstage) {\n      return renderTextarea(spec, backstage.shared.providers);\n    }),\n    label: make$6(function (spec, backstage) {\n      return renderLabel$2(spec, backstage.shared);\n    }),\n    iframe: makeIframe(function (spec, backstage) {\n      return renderIFrame(spec, backstage.shared.providers);\n    }),\n    button: make$6(function (spec, backstage) {\n      return renderDialogButton(spec, backstage.shared.providers);\n    }),\n    checkbox: make$6(function (spec, backstage) {\n      return renderCheckbox(spec, backstage.shared.providers);\n    }),\n    colorinput: make$6(function (spec, backstage) {\n      return renderColorInput(spec, backstage.shared, backstage.colorinput);\n    }),\n    colorpicker: make$6(renderColorPicker),\n    dropzone: make$6(function (spec, backstage) {\n      return renderDropZone(spec, backstage.shared.providers);\n    }),\n    grid: make$6(function (spec, backstage) {\n      return renderGrid(spec, backstage.shared);\n    }),\n    listbox: make$6(function (spec, backstage) {\n      return renderListBox(spec, backstage);\n    }),\n    selectbox: make$6(function (spec, backstage) {\n      return renderSelectBox(spec, backstage.shared.providers);\n    }),\n    sizeinput: make$6(function (spec, backstage) {\n      return renderSizeInput(spec, backstage.shared.providers);\n    }),\n    urlinput: make$6(function (spec, backstage) {\n      return renderUrlInput(spec, backstage, backstage.urlinput);\n    }),\n    customeditor: make$6(renderCustomEditor),\n    htmlpanel: make$6(renderHtmlPanel),\n    imagetools: make$6(function (spec, backstage) {\n      return renderImageTools(spec, backstage.shared.providers);\n    }),\n    table: make$6(function (spec, backstage) {\n      return renderTable(spec, backstage.shared.providers);\n    }),\n    panel: make$6(function (spec, backstage) {\n      return renderPanel(spec, backstage);\n    })\n  };\n  var noFormParts = {\n    field: function (_name, spec) {\n      return spec;\n    }\n  };\n\n  var interpretInForm = function (parts, spec, oldBackstage) {\n    var newBackstage = deepMerge(oldBackstage, {\n      shared: {\n        interpreter: function (childSpec) {\n          return interpretParts(parts, childSpec, newBackstage);\n        }\n      }\n    });\n    return interpretParts(parts, spec, newBackstage);\n  };\n\n  var interpretParts = function (parts, spec, backstage) {\n    return get(factories, spec.type).fold(function () {\n      console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n      return spec;\n    }, function (factory) {\n      return factory(parts, spec, backstage);\n    });\n  };\n\n  var interpretWithoutForm = function (spec, backstage) {\n    var parts = noFormParts;\n    return interpretParts(parts, spec, backstage);\n  };\n\n  var bubbleAlignments = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: [],\n    alignRight: [],\n    right: [],\n    left: [],\n    bottom: [],\n    top: []\n  };\n\n  var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var bubble = nu$8(-12, 12, bubbleAlignments);\n    var overrides = {\n      maxHeightFunction: expandable()\n    };\n\n    var editableAreaAnchor = function () {\n      return {\n        anchor: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        bubble: bubble,\n        layouts: {\n          onRtl: function () {\n            return [northwest$3];\n          },\n          onLtr: function () {\n            return [northeast$3];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        anchor: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        bubble: bubble,\n        layouts: {\n          onRtl: function () {\n            return [southeast$1];\n          },\n          onLtr: function () {\n            return [southwest$1];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var editableAreaAnchor = function () {\n      return {\n        anchor: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        layouts: {\n          onRtl: function () {\n            return [north$3];\n          },\n          onLtr: function () {\n            return [north$3];\n          }\n        }\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        anchor: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        layouts: {\n          onRtl: function () {\n            return [south$1];\n          },\n          onLtr: function () {\n            return [south$1];\n          }\n        }\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getCursorAnchor = function (editor, bodyElement) {\n    return function () {\n      return {\n        anchor: 'selection',\n        root: bodyElement(),\n        getSelection: function () {\n          var rng = editor.selection.getRng();\n          return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n        }\n      };\n    };\n  };\n\n  var getNodeAnchor = function (bodyElement) {\n    return function (element) {\n      return {\n        anchor: 'node',\n        root: bodyElement(),\n        node: element\n      };\n    };\n  };\n\n  var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n    var useFixedToolbarContainer = useFixedContainer(editor);\n\n    var bodyElement = function () {\n      return SugarElement.fromDom(editor.getBody());\n    };\n\n    var contentAreaElement = function () {\n      return SugarElement.fromDom(editor.getContentAreaContainer());\n    };\n\n    var lazyUseEditableAreaAnchor = function () {\n      return useFixedToolbarContainer || !isToolbarTop();\n    };\n\n    return {\n      inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      cursor: getCursorAnchor(editor, bodyElement),\n      node: getNodeAnchor(bodyElement)\n    };\n  };\n\n  var colorPicker = function (editor) {\n    return function (callback, value) {\n      var dialog = colorPickerDialog(editor);\n      dialog(callback, value);\n    };\n  };\n\n  var hasCustomColors$1 = function (editor) {\n    return function () {\n      return hasCustomColors(editor);\n    };\n  };\n\n  var getColors$2 = function (editor) {\n    return function () {\n      return getColors(editor);\n    };\n  };\n\n  var getColorCols$2 = function (editor) {\n    return function () {\n      return getColorCols$1(editor);\n    };\n  };\n\n  var ColorInputBackstage = function (editor) {\n    return {\n      colorPicker: colorPicker(editor),\n      hasCustomColors: hasCustomColors$1(editor),\n      getColors: getColors$2(editor),\n      getColorCols: getColorCols$2(editor)\n    };\n  };\n\n  var isDraggableModal$1 = function (editor) {\n    return function () {\n      return isDraggableModal(editor);\n    };\n  };\n\n  var DialogBackstage = function (editor) {\n    return {\n      isDraggableModal: isDraggableModal$1(editor)\n    };\n  };\n\n  var HeaderBackstage = function (editor) {\n    var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n    return {\n      isPositionedAtTop: function () {\n        return mode.get() === 'top';\n      },\n      getDockingMode: mode.get,\n      setDockingMode: mode.set\n    };\n  };\n\n  var defaultStyleFormats = [{\n    title: 'Headings',\n    items: [{\n      title: 'Heading 1',\n      format: 'h1'\n    }, {\n      title: 'Heading 2',\n      format: 'h2'\n    }, {\n      title: 'Heading 3',\n      format: 'h3'\n    }, {\n      title: 'Heading 4',\n      format: 'h4'\n    }, {\n      title: 'Heading 5',\n      format: 'h5'\n    }, {\n      title: 'Heading 6',\n      format: 'h6'\n    }]\n  }, {\n    title: 'Inline',\n    items: [{\n      title: 'Bold',\n      format: 'bold'\n    }, {\n      title: 'Italic',\n      format: 'italic'\n    }, {\n      title: 'Underline',\n      format: 'underline'\n    }, {\n      title: 'Strikethrough',\n      format: 'strikethrough'\n    }, {\n      title: 'Superscript',\n      format: 'superscript'\n    }, {\n      title: 'Subscript',\n      format: 'subscript'\n    }, {\n      title: 'Code',\n      format: 'code'\n    }]\n  }, {\n    title: 'Blocks',\n    items: [{\n      title: 'Paragraph',\n      format: 'p'\n    }, {\n      title: 'Blockquote',\n      format: 'blockquote'\n    }, {\n      title: 'Div',\n      format: 'div'\n    }, {\n      title: 'Pre',\n      format: 'pre'\n    }]\n  }, {\n    title: 'Align',\n    items: [{\n      title: 'Left',\n      format: 'alignleft'\n    }, {\n      title: 'Center',\n      format: 'aligncenter'\n    }, {\n      title: 'Right',\n      format: 'alignright'\n    }, {\n      title: 'Justify',\n      format: 'alignjustify'\n    }]\n  }];\n\n  var isNestedFormat = function (format) {\n    return has(format, 'items');\n  };\n\n  var isBlockFormat = function (format) {\n    return has(format, 'block');\n  };\n\n  var isInlineFormat = function (format) {\n    return has(format, 'inline');\n  };\n\n  var isSelectorFormat = function (format) {\n    return has(format, 'selector');\n  };\n\n  var mapFormats = function (userFormats) {\n    return foldl(userFormats, function (acc, fmt) {\n      if (isNestedFormat(fmt)) {\n        var result = mapFormats(fmt.items);\n        return {\n          customFormats: acc.customFormats.concat(result.customFormats),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            items: result.formats\n          }])\n        };\n      } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n        var formatName = 'custom-' + fmt.title.toLowerCase();\n        return {\n          customFormats: acc.customFormats.concat([{\n            name: formatName,\n            format: fmt\n          }]),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            format: formatName,\n            icon: fmt.icon\n          }])\n        };\n      } else {\n        return __assign(__assign({}, acc), {\n          formats: acc.formats.concat(fmt)\n        });\n      }\n    }, {\n      customFormats: [],\n      formats: []\n    });\n  };\n\n  var registerCustomFormats = function (editor, userFormats) {\n    var result = mapFormats(userFormats);\n\n    var registerFormats = function (customFormats) {\n      each(customFormats, function (fmt) {\n        if (!editor.formatter.has(fmt.name)) {\n          editor.formatter.register(fmt.name, fmt.format);\n        }\n      });\n    };\n\n    if (editor.formatter) {\n      registerFormats(result.customFormats);\n    } else {\n      editor.on('init', function () {\n        registerFormats(result.customFormats);\n      });\n    }\n\n    return result.formats;\n  };\n\n  var getStyleFormats = function (editor) {\n    return getUserStyleFormats(editor).map(function (userFormats) {\n      var registeredUserFormats = registerCustomFormats(editor, userFormats);\n      return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n    }).getOr(defaultStyleFormats);\n  };\n\n  var processBasic = function (item, isSelectedFor, getPreviewFor) {\n    var formatterSpec = {\n      type: 'formatter',\n      isSelected: isSelectedFor(item.format),\n      getStylePreview: getPreviewFor(item.format)\n    };\n    return deepMerge(item, formatterSpec);\n  };\n\n  var register$3 = function (editor, formats, isSelectedFor, getPreviewFor) {\n    var enrichSupported = function (item) {\n      return processBasic(item, isSelectedFor, getPreviewFor);\n    };\n\n    var enrichMenu = function (item) {\n      var submenuSpec = {\n        type: 'submenu'\n      };\n      return deepMerge(item, submenuSpec);\n    };\n\n    var enrichCustom = function (item) {\n      var formatName = generate$1(item.title);\n      var customSpec = {\n        type: 'formatter',\n        format: formatName,\n        isSelected: isSelectedFor(formatName),\n        getStylePreview: getPreviewFor(formatName)\n      };\n      var newItem = deepMerge(item, customSpec);\n      editor.formatter.register(formatName, newItem);\n      return newItem;\n    };\n\n    var doEnrich = function (items) {\n      return map(items, function (item) {\n        var keys$1 = keys(item);\n\n        if (hasNonNullableKey(item, 'items')) {\n          var newItems_1 = doEnrich(item.items);\n          return deepMerge(enrichMenu(item), {\n            getStyleItems: function () {\n              return newItems_1;\n            }\n          });\n        } else if (hasNonNullableKey(item, 'format')) {\n          return enrichSupported(item);\n        } else if (keys$1.length === 1 && contains(keys$1, 'title')) {\n          return deepMerge(item, {\n            type: 'separator'\n          });\n        } else {\n          return enrichCustom(item);\n        }\n      });\n    };\n\n    return doEnrich(formats);\n  };\n\n  var init$7 = function (editor) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var flatten = function (fmt) {\n      var subs = fmt.items;\n      return subs !== undefined && subs.length > 0 ? bind(subs, flatten) : [fmt.format];\n    };\n\n    var settingsFormats = Cell([]);\n    var settingsFlattenedFormats = Cell([]);\n    var eventsFormats = Cell([]);\n    var eventsFlattenedFormats = Cell([]);\n    var replaceSettings = Cell(false);\n    editor.on('PreInit', function (_e) {\n      var formats = getStyleFormats(editor);\n      var enriched = register$3(editor, formats, isSelectedFor, getPreviewFor);\n      settingsFormats.set(enriched);\n      settingsFlattenedFormats.set(bind(enriched, flatten));\n    });\n    editor.on('addStyleModifications', function (e) {\n      var modifications = register$3(editor, e.items, isSelectedFor, getPreviewFor);\n      eventsFormats.set(modifications);\n      replaceSettings.set(e.replace);\n      eventsFlattenedFormats.set(bind(modifications, flatten));\n    });\n\n    var getData = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n      var fromEvents = eventsFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    var getFlattenedKeys = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n      var fromEvents = eventsFlattenedFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    return {\n      getData: getData,\n      getFlattenedKeys: getFlattenedKeys\n    };\n  };\n\n  var trim$1 = global$e.trim;\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (node && node.nodeType === 1) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isContentEditableTrue = hasContentEditableState('true');\n  var isContentEditableFalse = hasContentEditableState('false');\n\n  var create$8 = function (type, title, url, level, attach) {\n    return {\n      type: type,\n      title: title,\n      url: url,\n      level: level,\n      attach: attach\n    };\n  };\n\n  var isChildOfContentEditableTrue = function (node) {\n    while (node = node.parentNode) {\n      var value = node.contentEditable;\n\n      if (value && value !== 'inherit') {\n        return isContentEditableTrue(node);\n      }\n    }\n\n    return false;\n  };\n\n  var select = function (selector, root) {\n    return map(descendants(SugarElement.fromDom(root), selector), function (element) {\n      return element.dom;\n    });\n  };\n\n  var getElementText = function (elm) {\n    return elm.innerText || elm.textContent;\n  };\n\n  var getOrGenerateId = function (elm) {\n    return elm.id ? elm.id : generate$1('h');\n  };\n\n  var isAnchor = function (elm) {\n    return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n  };\n\n  var isValidAnchor = function (elm) {\n    return isAnchor(elm) && isEditable(elm);\n  };\n\n  var isHeader = function (elm) {\n    return elm && /^(H[1-6])$/.test(elm.nodeName);\n  };\n\n  var isEditable = function (elm) {\n    return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n  };\n\n  var isValidHeader = function (elm) {\n    return isHeader(elm) && isEditable(elm);\n  };\n\n  var getLevel = function (elm) {\n    return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n  };\n\n  var headerTarget = function (elm) {\n    var headerId = getOrGenerateId(elm);\n\n    var attach = function () {\n      elm.id = headerId;\n    };\n\n    return create$8('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n  };\n\n  var anchorTarget = function (elm) {\n    var anchorId = elm.id || elm.name;\n    var anchorText = getElementText(elm);\n    return create$8('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n  };\n\n  var getHeaderTargets = function (elms) {\n    return map(filter(elms, isValidHeader), headerTarget);\n  };\n\n  var getAnchorTargets = function (elms) {\n    return map(filter(elms, isValidAnchor), anchorTarget);\n  };\n\n  var getTargetElements = function (elm) {\n    var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n    return elms;\n  };\n\n  var hasTitle = function (target) {\n    return trim$1(target.title).length > 0;\n  };\n\n  var find$5 = function (elm) {\n    var elms = getTargetElements(elm);\n    return filter(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n  };\n\n  var LinkTargets = {\n    find: find$5\n  };\n  var STORAGE_KEY = 'tinymce-url-history';\n  var HISTORY_LENGTH = 5;\n\n  var isHttpUrl = function (url) {\n    return isString(url) && /^https?/.test(url);\n  };\n\n  var isArrayOfUrl = function (a) {\n    return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n  };\n\n  var isRecordOfUrlArray = function (r) {\n    return isObject(r) && find$1(r, function (value) {\n      return !isArrayOfUrl(value);\n    }).isNone();\n  };\n\n  var getAllHistory = function () {\n    var unparsedHistory = global$9.getItem(STORAGE_KEY);\n\n    if (unparsedHistory === null) {\n      return {};\n    }\n\n    var history;\n\n    try {\n      history = JSON.parse(unparsedHistory);\n    } catch (e) {\n      if (e instanceof SyntaxError) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n        return {};\n      }\n\n      throw e;\n    }\n\n    if (!isRecordOfUrlArray(history)) {\n      console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n      return {};\n    }\n\n    return history;\n  };\n\n  var setAllHistory = function (history) {\n    if (!isRecordOfUrlArray(history)) {\n      throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n    }\n\n    global$9.setItem(STORAGE_KEY, JSON.stringify(history));\n  };\n\n  var getHistory = function (fileType) {\n    var history = getAllHistory();\n    return Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n  };\n\n  var addToHistory = function (url, fileType) {\n    if (!isHttpUrl(url)) {\n      return;\n    }\n\n    var history = getAllHistory();\n    var items = Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n    var itemsWithoutUrl = filter(items, function (item) {\n      return item !== url;\n    });\n    history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n    setAllHistory(history);\n  };\n\n  var isTruthy = function (value) {\n    return !!value;\n  };\n\n  var makeMap = function (value) {\n    return map$2(global$e.makeMap(value, /[, ]/), isTruthy);\n  };\n\n  var getPicker = function (editor) {\n    return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n  };\n\n  var getPickerTypes = function (editor) {\n    var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n    var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n    var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n    return getPicker(editor).fold(function () {\n      return false;\n    }, function (_picker) {\n      return optTypes.fold(function () {\n        return true;\n      }, function (types) {\n        return keys(types).length > 0 ? types : false;\n      });\n    });\n  };\n\n  var getPickerSetting = function (editor, filetype) {\n    var pickerTypes = getPickerTypes(editor);\n\n    if (isBoolean(pickerTypes)) {\n      return pickerTypes ? getPicker(editor) : Optional.none();\n    } else {\n      return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n    }\n  };\n\n  var getUrlPicker = function (editor, filetype) {\n    return getPickerSetting(editor, filetype).map(function (picker) {\n      return function (entry) {\n        return Future.nu(function (completer) {\n          var handler = function (value, meta) {\n            if (!isString(value)) {\n              throw new Error('Expected value to be string');\n            }\n\n            if (meta !== undefined && !isObject(meta)) {\n              throw new Error('Expected meta to be a object');\n            }\n\n            var r = {\n              value: value,\n              meta: meta\n            };\n            completer(r);\n          };\n\n          var meta = __assign({\n            filetype: filetype,\n            fieldname: entry.fieldname\n          }, Optional.from(entry.meta).getOr({}));\n\n          picker.call(editor, handler, entry.value, meta);\n        });\n      };\n    });\n  };\n\n  var getTextSetting = function (value) {\n    return Optional.from(value).filter(isString).getOrUndefined();\n  };\n\n  var getLinkInformation = function (editor) {\n    if (noTypeaheadUrls(editor)) {\n      return Optional.none();\n    }\n\n    return Optional.some({\n      targets: LinkTargets.find(editor.getBody()),\n      anchorTop: getTextSetting(getAnchorTop(editor)),\n      anchorBottom: getTextSetting(getAnchorBottom(editor))\n    });\n  };\n\n  var getValidationHandler = function (editor) {\n    return Optional.from(getFilePickerValidatorHandler(editor));\n  };\n\n  var UrlInputBackstage = function (editor) {\n    return {\n      getHistory: getHistory,\n      addToHistory: addToHistory,\n      getLinkInformation: function () {\n        return getLinkInformation(editor);\n      },\n      getValidationHandler: function () {\n        return getValidationHandler(editor);\n      },\n      getUrlPicker: function (filetype) {\n        return getUrlPicker(editor, filetype);\n      }\n    };\n  };\n\n  var init$8 = function (sink, editor, lazyAnchorbar) {\n    var contextMenuState = Cell(false);\n    var toolbar = HeaderBackstage(editor);\n    var backstage = {\n      shared: {\n        providers: {\n          icons: function () {\n            return editor.ui.registry.getAll().icons;\n          },\n          menuItems: function () {\n            return editor.ui.registry.getAll().menuItems;\n          },\n          translate: global$6.translate,\n          isReadOnly: function () {\n            return editor.mode.isReadOnly();\n          }\n        },\n        interpreter: function (s) {\n          return interpretWithoutForm(s, backstage);\n        },\n        anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n        header: toolbar,\n        getSink: function () {\n          return Result.value(sink);\n        }\n      },\n      urlinput: UrlInputBackstage(editor),\n      styleselect: init$7(editor),\n      colorinput: ColorInputBackstage(editor),\n      dialog: DialogBackstage(editor),\n      isContextMenuOpen: function () {\n        return contextMenuState.get();\n      },\n      setContextMenuState: function (state) {\n        return contextMenuState.set(state);\n      }\n    };\n    return backstage;\n  };\n\n  var expandable$1 = constant(function (element, available) {\n    setMax$1(element, Math.floor(available));\n  });\n  var showContextToolbarEvent = 'contexttoolbar-show';\n  var hideContextToolbarEvent = 'contexttoolbar-hide';\n  var schema$k = constant([strict$1('dom'), defaulted$1('shell', true), field$1('toolbarBehaviours', [Replacing])]);\n\n  var enhanceGroups = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var parts$7 = constant([optional({\n    name: 'groups',\n    overrides: enhanceGroups\n  })]);\n\n  var factory$9 = function (detail, components, _spec, _externals) {\n    var setGroups = function (toolbar, groups) {\n      getGroupContainer(toolbar).fold(function () {\n        console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n      }, function (container) {\n        Replacing.set(container, groups);\n      });\n    };\n\n    var getGroupContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n      apis: {\n        setGroups: setGroups\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var Toolbar = composite$1({\n    name: 'Toolbar',\n    configFields: schema$k(),\n    partFields: parts$7(),\n    factory: factory$9,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      }\n    }\n  });\n\n  var generate$6 = function (xs, f) {\n    var init = {\n      len: 0,\n      list: []\n    };\n    var r = foldl(xs, function (b, a) {\n      var value = f(a, b.len);\n      return value.fold(constant(b), function (v) {\n        return {\n          len: v.finish,\n          list: b.list.concat([v])\n        };\n      });\n    }, init);\n    return r.list;\n  };\n\n  var output$1 = function (within, extra, withinWidth) {\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var apportion = function (units, total, len) {\n    var parray = generate$6(units, function (unit, current) {\n      var width = len(unit);\n      return Optional.some({\n        element: unit,\n        start: current,\n        finish: current + width,\n        width: width\n      });\n    });\n    var within = filter(parray, function (unit) {\n      return unit.finish <= total;\n    });\n    var withinWidth = foldr(within, function (acc, el) {\n      return acc + el.width;\n    }, 0);\n    var extra = parray.slice(within.length);\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var toUnit = function (parray) {\n    return map(parray, function (unit) {\n      return unit.element;\n    });\n  };\n\n  var fitLast = function (within, extra, withinWidth) {\n    var fits = toUnit(within.concat(extra));\n    return output$1(fits, [], withinWidth);\n  };\n\n  var overflow = function (within, extra, overflower, withinWidth) {\n    var fits = toUnit(within).concat([overflower]);\n    return output$1(fits, toUnit(extra), withinWidth);\n  };\n\n  var fitAll = function (within, extra, withinWidth) {\n    return output$1(toUnit(within), [], withinWidth);\n  };\n\n  var tryFit = function (total, units, len) {\n    var divide = apportion(units, total, len);\n    return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n  };\n\n  var partition$3 = function (total, units, len, overflower) {\n    var divide = tryFit(total, units, len).getOrThunk(function () {\n      return apportion(units, total - len(overflower), len);\n    });\n    var within = divide.within;\n    var extra = divide.extra;\n    var withinWidth = divide.withinWidth;\n\n    if (extra.length === 1 && extra[0].width <= len(overflower)) {\n      return fitLast(within, extra, withinWidth);\n    } else if (extra.length >= 1) {\n      return overflow(within, extra, overflower, withinWidth);\n    } else {\n      return fitAll(within, extra, withinWidth);\n    }\n  };\n\n  var setGroups = function (toolbar, storedGroups) {\n    var bGroups = map(storedGroups, function (g) {\n      return premade$1(g);\n    });\n    Toolbar.setGroups(toolbar, bGroups);\n  };\n\n  var findFocusedComp = function (comps) {\n    return findMap(comps, function (comp) {\n      return search(comp.element).bind(function (focusedElm) {\n        return comp.getSystem().getByDom(focusedElm).toOptional();\n      });\n    });\n  };\n\n  var refresh = function (toolbar, detail, setOverflow) {\n    var primary = getPartOrDie(toolbar, detail, 'primary');\n    var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n    set$2(primary.element, 'visibility', 'hidden');\n    var groups = detail.builtGroups.get().concat([overflowGroup]);\n    var focusedComp = findFocusedComp(groups);\n    setOverflow([]);\n    setGroups(primary, groups);\n    var availableWidth = get$7(primary.element);\n    var overflows = partition$3(availableWidth, detail.builtGroups.get(), function (comp) {\n      return get$7(comp.element);\n    }, overflowGroup);\n\n    if (overflows.extra.length === 0) {\n      Replacing.remove(primary, overflowGroup);\n      setOverflow([]);\n    } else {\n      setGroups(primary, overflows.within);\n      setOverflow(overflows.extra);\n    }\n\n    remove$6(primary.element, 'visibility');\n    reflow(primary.element);\n    focusedComp.each(Focusing.focus);\n  };\n\n  var schema$l = constant([field$1('splitToolbarBehaviours', [Coupling]), state$1('builtGroups', function () {\n    return Cell([]);\n  })]);\n  var schema$m = constant([markers(['overflowToggledClass']), optionFunction('getOverflowBounds'), strict$1('lazySink'), state$1('overflowGroups', function () {\n    return Cell([]);\n  })].concat(schema$l()));\n  var parts$8 = constant([required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'primary'\n  }), external$1({\n    schema: schema$k(),\n    name: 'overflow'\n  }), external$1({\n    name: 'overflow-button'\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n  var schema$n = constant([markers(['toggledClass']), strict$1('lazySink'), strictFunction('fetch'), optionFunction('getBounds'), optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]), schema$1()]);\n  var parts$9 = constant([external$1({\n    name: 'button',\n    overrides: function (detail) {\n      return {\n        dom: {\n          attributes: {\n            'aria-haspopup': 'true'\n          }\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.toggledClass,\n          aria: {\n            mode: 'expanded'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'toolbar',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Keying.config({\n          mode: 'cyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'button').each(Focusing.focus);\n            return Optional.none();\n          }\n        })])\n      };\n    }\n  })]);\n\n  var toggle$2 = function (button, externals) {\n    var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n\n    if (Sandboxing.isOpen(toolbarSandbox)) {\n      Sandboxing.close(toolbarSandbox);\n    } else {\n      Sandboxing.open(toolbarSandbox, externals.toolbar());\n    }\n  };\n\n  var position$2 = function (button, toolbar, detail, layouts) {\n    var bounds = detail.getBounds.map(function (bounder) {\n      return bounder();\n    });\n    var sink = detail.lazySink(button).getOrDie();\n    Positioning.positionWithinBounds(sink, {\n      anchor: 'hotspot',\n      hotspot: button,\n      layouts: layouts,\n      overrides: {\n        maxWidthFunction: expandable$1()\n      }\n    }, toolbar, bounds);\n  };\n\n  var setGroups$1 = function (button, toolbar, detail, layouts, groups) {\n    Toolbar.setGroups(toolbar, groups);\n    position$2(button, toolbar, detail, layouts);\n    Toggling.on(button);\n  };\n\n  var makeSandbox$1 = function (button, spec, detail) {\n    var ariaOwner = manager();\n\n    var onOpen = function (sandbox, toolbar) {\n      detail.fetch().get(function (groups) {\n        setGroups$1(button, toolbar, detail, spec.layouts, groups);\n        ariaOwner.link(button.element);\n        Keying.focusIn(toolbar);\n      });\n    };\n\n    var onClose = function () {\n      Toggling.off(button);\n      Focusing.focus(button);\n      ariaOwner.unlink(button.element);\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          id: ariaOwner.id\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          Sandboxing.close(comp);\n          return Optional.some(true);\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOf(button, queryElem);\n        },\n        getAttachPoint: function () {\n          return detail.lazySink(button).getOrDie();\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel(__assign({\n          isExtraPart: never\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel$1({\n          doReposition: function () {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position$2(button, toolbar, detail, spec.layouts);\n            });\n          }\n        }))\n      })])\n    };\n  };\n\n  var factory$a = function (detail, components, spec, externals) {\n    return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n      action: function (button) {\n        toggle$2(button, externals);\n      },\n      buttonBehaviours: SketchBehaviours.augment({\n        dump: externals.button().buttonBehaviours\n      }, [Coupling.config({\n        others: {\n          toolbarSandbox: function (button) {\n            return makeSandbox$1(button, spec, detail);\n          }\n        }\n      })])\n    }))), {\n      apis: {\n        setGroups: function (button, groups) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            setGroups$1(button, toolbar, detail, spec.layouts, groups);\n          });\n        },\n        reposition: function (button) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            position$2(button, toolbar, detail, spec.layouts);\n          });\n        },\n        toggle: function (button) {\n          toggle$2(button, externals);\n        },\n        getToolbar: function (button) {\n          return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n        },\n        isOpen: function (button) {\n          return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n        }\n      }\n    });\n  };\n\n  var FloatingToolbarButton = composite$1({\n    name: 'FloatingToolbarButton',\n    factory: factory$a,\n    configFields: schema$n(),\n    partFields: parts$9(),\n    apis: {\n      setGroups: function (apis, button, groups) {\n        apis.setGroups(button, groups);\n      },\n      reposition: function (apis, button) {\n        apis.reposition(button);\n      },\n      toggle: function (apis, button) {\n        apis.toggle(button);\n      },\n      getToolbar: function (apis, button) {\n        return apis.getToolbar(button);\n      },\n      isOpen: function (apis, button) {\n        return apis.isOpen(button);\n      }\n    }\n  });\n  var schema$o = constant([strict$1('items'), markers(['itemSelector']), field$1('tgroupBehaviours', [Keying])]);\n  var parts$a = constant([group({\n    name: 'items',\n    unit: 'item'\n  })]);\n\n  var factory$b = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n        mode: 'flow',\n        selector: detail.markers.itemSelector\n      })]),\n      domModification: {\n        attributes: {\n          role: 'toolbar'\n        }\n      }\n    };\n  };\n\n  var ToolbarGroup = composite$1({\n    name: 'ToolbarGroup',\n    configFields: schema$o(),\n    partFields: parts$a(),\n    factory: factory$b\n  });\n\n  var buildGroups = function (comps) {\n    return map(comps, function (g) {\n      return premade$1(g);\n    });\n  };\n\n  var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n    refresh(toolbar, detail, function (overflowGroups) {\n      detail.overflowGroups.set(overflowGroups);\n      memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n        FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n      });\n    });\n  };\n\n  var factory$c = function (detail, components, spec, externals) {\n    var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(buildGroups(detail.overflowGroups.get()));\n        });\n      },\n      layouts: {\n        onLtr: function () {\n          return [southwest$1, southeast$1];\n        },\n        onRtl: function () {\n          return [southeast$1, southwest$1];\n        },\n        onBottomLtr: function () {\n          return [northwest$1, northeast$1];\n        },\n        onBottomRtl: function () {\n          return [northeast$1, northwest$1];\n        }\n      },\n      getBounds: spec.getOverflowBounds,\n      lazySink: detail.lazySink,\n      fireDismissalEventInstead: {},\n      markers: {\n        toggledClass: detail.markers.overflowToggledClass\n      },\n      parts: {\n        button: externals['overflow-button'](),\n        toolbar: externals.overflow()\n      }\n    }));\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function () {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [memFloatingToolbarButton.asSpec()]\n            }));\n          }\n        }\n      })]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          detail.builtGroups.set(map(groups, toolbar.getSystem().build));\n          refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        toggle: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.toggle(floatingToolbarButton);\n          });\n        },\n        isOpen: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n        },\n        reposition: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.reposition(floatingToolbarButton);\n          });\n        },\n        getOverflow: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitFloatingToolbar = composite$1({\n    name: 'SplitFloatingToolbar',\n    configFields: schema$m(),\n    partFields: parts$8(),\n    factory: factory$c,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      reposition: function (apis, toolbar) {\n        apis.reposition(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      },\n      getOverflow: function (apis, toolbar) {\n        return apis.getOverflow(toolbar);\n      }\n    }\n  });\n\n  var getAnimationRoot = function (component, slideConfig) {\n    return slideConfig.getAnimationRoot.fold(function () {\n      return component.element;\n    }, function (get) {\n      return get(component);\n    });\n  };\n\n  var getDimensionProperty = function (slideConfig) {\n    return slideConfig.dimension.property;\n  };\n\n  var getDimension = function (slideConfig, elem) {\n    return slideConfig.dimension.getDimension(elem);\n  };\n\n  var disableTransitions = function (component, slideConfig) {\n    var root = getAnimationRoot(component, slideConfig);\n    remove$5(root, [slideConfig.shrinkingClass, slideConfig.growingClass]);\n  };\n\n  var setShrunk = function (component, slideConfig) {\n    remove$4(component.element, slideConfig.openClass);\n    add$2(component.element, slideConfig.closedClass);\n    set$2(component.element, getDimensionProperty(slideConfig), '0px');\n    reflow(component.element);\n  };\n\n  var setGrown = function (component, slideConfig) {\n    remove$4(component.element, slideConfig.closedClass);\n    add$2(component.element, slideConfig.openClass);\n    remove$6(component.element, getDimensionProperty(slideConfig));\n  };\n\n  var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n    slideState.setCollapsed();\n    set$2(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n    reflow(component.element);\n    disableTransitions(component, slideConfig);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n    slideConfig.onShrunk(component);\n  };\n\n  var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n    var size = calculatedSize.getOrThunk(function () {\n      return getDimension(slideConfig, component.element);\n    });\n    slideState.setCollapsed();\n    set$2(component.element, getDimensionProperty(slideConfig), size);\n    reflow(component.element);\n    var root = getAnimationRoot(component, slideConfig);\n    remove$4(root, slideConfig.growingClass);\n    add$2(root, slideConfig.shrinkingClass);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n  };\n\n  var doStartSmartShrink = function (component, slideConfig, slideState) {\n    var size = getDimension(slideConfig, component.element);\n    var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n    shrinker(component, slideConfig, slideState, Optional.some(size));\n  };\n\n  var doStartGrow = function (component, slideConfig, slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    var wasShrinking = has$2(root, slideConfig.shrinkingClass);\n    var beforeSize = getDimension(slideConfig, component.element);\n    setGrown(component, slideConfig);\n    var fullSize = getDimension(slideConfig, component.element);\n\n    var startPartialGrow = function () {\n      set$2(component.element, getDimensionProperty(slideConfig), beforeSize);\n      reflow(component.element);\n    };\n\n    var startCompleteGrow = function () {\n      setShrunk(component, slideConfig);\n    };\n\n    var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n    setStartSize();\n    remove$4(root, slideConfig.shrinkingClass);\n    add$2(root, slideConfig.growingClass);\n    setGrown(component, slideConfig);\n    set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n    slideState.setExpanded();\n    slideConfig.onStartGrow(component);\n  };\n\n  var refresh$2 = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      remove$6(component.element, getDimensionProperty(slideConfig));\n      var fullSize = getDimension(slideConfig, component.element);\n      set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n    }\n  };\n\n  var grow = function (component, slideConfig, slideState) {\n    if (!slideState.isExpanded()) {\n      doStartGrow(component, slideConfig, slideState);\n    }\n  };\n\n  var shrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doStartSmartShrink(component, slideConfig, slideState);\n    }\n  };\n\n  var immediateShrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doImmediateShrink(component, slideConfig, slideState, Optional.none());\n    }\n  };\n\n  var hasGrown = function (component, slideConfig, slideState) {\n    return slideState.isExpanded();\n  };\n\n  var hasShrunk = function (component, slideConfig, slideState) {\n    return slideState.isCollapsed();\n  };\n\n  var isGrowing = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has$2(root, slideConfig.growingClass) === true;\n  };\n\n  var isShrinking = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has$2(root, slideConfig.shrinkingClass) === true;\n  };\n\n  var isTransitioning = function (component, slideConfig, slideState) {\n    return isGrowing(component, slideConfig) === true || isShrinking(component, slideConfig) === true;\n  };\n\n  var toggleGrow = function (component, slideConfig, slideState) {\n    var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n    f(component, slideConfig, slideState);\n  };\n\n  var SlidingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$2,\n    grow: grow,\n    shrink: shrink,\n    immediateShrink: immediateShrink,\n    hasGrown: hasGrown,\n    hasShrunk: hasShrunk,\n    isGrowing: isGrowing,\n    isShrinking: isShrinking,\n    isTransitioning: isTransitioning,\n    toggleGrow: toggleGrow,\n    disableTransitions: disableTransitions\n  });\n\n  var exhibit$6 = function (base, slideConfig, _slideState) {\n    var expanded = slideConfig.expanded;\n    return expanded ? nu$6({\n      classes: [slideConfig.openClass],\n      styles: {}\n    }) : nu$6({\n      classes: [slideConfig.closedClass],\n      styles: wrap$1(slideConfig.dimension.property, '0px')\n    });\n  };\n\n  var events$d = function (slideConfig, slideState) {\n    return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.propertyName === slideConfig.dimension.property) {\n        disableTransitions(component, slideConfig);\n\n        if (slideState.isExpanded()) {\n          remove$6(component.element, slideConfig.dimension.property);\n        }\n\n        var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n        notify(component);\n      }\n    })]);\n  };\n\n  var ActiveSliding = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$6,\n    events: events$d\n  });\n  var SlidingSchema = [strict$1('closedClass'), strict$1('openClass'), strict$1('shrinkingClass'), strict$1('growingClass'), option('getAnimationRoot'), onHandler('onShrunk'), onHandler('onStartShrink'), onHandler('onGrown'), onHandler('onStartGrow'), defaulted$1('expanded', false), strictOf('dimension', choose$1('property', {\n    width: [output('property', 'width'), output('getDimension', function (elem) {\n      return get$7(elem) + 'px';\n    })],\n    height: [output('property', 'height'), output('getDimension', function (elem) {\n      return get$6(elem) + 'px';\n    })]\n  }))];\n\n  var init$9 = function (spec) {\n    var state = Cell(spec.expanded);\n\n    var readState = function () {\n      return 'expanded: ' + state.get();\n    };\n\n    return nu$5({\n      isExpanded: function () {\n        return state.get() === true;\n      },\n      isCollapsed: function () {\n        return state.get() === false;\n      },\n      setCollapsed: curry(state.set, false),\n      setExpanded: curry(state.set, true),\n      readState: readState\n    });\n  };\n\n  var SlidingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$9\n  });\n  var Sliding = create$1({\n    fields: SlidingSchema,\n    name: 'sliding',\n    active: ActiveSliding,\n    apis: SlidingApis,\n    state: SlidingState\n  });\n  var schema$p = constant([markers(['closedClass', 'openClass', 'shrinkingClass', 'growingClass', 'overflowToggledClass']), onHandler('onOpened'), onHandler('onClosed')].concat(schema$l()));\n  var parts$b = constant([required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'primary'\n  }), required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'overflow',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Sliding.config({\n          dimension: {\n            property: 'height'\n          },\n          closedClass: detail.markers.closedClass,\n          openClass: detail.markers.openClass,\n          shrinkingClass: detail.markers.shrinkingClass,\n          growingClass: detail.markers.growingClass,\n          onShrunk: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(function (button) {\n              Toggling.off(button);\n              Focusing.focus(button);\n            });\n            detail.onClosed(comp);\n          },\n          onGrown: function (comp) {\n            Keying.focusIn(comp);\n            detail.onOpened(comp);\n          },\n          onStartGrow: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Toggling.on);\n          }\n        }), Keying.config({\n          mode: 'acyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n            return Optional.some(true);\n          }\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-button',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.overflowToggledClass,\n          aria: {\n            mode: 'pressed'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n\n  var isOpen$1 = function (toolbar, detail) {\n    return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n  };\n\n  var toggleToolbar = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow-button').bind(function () {\n      return getPart(toolbar, detail, 'overflow');\n    }).each(function (overf) {\n      refresh$3(toolbar, detail);\n      Sliding.toggleGrow(overf);\n    });\n  };\n\n  var refresh$3 = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow').each(function (overflow) {\n      refresh(toolbar, detail, function (groups) {\n        var builtGroups = map(groups, function (g) {\n          return premade$1(g);\n        });\n        Toolbar.setGroups(overflow, builtGroups);\n      });\n      getPart(toolbar, detail, 'overflow-button').each(function (button) {\n        if (Sliding.hasGrown(overflow)) {\n          Toggling.on(button);\n        }\n      });\n      Sliding.refresh(overflow);\n    });\n  };\n\n  var factory$d = function (detail, components, spec, externals) {\n    var toolbarToggleEvent = 'alloy.toolbar.toggle';\n\n    var doSetGroups = function (toolbar, groups) {\n      var built = map(groups, toolbar.getSystem().build);\n      detail.builtGroups.set(built);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function (toolbar) {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                action: function (_button) {\n                  emit(toolbar, toolbarToggleEvent);\n                }\n              }))]\n            }));\n          }\n        }\n      }), config('toolbar-toggle-events', [run(toolbarToggleEvent, function (toolbar) {\n        toggleToolbar(toolbar, detail);\n      })])]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          doSetGroups(toolbar, groups);\n          refresh$3(toolbar, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh$3(toolbar, detail);\n        },\n        toggle: function (toolbar) {\n          return toggleToolbar(toolbar, detail);\n        },\n        isOpen: function (toolbar) {\n          return isOpen$1(toolbar, detail);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitSlidingToolbar = composite$1({\n    name: 'SplitSlidingToolbar',\n    configFields: schema$p(),\n    partFields: parts$b(),\n    factory: factory$d,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      }\n    }\n  });\n  var toolbarHeightChange = constant(generate$1('toolbar-height-change'));\n\n  var renderToolbarGroupCommon = function (toolbarGroup) {\n    var attributes = toolbarGroup.title.fold(function () {\n      return {};\n    }, function (title) {\n      return {\n        attributes: {\n          title: title\n        }\n      };\n    });\n    return {\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-toolbar__group']\n      }, attributes),\n      components: [ToolbarGroup.parts.items({})],\n      items: toolbarGroup.items,\n      markers: {\n        itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])'\n      },\n      tgroupBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderToolbarGroup = function (toolbarGroup) {\n    return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n  };\n\n  var getToolbarbehaviours = function (toolbarSpec, modeName) {\n    var onAttached = runOnAttached(function (component) {\n      var groups = map(toolbarSpec.initGroups, renderToolbarGroup);\n      Toolbar.setGroups(component, groups);\n    });\n    return derive$1([DisablingConfigs.toolbarButton(toolbarSpec.providers.isReadOnly), receivingConfig(), Keying.config({\n      mode: modeName,\n      onEscape: toolbarSpec.onEscape,\n      selector: '.tox-toolbar__group'\n    }), config('toolbar-events', [onAttached])]);\n  };\n\n  var renderMoreToolbarCommon = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return {\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      parts: {\n        'overflow-group': renderToolbarGroupCommon({\n          title: Optional.none(),\n          items: []\n        }),\n        'overflow-button': renderIconButtonSpec({\n          name: 'more',\n          icon: Optional.some('more-drawer'),\n          disabled: false,\n          tooltip: Optional.some('More...'),\n          primary: false,\n          borderless: false\n        }, Optional.none(), toolbarSpec.providers)\n      },\n      splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    };\n  };\n\n  var renderFloatingMoreToolbar = function (toolbarSpec) {\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    var overflowXOffset = 4;\n    var primary = SplitFloatingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      lazySink: toolbarSpec.getSink,\n      getOverflowBounds: function () {\n        var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n        var headerBounds = absolute$1(headerElem);\n        var docElem = documentElement(headerElem);\n        var docBounds = absolute$1(docElem);\n        var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n        return bounds$1(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n      },\n      parts: __assign(__assign({}, baseSpec.parts), {\n        overflow: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: toolbarSpec.attributes\n          }\n        }\n      }),\n      components: [primary],\n      markers: {\n        overflowToggledClass: 'tox-tbtn--enabled'\n      }\n    }));\n  };\n\n  var renderSlidingMoreToolbar = function (toolbarSpec) {\n    var primary = SplitSlidingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    var overflow = SplitSlidingToolbar.parts.overflow({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__overflow']\n      }\n    });\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      components: [primary, overflow],\n      markers: {\n        openClass: 'tox-toolbar__overflow--open',\n        closedClass: 'tox-toolbar__overflow--closed',\n        growingClass: 'tox-toolbar__overflow--growing',\n        shrinkingClass: 'tox-toolbar__overflow--shrinking',\n        overflowToggledClass: 'tox-tbtn--enabled'\n      },\n      onOpened: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'opened'\n        });\n      },\n      onClosed: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'closed'\n        });\n      }\n    }));\n  };\n\n  var renderToolbar = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return Toolbar.sketch({\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n      },\n      components: [Toolbar.parts.groups({})],\n      toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    });\n  };\n\n  var groupToolbarButtonSchema = objOf([strictString('type'), strictOf('items', oneOf([arrOfObj$1([strictString('name'), strictArrayOf('items', string)]), string]))].concat(baseToolbarButtonFields));\n\n  var createGroupToolbarButton = function (spec) {\n    return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n  };\n\n  var baseMenuButtonFields = [optionString('text'), optionString('tooltip'), optionString('icon'), strictFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var MenuButtonSchema = objOf(__spreadArrays([strictString('type')], baseMenuButtonFields));\n\n  var createMenuButton = function (spec) {\n    return asRaw('menubutton', MenuButtonSchema, spec);\n  };\n\n  var splitButtonSchema = objOf([strictString('type'), optionString('tooltip'), optionString('icon'), optionString('text'), optionFunction('select'), strictFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedStringEnum('presets', 'normal', ['normal', 'color', 'listpreview']), defaulted$1('columns', 1), strictFunction('onAction'), strictFunction('onItemAction')]);\n\n  var createSplitButton = function (spec) {\n    return asRaw('SplitButton', splitButtonSchema, spec);\n  };\n\n  var events$e = function (reflectingConfig, reflectingState) {\n    var update = function (component, data) {\n      reflectingConfig.updateState.each(function (updateState) {\n        var newState = updateState(component, data);\n        reflectingState.set(newState);\n      });\n      reflectingConfig.renderComponents.each(function (renderComponents) {\n        var newComponents = renderComponents(data, reflectingState.get());\n        var newChildren = map(newComponents, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      });\n    };\n\n    return derive([run(receive(), function (component, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        var channel = reflectingConfig.channel;\n\n        if (contains(receivingData.channels, channel)) {\n          update(component, receivingData.data);\n        }\n      }\n    }), runOnAttached(function (comp, _se) {\n      reflectingConfig.initialData.each(function (rawData) {\n        update(comp, rawData);\n      });\n    })]);\n  };\n\n  var ActiveReflecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$e\n  });\n\n  var getState$2 = function (component, replaceConfig, reflectState) {\n    return reflectState;\n  };\n\n  var ReflectingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getState: getState$2\n  });\n  var ReflectingSchema = [strict$1('channel'), option('renderComponents'), option('updateState'), option('initialData')];\n\n  var init$a = function () {\n    var cell = Cell(Optional.none());\n\n    var set = function (optS) {\n      return cell.set(optS);\n    };\n\n    var clear = function () {\n      return cell.set(Optional.none());\n    };\n\n    var get = function () {\n      return cell.get();\n    };\n\n    var readState = function () {\n      return cell.get().fold(function () {\n        return 'none';\n      }, function (x) {\n        return x;\n      });\n    };\n\n    return {\n      readState: readState,\n      get: get,\n      set: set,\n      clear: clear\n    };\n  };\n\n  var ReflectingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$a\n  });\n  var Reflecting = create$1({\n    fields: ReflectingSchema,\n    name: 'reflecting',\n    active: ActiveReflecting,\n    apis: ReflectingApis,\n    state: ReflectingState\n  });\n  var schema$q = constant([strict$1('toggleClass'), strict$1('fetch'), onStrictHandler('onExecute'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), schema$1(), onStrictHandler('onItemExecute'), option('lazySink'), strict$1('dom'), onHandler('onOpen'), field$1('splitDropdownBehaviours', [Coupling, Keying, Focusing]), defaulted$1('matchWidth', false), defaulted$1('useMinWidth', false), defaulted$1('eventOrder', {}), option('role')].concat(sandboxFields()));\n  var arrowPart = required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'arrow',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (arrow) {\n          arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleOnExecute: false,\n          toggleClass: detail.toggleClass\n        })])\n      };\n    }\n  });\n  var buttonPart = required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'button',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (btn) {\n          btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onExecute(splitDropdown, btn);\n          });\n        }\n      };\n    }\n  });\n  var parts$c = constant([arrowPart, buttonPart, optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [strict$1('text')],\n    name: 'aria-descriptor'\n  }), external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: function (tmenu, item) {\n          tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onItemExecute(splitDropdown, tmenu, item);\n          });\n        }\n      };\n    }\n  }), partType()]);\n\n  var factory$e = function (detail, components, spec, externals) {\n    var _a;\n\n    var switchToMenu = function (sandbox) {\n      Composing.getCurrent(sandbox).each(function (current) {\n        Highlighting.highlightFirst(current);\n        Keying.focusIn(current);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, function (x) {\n        return x;\n      }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var openMenu = function (comp) {\n      action(comp);\n      return Optional.some(true);\n    };\n\n    var executeOnButton = function (comp) {\n      var button = getPartOrDie(comp, detail, 'button');\n      emitExecute(button);\n      return Optional.some(true);\n    };\n\n    var buttonEvents = __assign(__assign({}, derive([runOnAttached(function (component, _simulatedEvent) {\n      var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n      ariaDescriptor.each(function (descriptor) {\n        var descriptorId = generate$1('aria');\n        set$1(descriptor.element, 'id', descriptorId);\n        set$1(component.element, 'aria-describedby', descriptorId);\n      });\n    })])), events$7(Optional.some(action)));\n\n    var apis = {\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      events: buttonEvents,\n      behaviours: augment(detail.splitDropdownBehaviours, [Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            var arrow = getPartOrDie(hotspot, detail, 'arrow');\n            var extras = {\n              onOpen: function () {\n                Toggling.on(arrow);\n                Toggling.on(hotspot);\n              },\n              onClose: function () {\n                Toggling.off(arrow);\n                Toggling.off(hotspot);\n              }\n            };\n            return makeSandbox(detail, hotspot, extras);\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: executeOnButton,\n        onEnter: executeOnButton,\n        onDown: openMenu\n      }), Focusing.config({}), Toggling.config({\n        toggleOnExecute: false,\n        aria: {\n          mode: 'expanded'\n        }\n      })]),\n      domModification: {\n        attributes: {\n          'role': detail.role.getOr('button'),\n          'aria-haspopup': true\n        }\n      }\n    };\n  };\n\n  var SplitDropdown = composite$1({\n    name: 'SplitDropdown',\n    configFields: schema$q(),\n    partFields: parts$c(),\n    factory: factory$e,\n    apis: {\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var getButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getToggleApi = function (component) {\n    return {\n      setActive: function (state) {\n        Toggling.set(component, state);\n      },\n      isActive: function () {\n        return Toggling.isOn(component);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getTooltipAttributes = function (tooltip, providersBackstage) {\n    return tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n  };\n\n  var focusButtonEvent = generate$1('focus-button');\n  var rtlIcon$1 = ['checklist', 'ordered-list'];\n  var rtlTransform$1 = ['indent', 'outdent', 'table-insert-column-after', 'table-insert-column-before', 'unordered-list'];\n\n  var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n    var _d;\n\n    var getIconName = function (iconName) {\n      return global$6.isRtl() && contains(rtlIcon$1, iconName) ? iconName + '-rtl' : iconName;\n    };\n\n    var needsRtlClass = global$6.isRtl() && icon.exists(function (name) {\n      return contains(rtlTransform$1, name);\n    });\n    return {\n      dom: {\n        tag: 'button',\n        classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []).concat(needsRtlClass ? ['tox-tbtn__icon-rtl'] : []),\n        attributes: getTooltipAttributes(tooltip, providersBackstage)\n      },\n      components: componentRenderPipeline([icon.map(function (iconName) {\n        return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n      }), text.map(function (text) {\n        return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n      })]),\n      eventOrder: (_d = {}, _d[mousedown()] = ['focusing', 'alloy.base.behaviour', 'common-button-display-events'], _d),\n      buttonBehaviours: derive$1([DisablingConfigs.toolbarButton(providersBackstage.isReadOnly), receivingConfig(), config('common-button-display-events', [run(mousedown(), function (button, se) {\n        se.event.prevent();\n        emit(button, focusButtonEvent);\n      })])].concat(receiver.map(function (r) {\n        return Reflecting.config({\n          channel: r,\n          initialData: {\n            icon: icon,\n            text: text\n          },\n          renderComponents: function (data, _state) {\n            return componentRenderPipeline([data.icon.map(function (iconName) {\n              return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n            }), data.text.map(function (text) {\n              return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n            })]);\n          }\n        });\n      }).toArray()).concat(behaviours.getOr([])))\n    };\n  };\n\n  var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n    var sharedBackstage = backstage.shared;\n    return FloatingToolbarButton.sketch({\n      lazySink: sharedBackstage.getSink,\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(map(identifyButtons(spec.items), renderToolbarGroup));\n        });\n      },\n      markers: {\n        toggledClass: 'tox-tbtn--enabled'\n      },\n      parts: {\n        button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n        toolbar: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: attributes\n          }\n        }\n      }\n    });\n  };\n\n  var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n    var editorOffCell = Cell(noop);\n    var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n    return Button.sketch({\n      dom: structure.dom,\n      components: structure.components,\n      eventOrder: toolbarButtonEventOrder,\n      buttonBehaviours: derive$1([config('toolbar-button-events', [onToolbarButtonExecute({\n        onAction: spec.onAction,\n        getApi: specialisation.getApi\n      }), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), DisablingConfigs.toolbarButton(function () {\n        return spec.disabled || providersBackstage.isReadOnly();\n      }), receivingConfig()].concat(specialisation.toolbarButtonBehaviours))\n    });\n  };\n\n  var renderToolbarButton = function (spec, providersBackstage) {\n    return renderToolbarButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n      getApi: getButtonApi,\n      onSetup: spec.onSetup\n    }, providersBackstage);\n  };\n\n  var renderToolbarToggleButton = function (spec, providersBackstage) {\n    return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return deepMerge(renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [Replacing.config({}), Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        aria: {\n          mode: 'pressed'\n        },\n        toggleOnExecute: false\n      })].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n      getApi: getToggleApi,\n      onSetup: spec.onSetup\n    }, providersBackstage));\n  };\n\n  var fetchChoices = function (getApi, spec, providersBackstage) {\n    return function (comp) {\n      return Future.nu(function (callback) {\n        return spec.fetch(callback);\n      }).map(function (items) {\n        return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n          spec.onItemAction(getApi(comp), value);\n        }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(function () {\n          return false;\n        }), providersBackstage), {\n          movement: deriveMenuMovement(spec.columns, spec.presets),\n          menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n              var numRows = _d.numRows,\n                  numColumns = _d.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n        })));\n      });\n    };\n  };\n\n  var renderSplitButton = function (spec, sharedBackstage) {\n    var _d;\n\n    var displayChannel = generate$1('channel-update-split-dropdown-display');\n\n    var getApi = function (comp) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(comp);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(comp, state);\n        },\n        setIconFill: function (id, value) {\n          descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$1(underlinePath, 'fill', value);\n          });\n        },\n        setIconStroke: function (id, value) {\n          descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$1(underlinePath, 'stroke', value);\n          });\n        },\n        setActive: function (state) {\n          set$1(comp.element, 'aria-pressed', state);\n          descendant$1(comp.element, 'span').each(function (button) {\n            comp.getSystem().getByDom(button).each(function (buttonComp) {\n              return Toggling.set(buttonComp, state);\n            });\n          });\n        },\n        isActive: function () {\n          return descendant$1(comp.element, 'span').exists(function (button) {\n            return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n          });\n        }\n      };\n    };\n\n    var editorOffCell = Cell(noop);\n    var specialisation = {\n      getApi: getApi,\n      onSetup: spec.onSetup\n    };\n    return SplitDropdown.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-split-button'],\n        attributes: __assign({\n          'aria-pressed': false\n        }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n      },\n      onExecute: function (button) {\n        spec.onAction(getApi(button));\n      },\n      onItemExecute: function (_a, _b, _c) {},\n      splitDropdownBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isReadOnly), receivingConfig(), config('split-dropdown-events', [run(focusButtonEvent, Focusing.focus), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), Unselecting.config({})]),\n      eventOrder: (_d = {}, _d[attachedToDom()] = ['alloy.base.behaviour', 'split-dropdown-events'], _d),\n      toggleClass: 'tox-tbtn--enabled',\n      lazySink: sharedBackstage.getSink,\n      fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      components: [SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        toggleOnExecute: false\n      })]), sharedBackstage.providers)), SplitDropdown.parts.arrow({\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn', 'tox-split-button__chevron'],\n          innerHtml: get$d('chevron-down', sharedBackstage.providers.icons)\n        },\n        buttonBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isReadOnly), receivingConfig()])\n      }), SplitDropdown.parts['aria-descriptor']({\n        text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter')\n      })]\n    });\n  };\n\n  var getFormApi = function (input) {\n    return {\n      hide: function () {\n        return emit(input, sandboxClose());\n      },\n      getValue: function () {\n        return Representing.getValue(input);\n      }\n    };\n  };\n\n  var runOnExecute$1 = function (memInput, original) {\n    return run(internalToolbarButtonExecute, function (comp, se) {\n      var input = memInput.get(comp);\n      var formApi = getFormApi(input);\n      original.onAction(formApi, se.event.buttonApi);\n    });\n  };\n\n  var renderContextButton = function (memInput, button, extras) {\n    var _a = button.original,\n        primary = _a.primary,\n        rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n      type: 'button',\n      onAction: function () {}\n    })));\n    return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n  };\n\n  var renderContextToggleButton = function (memInput, button, extras) {\n    var _a = button.original,\n        primary = _a.primary,\n        rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n      type: 'togglebutton',\n      onAction: function () {}\n    })));\n    return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n  };\n\n  var generateOne$1 = function (memInput, button, providersBackstage) {\n    var extras = {\n      backstage: {\n        shared: {\n          providers: providersBackstage\n        }\n      }\n    };\n\n    if (button.type === 'contextformtogglebutton') {\n      return renderContextToggleButton(memInput, button, extras);\n    } else {\n      return renderContextButton(memInput, button, extras);\n    }\n  };\n\n  var generate$7 = function (memInput, buttons, providersBackstage) {\n    var mementos = map(buttons, function (button) {\n      return record(generateOne$1(memInput, button, providersBackstage));\n    });\n\n    var asSpecs = function () {\n      return map(mementos, function (mem) {\n        return mem.asSpec();\n      });\n    };\n\n    var findPrimary = function (compInSystem) {\n      return findMap(buttons, function (button, i) {\n        if (button.primary) {\n          return Optional.from(mementos[i]).bind(function (mem) {\n            return mem.getOpt(compInSystem);\n          }).filter(not(Disabling.isDisabled));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    return {\n      asSpecs: asSpecs,\n      findPrimary: findPrimary\n    };\n  };\n\n  var buildInitGroups = function (ctx, providers) {\n    var inputAttributes = ctx.label.fold(function () {\n      return {};\n    }, function (label) {\n      return {\n        'aria-label': label\n      };\n    });\n    var memInput = record(Input.sketch({\n      inputClasses: ['tox-toolbar-textfield', 'tox-toolbar-nav-js'],\n      data: ctx.initValue(),\n      inputAttributes: inputAttributes,\n      selectOnFocus: true,\n      inputBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEnter: function (input) {\n          return commands.findPrimary(input).map(function (primary) {\n            emitExecute(primary);\n            return true;\n          });\n        },\n        onLeft: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        },\n        onRight: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        }\n      })])\n    }));\n    var commands = generate$7(memInput, ctx.commands, providers);\n    return [{\n      title: Optional.none(),\n      items: [memInput.asSpec()]\n    }, {\n      title: Optional.none(),\n      items: commands.asSpecs()\n    }];\n  };\n\n  var renderContextForm = function (toolbarType, ctx, providers) {\n    return renderToolbar({\n      type: toolbarType,\n      uid: generate$1('context-toolbar'),\n      initGroups: buildInitGroups(ctx, providers),\n      onEscape: Optional.none,\n      cyclicKeying: true,\n      providers: providers\n    });\n  };\n\n  var ContextForm = {\n    renderContextForm: renderContextForm,\n    buildInitGroups: buildInitGroups\n  };\n\n  var getHorizontalBounds = function (contentAreaBox, viewportBounds) {\n    var x = Math.max(viewportBounds.x, contentAreaBox.x);\n    var contentBoxWidth = contentAreaBox.right - x;\n    var maxViewportWidth = viewportBounds.width - (x - viewportBounds.x);\n    var width = Math.min(contentBoxWidth, maxViewportWidth);\n    return {\n      x: x,\n      width: width\n    };\n  };\n\n  var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var header = descendant$1(container, '.tox-editor-header').getOr(container);\n    var headerBox = box(header);\n    var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n    var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n\n    if (editor.inline && isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom, viewportBounds.y),\n        bottom: viewportBounds.bottom\n      };\n    }\n\n    if (editor.inline && !isToolbarAbove) {\n      return {\n        y: viewportBounds.y,\n        bottom: Math.min(headerBox.y, viewportBounds.bottom)\n      };\n    }\n\n    var containerBounds = box(container);\n\n    if (isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom, viewportBounds.y),\n        bottom: Math.min(containerBounds.bottom, viewportBounds.bottom)\n      };\n    }\n\n    return {\n      y: Math.max(containerBounds.y, viewportBounds.y),\n      bottom: Math.min(headerBox.y, viewportBounds.bottom)\n    };\n  };\n\n  var getContextToolbarBounds = function (editor, sharedBackstage) {\n    var viewportBounds = getBounds(window);\n    var contentAreaBox = box(SugarElement.fromDom(editor.getContentAreaContainer()));\n    var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n\n    var _a = getHorizontalBounds(contentAreaBox, viewportBounds),\n        x = _a.x,\n        width = _a.width;\n\n    if (editor.inline && !toolbarOrMenubarEnabled) {\n      return bounds$1(x, viewportBounds.y, width, viewportBounds.height);\n    } else {\n      var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n\n      var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop),\n          y = _b.y,\n          bottom = _b.bottom;\n\n      return bounds$1(x, y, width, bottom - y);\n    }\n  };\n\n  var matchTargetWith = function (elem, candidates) {\n    var ctxs = filter(candidates, function (toolbarApi) {\n      return toolbarApi.predicate(elem.dom);\n    });\n\n    var _a = partition(ctxs, function (t) {\n      return t.type === 'contexttoolbar';\n    }),\n        pass = _a.pass,\n        fail = _a.fail;\n\n    return {\n      contextToolbars: pass,\n      contextForms: fail\n    };\n  };\n\n  var filterByPositionForStartNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var doesPositionExist = function (value) {\n        return exists(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var filterToolbarsByPosition = function (value) {\n        return filter(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var hasSelectionToolbars = doesPositionExist('selection');\n      var hasNodeToolbars = doesPositionExist('node');\n\n      if (hasSelectionToolbars || hasNodeToolbars) {\n        if (hasNodeToolbars && hasSelectionToolbars) {\n          var nodeToolbars = filterToolbarsByPosition('node');\n          var selectionToolbars = map(filterToolbarsByPosition('selection'), function (t) {\n            return __assign(__assign({}, t), {\n              position: 'node'\n            });\n          });\n          return nodeToolbars.concat(selectionToolbars);\n        } else {\n          return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n        }\n      } else {\n        return filterToolbarsByPosition('line');\n      }\n    }\n  };\n\n  var filterByPositionForAncestorNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var findPosition_1 = function (value) {\n        return find(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var basePosition = findPosition_1('selection').orThunk(function () {\n        return findPosition_1('node');\n      }).orThunk(function () {\n        return findPosition_1('line');\n      }).map(function (t) {\n        return t.position;\n      });\n      return basePosition.fold(function () {\n        return [];\n      }, function (pos) {\n        return filter(toolbars, function (t) {\n          return t.position === pos;\n        });\n      });\n    }\n  };\n\n  var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n    var nodeMatches = matchTargetWith(elem, nodeCandidates);\n\n    if (nodeMatches.contextForms.length > 0) {\n      return Optional.some({\n        elem: elem,\n        toolbars: [nodeMatches.contextForms[0]]\n      });\n    } else {\n      var editorMatches = matchTargetWith(elem, editorCandidates);\n\n      if (editorMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [editorMatches.contextForms[0]]\n        });\n      } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n        var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n        return Optional.some({\n          elem: elem,\n          toolbars: toolbars\n        });\n      } else {\n        return Optional.none();\n      }\n    }\n  };\n\n  var matchAncestor = function (isRoot, startNode, scopes) {\n    if (isRoot(startNode)) {\n      return Optional.none();\n    } else {\n      return ancestor(startNode, function (ancestorElem) {\n        var _a = matchTargetWith(ancestorElem, scopes.inNodeScope),\n            contextToolbars = _a.contextToolbars,\n            contextForms = _a.contextForms;\n\n        var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n        return toolbars.length > 0 ? Optional.some({\n          elem: ancestorElem,\n          toolbars: toolbars\n        }) : Optional.none();\n      }, isRoot);\n    }\n  };\n\n  var lookup$1 = function (scopes, editor) {\n    var rootElem = SugarElement.fromDom(editor.getBody());\n\n    var isRoot = function (elem) {\n      return eq$1(elem, rootElem);\n    };\n\n    var isOutsideRoot = function (startNode) {\n      return !isRoot(startNode) && !contains$2(rootElem, startNode);\n    };\n\n    var startNode = SugarElement.fromDom(editor.selection.getNode());\n\n    if (isOutsideRoot(startNode)) {\n      return Optional.none();\n    }\n\n    return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n      return matchAncestor(isRoot, startNode, scopes);\n    });\n  };\n\n  var categorise = function (contextToolbars, navigate) {\n    var forms = {};\n    var inNodeScope = [];\n    var inEditorScope = [];\n    var formNavigators = {};\n    var lookupTable = {};\n\n    var registerForm = function (key, toolbarSpec) {\n      var contextForm = getOrDie(createContextForm(toolbarSpec));\n      forms[key] = contextForm;\n      contextForm.launch.map(function (launch) {\n        formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n          type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n          onAction: function () {\n            navigate(contextForm);\n          }\n        });\n      });\n\n      if (contextForm.scope === 'editor') {\n        inEditorScope.push(contextForm);\n      } else {\n        inNodeScope.push(contextForm);\n      }\n\n      lookupTable[key] = contextForm;\n    };\n\n    var registerToolbar = function (key, toolbarSpec) {\n      createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n        if (toolbarSpec.scope === 'editor') {\n          inEditorScope.push(contextToolbar);\n        } else {\n          inNodeScope.push(contextToolbar);\n        }\n\n        lookupTable[key] = contextToolbar;\n      });\n    };\n\n    var keys$1 = keys(contextToolbars);\n    each(keys$1, function (key) {\n      var toolbarApi = contextToolbars[key];\n\n      if (toolbarApi.type === 'contextform') {\n        registerForm(key, toolbarApi);\n      } else if (toolbarApi.type === 'contexttoolbar') {\n        registerToolbar(key, toolbarApi);\n      }\n    });\n    return {\n      forms: forms,\n      inNodeScope: inNodeScope,\n      inEditorScope: inEditorScope,\n      lookupTable: lookupTable,\n      formNavigators: formNavigators\n    };\n  };\n\n  var forwardSlideEvent = generate$1('forward-slide');\n  var backSlideEvent = generate$1('backward-slide');\n  var changeSlideEvent = generate$1('change-slide-event');\n  var resizingClass = 'tox-pop--resizing';\n\n  var renderContextToolbar = function (spec) {\n    var stack = Cell([]);\n    return InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-pop']\n      },\n      fireDismissalEventInstead: {\n        event: 'doNotDismissYet'\n      },\n      onShow: function (comp) {\n        stack.set([]);\n        InlineView.getContent(comp).each(function (c) {\n          remove$6(c.element, 'visibility');\n        });\n        remove$4(comp.element, resizingClass);\n        remove$6(comp.element, 'width');\n      },\n      inlineBehaviours: derive$1([config('context-toolbar-events', [runOnSource(transitionend(), function (comp, _se) {\n        remove$4(comp.element, resizingClass);\n        remove$6(comp.element, 'width');\n      }), run(changeSlideEvent, function (comp, se) {\n        remove$6(comp.element, 'width');\n        var currentWidth = get$7(comp.element);\n        InlineView.setContent(comp, se.event.contents);\n        add$2(comp.element, resizingClass);\n        var newWidth = get$7(comp.element);\n        set$2(comp.element, 'width', currentWidth + 'px');\n        InlineView.getContent(comp).each(function (newContents) {\n          se.event.focus.bind(function (f) {\n            focus$1(f);\n            return search(comp.element);\n          }).orThunk(function () {\n            Keying.focusIn(newContents);\n            return active();\n          });\n        });\n        global$2.setTimeout(function () {\n          set$2(comp.element, 'width', newWidth + 'px');\n        }, 0);\n      }), run(forwardSlideEvent, function (comp, se) {\n        InlineView.getContent(comp).each(function (oldContents) {\n          stack.set(stack.get().concat([{\n            bar: oldContents,\n            focus: active()\n          }]));\n        });\n        emitWith(comp, changeSlideEvent, {\n          contents: se.event.forwardContents,\n          focus: Optional.none()\n        });\n      }), run(backSlideEvent, function (comp, _se) {\n        last(stack.get()).each(function (last) {\n          stack.set(stack.get().slice(0, stack.get().length - 1));\n          emitWith(comp, changeSlideEvent, {\n            contents: premade$1(last.bar),\n            focus: last.focus\n          });\n        });\n      })]), Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          return last(stack.get()).fold(function () {\n            return spec.onEscape();\n          }, function (_) {\n            emit(comp, backSlideEvent);\n            return Optional.some(true);\n          });\n        }\n      })]),\n      lazySink: function () {\n        return Result.value(spec.sink);\n      }\n    });\n  };\n\n  var generateSelectItems = function (_editor, backstage, spec) {\n    var generateItem = function (rawItem, response, disabled, value) {\n      var translatedText = backstage.shared.providers.translate(rawItem.title);\n\n      if (rawItem.type === 'separator') {\n        return Optional.some({\n          type: 'separator',\n          text: translatedText\n        });\n      } else if (rawItem.type === 'submenu') {\n        var items = bind(rawItem.getStyleItems(), function (si) {\n          return validate(si, response, value);\n        });\n\n        if (response === 0 && items.length <= 0) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            type: 'nestedmenuitem',\n            text: translatedText,\n            disabled: items.length <= 0,\n            getSubmenuItems: function () {\n              return bind(rawItem.getStyleItems(), function (si) {\n                return validate(si, response, value);\n              });\n            }\n          });\n        }\n      } else {\n        return Optional.some(__assign({\n          type: 'togglemenuitem',\n          text: translatedText,\n          icon: rawItem.icon,\n          active: rawItem.isSelected(value),\n          disabled: disabled,\n          onAction: spec.onAction(rawItem)\n        }, rawItem.getStylePreview().fold(function () {\n          return {};\n        }, function (preview) {\n          return {\n            meta: {\n              style: preview\n            }\n          };\n        })));\n      }\n    };\n\n    var validate = function (item, response, value) {\n      var invalid = item.type === 'formatter' && spec.isInvalid(item);\n\n      if (response === 0) {\n        return invalid ? [] : generateItem(item, response, false, value).toArray();\n      } else {\n        return generateItem(item, response, invalid, value).toArray();\n      }\n    };\n\n    var validateItems = function (preItems) {\n      var value = spec.getCurrentValue();\n      var response = spec.shouldHide ? 0 : 1;\n      return bind(preItems, function (item) {\n        return validate(item, response, value);\n      });\n    };\n\n    var getFetch = function (backstage, getStyleItems) {\n      return function (comp, callback) {\n        var preItems = getStyleItems();\n        var items = validateItems(preItems);\n        var menu = build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n        callback(menu);\n      };\n    };\n\n    return {\n      validateItems: validateItems,\n      getFetch: getFetch\n    };\n  };\n\n  var createMenuItems = function (editor, backstage, spec) {\n    var dataset = spec.dataset;\n    var getStyleItems = dataset.type === 'basic' ? function () {\n      return map(dataset.data, function (d) {\n        return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n      });\n    } : dataset.getData;\n    return {\n      items: generateSelectItems(editor, backstage, spec),\n      getStyleItems: getStyleItems\n    };\n  };\n\n  var createSelectButton = function (editor, backstage, spec) {\n    var _a = createMenuItems(editor, backstage, spec),\n        items = _a.items,\n        getStyleItems = _a.getStyleItems;\n\n    var getApi = function (comp) {\n      return {\n        getComponent: function () {\n          return comp;\n        }\n      };\n    };\n\n    var onSetup = function (api) {\n      spec.setInitialValue.each(function (f) {\n        return f(api.getComponent());\n      });\n      return spec.nodeChangeHandler.map(function (f) {\n        var handler = f(api.getComponent());\n        editor.on('NodeChange', handler);\n        return function () {\n          editor.off('NodeChange', handler);\n        };\n      }).getOr(noop);\n    };\n\n    return renderCommonDropdown({\n      text: spec.icon.isSome() ? Optional.none() : Optional.some(''),\n      icon: spec.icon,\n      tooltip: Optional.from(spec.tooltip),\n      role: Optional.none(),\n      fetch: items.getFetch(backstage, getStyleItems),\n      onSetup: onSetup,\n      getApi: getApi,\n      columns: 1,\n      presets: 'normal',\n      classes: spec.icon.isSome() ? [] : ['bespoke'],\n      dropdownBehaviours: []\n    }, 'tox-tbtn', backstage.shared);\n  };\n\n  var process = function (rawFormats) {\n    return map(rawFormats, function (item) {\n      var title = item,\n          format = item;\n      var values = item.split('=');\n\n      if (values.length > 1) {\n        title = values[0];\n        format = values[1];\n      }\n\n      return {\n        title: title,\n        format: format\n      };\n    });\n  };\n\n  var buildBasicStaticDataset = function (data) {\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var Delimiter;\n\n  (function (Delimiter) {\n    Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n    Delimiter[Delimiter['Space'] = 1] = 'Space';\n  })(Delimiter || (Delimiter = {}));\n\n  var split = function (rawFormats, delimiter) {\n    if (delimiter === Delimiter.SemiColon) {\n      return rawFormats.replace(/;$/, '').split(';');\n    } else {\n      return rawFormats.split(' ');\n    }\n  };\n\n  var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n    var rawFormats = editor.getParam(settingName, defaults, 'string');\n    var data = process(split(rawFormats, delimiter));\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var alignMenuItems = [{\n    title: 'Left',\n    icon: 'align-left',\n    format: 'alignleft',\n    command: 'JustifyLeft'\n  }, {\n    title: 'Center',\n    icon: 'align-center',\n    format: 'aligncenter',\n    command: 'JustifyCenter'\n  }, {\n    title: 'Right',\n    icon: 'align-right',\n    format: 'alignright',\n    command: 'JustifyRight'\n  }, {\n    title: 'Justify',\n    icon: 'align-justify',\n    format: 'alignjustify',\n    command: 'JustifyFull'\n  }];\n\n  var getSpec = function (editor) {\n    var getMatchingValue = function () {\n      return find(alignMenuItems, function (item) {\n        return editor.formatter.match(item.format);\n      });\n    };\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (_format) {\n      return function () {\n        return Optional.none();\n      };\n    };\n\n    var updateSelectMenuIcon = function (comp) {\n      var match = getMatchingValue();\n      var alignment = match.fold(function () {\n        return 'left';\n      }, function (item) {\n        return item.title.toLowerCase();\n      });\n      emitWith(comp, updateMenuIcon, {\n        icon: 'align-' + alignment\n      });\n    };\n\n    var nodeChangeHandler = Optional.some(function (comp) {\n      return function () {\n        return updateSelectMenuIcon(comp);\n      };\n    });\n    var setInitialValue = Optional.some(function (comp) {\n      return updateSelectMenuIcon(comp);\n    });\n    var dataset = buildBasicStaticDataset(alignMenuItems);\n\n    var onAction = function (rawItem) {\n      return function () {\n        return find(alignMenuItems, function (item) {\n          return item.format === rawItem.format;\n        }).each(function (item) {\n          return editor.execCommand(item.command);\n        });\n      };\n    };\n\n    return {\n      tooltip: 'Align',\n      icon: Optional.some('align-left'),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      setInitialValue: setInitialValue,\n      nodeChangeHandler: nodeChangeHandler,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createAlignSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec(editor));\n  };\n\n  var alignSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec(editor));\n    editor.ui.registry.addNestedMenuItem('align', {\n      text: backstage.shared.providers.translate('Align'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n  var systemStackFonts = ['-apple-system', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'sans-serif'];\n\n  var splitFonts = function (fontFamily) {\n    var fonts = fontFamily.split(/\\s*,\\s*/);\n    return map(fonts, function (font) {\n      return font.replace(/^['\"]+|['\"]+$/g, '');\n    });\n  };\n\n  var isSystemFontStack = function (fontFamily) {\n    var matchesSystemStack = function () {\n      var fonts = splitFonts(fontFamily.toLowerCase());\n      return forall(systemStackFonts, function (font) {\n        return fonts.indexOf(font.toLowerCase()) > -1;\n      });\n    };\n\n    return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n  };\n\n  var getSpec$1 = function (editor) {\n    var getMatchingValue = function () {\n      var getFirstFont = function (fontFamily) {\n        return fontFamily ? splitFonts(fontFamily)[0] : '';\n      };\n\n      var fontFamily = editor.queryCommandValue('FontName');\n      var items = dataset.data;\n      var font = fontFamily ? fontFamily.toLowerCase() : '';\n      var matchOpt = find(items, function (item) {\n        var format = item.format;\n        return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n      }).orThunk(function () {\n        if (isSystemFontStack(font)) {\n          return Optional.from({\n            title: 'System Font',\n            format: font\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n      return {\n        matchOpt: matchOpt,\n        font: fontFamily\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = function (item) {\n      return function () {\n        return Optional.some({\n          tag: 'div',\n          styles: item.indexOf('dings') === -1 ? {\n            'font-family': item\n          } : {}\n        });\n      };\n    };\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontName', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          font = _a.font;\n\n      var text = matchOpt.fold(function () {\n        return font;\n      }, function (item) {\n        return item.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var nodeChangeHandler = Optional.some(function (comp) {\n      return function () {\n        return updateSelectMenuText(comp);\n      };\n    });\n    var setInitialValue = Optional.some(function (comp) {\n      return updateSelectMenuText(comp);\n    });\n    var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n    return {\n      tooltip: 'Fonts',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: getCurrentValue,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      setInitialValue: setInitialValue,\n      nodeChangeHandler: nodeChangeHandler,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function () {\n        return false;\n      }\n    };\n  };\n\n  var createFontSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$1(editor));\n  };\n\n  var fontSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n    editor.ui.registry.addNestedMenuItem('fontformats', {\n      text: backstage.shared.providers.translate('Fonts'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n  var legacyFontSizes = {\n    '8pt': '1',\n    '10pt': '2',\n    '12pt': '3',\n    '14pt': '4',\n    '18pt': '5',\n    '24pt': '6',\n    '36pt': '7'\n  };\n\n  var round$1 = function (number, precision) {\n    var factor = Math.pow(10, precision);\n    return Math.round(number * factor) / factor;\n  };\n\n  var toPt = function (fontSize, precision) {\n    if (/[0-9.]+px$/.test(fontSize)) {\n      return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n    }\n\n    return fontSize;\n  };\n\n  var toLegacy = function (fontSize) {\n    return get(legacyFontSizes, fontSize).getOr('');\n  };\n\n  var getSpec$2 = function (editor) {\n    var getMatchingValue = function () {\n      var matchOpt = Optional.none();\n      var items = dataset.data;\n      var fontSize = editor.queryCommandValue('FontSize');\n\n      if (fontSize) {\n        var _loop_1 = function (precision) {\n          var pt = toPt(fontSize, precision);\n          var legacy = toLegacy(pt);\n          matchOpt = find(items, function (item) {\n            return item.format === fontSize || item.format === pt || item.format === legacy;\n          });\n        };\n\n        for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n          _loop_1(precision);\n        }\n      }\n\n      return {\n        matchOpt: matchOpt,\n        size: fontSize\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = constant(Optional.none);\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontSize', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          size = _a.size;\n\n      var text = matchOpt.fold(function () {\n        return size;\n      }, function (match) {\n        return match.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var nodeChangeHandler = Optional.some(function (comp) {\n      return function () {\n        return updateSelectMenuText(comp);\n      };\n    });\n    var setInitialValue = Optional.some(function (comp) {\n      return updateSelectMenuText(comp);\n    });\n    var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n    return {\n      tooltip: 'Font sizes',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getPreviewFor: getPreviewFor,\n      getCurrentValue: getCurrentValue,\n      onAction: onAction,\n      setInitialValue: setInitialValue,\n      nodeChangeHandler: nodeChangeHandler,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function () {\n        return false;\n      }\n    };\n  };\n\n  var createFontsizeSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$2(editor));\n  };\n\n  var fontsizeSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n    editor.ui.registry.addNestedMenuItem('fontsizes', {\n      text: 'Font sizes',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var findNearest = function (editor, getStyles, parents) {\n    var styles = getStyles();\n    return findMap(parents, function (parent) {\n      return find(styles, function (fmt) {\n        return editor.formatter.matchNode(parent, fmt.format);\n      });\n    }).orThunk(function () {\n      if (editor.formatter.match('p')) {\n        return Optional.some({\n          title: 'Paragraph',\n          format: 'p'\n        });\n      }\n\n      return Optional.none();\n    });\n  };\n\n  var getCurrentSelectionParents = function (editor) {\n    var currentNode = editor.selection.getStart(true) || editor.getBody();\n    return editor.dom.getParents(currentNode, function () {\n      return true;\n    }, editor.getBody());\n  };\n\n  var revocable = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      set: set\n    };\n  };\n\n  var destroyable = function () {\n    return revocable(function (s) {\n      return s.destroy();\n    });\n  };\n\n  var unbindable = function () {\n    return revocable(function (s) {\n      return s.unbind();\n    });\n  };\n\n  var value$3 = function () {\n    var subject = Cell(Optional.none());\n\n    var clear = function () {\n      return subject.set(Optional.none());\n    };\n\n    var set = function (s) {\n      return subject.set(Optional.some(s));\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return {\n      clear: clear,\n      set: set,\n      isSet: isSet,\n      on: on\n    };\n  };\n\n  var onSetupFormatToggle = function (editor, name) {\n    return function (api) {\n      var boundCallback = unbindable();\n\n      var init = function () {\n        api.setActive(editor.formatter.match(name));\n        var binding = editor.formatter.formatChanged(name, api.setActive);\n        boundCallback.set(binding);\n      };\n\n      editor.initialized ? init() : editor.on('init', init);\n      return boundCallback.clear;\n    };\n  };\n\n  var onActionToggleFormat = function (editor) {\n    return function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('mceToggleFormat', false, rawItem.format);\n        });\n      };\n    };\n  };\n\n  var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n\n  var getSpec$3 = function (editor) {\n    var getMatchingValue = function (nodeChangeEvent) {\n      return findNearest(editor, function () {\n        return dataset.data;\n      }, nodeChangeEvent);\n    };\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (parents, comp) {\n      var detectedFormat = getMatchingValue(parents);\n      var text = detectedFormat.fold(function () {\n        return 'Paragraph';\n      }, function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var nodeChangeHandler = Optional.some(function (comp) {\n      return function (e) {\n        return updateSelectMenuText(e.parents, comp);\n      };\n    });\n    var setInitialValue = Optional.some(function (comp) {\n      var parents = getCurrentSelectionParents(editor);\n      updateSelectMenuText(parents, comp);\n    });\n    var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n    return {\n      tooltip: 'Blocks',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat(editor),\n      setInitialValue: setInitialValue,\n      nodeChangeHandler: nodeChangeHandler,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createFormatSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$3(editor));\n  };\n\n  var formatSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n    editor.ui.registry.addNestedMenuItem('blockformats', {\n      text: 'Blocks',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var getSpec$4 = function (editor, dataset) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var updateSelectMenuText = function (parents, comp) {\n      var getFormatItems = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind(subs, getFormatItems) : [{\n          title: fmt.title,\n          format: fmt.format\n        }];\n      };\n\n      var flattenedItems = bind(getStyleFormats(editor), getFormatItems);\n      var detectedFormat = findNearest(editor, function () {\n        return flattenedItems;\n      }, parents);\n      var text = detectedFormat.fold(function () {\n        return 'Paragraph';\n      }, function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var nodeChangeHandler = Optional.some(function (comp) {\n      return function (e) {\n        return updateSelectMenuText(e.parents, comp);\n      };\n    });\n    var setInitialValue = Optional.some(function (comp) {\n      var parents = getCurrentSelectionParents(editor);\n      updateSelectMenuText(parents, comp);\n    });\n    return {\n      tooltip: 'Formats',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat(editor),\n      setInitialValue: setInitialValue,\n      nodeChangeHandler: nodeChangeHandler,\n      shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      },\n      dataset: dataset\n    };\n  };\n\n  var createStyleSelect = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    return createSelectButton(editor, backstage, getSpec$4(editor, dataset));\n  };\n\n  var styleSelectMenu = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    var menuItems = createMenuItems(editor, backstage, getSpec$4(editor, dataset));\n    editor.ui.registry.addNestedMenuItem('formats', {\n      text: 'Formats',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultToolbar = [{\n    name: 'history',\n    items: ['undo', 'redo']\n  }, {\n    name: 'styles',\n    items: ['styleselect']\n  }, {\n    name: 'formatting',\n    items: ['bold', 'italic']\n  }, {\n    name: 'alignment',\n    items: ['alignleft', 'aligncenter', 'alignright', 'alignjustify']\n  }, {\n    name: 'indentation',\n    items: ['outdent', 'indent']\n  }, {\n    name: 'permanent pen',\n    items: ['permanentpen']\n  }, {\n    name: 'comments',\n    items: ['addcomment']\n  }];\n\n  var renderFromBridge = function (bridgeBuilder, render) {\n    return function (spec, extras, editor) {\n      var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n        return formatError(errInfo);\n      }).getOrDie();\n      return render(internal, extras, editor);\n    };\n  };\n\n  var types = {\n    button: renderFromBridge(createToolbarButton, function (s, extras) {\n      return renderToolbarButton(s, extras.backstage.shared.providers);\n    }),\n    togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n      return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n    }),\n    menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n      return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n    }),\n    splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n      return renderSplitButton(s, extras.backstage.shared);\n    }),\n    grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n      var _a;\n\n      var buttons = editor.ui.registry.getAll().buttons;\n\n      var identify = function (toolbar) {\n        return identifyButtons(editor, {\n          buttons: buttons,\n          toolbar: toolbar,\n          allowToolbarGroups: false\n        }, extras, Optional.none());\n      };\n\n      var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n\n      switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n      }\n    }),\n    styleSelectButton: function (editor, extras) {\n      return createStyleSelect(editor, extras.backstage);\n    },\n    fontsizeSelectButton: function (editor, extras) {\n      return createFontsizeSelect(editor, extras.backstage);\n    },\n    fontSelectButton: function (editor, extras) {\n      return createFontSelect(editor, extras.backstage);\n    },\n    formatButton: function (editor, extras) {\n      return createFormatSelect(editor, extras.backstage);\n    },\n    alignMenuButton: function (editor, extras) {\n      return createAlignSelect(editor, extras.backstage);\n    }\n  };\n\n  var extractFrom = function (spec, extras, editor) {\n    return get(types, spec.type).fold(function () {\n      console.error('skipping button defined by', spec);\n      return Optional.none();\n    }, function (render) {\n      return Optional.some(render(spec, extras, editor));\n    });\n  };\n\n  var bespokeButtons = {\n    styleselect: types.styleSelectButton,\n    fontsizeselect: types.fontsizeSelectButton,\n    fontselect: types.fontSelectButton,\n    formatselect: types.formatButton,\n    align: types.alignMenuButton\n  };\n\n  var removeUnusedDefaults = function (buttons) {\n    var filteredItemGroups = map(defaultToolbar, function (group) {\n      var items = filter(group.items, function (subItem) {\n        return has(buttons, subItem) || has(bespokeButtons, subItem);\n      });\n      return {\n        name: group.name,\n        items: items\n      };\n    });\n    return filter(filteredItemGroups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var convertStringToolbar = function (strToolbar) {\n    var groupsStrings = strToolbar.split('|');\n    return map(groupsStrings, function (g) {\n      return {\n        items: g.trim().split(' ')\n      };\n    });\n  };\n\n  var isToolbarGroupSettingArray = function (toolbar) {\n    return isArrayOf(toolbar, function (t) {\n      return has(t, 'name') && has(t, 'items');\n    });\n  };\n\n  var createToolbar = function (toolbarConfig) {\n    var toolbar = toolbarConfig.toolbar;\n    var buttons = toolbarConfig.buttons;\n\n    if (toolbar === false) {\n      return [];\n    } else if (toolbar === undefined || toolbar === true) {\n      return removeUnusedDefaults(buttons);\n    } else if (isString(toolbar)) {\n      return convertStringToolbar(toolbar);\n    } else if (isToolbarGroupSettingArray(toolbar)) {\n      return toolbar;\n    } else {\n      console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n      return [];\n    }\n  };\n\n  var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n    return get(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n      return prefixes.bind(function (ps) {\n        return findMap(ps, function (prefix) {\n          return get(buttons, prefix + toolbarItem.toLowerCase());\n        });\n      });\n    }).fold(function () {\n      return get(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n        return r(editor, extras);\n      }).orThunk(function () {\n        return Optional.none();\n      });\n    }, function (spec) {\n      if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n        console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n        return Optional.none();\n      } else {\n        return extractFrom(spec, extras, editor);\n      }\n    });\n  };\n\n  var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n    var toolbarGroups = createToolbar(toolbarConfig);\n    var groups = map(toolbarGroups, function (group) {\n      var items = bind(group.items, function (toolbarItem) {\n        return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n      });\n      return {\n        title: Optional.from(editor.translate(group.name)),\n        items: items\n      };\n    });\n    return filter(groups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var bubbleSize = 12;\n  var bubbleAlignments$1 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top']\n  };\n  var anchorOverrides = {\n    maxHeightFunction: expandable(),\n    maxWidthFunction: expandable$1()\n  };\n  var desktopAnchorSpecLayouts = {\n    onLtr: function () {\n      return [north$1, south$1, northeast$1, southeast$1, northwest$1, southwest$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [north$1, south$1, northwest$1, southwest$1, northeast$1, southeast$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n  var mobileAnchorSpecLayouts = {\n    onLtr: function () {\n      return [south$1, southeast$1, southwest$1, northeast$1, northwest$1, north$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [south$1, southwest$1, southeast$1, northwest$1, northeast$1, north$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n\n  var getAnchorLayout = function (position, isTouch) {\n    if (position === 'line') {\n      return {\n        bubble: nu$8(bubbleSize, 0, bubbleAlignments$1),\n        layouts: {\n          onLtr: function () {\n            return [east$1];\n          },\n          onRtl: function () {\n            return [west$1];\n          }\n        },\n        overrides: anchorOverrides\n      };\n    } else {\n      return {\n        bubble: nu$8(0, bubbleSize, bubbleAlignments$1),\n        layouts: isTouch ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts,\n        overrides: anchorOverrides\n      };\n    }\n  };\n\n  var register$4 = function (editor, registryContextToolbars, sink, extras) {\n    var isTouch = detect$3().deviceType.isTouch;\n    var contextbar = build$1(renderContextToolbar({\n      sink: sink,\n      onEscape: function () {\n        editor.focus();\n        return Optional.some(true);\n      }\n    }));\n\n    var getBounds = function () {\n      return getContextToolbarBounds(editor, extras.backstage.shared);\n    };\n\n    var isRangeOverlapping = function (aTop, aBottom, bTop, bBottom) {\n      return Math.max(aTop, bTop) <= Math.min(aBottom, bBottom);\n    };\n\n    var getLastElementVerticalBound = function () {\n      var nodeBounds = lastElement.get().filter(function (ele) {\n        return inBody(SugarElement.fromDom(ele));\n      }).map(function (ele) {\n        return ele.getBoundingClientRect();\n      }).getOrThunk(function () {\n        return editor.selection.getRng().getBoundingClientRect();\n      });\n      var diffTop = editor.inline ? get$8().top : absolute$1(SugarElement.fromDom(editor.getBody())).y;\n      return {\n        y: nodeBounds.top + diffTop,\n        bottom: nodeBounds.bottom + diffTop\n      };\n    };\n\n    var shouldContextToolbarHide = function () {\n      if (isTouch() && extras.backstage.isContextMenuOpen()) {\n        return true;\n      }\n\n      var lastElementBounds = getLastElementVerticalBound();\n      var contextToolbarBounds = getBounds();\n      return !isRangeOverlapping(lastElementBounds.y, lastElementBounds.bottom, contextToolbarBounds.y, contextToolbarBounds.bottom);\n    };\n\n    var forceHide = function () {\n      InlineView.hide(contextbar);\n    };\n\n    var hideOrRepositionIfNecessary = function () {\n      lastAnchor.get().each(function (anchor) {\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n\n        if (shouldContextToolbarHide()) {\n          set$2(contextBarEle, 'display', 'none');\n        } else {\n          Positioning.positionWithinBounds(sink, anchor, contextbar, Optional.some(getBounds()));\n        }\n      });\n    };\n\n    var lastAnchor = Cell(Optional.none());\n    var lastElement = Cell(Optional.none());\n    var timer = Cell(null);\n\n    var wrapInPopDialog = function (toolbarSpec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop__dialog']\n        },\n        components: [toolbarSpec],\n        behaviours: derive$1([Keying.config({\n          mode: 'acyclic'\n        }), config('pop-dialog-wrap-events', [runOnAttached(function (comp) {\n          editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n            return Keying.focusIn(comp);\n          });\n        }), runOnDetached(function (_comp) {\n          editor.shortcuts.remove('ctrl+F9');\n        })])])\n      };\n    };\n\n    var getScopes = cached(function () {\n      return categorise(registryContextToolbars, function (toolbarApi) {\n        var alloySpec = buildToolbar([toolbarApi]);\n        emitWith(contextbar, forwardSlideEvent, {\n          forwardContents: wrapInPopDialog(alloySpec)\n        });\n      });\n    });\n\n    var buildContextToolbarGroups = function (allButtons, ctx) {\n      return identifyButtons(editor, {\n        buttons: allButtons,\n        toolbar: ctx.items,\n        allowToolbarGroups: false\n      }, extras, Optional.some(['form:']));\n    };\n\n    var buildContextMenuGroups = function (ctx, providers) {\n      return ContextForm.buildInitGroups(ctx, providers);\n    };\n\n    var buildToolbar = function (toolbars) {\n      var buttons = editor.ui.registry.getAll().buttons;\n      var scopes = getScopes();\n\n      var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n\n      var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n      var initGroups = flatten(map(toolbars, function (ctx) {\n        return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextMenuGroups(ctx, extras.backstage.shared.providers);\n      }));\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$1('context-toolbar'),\n        initGroups: initGroups,\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: extras.backstage.shared.providers\n      });\n    };\n\n    editor.on(showContextToolbarEvent, function (e) {\n      var scopes = getScopes();\n      get(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n        launchContext([ctx], e.target === editor ? Optional.none() : Optional.some(e));\n        InlineView.getContent(contextbar).each(Keying.focusIn);\n      });\n    });\n\n    var getAnchor = function (position, element) {\n      var anchorage = position === 'node' ? extras.backstage.shared.anchors.node(element) : extras.backstage.shared.anchors.cursor();\n      return deepMerge(anchorage, getAnchorLayout(position, isTouch()));\n    };\n\n    var launchContext = function (toolbarApi, elem) {\n      clearTimer();\n\n      if (isTouch() && extras.backstage.isContextMenuOpen()) {\n        return;\n      }\n\n      var toolbarSpec = buildToolbar(toolbarApi);\n      var sElem = elem.map(SugarElement.fromDom);\n      var anchor = getAnchor(toolbarApi[0].position, sElem);\n      lastAnchor.set(Optional.some(anchor));\n      lastElement.set(elem);\n      var contextBarEle = contextbar.element;\n      remove$6(contextBarEle, 'display');\n      InlineView.showWithinBounds(contextbar, anchor, wrapInPopDialog(toolbarSpec), function () {\n        return Optional.some(getBounds());\n      });\n\n      if (shouldContextToolbarHide()) {\n        set$2(contextBarEle, 'display', 'none');\n      }\n    };\n\n    var launchContextToolbar = function () {\n      if (!editor.hasFocus()) {\n        return;\n      }\n\n      var scopes = getScopes();\n      lookup$1(scopes, editor).fold(function () {\n        lastAnchor.set(Optional.none());\n        InlineView.hide(contextbar);\n      }, function (info) {\n        launchContext(info.toolbars, Optional.some(info.elem.dom));\n      });\n    };\n\n    var clearTimer = function () {\n      var current = timer.get();\n\n      if (current !== null) {\n        global$2.clearTimeout(current);\n        timer.set(null);\n      }\n    };\n\n    var resetTimer = function (t) {\n      clearTimer();\n      timer.set(t);\n    };\n\n    editor.on('init', function () {\n      editor.on(hideContextToolbarEvent, forceHide);\n      editor.on('ScrollContent ScrollWindow longpress', hideOrRepositionIfNecessary);\n      editor.on('click keyup focus SetContent ObjectResized ResizeEditor', function () {\n        resetTimer(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n      });\n      editor.on('focusout', function (_e) {\n        global$2.setEditorTimeout(editor, function () {\n          if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n            lastAnchor.set(Optional.none());\n            InlineView.hide(contextbar);\n          }\n        }, 0);\n      });\n      editor.on('SwitchMode', function () {\n        if (editor.mode.isReadOnly()) {\n          lastAnchor.set(Optional.none());\n          InlineView.hide(contextbar);\n        }\n      });\n      editor.on('NodeChange', function (_e) {\n        search(contextbar.element).fold(function () {\n          resetTimer(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n        }, function (_) {});\n      });\n    });\n  };\n\n  var setup$3 = function (editor, mothership, uiMothership) {\n    var broadcastEvent = function (name, evt) {\n      each([mothership, uiMothership], function (ship) {\n        ship.broadcastEvent(name, evt);\n      });\n    };\n\n    var broadcastOn = function (channel, message) {\n      each([mothership, uiMothership], function (ship) {\n        ship.broadcastOn([channel], message);\n      });\n    };\n\n    var fireDismissPopups = function (evt) {\n      return broadcastOn(dismissPopups(), {\n        target: evt.target\n      });\n    };\n\n    var onTouchstart = bind$3(SugarElement.fromDom(document), 'touchstart', fireDismissPopups);\n    var onTouchmove = bind$3(SugarElement.fromDom(document), 'touchmove', function (evt) {\n      return broadcastEvent(documentTouchmove(), evt);\n    });\n    var onTouchend = bind$3(SugarElement.fromDom(document), 'touchend', function (evt) {\n      return broadcastEvent(documentTouchend(), evt);\n    });\n    var onMousedown = bind$3(SugarElement.fromDom(document), 'mousedown', fireDismissPopups);\n    var onMouseup = bind$3(SugarElement.fromDom(document), 'mouseup', function (evt) {\n      if (evt.raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: evt.target\n        });\n      }\n    });\n\n    var onContentClick = function (raw) {\n      return broadcastOn(dismissPopups(), {\n        target: SugarElement.fromDom(raw.target)\n      });\n    };\n\n    var onContentMouseup = function (raw) {\n      if (raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: SugarElement.fromDom(raw.target)\n        });\n      }\n    };\n\n    var onWindowScroll = function (evt) {\n      return broadcastEvent(windowScroll(), fromRawEvent$1(evt));\n    };\n\n    var onWindowResize = function (evt) {\n      broadcastOn(repositionPopups(), {});\n      broadcastEvent(windowResize(), fromRawEvent$1(evt));\n    };\n\n    var onEditorResize = function () {\n      return broadcastOn(repositionPopups(), {});\n    };\n\n    editor.on('PostRender', function () {\n      editor.on('click', onContentClick);\n      editor.on('tap', onContentClick);\n      editor.on('mouseup', onContentMouseup);\n      editor.on('ScrollWindow', onWindowScroll);\n      editor.on('ResizeWindow', onWindowResize);\n      editor.on('ResizeEditor', onEditorResize);\n    });\n    editor.on('remove', function () {\n      editor.off('click', onContentClick);\n      editor.off('tap', onContentClick);\n      editor.off('mouseup', onContentMouseup);\n      editor.off('ScrollWindow', onWindowScroll);\n      editor.off('ResizeWindow', onWindowResize);\n      editor.off('ResizeEditor', onEditorResize);\n      onMousedown.unbind();\n      onTouchstart.unbind();\n      onTouchmove.unbind();\n      onTouchend.unbind();\n      onMouseup.unbind();\n    });\n    editor.on('detach', function () {\n      detachSystem(mothership);\n      detachSystem(uiMothership);\n      mothership.destroy();\n      uiMothership.destroy();\n    });\n  };\n\n  var parts$d = AlloyParts;\n  var partType$1 = PartType;\n  var schema$r = constant([defaulted$1('shell', false), strict$1('makeItem'), defaulted$1('setupItem', noop), SketchBehaviours.field('listBehaviours', [Replacing])]);\n\n  var customListDetail = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var itemsPart = optional({\n    name: 'items',\n    overrides: customListDetail\n  });\n  var parts$e = constant([itemsPart]);\n  var name$2 = constant('CustomList');\n\n  var factory$f = function (detail, components, _spec, _external) {\n    var setItems = function (list, items) {\n      getListContainer(list).fold(function () {\n        console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n        throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n      }, function (container) {\n        var itemComps = Replacing.contents(container);\n        var numListsRequired = items.length;\n        var numListsToAdd = numListsRequired - itemComps.length;\n        var itemsToAdd = numListsToAdd > 0 ? range(numListsToAdd, function () {\n          return detail.makeItem();\n        }) : [];\n        var itemsToRemove = itemComps.slice(numListsRequired);\n        each(itemsToRemove, function (item) {\n          return Replacing.remove(container, item);\n        });\n        each(itemsToAdd, function (item) {\n          return Replacing.append(container, item);\n        });\n        var builtLists = Replacing.contents(container);\n        each(builtLists, function (item, i) {\n          detail.setupItem(list, item, items[i], i);\n        });\n      });\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n\n    var getListContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.listBehaviours, extra.behaviours),\n      apis: {\n        setItems: setItems\n      }\n    };\n  };\n\n  var CustomList = composite$1({\n    name: name$2(),\n    configFields: schema$r(),\n    partFields: parts$e(),\n    factory: factory$f,\n    apis: {\n      setItems: function (apis, list, items) {\n        apis.setItems(list, items);\n      }\n    }\n  });\n  var setup$4 = noop;\n  var isDocked = never;\n  var getBehaviours$2 = constant([]);\n  var StaticHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$4,\n    isDocked: isDocked,\n    getBehaviours: getBehaviours$2\n  });\n\n  var getOffsetParent = function (element) {\n    var isFixed = getRaw(element, 'position').is('fixed');\n    var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n    return offsetParent$1.orThunk(function () {\n      var marker = SugarElement.fromTag('span');\n      return parent(element).bind(function (parent) {\n        append(parent, marker);\n        var offsetParent$1 = offsetParent(marker);\n        remove(marker);\n        return offsetParent$1;\n      });\n    });\n  };\n\n  var getOrigin = function (element) {\n    return getOffsetParent(element).map(absolute).getOrThunk(function () {\n      return SugarPosition(0, 0);\n    });\n  };\n\n  var morphAdt = Adt.generate([{\n    static: []\n  }, {\n    absolute: ['positionCss']\n  }, {\n    fixed: ['positionCss']\n  }]);\n\n  var appear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$4(elem, contextualInfo.fadeOutClass);\n    add$2(elem, contextualInfo.fadeInClass);\n    contextualInfo.onShow(component);\n  };\n\n  var disappear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$4(elem, contextualInfo.fadeInClass);\n    add$2(elem, contextualInfo.fadeOutClass);\n    contextualInfo.onHide(component);\n  };\n\n  var isPartiallyVisible = function (box, viewport) {\n    return box.y < viewport.bottom && box.bottom > viewport.y;\n  };\n\n  var isTopCompletelyVisible = function (box, viewport) {\n    return box.y >= viewport.y;\n  };\n\n  var isBottomCompletelyVisible = function (box, viewport) {\n    return box.bottom <= viewport.bottom;\n  };\n\n  var isVisibleForModes = function (modes, box, viewport) {\n    return forall(modes, function (mode) {\n      switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n      }\n    });\n  };\n\n  var getPrior = function (elem, state) {\n    return state.getInitialPosition().map(function (pos) {\n      return bounds$1(pos.bounds.x, pos.bounds.y, get$7(elem), get$6(elem));\n    });\n  };\n\n  var storePrior = function (elem, box, state) {\n    state.setInitialPosition(Optional.some({\n      style: getAllRaw(elem),\n      position: get$4(elem, 'position') || 'static',\n      bounds: box\n    }));\n  };\n\n  var revertToOriginal = function (elem, box$1, state) {\n    return state.getInitialPosition().bind(function (position) {\n      state.setInitialPosition(Optional.none());\n\n      switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box).getOrThunk(function () {\n            return box(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get(position.style, 'left').map(function (_left) {\n            return box$1.x - offsetBox_1.x;\n          }), get(position.style, 'top').map(function (_top) {\n            return box$1.y - offsetBox_1.y;\n          }), get(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box$1.right;\n          }), get(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box$1.bottom;\n          }))));\n\n        default:\n          return Optional.none();\n      }\n    });\n  };\n\n  var morphToOriginal = function (elem, viewport, state) {\n    return getPrior(elem, state).filter(function (box) {\n      return isVisibleForModes(state.getModes(), box, viewport);\n    }).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToFixed = function (elem, viewport, state) {\n    var box$1 = box(elem);\n\n    if (!isVisibleForModes(state.getModes(), box$1, viewport)) {\n      storePrior(elem, box$1, state);\n      var winBox = win();\n      var left = box$1.x - winBox.x;\n      var top_1 = viewport.y - winBox.y;\n      var bottom = winBox.bottom - viewport.bottom;\n      var isTop = box$1.y <= viewport.y;\n      return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var getMorph = function (component, viewport, state) {\n    var elem = component.element;\n    var isDocked = getRaw(elem, 'position').is('fixed');\n    return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n  };\n\n  var getMorphToOriginal = function (component, state) {\n    var elem = component.element;\n    return getPrior(elem, state).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToStatic = function (component, config) {\n    each(['left', 'right', 'top', 'bottom', 'position'], function (prop) {\n      return remove$6(component.element, prop);\n    });\n    config.onUndocked(component);\n  };\n\n  var morphToCoord = function (component, config, position) {\n    applyPositionCss(component.element, position);\n    var method = position.position === 'fixed' ? config.onDocked : config.onUndocked;\n    method(component);\n  };\n\n  var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n    if (morphToDocked === void 0) {\n      morphToDocked = false;\n    }\n\n    config.contextual.each(function (contextInfo) {\n      contextInfo.lazyContext(component).each(function (box) {\n        var isVisible = isPartiallyVisible(box, viewport);\n\n        if (isVisible !== state.isVisible()) {\n          state.setVisible(isVisible);\n\n          if (morphToDocked && !isVisible) {\n            add$3(component.element, [contextInfo.fadeOutClass]);\n            contextInfo.onHide(component);\n          } else {\n            var method = isVisible ? appear : disappear;\n            method(component, contextInfo);\n          }\n        }\n      });\n    });\n  };\n\n  var refreshInternal = function (component, config, state) {\n    var viewport = config.lazyViewport(component);\n    var isDocked = state.isDocked();\n\n    if (isDocked) {\n      updateVisibility(component, config, state, viewport);\n    }\n\n    getMorph(component, viewport, state).each(function (morph) {\n      state.setDocked(!isDocked);\n      morph.fold(function () {\n        return morphToStatic(component, config);\n      }, function (position) {\n        return morphToCoord(component, config, position);\n      }, function (position) {\n        updateVisibility(component, config, state, viewport, true);\n        morphToCoord(component, config, position);\n      });\n    });\n  };\n\n  var resetInternal = function (component, config, state) {\n    var elem = component.element;\n    state.setDocked(false);\n    getMorphToOriginal(component, state).each(function (morph) {\n      morph.fold(function () {\n        return morphToStatic(component, config);\n      }, function (position) {\n        return morphToCoord(component, config, position);\n      }, noop);\n    });\n    state.setVisible(true);\n    config.contextual.each(function (contextInfo) {\n      remove$5(elem, [contextInfo.fadeInClass, contextInfo.fadeOutClass, contextInfo.transitionClass]);\n      contextInfo.onShow(component);\n    });\n    refresh$4(component, config, state);\n  };\n\n  var refresh$4 = function (component, config, state) {\n    if (component.getSystem().isConnected()) {\n      refreshInternal(component, config, state);\n    }\n  };\n\n  var reset = function (component, config, state) {\n    if (state.isDocked()) {\n      resetInternal(component, config, state);\n    }\n  };\n\n  var isDocked$1 = function (component, config, state) {\n    return state.isDocked();\n  };\n\n  var setModes = function (component, config, state, modes) {\n    return state.setModes(modes);\n  };\n\n  var getModes = function (component, config, state) {\n    return state.getModes();\n  };\n\n  var DockingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$4,\n    reset: reset,\n    isDocked: isDocked$1,\n    getModes: getModes,\n    setModes: setModes\n  });\n\n  var events$f = function (dockInfo, dockState) {\n    return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n      dockInfo.contextual.each(function (contextInfo) {\n        if (has$2(component.element, contextInfo.transitionClass)) {\n          remove$5(component.element, [contextInfo.transitionClass, contextInfo.fadeInClass]);\n          var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n          notify(component);\n        }\n\n        simulatedEvent.stop();\n      });\n    }), run(windowScroll(), function (component, _) {\n      refresh$4(component, dockInfo, dockState);\n    }), run(windowResize(), function (component, _) {\n      reset(component, dockInfo, dockState);\n    })]);\n  };\n\n  var ActiveDocking = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$f\n  });\n  var DockingSchema = [optionObjOf('contextual', [strictString('fadeInClass'), strictString('fadeOutClass'), strictString('transitionClass'), strictFunction('lazyContext'), onHandler('onShow'), onHandler('onShown'), onHandler('onHide'), onHandler('onHidden')]), defaultedFunction('lazyViewport', win), defaultedArrayOf('modes', ['top', 'bottom'], string), onHandler('onDocked'), onHandler('onUndocked')];\n\n  var init$b = function (spec) {\n    var docked = Cell(false);\n    var visible = Cell(true);\n    var initialBounds = Cell(Optional.none());\n    var modes = Cell(spec.modes);\n\n    var readState = function () {\n      return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n    };\n\n    return nu$5({\n      isDocked: docked.get,\n      setDocked: docked.set,\n      getInitialPosition: initialBounds.get,\n      setInitialPosition: initialBounds.set,\n      isVisible: visible.get,\n      setVisible: visible.set,\n      getModes: modes.get,\n      setModes: modes.set,\n      readState: readState\n    });\n  };\n\n  var DockingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$b\n  });\n  var Docking = create$1({\n    fields: DockingSchema,\n    name: 'docking',\n    active: ActiveDocking,\n    apis: DockingApis,\n    state: DockingState\n  });\n  var visibility = {\n    fadeInClass: 'tox-editor-dock-fadein',\n    fadeOutClass: 'tox-editor-dock-fadeout',\n    transitionClass: 'tox-editor-dock-transition'\n  };\n  var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n  var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n\n  var scrollFromBehindHeader = function (e, containerHeader) {\n    var doc = owner(containerHeader);\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    var scrollPos = get$8(doc);\n    var markerElement = SugarElement.fromDom(e.elm);\n    var markerPos = absolute$1(markerElement);\n    var markerHeight = get$6(markerElement);\n    var markerTop = markerPos.y;\n    var markerBottom = markerTop + markerHeight;\n    var editorHeaderPos = absolute(containerHeader);\n    var editorHeaderHeight = get$6(containerHeader);\n    var editorHeaderTop = editorHeaderPos.top;\n    var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n    var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n    var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n\n    if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n      to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n    } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n      var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n      to(scrollPos.left, y, doc);\n    }\n  };\n\n  var isDockedMode = function (header, mode) {\n    return contains(Docking.getModes(header), mode);\n  };\n\n  var updateIframeContentFlow = function (header) {\n    var getOccupiedHeight = function (elm) {\n      return getOuter$1(elm) + (parseInt(get$4(elm, 'margin-top'), 10) || 0) + (parseInt(get$4(elm, 'margin-bottom'), 10) || 0);\n    };\n\n    var elm = header.element;\n    parent(elm).each(function (parentElem) {\n      var padding = 'padding-' + Docking.getModes(header)[0];\n\n      if (Docking.isDocked(header)) {\n        var parentWidth = get$7(parentElem);\n        set$2(elm, 'width', parentWidth + 'px');\n        set$2(parentElem, padding, getOccupiedHeight(elm) + 'px');\n      } else {\n        remove$6(elm, 'width');\n        remove$6(parentElem, padding);\n      }\n    });\n  };\n\n  var updateSinkVisibility = function (sinkElem, visible) {\n    if (visible) {\n      remove$4(sinkElem, visibility.fadeOutClass);\n      add$3(sinkElem, [visibility.transitionClass, visibility.fadeInClass]);\n    } else {\n      remove$4(sinkElem, visibility.fadeInClass);\n      add$3(sinkElem, [visibility.fadeOutClass, visibility.transitionClass]);\n    }\n  };\n\n  var updateEditorClasses = function (editor, docked) {\n    var editorContainer = SugarElement.fromDom(editor.getContainer());\n\n    if (docked) {\n      add$2(editorContainer, editorStickyOnClass);\n      remove$4(editorContainer, editorStickyOffClass);\n    } else {\n      add$2(editorContainer, editorStickyOffClass);\n      remove$4(editorContainer, editorStickyOnClass);\n    }\n  };\n\n  var restoreFocus = function (headerElem, focusedElem) {\n    var ownerDoc = owner(focusedElem);\n    active(ownerDoc).filter(function (activeElm) {\n      return !eq$1(focusedElem, activeElm);\n    }).filter(function (activeElm) {\n      return eq$1(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains$2(headerElem, activeElm);\n    }).each(function () {\n      return focus$1(focusedElem);\n    });\n  };\n\n  var findFocusedElem = function (rootElm, lazySink) {\n    return search(rootElm).orThunk(function () {\n      return lazySink().toOptional().bind(function (sink) {\n        return search(sink.element);\n      });\n    });\n  };\n\n  var setup$5 = function (editor, sharedBackstage, lazyHeader) {\n    if (!editor.inline) {\n      if (!sharedBackstage.header.isPositionedAtTop()) {\n        editor.on('ResizeEditor', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n\n      editor.on('ResizeWindow ResizeEditor', function () {\n        lazyHeader().each(updateIframeContentFlow);\n      });\n      editor.on('SkinLoaded', function () {\n        lazyHeader().each(function (comp) {\n          Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n        });\n      });\n      editor.on('FullscreenStateChanged', function () {\n        lazyHeader().each(Docking.reset);\n      });\n    }\n\n    editor.on('AfterScrollIntoView', function (e) {\n      lazyHeader().each(function (header) {\n        Docking.refresh(header);\n        var headerElem = header.element;\n\n        if (isVisible(headerElem)) {\n          scrollFromBehindHeader(e, headerElem);\n        }\n      });\n    });\n    editor.on('PostRender', function () {\n      updateEditorClasses(editor, false);\n    });\n  };\n\n  var isDocked$2 = function (lazyHeader) {\n    return lazyHeader().map(Docking.isDocked).getOr(false);\n  };\n\n  var getIframeBehaviours = function () {\n    var _a;\n\n    return [Receiving.config({\n      channels: (_a = {}, _a[toolbarHeightChange()] = {\n        onReceive: updateIframeContentFlow\n      }, _a)\n    })];\n  };\n\n  var getBehaviours$3 = function (editor, sharedBackstage) {\n    var focusedElm = Cell(Optional.none());\n    var lazySink = sharedBackstage.getSink;\n\n    var runOnSinkElement = function (f) {\n      lazySink().each(function (sink) {\n        return f(sink.element);\n      });\n    };\n\n    var onDockingSwitch = function (comp) {\n      if (!editor.inline) {\n        updateIframeContentFlow(comp);\n      }\n\n      updateEditorClasses(editor, Docking.isDocked(comp));\n      comp.getSystem().broadcastOn([repositionPopups()], {});\n      lazySink().each(function (sink) {\n        return sink.getSystem().broadcastOn([repositionPopups()], {});\n      });\n    };\n\n    var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n    return __spreadArrays([Focusing.config({}), Docking.config({\n      contextual: __assign({\n        lazyContext: function (comp) {\n          var headerHeight = getOuter$1(comp.element);\n          var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n          var box$1 = box(SugarElement.fromDom(container));\n          var boxHeight = box$1.height - headerHeight;\n          var topBound = box$1.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n          return Optional.some(bounds$1(box$1.x, topBound, box$1.width, boxHeight));\n        },\n        onShow: function () {\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, true);\n          });\n        },\n        onShown: function (comp) {\n          runOnSinkElement(function (elem) {\n            return remove$5(elem, [visibility.transitionClass, visibility.fadeInClass]);\n          });\n          focusedElm.get().each(function (elem) {\n            restoreFocus(comp.element, elem);\n            focusedElm.set(Optional.none());\n          });\n        },\n        onHide: function (comp) {\n          focusedElm.set(findFocusedElem(comp.element, lazySink));\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, false);\n          });\n        },\n        onHidden: function () {\n          runOnSinkElement(function (elem) {\n            return remove$5(elem, [visibility.transitionClass]);\n          });\n        }\n      }, visibility),\n      modes: [sharedBackstage.header.getDockingMode()],\n      onDocked: onDockingSwitch,\n      onUndocked: onDockingSwitch\n    })], additionalBehaviours);\n  };\n\n  var StickyHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$5,\n    isDocked: isDocked$2,\n    getBehaviours: getBehaviours$3\n  });\n\n  var renderHeader = function (spec) {\n    var editor = spec.editor;\n    var getBehaviours = spec.sticky ? getBehaviours$3 : getBehaviours$2;\n    return {\n      uid: spec.uid,\n      dom: spec.dom,\n      components: spec.components,\n      behaviours: derive$1(getBehaviours(editor, spec.sharedBackstage))\n    };\n  };\n\n  var factory$g = function (detail, spec) {\n    var setMenus = function (comp, menus) {\n      var newMenus = map(menus, function (m) {\n        var buttonSpec = {\n          type: 'menubutton',\n          text: m.text,\n          fetch: function (callback) {\n            callback(m.getItems());\n          }\n        };\n        var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n      });\n      Replacing.set(comp, newMenus);\n    };\n\n    var apis = {\n      focus: Keying.focusIn,\n      setMenus: setMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: [],\n      behaviours: derive$1([Replacing.config({}), config('menubar-events', [runOnAttached(function (component) {\n        detail.onSetup(component);\n      }), run(mouseover(), function (comp, se) {\n        descendant$1(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n          closest$3(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n            if (!eq$1(activeButton, hoveredButton)) {\n              comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                  Dropdown.expand(hoveredComp);\n                  Dropdown.close(activeComp);\n                  Focusing.focus(hoveredComp);\n                });\n              });\n            }\n          });\n        });\n      }), run(focusShifted(), function (comp, se) {\n        se.event.prevFocus.bind(function (prev) {\n          return comp.getSystem().getByDom(prev).toOptional();\n        }).each(function (prev) {\n          se.event.newFocus.bind(function (nu) {\n            return comp.getSystem().getByDom(nu).toOptional();\n          }).each(function (nu) {\n            if (Dropdown.isOpen(prev)) {\n              Dropdown.expand(nu);\n              Dropdown.close(prev);\n            }\n          });\n        });\n      })]), Keying.config({\n        mode: 'flow',\n        selector: '.' + 'tox-mbtn',\n        onEscape: function (comp) {\n          detail.onEscape(comp);\n          return Optional.some(true);\n        }\n      }), Tabstopping.config({})]),\n      apis: apis,\n      domModification: {\n        attributes: {\n          role: 'menubar'\n        }\n      }\n    };\n  };\n\n  var SilverMenubar = single$2({\n    factory: factory$g,\n    name: 'silver.Menubar',\n    configFields: [strict$1('dom'), strict$1('uid'), strict$1('onEscape'), strict$1('backstage'), defaulted$1('onSetup', noop)],\n    apis: {\n      focus: function (apis, comp) {\n        apis.focus(comp);\n      },\n      setMenus: function (apis, comp, menus) {\n        apis.setMenus(comp, menus);\n      }\n    }\n  });\n  var owner$4 = 'container';\n  var schema$s = [field$1('slotBehaviours', [])];\n\n  var getPartName$1 = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch$2 = function (sSpec) {\n    var parts = function () {\n      var record = [];\n\n      var slot = function (name, config) {\n        record.push(name);\n        return generateOne(owner$4, getPartName$1(name), config);\n      };\n\n      return {\n        slot: slot,\n        record: function () {\n          return record;\n        }\n      };\n    }();\n\n    var spec = sSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName$1(n)\n      });\n    });\n    return composite(owner$4, schema$s, fieldParts, make$7, spec);\n  };\n\n  var make$7 = function (detail, components) {\n    var getSlotNames = function (_) {\n      return getAllPartNames(detail);\n    };\n\n    var getSlot = function (container, key) {\n      return getPart(container, detail, key);\n    };\n\n    var onSlot = function (f, def) {\n      return function (container, key) {\n        return getPart(container, detail, key).map(function (slot) {\n          return f(slot, key);\n        }).getOr(def);\n      };\n    };\n\n    var onSlots = function (f) {\n      return function (container, keys) {\n        each(keys, function (key) {\n          return f(container, key);\n        });\n      };\n    };\n\n    var doShowing = function (comp, _key) {\n      return get$2(comp.element, 'aria-hidden') !== 'true';\n    };\n\n    var doShow = function (comp, key) {\n      if (!doShowing(comp)) {\n        var element = comp.element;\n        remove$6(element, 'display');\n        remove$1(element, 'aria-hidden');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: true\n        });\n      }\n    };\n\n    var doHide = function (comp, key) {\n      if (doShowing(comp)) {\n        var element = comp.element;\n        set$2(element, 'display', 'none');\n        set$1(element, 'aria-hidden', 'true');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: false\n        });\n      }\n    };\n\n    var isShowing = onSlot(doShowing, false);\n    var hideSlot = onSlot(doHide);\n    var hideSlots = onSlots(hideSlot);\n\n    var hideAllSlots = function (container) {\n      return hideSlots(container, getSlotNames());\n    };\n\n    var showSlot = onSlot(doShow);\n    var apis = {\n      getSlotNames: getSlotNames,\n      getSlot: getSlot,\n      isShowing: isShowing,\n      hideSlot: hideSlot,\n      hideAllSlots: hideAllSlots,\n      showSlot: showSlot\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$c(detail.slotBehaviours),\n      apis: apis\n    };\n  };\n\n  var slotApis = map$2({\n    getSlotNames: function (apis, c) {\n      return apis.getSlotNames(c);\n    },\n    getSlot: function (apis, c, key) {\n      return apis.getSlot(c, key);\n    },\n    isShowing: function (apis, c, key) {\n      return apis.isShowing(c, key);\n    },\n    hideSlot: function (apis, c, key) {\n      return apis.hideSlot(c, key);\n    },\n    hideAllSlots: function (apis, c) {\n      return apis.hideAllSlots(c);\n    },\n    showSlot: function (apis, c, key) {\n      return apis.showSlot(c, key);\n    }\n  }, function (value) {\n    return makeApi(value);\n  });\n\n  var SlotContainer = __assign(__assign({}, slotApis), {\n    sketch: sketch$2\n  });\n\n  var sidebarSchema = objOf([optionString('icon'), optionString('tooltip'), defaultedFunction('onShow', noop), defaultedFunction('onHide', noop), defaultedFunction('onSetup', function () {\n    return noop;\n  })]);\n\n  var createSidebar = function (spec) {\n    return asRaw('sidebar', sidebarSchema, spec);\n  };\n\n  var setup$6 = function (editor) {\n    var sidebars = editor.ui.registry.getAll().sidebars;\n    each(keys(sidebars), function (name) {\n      var spec = sidebars[name];\n\n      var isActive = function () {\n        return Optional.from(editor.queryCommandValue('ToggleSidebar')).is(name);\n      };\n\n      editor.ui.registry.addToggleButton(name, {\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        onAction: function (buttonApi) {\n          editor.execCommand('ToggleSidebar', false, name);\n          buttonApi.setActive(isActive());\n        },\n        onSetup: function (buttonApi) {\n          var handleToggle = function () {\n            return buttonApi.setActive(isActive());\n          };\n\n          editor.on('ToggleSidebar', handleToggle);\n          return function () {\n            editor.off('ToggleSidebar', handleToggle);\n          };\n        }\n      });\n    });\n  };\n\n  var getApi = function (comp) {\n    return {\n      element: function () {\n        return comp.element.dom;\n      }\n    };\n  };\n\n  var makePanels = function (parts, panelConfigs) {\n    var specs = map(keys(panelConfigs), function (name) {\n      var spec = panelConfigs[name];\n      var bridged = getOrDie(createSidebar(spec));\n      return {\n        name: name,\n        getApi: getApi,\n        onSetup: bridged.onSetup,\n        onShow: bridged.onShow,\n        onHide: bridged.onHide\n      };\n    });\n    return map(specs, function (spec) {\n      var editorOffCell = Cell(noop);\n      return parts.slot(spec.name, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane']\n        },\n        behaviours: SimpleBehaviours.unnamedEvents([onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell), run(slotVisibility(), function (sidepanel, se) {\n          var data = se.event;\n          var optSidePanelSpec = find(specs, function (config) {\n            return config.name === data.name;\n          });\n          optSidePanelSpec.each(function (sidePanelSpec) {\n            var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n            handler(sidePanelSpec.getApi(sidepanel));\n          });\n        })])\n      });\n    });\n  };\n\n  var makeSidebar = function (panelConfigs) {\n    return SlotContainer.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane-container']\n        },\n        components: makePanels(parts, panelConfigs),\n        slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n          return SlotContainer.hideAllSlots(slotContainer);\n        })])\n      };\n    });\n  };\n\n  var setSidebar = function (sidebar, panelConfigs) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n    });\n  };\n\n  var toggleSidebar = function (sidebar, name) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      var optSlotContainer = Composing.getCurrent(slider);\n      optSlotContainer.each(function (slotContainer) {\n        if (Sliding.hasGrown(slider)) {\n          if (SlotContainer.isShowing(slotContainer, name)) {\n            Sliding.shrink(slider);\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n          }\n        } else {\n          SlotContainer.hideAllSlots(slotContainer);\n          SlotContainer.showSlot(slotContainer, name);\n          Sliding.grow(slider);\n        }\n      });\n    });\n  };\n\n  var whichSidebar = function (sidebar) {\n    var optSlider = Composing.getCurrent(sidebar);\n    return optSlider.bind(function (slider) {\n      var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n\n      if (sidebarOpen) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        return optSlotContainer.bind(function (slotContainer) {\n          return find(SlotContainer.getSlotNames(slotContainer), function (name) {\n            return SlotContainer.isShowing(slotContainer, name);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var fixSize = generate$1('FixSizeEvent');\n  var autoSize = generate$1('AutoSizeEvent');\n\n  var renderSidebar = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar'],\n        attributes: {\n          role: 'complementary'\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__slider']\n        },\n        components: [],\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), Sliding.config({\n          dimension: {\n            property: 'width'\n          },\n          closedClass: 'tox-sidebar--sliding-closed',\n          openClass: 'tox-sidebar--sliding-open',\n          shrinkingClass: 'tox-sidebar--sliding-shrinking',\n          growingClass: 'tox-sidebar--sliding-growing',\n          onShrunk: function (slider) {\n            var optSlotContainer = Composing.getCurrent(slider);\n            optSlotContainer.each(SlotContainer.hideAllSlots);\n            emit(slider, autoSize);\n          },\n          onGrown: function (slider) {\n            emit(slider, autoSize);\n          },\n          onStartGrow: function (slider) {\n            emitWith(slider, fixSize, {\n              width: getRaw(slider.element, 'width').getOr('')\n            });\n          },\n          onStartShrink: function (slider) {\n            emitWith(slider, fixSize, {\n              width: get$7(slider.element) + 'px'\n            });\n          }\n        }), Replacing.config({}), Composing.config({\n          find: function (comp) {\n            var children = Replacing.contents(comp);\n            return head(children);\n          }\n        })])\n      }],\n      behaviours: derive$1([ComposingConfigs.childAt(0), config('sidebar-sliding-events', [run(fixSize, function (comp, se) {\n        set$2(comp.element, 'width', se.event.width);\n      }), run(autoSize, function (comp, _se) {\n        remove$6(comp.element, 'width');\n      })])])\n    };\n  };\n\n  var getAttrs = function (elem) {\n    var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n    return foldl(attributes, function (b, attr) {\n      var _a;\n\n      if (attr.name === 'class') {\n        return b;\n      } else {\n        return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n      }\n    }, {});\n  };\n\n  var getClasses = function (elem) {\n    return Array.prototype.slice.call(elem.dom.classList, 0);\n  };\n\n  var fromHtml$2 = function (html) {\n    var elem = SugarElement.fromHtml(html);\n    var children$1 = children(elem);\n    var attrs = getAttrs(elem);\n    var classes = getClasses(elem);\n    var contents = children$1.length === 0 ? {} : {\n      innerHtml: get$1(elem)\n    };\n    return __assign({\n      tag: name(elem),\n      classes: classes,\n      attributes: attrs\n    }, contents);\n  };\n\n  var renderSpinner = function (providerBackstage) {\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          'aria-label': providerBackstage.translate('Loading...')\n        },\n        classes: ['tox-throbber__busy-spinner']\n      },\n      components: [{\n        dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'special',\n        onTab: function () {\n          return Optional.some(true);\n        },\n        onShiftTab: function () {\n          return Optional.some(true);\n        }\n      }), Focusing.config({})])\n    };\n  };\n\n  var toggleThrobber = function (comp, state, providerBackstage) {\n    var element = comp.element;\n\n    if (state === true) {\n      Replacing.set(comp, [renderSpinner(providerBackstage)]);\n      remove$6(element, 'display');\n      remove$1(element, 'aria-hidden');\n    } else {\n      Replacing.set(comp, []);\n      set$2(element, 'display', 'none');\n      set$1(element, 'aria-hidden', 'true');\n    }\n  };\n\n  var renderThrobber = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          'aria-hidden': 'true'\n        },\n        classes: ['tox-throbber'],\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([Replacing.config({})]),\n      components: []\n    };\n  };\n\n  var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n    var throbberState = Cell(false);\n    var timer = Cell(Optional.none());\n\n    var toggle = function (state) {\n      if (state !== throbberState.get()) {\n        toggleThrobber(lazyThrobber(), state, sharedBackstage.providers);\n        throbberState.set(state);\n      }\n    };\n\n    editor.on('ProgressState', function (e) {\n      timer.get().each(global$2.clearTimeout);\n\n      if (isNumber(e.time)) {\n        var timerId = global$2.setEditorTimeout(editor, function () {\n          return toggle(e.state);\n        }, e.time);\n        timer.set(Optional.some(timerId));\n      } else {\n        toggle(e.state);\n        timer.set(Optional.none());\n      }\n    });\n  };\n\n  var factory$h = function (detail, components, _spec) {\n    var apis = {\n      getSocket: function (comp) {\n        return parts$d.getPart(comp, detail, 'socket');\n      },\n      setSidebar: function (comp, panelConfigs) {\n        parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return setSidebar(sidebar, panelConfigs);\n        });\n      },\n      toggleSidebar: function (comp, name) {\n        parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return toggleSidebar(sidebar, name);\n        });\n      },\n      whichSidebar: function (comp) {\n        return parts$d.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n      },\n      getHeader: function (comp) {\n        return parts$d.getPart(comp, detail, 'header');\n      },\n      getToolbar: function (comp) {\n        return parts$d.getPart(comp, detail, 'toolbar');\n      },\n      setToolbar: function (comp, groups) {\n        parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          toolbar.getApis().setGroups(toolbar, groups);\n        });\n      },\n      setToolbars: function (comp, toolbars) {\n        parts$d.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n          CustomList.setItems(mToolbar, toolbars);\n        });\n      },\n      refreshToolbar: function (comp) {\n        var toolbar = parts$d.getPart(comp, detail, 'toolbar');\n        toolbar.each(function (toolbar) {\n          return toolbar.getApis().refresh(toolbar);\n        });\n      },\n      toggleToolbarDrawer: function (comp) {\n        parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          mapFrom(toolbar.getApis().toggle, function (toggle) {\n            return toggle(toolbar);\n          });\n        });\n      },\n      isToolbarDrawerToggled: function (comp) {\n        return parts$d.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n          return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n            return isOpen(toolbar);\n          });\n        }).getOr(false);\n      },\n      getThrobber: function (comp) {\n        return parts$d.getPart(comp, detail, 'throbber');\n      },\n      focusToolbar: function (comp) {\n        var optToolbar = parts$d.getPart(comp, detail, 'toolbar').orThunk(function () {\n          return parts$d.getPart(comp, detail, 'multiple-toolbar');\n        });\n        optToolbar.each(function (toolbar) {\n          Keying.focusIn(toolbar);\n        });\n      },\n      setMenubar: function (comp, menus) {\n        parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.setMenus(menubar, menus);\n        });\n      },\n      focusMenubar: function (comp) {\n        parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.focus(menubar);\n        });\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      behaviours: detail.behaviours\n    };\n  };\n\n  var partMenubar = partType$1.optional({\n    factory: SilverMenubar,\n    name: 'menubar',\n    schema: [strict$1('backstage')]\n  });\n\n  var toolbarFactory = function (spec) {\n    if (spec.type === ToolbarMode.sliding) {\n      return renderSlidingMoreToolbar;\n    } else if (spec.type === ToolbarMode.floating) {\n      return renderFloatingMoreToolbar;\n    } else {\n      return renderToolbar;\n    }\n  };\n\n  var partMultipleToolbar = partType$1.optional({\n    factory: {\n      sketch: function (spec) {\n        return CustomList.sketch({\n          uid: spec.uid,\n          dom: spec.dom,\n          listBehaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            selector: '.tox-toolbar'\n          })]),\n          makeItem: function () {\n            return renderToolbar({\n              type: spec.type,\n              uid: generate$1('multiple-toolbar-item'),\n              cyclicKeying: false,\n              initGroups: [],\n              providers: spec.providers,\n              onEscape: function () {\n                spec.onEscape();\n                return Optional.some(true);\n              }\n            });\n          },\n          setupItem: function (_mToolbar, tc, data, _index) {\n            Toolbar.setGroups(tc, data);\n          },\n          shell: true\n        });\n      }\n    },\n    name: 'multiple-toolbar',\n    schema: [strict$1('dom'), strict$1('onEscape')]\n  });\n  var partToolbar = partType$1.optional({\n    factory: {\n      sketch: function (spec) {\n        var renderer = toolbarFactory(spec);\n        var toolbarSpec = {\n          type: spec.type,\n          uid: spec.uid,\n          onEscape: function () {\n            spec.onEscape();\n            return Optional.some(true);\n          },\n          cyclicKeying: false,\n          initGroups: [],\n          getSink: spec.getSink,\n          providers: spec.providers,\n          moreDrawerData: {\n            lazyToolbar: spec.lazyToolbar,\n            lazyMoreButton: spec.lazyMoreButton,\n            lazyHeader: spec.lazyHeader\n          },\n          attributes: spec.attributes\n        };\n        return renderer(toolbarSpec);\n      }\n    },\n    name: 'toolbar',\n    schema: [strict$1('dom'), strict$1('onEscape'), strict$1('getSink')]\n  });\n  var partHeader = partType$1.optional({\n    factory: {\n      sketch: renderHeader\n    },\n    name: 'header',\n    schema: [strict$1('dom')]\n  });\n  var partSocket = partType$1.optional({\n    name: 'socket',\n    schema: [strict$1('dom')]\n  });\n  var partSidebar = partType$1.optional({\n    factory: {\n      sketch: renderSidebar\n    },\n    name: 'sidebar',\n    schema: [strict$1('dom')]\n  });\n  var partThrobber = partType$1.optional({\n    factory: {\n      sketch: renderThrobber\n    },\n    name: 'throbber',\n    schema: [strict$1('dom')]\n  });\n  var OuterContainer = composite$1({\n    name: 'OuterContainer',\n    factory: factory$h,\n    configFields: [strict$1('dom'), strict$1('behaviours')],\n    partFields: [partHeader, partMenubar, partToolbar, partMultipleToolbar, partSocket, partSidebar, partThrobber],\n    apis: {\n      getSocket: function (apis, comp) {\n        return apis.getSocket(comp);\n      },\n      setSidebar: function (apis, comp, panelConfigs) {\n        apis.setSidebar(comp, panelConfigs);\n      },\n      toggleSidebar: function (apis, comp, name) {\n        apis.toggleSidebar(comp, name);\n      },\n      whichSidebar: function (apis, comp) {\n        return apis.whichSidebar(comp);\n      },\n      getHeader: function (apis, comp) {\n        return apis.getHeader(comp);\n      },\n      getToolbar: function (apis, comp) {\n        return apis.getToolbar(comp);\n      },\n      setToolbar: function (apis, comp, grps) {\n        var groups = map(grps, function (grp) {\n          return renderToolbarGroup(grp);\n        });\n        apis.setToolbar(comp, groups);\n      },\n      setToolbars: function (apis, comp, ts) {\n        var renderedToolbars = map(ts, function (g) {\n          return map(g, renderToolbarGroup);\n        });\n        apis.setToolbars(comp, renderedToolbars);\n      },\n      refreshToolbar: function (apis, comp) {\n        return apis.refreshToolbar(comp);\n      },\n      toggleToolbarDrawer: function (apis, comp) {\n        apis.toggleToolbarDrawer(comp);\n      },\n      isToolbarDrawerToggled: function (apis, comp) {\n        return apis.isToolbarDrawerToggled(comp);\n      },\n      getThrobber: function (apis, comp) {\n        return apis.getThrobber(comp);\n      },\n      setMenubar: function (apis, comp, menus) {\n        apis.setMenubar(comp, menus);\n      },\n      focusMenubar: function (apis, comp) {\n        apis.focusMenubar(comp);\n      },\n      focusToolbar: function (apis, comp) {\n        apis.focusToolbar(comp);\n      }\n    }\n  });\n  var defaultMenubar = 'file edit view insert format tools table help';\n  var defaultMenus = {\n    file: {\n      title: 'File',\n      items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n    },\n    edit: {\n      title: 'Edit',\n      items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n    },\n    view: {\n      title: 'View',\n      items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n    },\n    insert: {\n      title: 'Insert',\n      items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n    },\n    format: {\n      title: 'Format',\n      items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat'\n    },\n    tools: {\n      title: 'Tools',\n      items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n    },\n    table: {\n      title: 'Table',\n      items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n    },\n    help: {\n      title: 'Help',\n      items: 'help'\n    }\n  };\n\n  var make$8 = function (menu, registry, editor) {\n    var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n    return {\n      text: menu.title,\n      getItems: function () {\n        return bind(menu.items, function (i) {\n          var itemName = i.toLowerCase();\n\n          if (itemName.trim().length === 0) {\n            return [];\n          } else if (exists(removedMenuItems, function (removedMenuItem) {\n            return removedMenuItem === itemName;\n          })) {\n            return [];\n          } else if (itemName === 'separator' || itemName === '|') {\n            return [{\n              type: 'separator'\n            }];\n          } else if (registry.menuItems[itemName]) {\n            return [registry.menuItems[itemName]];\n          } else {\n            return [];\n          }\n        });\n      }\n    };\n  };\n\n  var parseItemsString = function (items) {\n    if (typeof items === 'string') {\n      return items.split(' ');\n    }\n\n    return items;\n  };\n\n  var identifyMenus = function (editor, registry) {\n    var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n\n    var userDefinedMenus = keys(registry.menus).length > 0;\n    var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n    var validMenus = filter(menubar, function (menuName) {\n      return userDefinedMenus ? registry.menus.hasOwnProperty(menuName) && registry.menus[menuName].hasOwnProperty('items') || defaultMenus.hasOwnProperty(menuName) : defaultMenus.hasOwnProperty(menuName);\n    });\n    var menus = map(validMenus, function (menuName) {\n      var menuData = rawMenuData[menuName];\n      return make$8({\n        title: menuData.title,\n        items: parseItemsString(menuData.items)\n      }, registry, editor);\n    });\n    return filter(menus, function (menu) {\n      var isNotSeparator = function (item) {\n        return item.type !== 'separator';\n      };\n\n      return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n    });\n  };\n\n  var fireSkinLoaded$1 = function (editor) {\n    var done = function () {\n      editor._skinLoaded = true;\n      fireSkinLoaded(editor);\n    };\n\n    return function () {\n      if (editor.initialized) {\n        done();\n      } else {\n        editor.on('init', done);\n      }\n    };\n  };\n\n  var fireSkinLoadError$1 = function (editor, err) {\n    return function () {\n      return fireSkinLoadError(editor, {\n        message: err\n      });\n    };\n  };\n\n  var loadSkin = function (isInline, editor) {\n    var skinUrl = getSkinUrl(editor);\n    var skinUiCss;\n\n    if (skinUrl) {\n      skinUiCss = skinUrl + '/skin.min.css';\n      editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n    }\n\n    if (isSkinDisabled(editor) === false && skinUiCss) {\n      var styleSheetLoader_1 = editor.ui.styleSheetLoader;\n      styleSheetLoader_1.load(skinUiCss, fireSkinLoaded$1(editor), fireSkinLoadError$1(editor, 'Skin could not be loaded'));\n      editor.on('remove', function () {\n        return styleSheetLoader_1.unload(skinUiCss);\n      });\n    } else {\n      fireSkinLoaded$1(editor)();\n    }\n  };\n\n  var iframe = curry(loadSkin, false);\n  var inline = curry(loadSkin, true);\n\n  var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n    var comp = uiComponents.outerContainer;\n    var toolbarConfig = rawUiConfig.toolbar;\n    var toolbarButtonsConfig = rawUiConfig.buttons;\n\n    if (isArrayOf(toolbarConfig, isString)) {\n      var toolbars = toolbarConfig.map(function (t) {\n        var config = {\n          toolbar: t,\n          buttons: toolbarButtonsConfig,\n          allowToolbarGroups: rawUiConfig.allowToolbarGroups\n        };\n        return identifyButtons(editor, config, {\n          backstage: backstage\n        }, Optional.none());\n      });\n      OuterContainer.setToolbars(comp, toolbars);\n    } else {\n      OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, {\n        backstage: backstage\n      }, Optional.none()));\n    }\n  };\n\n  var DOM = global$5.DOM;\n  var detection = detect$3();\n  var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n\n  var setupEvents = function (editor, uiComponents) {\n    var contentWindow = editor.getWin();\n    var initialDocEle = editor.getDoc().documentElement;\n    var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n    var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n\n    var resizeWindow = function () {\n      var outer = lastWindowDimensions.get();\n\n      if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n        lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var resizeDocument = function () {\n      var docEle = editor.getDoc().documentElement;\n      var inner = lastDocumentDimensions.get();\n\n      if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n        lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var scroll = function (e) {\n      return fireScrollContent(editor, e);\n    };\n\n    DOM.bind(contentWindow, 'resize', resizeWindow);\n    DOM.bind(contentWindow, 'scroll', scroll);\n    var elementLoad = capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n    var mothership = uiComponents.uiMothership.element;\n    editor.on('hide', function () {\n      set$2(mothership, 'display', 'none');\n    });\n    editor.on('show', function () {\n      remove$6(mothership, 'display');\n    });\n    editor.on('NodeChange', resizeDocument);\n    editor.on('remove', function () {\n      elementLoad.unbind();\n      DOM.unbind(contentWindow, 'resize', resizeWindow);\n      DOM.unbind(contentWindow, 'scroll', scroll);\n    });\n  };\n\n  var render = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var lastToolbarWidth = Cell(0);\n    var outerContainer = uiComponents.outerContainer;\n    iframe(editor);\n    var eTargetNode = SugarElement.fromDom(args.targetNode);\n    var uiRoot = getContentContainer(getRootNode(eTargetNode));\n    attachSystemAfter(eTargetNode, uiComponents.mothership);\n    attachSystem(uiRoot, uiComponents.uiMothership);\n    editor.on('PostRender', function () {\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      lastToolbarWidth.set(editor.getWin().innerWidth);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n      setupEvents(editor, uiComponents);\n    });\n    var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n\n    if (isiOS12) {\n      setAll$1(socket.element, {\n        'overflow': 'scroll',\n        '-webkit-overflow-scrolling': 'touch'\n      });\n      var limit = first(function () {\n        editor.fire('ScrollContent');\n      }, 20);\n      bind$3(socket.element, 'scroll', limit.throttle);\n    }\n\n    setupReadonlyModeSwitch(editor, uiComponents);\n    editor.addCommand('ToggleSidebar', function (_ui, value) {\n      OuterContainer.toggleSidebar(outerContainer, value);\n      editor.fire('ToggleSidebar');\n    });\n    editor.addQueryValueHandler('ToggleSidebar', function () {\n      return OuterContainer.whichSidebar(outerContainer);\n    });\n    var toolbarMode = getToolbarMode(editor);\n\n    var refreshDrawer = function () {\n      OuterContainer.refreshToolbar(uiComponents.outerContainer);\n    };\n\n    if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n      editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n        var width = editor.getWin().innerWidth;\n\n        if (width !== lastToolbarWidth.get()) {\n          refreshDrawer();\n          lastToolbarWidth.set(width);\n        }\n      });\n    }\n\n    return {\n      iframeContainer: socket.element.dom,\n      editorContainer: outerContainer.element.dom\n    };\n  };\n\n  var Iframe = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render\n  });\n\n  var parseToInt = function (val) {\n    var re = /^[0-9\\.]+(|px)$/i;\n\n    if (re.test('' + val)) {\n      return Optional.some(parseInt('' + val, 10));\n    }\n\n    return Optional.none();\n  };\n\n  var numToPx = function (val) {\n    return isNumber(val) ? val + 'px' : val;\n  };\n\n  var calcCappedSize = function (size, minSize, maxSize) {\n    var minOverride = minSize.filter(function (min) {\n      return size < min;\n    });\n    var maxOverride = maxSize.filter(function (max) {\n      return size > max;\n    });\n    return minOverride.or(maxOverride).getOr(size);\n  };\n\n  var getHeight$1 = function (editor) {\n    var baseHeight = getHeightSetting(editor);\n    var minHeight = getMinHeightSetting(editor);\n    var maxHeight = getMaxHeightSetting(editor);\n    return parseToInt(baseHeight).map(function (height) {\n      return calcCappedSize(height, minHeight, maxHeight);\n    });\n  };\n\n  var getHeightWithFallback = function (editor) {\n    var height = getHeight$1(editor);\n    return height.getOr(getHeightSetting(editor));\n  };\n\n  var getWidth$1 = function (editor) {\n    var baseWidth = getWidthSetting(editor);\n    var minWidth = getMinWidthSetting(editor);\n    var maxWidth = getMaxWidthSetting(editor);\n    return parseToInt(baseWidth).map(function (width) {\n      return calcCappedSize(width, minWidth, maxWidth);\n    });\n  };\n\n  var getWidthWithFallback = function (editor) {\n    var width = getWidth$1(editor);\n    return width.getOr(getWidthSetting(editor));\n  };\n\n  var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n    var uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var DOM = global$5.DOM;\n    var useFixedToolbarContainer = useFixedContainer(editor);\n    var isSticky = isStickyToolbar(editor);\n    var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth$1(editor));\n    var headerBackstage = backstage.shared.header;\n    var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n    var toolbarMode = getToolbarMode(editor);\n    var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n    var visible = Cell(false);\n\n    var isVisible = function () {\n      return visible.get() && !editor.removed;\n    };\n\n    var calcToolbarOffset = function (toolbar) {\n      return isSplitToolbar ? toolbar.fold(function () {\n        return 0;\n      }, function (tbar) {\n        return tbar.components().length > 1 ? get$6(tbar.components()[1].element) : 0;\n      }) : 0;\n    };\n\n    var calcMode = function (container) {\n      switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$6(container.element) - offset;\n          var targetBounds = box(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$6(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n\n        case ToolbarLocation.bottom:\n          return 'bottom';\n\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n      }\n    };\n\n    var setupMode = function (mode) {\n      var container = floatContainer.get();\n      Docking.setModes(container, [mode]);\n      headerBackstage.setDockingMode(mode);\n      var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n      set$1(container.element, Attribute, verticalDir);\n    };\n\n    var updateChromeWidth = function () {\n      var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n        var bodyMargin = parseToInt(get$4(body(), 'margin-left')).getOr(0);\n        return get$7(body()) - absolute(targetElm).left + bodyMargin;\n      });\n      set$2(floatContainer.get().element, 'max-width', maxWidth + 'px');\n    };\n\n    var updateChromePosition = function () {\n      var toolbar = OuterContainer.getToolbar(outerContainer);\n      var offset = calcToolbarOffset(toolbar);\n      var targetBounds = box(targetElm);\n      var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$6(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n      setAll$1(outerContainer.element, {\n        position: 'absolute',\n        top: Math.round(top) + 'px',\n        left: Math.round(targetBounds.x) + 'px'\n      });\n    };\n\n    var repositionPopups$1 = function () {\n      uiMothership.broadcastOn([repositionPopups()], {});\n    };\n\n    var updateChromeUi = function (resetDocking) {\n      if (resetDocking === void 0) {\n        resetDocking = false;\n      }\n\n      if (!isVisible()) {\n        return;\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromeWidth();\n      }\n\n      if (isSplitToolbar) {\n        OuterContainer.refreshToolbar(outerContainer);\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromePosition();\n      }\n\n      if (isSticky) {\n        var floatContainerComp = floatContainer.get();\n        resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n      }\n\n      repositionPopups$1();\n    };\n\n    var updateMode = function (updateUi) {\n      if (updateUi === void 0) {\n        updateUi = true;\n      }\n\n      if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n        return;\n      }\n\n      var currentMode = headerBackstage.getDockingMode();\n      var newMode = calcMode(floatContainer.get());\n\n      if (newMode !== currentMode) {\n        setupMode(newMode);\n\n        if (updateUi) {\n          updateChromeUi(true);\n        }\n      }\n    };\n\n    var show = function () {\n      visible.set(true);\n      set$2(outerContainer.element, 'display', 'flex');\n      DOM.addClass(editor.getBody(), 'mce-edit-focus');\n      remove$6(uiMothership.element, 'display');\n      updateMode(false);\n      updateChromeUi();\n    };\n\n    var hide = function () {\n      visible.set(false);\n\n      if (uiComponents.outerContainer) {\n        set$2(outerContainer.element, 'display', 'none');\n        DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n      }\n\n      set$2(uiMothership.element, 'display', 'none');\n    };\n\n    return {\n      isVisible: isVisible,\n      isPositionedAtTop: isPositionedAtTop,\n      show: show,\n      hide: hide,\n      update: updateChromeUi,\n      updateMode: updateMode,\n      repositionPopups: repositionPopups$1\n    };\n  };\n\n  var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n    var bounds = box(targetElm);\n    return {\n      pos: isToolbarTop ? bounds.y : bounds.bottom,\n      bounds: bounds\n    };\n  };\n\n  var setupEvents$1 = function (editor, targetElm, ui, toolbarPersist) {\n    var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n\n    var resizeContent = function (e) {\n      var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()),\n          pos = _a.pos,\n          bounds = _a.bounds;\n\n      var _b = prevPosAndBounds.get(),\n          prevPos = _b.pos,\n          prevBounds = _b.bounds;\n\n      var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n      prevPosAndBounds.set({\n        pos: pos,\n        bounds: bounds\n      });\n\n      if (hasResized) {\n        fireResizeContent(editor, e);\n      }\n\n      if (ui.isVisible()) {\n        if (prevPos !== pos) {\n          ui.update(true);\n        } else if (hasResized) {\n          ui.updateMode();\n          ui.repositionPopups();\n        }\n      }\n    };\n\n    if (!toolbarPersist) {\n      editor.on('activate', ui.show);\n      editor.on('deactivate', ui.hide);\n    }\n\n    editor.on('SkinLoaded ResizeWindow', function () {\n      return ui.update(true);\n    });\n    editor.on('NodeChange keydown', function (e) {\n      global$2.requestAnimationFrame(function () {\n        return resizeContent(e);\n      });\n    });\n    editor.on('ScrollWindow', function () {\n      return ui.updateMode();\n    });\n    var elementLoad = unbindable();\n    elementLoad.set(capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n    editor.on('remove', function () {\n      elementLoad.clear();\n    });\n  };\n\n  var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var mothership = uiComponents.mothership,\n        uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var floatContainer = Cell(null);\n    var targetElm = SugarElement.fromDom(args.targetNode);\n    var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n    var toolbarPersist = isToolbarPersist(editor);\n    inline(editor);\n\n    var render = function () {\n      if (floatContainer.get()) {\n        ui.show();\n        return;\n      }\n\n      floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n      var uiContainer = getUiContainer(editor);\n      attachSystem(uiContainer, mothership);\n      attachSystem(uiContainer, uiMothership);\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      ui.show();\n      setupEvents$1(editor, targetElm, ui, toolbarPersist);\n      editor.nodeChanged();\n    };\n\n    editor.on('show', render);\n    editor.on('hide', ui.hide);\n\n    if (!toolbarPersist) {\n      editor.on('focus', render);\n      editor.on('blur', ui.hide);\n    }\n\n    editor.on('init', function () {\n      if (editor.hasFocus() || toolbarPersist) {\n        render();\n      }\n    });\n    setupReadonlyModeSwitch(editor, uiComponents);\n    var api = {\n      show: function () {\n        ui.show();\n      },\n      hide: function () {\n        ui.hide();\n      }\n    };\n    return {\n      editorContainer: outerContainer.element.dom,\n      api: api\n    };\n  };\n\n  var Inline = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render$1\n  });\n\n  var register$5 = function (editor) {\n    var alignToolbarButtons = [{\n      name: 'alignleft',\n      text: 'Align left',\n      cmd: 'JustifyLeft',\n      icon: 'align-left'\n    }, {\n      name: 'aligncenter',\n      text: 'Align center',\n      cmd: 'JustifyCenter',\n      icon: 'align-center'\n    }, {\n      name: 'alignright',\n      text: 'Align right',\n      cmd: 'JustifyRight',\n      icon: 'align-right'\n    }, {\n      name: 'alignjustify',\n      text: 'Justify',\n      cmd: 'JustifyFull',\n      icon: 'align-justify'\n    }];\n    global$e.each(alignToolbarButtons, function (item) {\n      editor.ui.registry.addToggleButton(item.name, {\n        tooltip: item.text,\n        onAction: function () {\n          return editor.execCommand(item.cmd);\n        },\n        icon: item.icon,\n        onSetup: onSetupFormatToggle(editor, item.name)\n      });\n    });\n    var alignNoneToolbarButton = {\n      name: 'alignnone',\n      text: 'No alignment',\n      cmd: 'JustifyNone',\n      icon: 'align-none'\n    };\n    editor.ui.registry.addButton(alignNoneToolbarButton.name, {\n      tooltip: alignNoneToolbarButton.text,\n      onAction: function () {\n        return editor.execCommand(alignNoneToolbarButton.cmd);\n      },\n      icon: alignNoneToolbarButton.icon\n    });\n  };\n\n  var register$6 = function (editor, backstage) {\n    alignSelectMenu(editor, backstage);\n    fontSelectMenu(editor, backstage);\n    styleSelectMenu(editor, backstage);\n    formatSelectMenu(editor, backstage);\n    fontsizeSelectMenu(editor, backstage);\n  };\n\n  var toggleOutdentState = function (api, editor) {\n    api.setDisabled(!editor.queryCommandState('outdent'));\n\n    var onNodeChange = function () {\n      api.setDisabled(!editor.queryCommandState('outdent'));\n    };\n\n    editor.on('NodeChange', onNodeChange);\n    return function () {\n      return editor.off('NodeChange', onNodeChange);\n    };\n  };\n\n  var registerButtons = function (editor) {\n    editor.ui.registry.addButton('outdent', {\n      tooltip: 'Decrease indent',\n      icon: 'outdent',\n      onSetup: function (api) {\n        return toggleOutdentState(api, editor);\n      },\n      onAction: function () {\n        return editor.execCommand('outdent');\n      }\n    });\n    editor.ui.registry.addButton('indent', {\n      tooltip: 'Increase indent',\n      icon: 'indent',\n      onAction: function () {\n        return editor.execCommand('indent');\n      }\n    });\n  };\n\n  var register$7 = function (editor) {\n    registerButtons(editor);\n  };\n\n  var toggleFormat = function (editor, fmt) {\n    return function () {\n      editor.execCommand('mceToggleFormat', false, fmt);\n    };\n  };\n\n  var registerFormatButtons = function (editor) {\n    global$e.each([{\n      name: 'bold',\n      text: 'Bold',\n      icon: 'bold'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      icon: 'italic'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      icon: 'underline'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      icon: 'strike-through'\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      icon: 'subscript'\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      icon: 'superscript'\n    }], function (btn, _idx) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onSetup: onSetupFormatToggle(editor, btn.name),\n        onAction: toggleFormat(editor, btn.name)\n      });\n    });\n\n    for (var i = 1; i <= 6; i++) {\n      var name_1 = 'h' + i;\n      editor.ui.registry.addToggleButton(name_1, {\n        text: name_1.toUpperCase(),\n        tooltip: 'Heading ' + i,\n        onSetup: onSetupFormatToggle(editor, name_1),\n        onAction: toggleFormat(editor, name_1)\n      });\n    }\n  };\n\n  var registerCommandButtons = function (editor) {\n    global$e.each([{\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste'\n    }, {\n      name: 'help',\n      text: 'Help',\n      action: 'mceHelp',\n      icon: 'help'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all'\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document'\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting'\n    }, {\n      name: 'remove',\n      text: 'Remove',\n      action: 'Delete',\n      icon: 'remove'\n    }], function (btn) {\n      editor.ui.registry.addButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        }\n      });\n    });\n  };\n\n  var registerCommandToggleButtons = function (editor) {\n    global$e.each([{\n      name: 'blockquote',\n      text: 'Blockquote',\n      action: 'mceBlockQuote',\n      icon: 'quote'\n    }], function (btn) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        },\n        onSetup: onSetupFormatToggle(editor, btn.name)\n      });\n    });\n  };\n\n  var registerButtons$1 = function (editor) {\n    registerFormatButtons(editor);\n    registerCommandButtons(editor);\n    registerCommandToggleButtons(editor);\n  };\n\n  var registerMenuItems = function (editor) {\n    global$e.each([{\n      name: 'bold',\n      text: 'Bold',\n      action: 'Bold',\n      icon: 'bold',\n      shortcut: 'Meta+B'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      action: 'Italic',\n      icon: 'italic',\n      shortcut: 'Meta+I'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      action: 'Underline',\n      icon: 'underline',\n      shortcut: 'Meta+U'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      action: 'Strikethrough',\n      icon: 'strike-through',\n      shortcut: ''\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      action: 'Subscript',\n      icon: 'subscript',\n      shortcut: ''\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      action: 'Superscript',\n      icon: 'superscript',\n      shortcut: ''\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting',\n      shortcut: ''\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document',\n      shortcut: ''\n    }, {\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut',\n      shortcut: 'Meta+X'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy',\n      shortcut: 'Meta+C'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste',\n      shortcut: 'Meta+V'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all',\n      shortcut: 'Meta+A'\n    }], function (btn) {\n      editor.ui.registry.addMenuItem(btn.name, {\n        text: btn.text,\n        icon: btn.icon,\n        shortcut: btn.shortcut,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        }\n      });\n    });\n    editor.ui.registry.addMenuItem('codeformat', {\n      text: 'Code',\n      icon: 'sourcecode',\n      onAction: toggleFormat(editor, 'code')\n    });\n  };\n\n  var register$8 = function (editor) {\n    registerButtons$1(editor);\n    registerMenuItems(editor);\n  };\n\n  var toggleUndoRedoState = function (api, editor, type) {\n    var checkState = function () {\n      return editor.undoManager ? editor.undoManager[type]() : false;\n    };\n\n    var onUndoStateChange = function () {\n      api.setDisabled(editor.mode.isReadOnly() || !checkState());\n    };\n\n    api.setDisabled(!checkState());\n    editor.on('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n    return function () {\n      return editor.off('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n    };\n  };\n\n  var registerMenuItems$1 = function (editor) {\n    editor.ui.registry.addMenuItem('undo', {\n      text: 'Undo',\n      icon: 'undo',\n      shortcut: 'Meta+Z',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasUndo');\n      },\n      onAction: function () {\n        return editor.execCommand('undo');\n      }\n    });\n    editor.ui.registry.addMenuItem('redo', {\n      text: 'Redo',\n      icon: 'redo',\n      shortcut: 'Meta+Y',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasRedo');\n      },\n      onAction: function () {\n        return editor.execCommand('redo');\n      }\n    });\n  };\n\n  var registerButtons$2 = function (editor) {\n    editor.ui.registry.addButton('undo', {\n      tooltip: 'Undo',\n      icon: 'undo',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasUndo');\n      },\n      onAction: function () {\n        return editor.execCommand('undo');\n      }\n    });\n    editor.ui.registry.addButton('redo', {\n      tooltip: 'Redo',\n      icon: 'redo',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasRedo');\n      },\n      onAction: function () {\n        return editor.execCommand('redo');\n      }\n    });\n  };\n\n  var register$9 = function (editor) {\n    registerMenuItems$1(editor);\n    registerButtons$2(editor);\n  };\n\n  var toggleVisualAidState = function (api, editor) {\n    api.setActive(editor.hasVisual);\n\n    var onVisualAid = function (e) {\n      api.setActive(e.hasVisual);\n    };\n\n    editor.on('VisualAid', onVisualAid);\n    return function () {\n      return editor.off('VisualAid', onVisualAid);\n    };\n  };\n\n  var registerMenuItems$2 = function (editor) {\n    editor.ui.registry.addToggleMenuItem('visualaid', {\n      text: 'Visual aids',\n      onSetup: function (api) {\n        return toggleVisualAidState(api, editor);\n      },\n      onAction: function () {\n        editor.execCommand('mceToggleVisualAid');\n      }\n    });\n  };\n\n  var registerToolbarButton = function (editor) {\n    editor.ui.registry.addButton('visualaid', {\n      tooltip: 'Visual aids',\n      text: 'Visual aids',\n      onAction: function () {\n        return editor.execCommand('mceToggleVisualAid');\n      }\n    });\n  };\n\n  var register$a = function (editor) {\n    registerToolbarButton(editor);\n    registerMenuItems$2(editor);\n  };\n\n  var units = {\n    unsupportedLength: ['em', 'ex', 'cap', 'ch', 'ic', 'rem', 'lh', 'rlh', 'vw', 'vh', 'vi', 'vb', 'vmin', 'vmax', 'cm', 'mm', 'Q', 'in', 'pc', 'pt', 'px'],\n    fixed: ['px', 'pt'],\n    relative: ['%'],\n    empty: ['']\n  };\n\n  var pattern = function () {\n    var decimalDigits = '[0-9]+';\n    var signedInteger = '[+-]?' + decimalDigits;\n    var exponentPart = '[eE]' + signedInteger;\n    var dot = '\\\\.';\n\n    var opt = function (input) {\n      return '(?:' + input + ')?';\n    };\n\n    var unsignedDecimalLiteral = ['Infinity', decimalDigits + dot + opt(decimalDigits) + opt(exponentPart), dot + decimalDigits + opt(exponentPart), decimalDigits + opt(exponentPart)].join('|');\n    var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n    return new RegExp('^(' + float + ')(.*)$');\n  }();\n\n  var isUnit = function (unit, accepted) {\n    return exists(accepted, function (acc) {\n      return exists(units[acc], function (check) {\n        return unit === check;\n      });\n    });\n  };\n\n  var parse = function (input, accepted) {\n    var match = Optional.from(pattern.exec(input));\n    return match.bind(function (array) {\n      var value = Number(array[1]);\n      var unitRaw = array[2];\n\n      if (isUnit(unitRaw, accepted)) {\n        return Optional.some({\n          value: value,\n          unit: unitRaw\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalise = function (input, accepted) {\n    return parse(input, accepted).map(function (_a) {\n      var value = _a.value,\n          unit = _a.unit;\n      return value + unit;\n    });\n  };\n\n  var normaliseLineHeight = function (input) {\n    return normalise(input, ['fixed', 'relative', 'empty']).getOr(input);\n  };\n\n  var getLineHeights = function (editor) {\n    var options = getLineHeightFormats(editor);\n    var apis = new Map();\n    var lastApi = destroyable();\n\n    var callback = function () {\n      var current = normaliseLineHeight(editor.queryCommandValue('LineHeight'));\n      Optional.from(apis.get(current)).fold(function () {\n        return lastApi.clear();\n      }, function (api) {\n        lastApi.set({\n          destroy: function () {\n            api.setActive(false);\n          }\n        });\n        api.setActive(true);\n      });\n    };\n\n    editor.on('nodeChange', callback);\n    return map(options, function (value, i) {\n      return {\n        type: 'togglemenuitem',\n        text: value,\n        onSetup: function (api) {\n          apis.set(normaliseLineHeight(value), api);\n\n          if (i + 1 === options.length) {\n            callback();\n          }\n\n          return function () {\n            if (i === 0) {\n              editor.off('nodeChange', callback);\n              lastApi.clear();\n            }\n          };\n        },\n        onAction: function () {\n          return editor.execCommand('LineHeight', false, value);\n        }\n      };\n    });\n  };\n\n  var registerMenuItems$3 = function (editor) {\n    editor.ui.registry.addNestedMenuItem('lineheight', {\n      type: 'nestedmenuitem',\n      text: 'Line height',\n      getSubmenuItems: function () {\n        return getLineHeights(editor);\n      }\n    });\n  };\n\n  var registerButtons$3 = function (editor) {\n    editor.ui.registry.addMenuButton('lineheight', {\n      tooltip: 'Line height',\n      icon: 'line-height',\n      fetch: function (callback) {\n        return callback(getLineHeights(editor));\n      }\n    });\n  };\n\n  var register$b = function (editor) {\n    registerMenuItems$3(editor);\n    registerButtons$3(editor);\n  };\n\n  var setup$8 = function (editor, backstage) {\n    register$5(editor);\n    register$8(editor);\n    register$6(editor, backstage);\n    register$9(editor);\n    register$1(editor);\n    register$a(editor);\n    register$7(editor);\n    register$b(editor);\n  };\n\n  var nu$d = function (x, y) {\n    return {\n      anchor: 'makeshift',\n      x: x,\n      y: y\n    };\n  };\n\n  var transpose$1 = function (pos, dx, dy) {\n    return nu$d(pos.x + dx, pos.y + dy);\n  };\n\n  var isTouchEvent$1 = function (e) {\n    return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n  };\n\n  var fromPageXY = function (e) {\n    if (isTouchEvent$1(e)) {\n      var touch = e.touches[0];\n      return nu$d(touch.pageX, touch.pageY);\n    } else {\n      return nu$d(e.pageX, e.pageY);\n    }\n  };\n\n  var fromClientXY = function (e) {\n    if (isTouchEvent$1(e)) {\n      var touch = e.touches[0];\n      return nu$d(touch.clientX, touch.clientY);\n    } else {\n      return nu$d(e.clientX, e.clientY);\n    }\n  };\n\n  var transposeContentAreaContainer = function (element, pos) {\n    var containerPos = global$5.DOM.getPos(element);\n    return transpose$1(pos, containerPos.x, containerPos.y);\n  };\n\n  var getPointAnchor = function (editor, e) {\n    if (e.type === 'contextmenu' || e.type === 'longpress') {\n      if (editor.inline) {\n        return fromPageXY(e);\n      } else {\n        return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n      }\n    } else {\n      return getSelectionAnchor(editor);\n    }\n  };\n\n  var getSelectionAnchor = function (editor) {\n    return {\n      anchor: 'selection',\n      root: SugarElement.fromDom(editor.selection.getNode())\n    };\n  };\n\n  var getNodeAnchor$1 = function (editor) {\n    return {\n      anchor: 'node',\n      node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n      root: SugarElement.fromDom(editor.getBody())\n    };\n  };\n\n  var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n    var items = buildMenu();\n    var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchor(editor, e);\n    build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuAt(contextmenu, anchorSpec, {\n        menu: {\n          markers: markers$1('normal')\n        },\n        data: menuData\n      });\n    });\n  };\n\n  var layouts = {\n    onLtr: function () {\n      return [south$1, southeast$1, southwest$1, northeast$1, northwest$1, north$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [south$1, southwest$1, southeast$1, northwest$1, northeast$1, north$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n  var bubbleSize$1 = 12;\n  var bubbleAlignments$2 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top']\n  };\n\n  var isTouchWithinSelection = function (editor, e) {\n    var selection = editor.selection;\n\n    if (selection.isCollapsed() || e.touches.length < 1) {\n      return false;\n    } else {\n      var touch_1 = e.touches[0];\n      var rng = selection.getRng();\n      var rngRectOpt = getFirstRect$1(editor.getWin(), SimSelection.domRange(rng));\n      return rngRectOpt.exists(function (rngRect) {\n        return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n      });\n    }\n  };\n\n  var getPointAnchorSpec = function (editor, e) {\n    return __assign({\n      bubble: nu$8(0, bubbleSize$1, bubbleAlignments$2),\n      layouts: layouts,\n      overrides: {\n        maxWidthFunction: expandable$1(),\n        maxHeightFunction: expandable()\n      }\n    }, getPointAnchor(editor, e));\n  };\n\n  var setupiOSOverrides = function (editor) {\n    var originalSelection = editor.selection.getRng();\n\n    var selectionReset = function () {\n      global$2.setEditorTimeout(editor, function () {\n        editor.selection.setRng(originalSelection);\n      }, 10);\n      unbindEventListeners();\n    };\n\n    editor.once('touchend', selectionReset);\n\n    var preventMousedown = function (e) {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n    };\n\n    editor.on('mousedown', preventMousedown, true);\n\n    var clearSelectionReset = function () {\n      return unbindEventListeners();\n    };\n\n    editor.once('longpresscancel', clearSelectionReset);\n\n    var unbindEventListeners = function () {\n      editor.off('touchend', selectionReset);\n      editor.off('longpresscancel', clearSelectionReset);\n      editor.off('mousedown', preventMousedown);\n    };\n  };\n\n  var show = function (editor, e, items, backstage, contextmenu, useNodeAnchor, highlightImmediately) {\n    var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchorSpec(editor, e);\n    build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuWithinBounds(contextmenu, anchorSpec, {\n        menu: {\n          markers: markers$1('normal'),\n          highlightImmediately: highlightImmediately\n        },\n        data: menuData,\n        type: 'horizontal'\n      }, function () {\n        return Optional.some(getContextToolbarBounds(editor, backstage.shared));\n      });\n      editor.fire(hideContextToolbarEvent);\n    });\n  };\n\n  var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n    var detection = detect$3();\n    var isiOS = detection.os.isiOS();\n    var isOSX = detection.os.isOSX();\n    var isAndroid = detection.os.isAndroid();\n    var isTouch = detection.deviceType.isTouch();\n\n    var shouldHighlightImmediately = function () {\n      return !(isAndroid || isiOS || isOSX && isTouch);\n    };\n\n    var open = function () {\n      var items = buildMenu();\n      show(editor, e, items, backstage, contextmenu, useNodeAnchor, shouldHighlightImmediately());\n    };\n\n    if ((isOSX || isiOS) && !useNodeAnchor) {\n      var openiOS_1 = function () {\n        setupiOSOverrides(editor);\n        open();\n      };\n\n      if (isTouchWithinSelection(editor, e)) {\n        openiOS_1();\n      } else {\n        editor.once('selectionchange', openiOS_1);\n        editor.once('touchend', function () {\n          return editor.off('selectionchange', openiOS_1);\n        });\n      }\n    } else {\n      if (isAndroid && !useNodeAnchor) {\n        editor.selection.setCursorLocation(e.target, 0);\n      }\n\n      open();\n    }\n  };\n\n  var patchPipeConfig = function (config) {\n    return typeof config === 'string' ? config.split(/[ ,]/) : config;\n  };\n\n  var shouldNeverUseNative = function (editor) {\n    return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n  };\n\n  var getMenuItems = function (editor, name, defaultItems) {\n    var contextMenus = editor.ui.registry.getAll().contextMenus;\n    return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n      return filter(patchPipeConfig(defaultItems), function (item) {\n        return has(contextMenus, item);\n      });\n    });\n  };\n\n  var isContextMenuDisabled = function (editor) {\n    return editor.getParam('contextmenu') === false;\n  };\n\n  var getContextMenu = function (editor) {\n    return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n  };\n\n  var getAvoidOverlapSelector = function (editor) {\n    return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n  };\n\n  var isSeparator$1 = function (item) {\n    return isString(item) ? item === '|' : item.type === 'separator';\n  };\n\n  var separator$3 = {\n    type: 'separator'\n  };\n\n  var makeContextItem = function (item) {\n    if (isString(item)) {\n      return item;\n    } else {\n      switch (item.type) {\n        case 'separator':\n          return separator$3;\n\n        case 'submenu':\n          return {\n            type: 'nestedmenuitem',\n            text: item.text,\n            icon: item.icon,\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n\n              if (isString(items)) {\n                return items;\n              } else {\n                return map(items, makeContextItem);\n              }\n            }\n          };\n\n        default:\n          return {\n            type: 'menuitem',\n            text: item.text,\n            icon: item.icon,\n            onAction: noarg(item.onAction)\n          };\n      }\n    }\n  };\n\n  var addContextMenuGroup = function (xs, groupItems) {\n    if (groupItems.length === 0) {\n      return xs;\n    }\n\n    var lastMenuItem = last(xs).filter(function (item) {\n      return !isSeparator$1(item);\n    });\n    var before = lastMenuItem.fold(function () {\n      return [];\n    }, function (_) {\n      return [separator$3];\n    });\n    return xs.concat(before).concat(groupItems).concat([separator$3]);\n  };\n\n  var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n    var sections = foldl(menuConfig, function (acc, name) {\n      if (has(contextMenus, name)) {\n        var items = contextMenus[name].update(selectedElement);\n\n        if (isString(items)) {\n          return addContextMenuGroup(acc, items.split(' '));\n        } else if (items.length > 0) {\n          var allItems = map(items, makeContextItem);\n          return addContextMenuGroup(acc, allItems);\n        } else {\n          return acc;\n        }\n      } else {\n        return acc.concat([name]);\n      }\n    }, []);\n\n    if (sections.length > 0 && isSeparator$1(sections[sections.length - 1])) {\n      sections.pop();\n    }\n\n    return sections;\n  };\n\n  var isNativeOverrideKeyEvent = function (editor, e) {\n    return e.ctrlKey && !shouldNeverUseNative(editor);\n  };\n\n  var isTriggeredByKeyboard = function (editor, e) {\n    return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n  };\n\n  var getSelectedElement = function (editor, e) {\n    return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n  };\n\n  var shouldUseNodeAnchor = function (editor, e) {\n    var selector = getAvoidOverlapSelector(editor);\n\n    if (isTriggeredByKeyboard(editor, e)) {\n      return true;\n    } else if (selector) {\n      var target = getSelectedElement(editor, e);\n      return closest$4(SugarElement.fromDom(target), selector);\n    } else {\n      return false;\n    }\n  };\n\n  var setup$9 = function (editor, lazySink, backstage) {\n    var detection = detect$3();\n    var isTouch = detection.deviceType.isTouch;\n    var contextmenu = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div'\n      },\n      lazySink: lazySink,\n      onEscape: function () {\n        return editor.focus();\n      },\n      onShow: function () {\n        return backstage.setContextMenuState(true);\n      },\n      onHide: function () {\n        return backstage.setContextMenuState(false);\n      },\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissContextMenu', [run(dismissRequested(), function (comp, _se) {\n        Sandboxing.close(comp);\n        editor.focus();\n      })])])\n    }));\n\n    var hideContextMenu = function (_e) {\n      return InlineView.hide(contextmenu);\n    };\n\n    var showContextMenu = function (e) {\n      if (shouldNeverUseNative(editor)) {\n        e.preventDefault();\n      }\n\n      if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n        return;\n      }\n\n      var useNodeAnchor = shouldUseNodeAnchor(editor, e);\n\n      var buildMenu = function () {\n        var selectedElement = getSelectedElement(editor, e);\n        var registry = editor.ui.registry.getAll();\n        var menuConfig = getContextMenu(editor);\n        return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n      };\n\n      var initAndShow$2 = isTouch() ? initAndShow$1 : initAndShow;\n      initAndShow$2(editor, e, buildMenu, backstage, contextmenu, useNodeAnchor);\n    };\n\n    editor.on('init', function () {\n      var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n      editor.on(hideEvents, hideContextMenu);\n      editor.on('longpress contextmenu', showContextMenu);\n    });\n  };\n\n  var adt$c = Adt.generate([{\n    offset: ['x', 'y']\n  }, {\n    absolute: ['x', 'y']\n  }, {\n    fixed: ['x', 'y']\n  }]);\n\n  var subtract = function (change) {\n    return function (point) {\n      return point.translate(-change.left, -change.top);\n    };\n  };\n\n  var add$4 = function (change) {\n    return function (point) {\n      return point.translate(change.left, change.top);\n    };\n  };\n\n  var transform$1 = function (changes) {\n    return function (x, y) {\n      return foldl(changes, function (rest, f) {\n        return f(rest);\n      }, SugarPosition(x, y));\n    };\n  };\n\n  var asFixed = function (coord, scroll, origin) {\n    return coord.fold(transform$1([add$4(origin), subtract(scroll)]), transform$1([subtract(scroll)]), transform$1([]));\n  };\n\n  var asAbsolute = function (coord, scroll, origin) {\n    return coord.fold(transform$1([add$4(origin)]), transform$1([]), transform$1([add$4(scroll)]));\n  };\n\n  var asOffset = function (coord, scroll, origin) {\n    return coord.fold(transform$1([]), transform$1([subtract(origin)]), transform$1([add$4(scroll), subtract(origin)]));\n  };\n\n  var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n  };\n\n  var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    var left = Math.abs(a1.left - a2.left);\n    var top = Math.abs(a1.top - a2.top);\n    return SugarPosition(left, top);\n  };\n\n  var toStyles = function (coord, scroll, origin) {\n    var stylesOpt = coord.fold(function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x - origin.left + 'px'),\n        top: Optional.some(y - origin.top + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('fixed'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    });\n    return __assign({\n      right: Optional.none(),\n      bottom: Optional.none()\n    }, stylesOpt);\n  };\n\n  var translate$2 = function (coord, deltaX, deltaY) {\n    return coord.fold(function (x, y) {\n      return offset(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return absolute$3(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return fixed$1(x + deltaX, y + deltaY);\n    });\n  };\n\n  var absorb = function (partialCoord, originalCoord, scroll, origin) {\n    var absorbOne = function (stencil, nu) {\n      return function (optX, optY) {\n        var original = stencil(originalCoord, scroll, origin);\n        return nu(optX.getOr(original.left), optY.getOr(original.top));\n      };\n    };\n\n    return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute$3), absorbOne(asFixed, fixed$1));\n  };\n\n  var offset = adt$c.offset;\n  var absolute$3 = adt$c.absolute;\n  var fixed$1 = adt$c.fixed;\n\n  var parseAttrToInt = function (element, name) {\n    var value = get$2(element, name);\n    return isUndefined(value) ? NaN : parseInt(value, 10);\n  };\n\n  var get$e = function (component, snapsInfo) {\n    var element = component.element;\n    var x = parseAttrToInt(element, snapsInfo.leftAttr);\n    var y = parseAttrToInt(element, snapsInfo.topAttr);\n    return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n  };\n\n  var set$8 = function (component, snapsInfo, pt) {\n    var element = component.element;\n    set$1(element, snapsInfo.leftAttr, pt.left + 'px');\n    set$1(element, snapsInfo.topAttr, pt.top + 'px');\n  };\n\n  var clear = function (component, snapsInfo) {\n    var element = component.element;\n    remove$1(element, snapsInfo.leftAttr);\n    remove$1(element, snapsInfo.topAttr);\n  };\n\n  var getCoords = function (component, snapInfo, coord, delta) {\n    return get$e(component, snapInfo).fold(function () {\n      return coord;\n    }, function (fixed) {\n      return fixed$1(fixed.left + delta.left, fixed.top + delta.top);\n    });\n  };\n\n  var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n    var newCoord = getCoords(component, snapInfo, coord, delta);\n    var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n    var fixedCoord = asFixed(newCoord, scroll, origin);\n    set$8(component, snapInfo, fixedCoord);\n    return snap.fold(function () {\n      return {\n        coord: fixed$1(fixedCoord.left, fixedCoord.top),\n        extra: Optional.none()\n      };\n    }, function (spanned) {\n      return {\n        coord: spanned.output,\n        extra: spanned.extra\n      };\n    });\n  };\n\n  var stopDrag = function (component, snapInfo) {\n    clear(component, snapInfo);\n  };\n\n  var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n    return findMap(snaps, function (snap) {\n      var sensor = snap.sensor;\n      var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n      return inRange ? Optional.some({\n        output: absorb(snap.output, newCoord, scroll, origin),\n        extra: snap.extra\n      }) : Optional.none();\n    });\n  };\n\n  var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n    return matchSnap.orThunk(function () {\n      var bestSnap = foldl(snaps, function (acc, snap) {\n        var sensor = snap.sensor;\n        var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return acc.deltas.fold(function () {\n          return {\n            deltas: Optional.some(deltas),\n            snap: Optional.some(snap)\n          };\n        }, function (bestDeltas) {\n          var currAvg = (deltas.left + deltas.top) / 2;\n          var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n\n          if (currAvg <= bestAvg) {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          } else {\n            return acc;\n          }\n        });\n      }, {\n        deltas: Optional.none(),\n        snap: Optional.none()\n      });\n      return bestSnap.snap.map(function (snap) {\n        return {\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        };\n      });\n    });\n  };\n\n  var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    return findMatchingSnap(snaps, newCoord, scroll, origin);\n  };\n\n  var snapTo = function (snap, scroll, origin) {\n    return {\n      coord: absorb(snap.output, snap.output, scroll, origin),\n      extra: snap.extra\n    };\n  };\n\n  var snapTo$1 = function (component, dragConfig, _state, snap) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner(component.element);\n      var scroll_1 = get$8(doc);\n      var origin_1 = getOrigin(target);\n      var snapPin = snapTo(snap, scroll_1, origin_1);\n      var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n  };\n\n  var DraggingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    snapTo: snapTo$1\n  });\n  var initialAttribute = 'data-initial-z-index';\n\n  var resetZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement).each(function (root) {\n      getOpt(root, initialAttribute).fold(function () {\n        return remove$6(root, 'z-index');\n      }, function (zIndex) {\n        return set$2(root, 'z-index', zIndex);\n      });\n      remove$1(root, initialAttribute);\n    });\n  };\n\n  var changeZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement).each(function (root) {\n      getRaw(root, 'z-index').each(function (zindex) {\n        set$1(root, initialAttribute, zindex);\n      });\n      set$2(root, 'z-index', get$4(blocker.element, 'z-index'));\n    });\n  };\n\n  var instigate = function (anyComponent, blocker) {\n    anyComponent.getSystem().addToGui(blocker);\n    changeZIndex(blocker);\n  };\n\n  var discard = function (blocker) {\n    resetZIndex(blocker);\n    blocker.getSystem().removeFromGui(blocker);\n  };\n\n  var createComponent = function (component, blockerClass, blockerEvents) {\n    return component.getSystem().build(Container.sketch({\n      dom: {\n        styles: {\n          'left': '0px',\n          'top': '0px',\n          'width': '100%',\n          'height': '100%',\n          'position': 'fixed',\n          'z-index': '1000000000000000'\n        },\n        classes: [blockerClass]\n      },\n      events: blockerEvents\n    }));\n  };\n\n  var SnapSchema = optionObjOf('snaps', [strict$1('getSnapPoints'), onHandler('onSensor'), strict$1('leftAttr'), strict$1('topAttr'), defaulted$1('lazyViewport', win), defaulted$1('mustSnap', false)]);\n  var schema$t = [defaulted$1('useFixed', never), strict$1('blockerClass'), defaulted$1('getTarget', identity), defaulted$1('onDrag', noop), defaulted$1('repositionTarget', true), defaulted$1('onDrop', noop), defaultedFunction('getBounds', win), SnapSchema];\n\n  var getCurrentCoord = function (target) {\n    return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n      var nu = position === 'fixed' ? fixed$1 : offset;\n      return nu(parseInt(left, 10), parseInt(top, 10));\n    }).getOrThunk(function () {\n      var location = absolute(target);\n      return absolute$3(location.left, location.top);\n    });\n  };\n\n  var clampCoords = function (component, coords, scroll, origin, startData) {\n    var bounds = startData.bounds;\n    var absoluteCoord = asAbsolute(coords, scroll, origin);\n    var newX = clamp(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n    var newY = clamp(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n    var newCoords = absolute$3(newX, newY);\n    return coords.fold(function () {\n      var offset$1 = asOffset(newCoords, scroll, origin);\n      return offset(offset$1.left, offset$1.top);\n    }, function () {\n      return newCoords;\n    }, function () {\n      var fixed = asFixed(newCoords, scroll, origin);\n      return fixed$1(fixed.left, fixed.top);\n    });\n  };\n\n  var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n    var newCoord = optSnaps.fold(function () {\n      var translated = translate$2(currentCoord, delta.left, delta.top);\n      var fixedCoord = asFixed(translated, scroll, origin);\n      return fixed$1(fixedCoord.left, fixedCoord.top);\n    }, function (snapInfo) {\n      var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n      snapping.extra.each(function (extra) {\n        snapInfo.onSensor(component, extra);\n      });\n      return snapping.coord;\n    });\n    return clampCoords(component, newCoord, scroll, origin, startData);\n  };\n\n  var dragBy = function (component, dragConfig, startData, delta) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner(component.element);\n      var scroll_1 = get$8(doc);\n      var origin_1 = getOrigin(target);\n      var currentCoord = getCurrentCoord(target);\n      var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n      var styles = toStyles(newCoord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n\n    dragConfig.onDrag(component, target, delta);\n  };\n\n  var calcStartData = function (dragConfig, comp) {\n    return {\n      bounds: dragConfig.getBounds(),\n      height: getOuter$1(comp.element),\n      width: getOuter$2(comp.element)\n    };\n  };\n\n  var move$1 = function (component, dragConfig, dragState, dragMode, event) {\n    var delta = dragState.update(dragMode, event);\n    var dragStartData = dragState.getStartData().getOrThunk(function () {\n      return calcStartData(dragConfig, component);\n    });\n    delta.each(function (dlt) {\n      dragBy(component, dragConfig, dragStartData, dlt);\n    });\n  };\n\n  var stop = function (component, blocker, dragConfig, dragState) {\n    blocker.each(discard);\n    dragConfig.snaps.each(function (snapInfo) {\n      stopDrag(component, snapInfo);\n    });\n    var target = dragConfig.getTarget(component.element);\n    dragState.reset();\n    dragConfig.onDrop(component, target);\n  };\n\n  var handlers = function (events) {\n    return function (dragConfig, dragState) {\n      var updateStartState = function (comp) {\n        dragState.setStartData(calcStartData(dragConfig, comp));\n      };\n\n      return derive(__spreadArrays([run(windowScroll(), function (comp) {\n        dragState.getStartData().each(function () {\n          return updateStartState(comp);\n        });\n      })], events(dragConfig, dragState, updateStartState)));\n    };\n  };\n\n  var init$c = function (dragApi) {\n    return derive([run(mousedown(), dragApi.forceDrop), run(mouseup(), dragApi.drop), run(mousemove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    }), run(mouseout(), dragApi.delayDrop)]);\n  };\n\n  var getData$1 = function (event) {\n    return Optional.from(SugarPosition(event.x, event.y));\n  };\n\n  var getDelta$1 = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var MouseData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData$1,\n    getDelta: getDelta$1\n  });\n\n  var events$g = function (dragConfig, dragState, updateStartState) {\n    return [run(mousedown(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.button !== 0) {\n        return;\n      }\n\n      simulatedEvent.stop();\n\n      var stop$1 = function () {\n        return stop(component, Optional.some(blocker), dragConfig, dragState);\n      };\n\n      var delayDrop = DelayedFunction(stop$1, 200);\n      var dragApi = {\n        drop: stop$1,\n        delayDrop: delayDrop.schedule,\n        forceDrop: stop$1,\n        move: function (event) {\n          delayDrop.cancel();\n          move$1(component, dragConfig, dragState, MouseData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$c(dragApi));\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    })];\n  };\n\n  var schema$u = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$g)\n  })]);\n\n  var init$d = function (dragApi) {\n    return derive([run(touchstart(), dragApi.forceDrop), run(touchend(), dragApi.drop), run(touchcancel(), dragApi.drop), run(touchmove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    })]);\n  };\n\n  var getDataFrom = function (touches) {\n    var touch = touches[0];\n    return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n  };\n\n  var getData$2 = function (event) {\n    var raw = event.raw;\n    var touches = raw.touches;\n    return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n  };\n\n  var getDelta$2 = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var TouchData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData$2,\n    getDelta: getDelta$2\n  });\n\n  var events$h = function (dragConfig, dragState, updateStartState) {\n    var blockerCell = Cell(Optional.none());\n    return [run(touchstart(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n\n      var stop$1 = function () {\n        stop(component, blockerCell.get(), dragConfig, dragState);\n        blockerCell.set(Optional.none());\n      };\n\n      var dragApi = {\n        drop: stop$1,\n        delayDrop: function () {},\n        forceDrop: stop$1,\n        move: function (event) {\n          move$1(component, dragConfig, dragState, TouchData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$d(dragApi));\n      blockerCell.set(Optional.some(blocker));\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    }), run(touchmove(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      move$1(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n    }), run(touchend(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      stop(component, blockerCell.get(), dragConfig, dragState);\n      blockerCell.set(Optional.none());\n    }), run(touchcancel(), function (component) {\n      stop(component, blockerCell.get(), dragConfig, dragState);\n      blockerCell.set(Optional.none());\n    })];\n  };\n\n  var schema$v = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$h)\n  })]);\n\n  var events$i = function (dragConfig, dragState, updateStartState) {\n    return __spreadArrays(events$g(dragConfig, dragState, updateStartState), events$h(dragConfig, dragState, updateStartState));\n  };\n\n  var schema$w = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$i)\n  })]);\n\n  var mouse = schema$u;\n  var touch = schema$v;\n  var mouseOrTouch = schema$w;\n  var DraggingBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    mouse: mouse,\n    touch: touch,\n    mouseOrTouch: mouseOrTouch\n  });\n\n  var init$e = function () {\n    var previous = Optional.none();\n    var startData = Optional.none();\n\n    var reset = function () {\n      previous = Optional.none();\n      startData = Optional.none();\n    };\n\n    var calculateDelta = function (mode, nu) {\n      var result = previous.map(function (old) {\n        return mode.getDelta(old, nu);\n      });\n      previous = Optional.some(nu);\n      return result;\n    };\n\n    var update = function (mode, dragEvent) {\n      return mode.getData(dragEvent).bind(function (nuData) {\n        return calculateDelta(mode, nuData);\n      });\n    };\n\n    var setStartData = function (data) {\n      startData = Optional.some(data);\n    };\n\n    var getStartData = function () {\n      return startData;\n    };\n\n    var readState = constant({});\n    return nu$5({\n      readState: readState,\n      reset: reset,\n      update: update,\n      getStartData: getStartData,\n      setStartData: setStartData\n    });\n  };\n\n  var DragState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$e\n  });\n  var Dragging = createModes$1({\n    branchKey: 'mode',\n    branches: DraggingBranches,\n    name: 'dragging',\n    active: {\n      events: function (dragConfig, dragState) {\n        var dragger = dragConfig.dragger;\n        return dragger.handlers(dragConfig, dragState);\n      }\n    },\n    extra: {\n      snap: function (sConfig) {\n        return {\n          sensor: sConfig.sensor,\n          range: sConfig.range,\n          output: sConfig.output,\n          extra: Optional.from(sConfig.extra)\n        };\n      }\n    },\n    state: DragState,\n    apis: DraggingApis\n  });\n  var snapWidth = 40;\n  var snapOffset = snapWidth / 2;\n\n  var calcSnap = function (selectorOpt, td, x, y, width, height) {\n    return selectorOpt.fold(function () {\n      return Dragging.snap({\n        sensor: absolute$3(x - snapOffset, y - snapOffset),\n        range: SugarPosition(width, height),\n        output: absolute$3(Optional.some(x), Optional.some(y)),\n        extra: {\n          td: td\n        }\n      });\n    }, function (selectorHandle) {\n      var sensorLeft = x - snapOffset;\n      var sensorTop = y - snapOffset;\n      var sensorWidth = snapWidth;\n      var sensorHeight = snapWidth;\n      var rect = selectorHandle.element.dom.getBoundingClientRect();\n      return Dragging.snap({\n        sensor: absolute$3(sensorLeft, sensorTop),\n        range: SugarPosition(sensorWidth, sensorHeight),\n        output: absolute$3(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n        extra: {\n          td: td\n        }\n      });\n    });\n  };\n\n  var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n    var isSameCell = function (cellOpt, td) {\n      return cellOpt.exists(function (currentTd) {\n        return eq$1(currentTd, td);\n      });\n    };\n\n    return {\n      getSnapPoints: getSnapPoints,\n      leftAttr: 'data-drag-left',\n      topAttr: 'data-drag-top',\n      onSensor: function (component, extra) {\n        var td = extra.td;\n\n        if (!isSameCell(cell.get(), td)) {\n          cell.set(Optional.some(td));\n          onChange(td);\n        }\n      },\n      mustSnap: true\n    };\n  };\n\n  var createSelector = function (snaps) {\n    return record(Button.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-selector']\n      },\n      buttonBehaviours: derive$1([Dragging.config({\n        mode: 'mouseOrTouch',\n        blockerClass: 'blocker',\n        snaps: snaps\n      }), Unselecting.config({})]),\n      eventOrder: {\n        mousedown: ['dragging', 'alloy.base.behaviour'],\n        touchstart: ['dragging', 'alloy.base.behaviour']\n      }\n    }));\n  };\n\n  var setup$a = function (editor, sink) {\n    var tlTds = Cell([]);\n    var brTds = Cell([]);\n    var isVisible = Cell(false);\n    var startCell = Cell(Optional.none());\n    var finishCell = Cell(Optional.none());\n\n    var getTopLeftSnap = function (td) {\n      var box = absolute$1(td);\n      return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n    };\n\n    var getTopLeftSnaps = function () {\n      return map(tlTds.get(), function (td) {\n        return getTopLeftSnap(td);\n      });\n    };\n\n    var getBottomRightSnap = function (td) {\n      var box = absolute$1(td);\n      return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n    };\n\n    var getBottomRightSnaps = function () {\n      return map(brTds.get(), function (td) {\n        return getBottomRightSnap(td);\n      });\n    };\n\n    var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n      finishCell.get().each(function (finish) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n      startCell.get().each(function (start) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var memTopLeft = createSelector(topLeftSnaps);\n    var memBottomRight = createSelector(bottomRightSnaps);\n    var topLeft = build$1(memTopLeft.asSpec());\n    var bottomRight = build$1(memBottomRight.asSpec());\n\n    var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n      var cellRect = cell.dom.getBoundingClientRect();\n      remove$6(selector.element, 'display');\n      var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n      var aboveViewport = isAbove(cellRect);\n      var belowViewport = isBelow(cellRect, viewportHeight);\n\n      if (aboveViewport || belowViewport) {\n        set$2(selector.element, 'display', 'none');\n      }\n    };\n\n    var snapTo = function (selector, cell, getSnapConfig, pos) {\n      var snap = getSnapConfig(cell);\n      Dragging.snapTo(selector, snap);\n\n      var isAbove = function (rect) {\n        return rect[pos] < 0;\n      };\n\n      var isBelow = function (rect, viewportHeight) {\n        return rect[pos] > viewportHeight;\n      };\n\n      showOrHideHandle(selector, cell, isAbove, isBelow);\n    };\n\n    var snapTopLeft = function (cell) {\n      return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n    };\n\n    var snapLastTopLeft = function () {\n      return startCell.get().each(snapTopLeft);\n    };\n\n    var snapBottomRight = function (cell) {\n      return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n    };\n\n    var snapLastBottomRight = function () {\n      return finishCell.get().each(snapBottomRight);\n    };\n\n    if (detect$3().deviceType.isTouch()) {\n      editor.on('TableSelectionChange', function (e) {\n        if (!isVisible.get()) {\n          attach$1(sink, topLeft);\n          attach$1(sink, bottomRight);\n          isVisible.set(true);\n        }\n\n        startCell.set(Optional.some(e.start));\n        finishCell.set(Optional.some(e.finish));\n        e.otherCells.each(function (otherCells) {\n          tlTds.set(otherCells.upOrLeftCells);\n          brTds.set(otherCells.downOrRightCells);\n          snapTopLeft(e.start);\n          snapBottomRight(e.finish);\n        });\n      });\n      editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n        snapLastTopLeft();\n        snapLastBottomRight();\n      });\n      editor.on('TableSelectionClear', function () {\n        if (isVisible.get()) {\n          detach(topLeft);\n          detach(bottomRight);\n          isVisible.set(false);\n        }\n\n        startCell.set(Optional.none());\n        finishCell.set(Optional.none());\n      });\n    }\n  };\n\n  var ResizeTypes;\n\n  (function (ResizeTypes) {\n    ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n    ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n    ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n  })(ResizeTypes || (ResizeTypes = {}));\n\n  var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n    var dimensions = {};\n    dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n\n    if (resizeType === ResizeTypes.Both) {\n      dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n    }\n\n    return dimensions;\n  };\n\n  var resize$3 = function (editor, deltas, resizeType) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var dimensions = getDimensions(editor, deltas, resizeType, get$6(container), get$7(container));\n    each$1(dimensions, function (val, dim) {\n      return set$2(container, dim, numToPx(val));\n    });\n    fireResizeEditor(editor);\n  };\n\n  var isHidden$1 = function (elm) {\n    if (elm.nodeType === 1) {\n      if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n        return true;\n      }\n\n      if (elm.getAttribute('data-mce-type') === 'bookmark') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var renderElementPath = function (editor, settings, providersBackstage) {\n    if (!settings.delimiter) {\n      settings.delimiter = '\\xBB';\n    }\n\n    var getDataPath = function (data) {\n      var parts = data || [];\n      var newPathElements = map(parts, function (part, index) {\n        return Button.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-item'],\n            attributes: {\n              'role': 'button',\n              'data-index': index,\n              'tab-index': -1,\n              'aria-level': index + 1\n            },\n            innerHtml: part.name\n          },\n          action: function (_btn) {\n            editor.focus();\n            editor.selection.select(part.element);\n            editor.nodeChanged();\n          },\n          buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isReadOnly), receivingConfig()])\n        });\n      });\n      var divider = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path-divider'],\n          attributes: {\n            'aria-hidden': true\n          },\n          innerHtml: ' ' + settings.delimiter + ' '\n        }\n      };\n      return foldl(newPathElements.slice(1), function (acc, element) {\n        var newAcc = acc;\n        newAcc.push(divider);\n        newAcc.push(element);\n        return newAcc;\n      }, [newPathElements[0]]);\n    };\n\n    var updatePath = function (parents) {\n      var newPath = [];\n      var i = parents.length;\n\n      while (i-- > 0) {\n        var parent_1 = parents[i];\n\n        if (parent_1.nodeType === 1 && !isHidden$1(parent_1)) {\n          var args = editor.fire('ResolveName', {\n            name: parent_1.nodeName.toLowerCase(),\n            target: parent_1\n          });\n\n          if (!args.isDefaultPrevented()) {\n            newPath.push({\n              name: args.name,\n              element: parent_1\n            });\n          }\n\n          if (args.isPropagationStopped()) {\n            break;\n          }\n        }\n      }\n\n      return newPath;\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar__path'],\n        attributes: {\n          role: 'navigation'\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'flow',\n        selector: 'div[role=button]'\n      }), Disabling.config({\n        disabled: providersBackstage.isReadOnly\n      }), receivingConfig(), Tabstopping.config({}), Replacing.config({}), config('elementPathEvents', [runOnAttached(function (comp, _e) {\n        editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n          return Keying.focusIn(comp);\n        });\n        editor.on('NodeChange', function (e) {\n          var newPath = updatePath(e.parents);\n\n          if (newPath.length > 0) {\n            Replacing.set(comp, getDataPath(newPath));\n          } else {\n            Replacing.set(comp, []);\n          }\n        });\n      })])]),\n      components: []\n    };\n  };\n\n  var renderWordCount = function (editor, providersBackstage) {\n    var _a;\n\n    var replaceCountText = function (comp, count, mode) {\n      return Replacing.set(comp, [text(providersBackstage.translate(['{0} ' + mode, count[mode]]))]);\n    };\n\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-statusbar__wordcount']\n      },\n      components: [],\n      buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isReadOnly), receivingConfig(), Tabstopping.config({}), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: {\n            mode: 'words',\n            count: {\n              words: 0,\n              characters: 0\n            }\n          }\n        }\n      }), config('wordcount-events', [runOnExecute(function (comp) {\n        var currentVal = Representing.getValue(comp);\n        var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n        Representing.setValue(comp, {\n          mode: newMode,\n          count: currentVal.count\n        });\n        replaceCountText(comp, currentVal.count, newMode);\n      }), runOnAttached(function (comp) {\n        editor.on('wordCountUpdate', function (e) {\n          var mode = Representing.getValue(comp).mode;\n          Representing.setValue(comp, {\n            mode: mode,\n            count: e.wordCount\n          });\n          replaceCountText(comp, e.wordCount, mode);\n        });\n      })])]),\n      eventOrder: (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'wordcount-events'], _a)\n    });\n  };\n\n  var renderStatusbar = function (editor, providersBackstage) {\n    var renderResizeHandlerIcon = function (resizeType) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__resize-handle'],\n          attributes: {\n            'title': providersBackstage.translate('Resize'),\n            'aria-hidden': 'true'\n          },\n          innerHtml: get$d('resize-handle', providersBackstage.icons)\n        },\n        behaviours: derive$1([Dragging.config({\n          mode: 'mouse',\n          repositionTarget: false,\n          onDrag: function (comp, target, delta) {\n            resize$3(editor, delta, resizeType);\n          },\n          blockerClass: 'tox-blocker'\n        })])\n      };\n    };\n\n    var renderBranding = function () {\n      var label = global$6.translate(['Powered by {0}', 'Tiny']);\n      var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n      return {\n        dom: {\n          tag: 'span',\n          classes: ['tox-statusbar__branding'],\n          innerHtml: linkHtml\n        }\n      };\n    };\n\n    var getResizeType = function (editor) {\n      var fallback = !editor.hasPlugin('autoresize');\n      var resize = editor.getParam('resize', fallback);\n\n      if (resize === false) {\n        return ResizeTypes.None;\n      } else if (resize === 'both') {\n        return ResizeTypes.Both;\n      } else {\n        return ResizeTypes.Vertical;\n      }\n    };\n\n    var getTextComponents = function () {\n      var components = [];\n\n      if (editor.getParam('elementpath', true, 'boolean')) {\n        components.push(renderElementPath(editor, {}, providersBackstage));\n      }\n\n      if (editor.hasPlugin('wordcount')) {\n        components.push(renderWordCount(editor, providersBackstage));\n      }\n\n      if (editor.getParam('branding', true, 'boolean')) {\n        components.push(renderBranding());\n      }\n\n      if (components.length > 0) {\n        return [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__text-container']\n          },\n          components: components\n        }];\n      }\n\n      return [];\n    };\n\n    var getComponents = function () {\n      var components = getTextComponents();\n      var resizeType = getResizeType(editor);\n\n      if (resizeType !== ResizeTypes.None) {\n        components.push(renderResizeHandlerIcon(resizeType));\n      }\n\n      return components;\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar']\n      },\n      components: getComponents()\n    };\n  };\n\n  var setup$b = function (editor) {\n    var _a;\n\n    var isInline = editor.inline;\n    var mode = isInline ? Inline : Iframe;\n    var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n    var lazyOuterContainer = Optional.none();\n    var platform = detect$3();\n    var isIE = platform.browser.isIE();\n    var platformClasses = isIE ? ['tox-platform-ie'] : [];\n    var isTouch = platform.deviceType.isTouch();\n    var touchPlatformClass = 'tox-platform-touch';\n    var deviceClasses = isTouch ? [touchPlatformClass] : [];\n    var isToolbarBottom = isToolbarLocationBottom(editor);\n    var dirAttributes = global$6.isRtl() ? {\n      attributes: {\n        dir: 'rtl'\n      }\n    } : {};\n    var verticalDirAttributes = {\n      attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a)\n    };\n\n    var lazyHeader = function () {\n      return lazyOuterContainer.bind(OuterContainer.getHeader);\n    };\n\n    var isHeaderDocked = function () {\n      return header.isDocked(lazyHeader);\n    };\n\n    var sink = build$1({\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox', 'tox-silver-sink', 'tox-tinymce-aux'].concat(platformClasses).concat(deviceClasses)\n      }, dirAttributes),\n      behaviours: derive$1([Positioning.config({\n        useFixed: function () {\n          return isHeaderDocked();\n        }\n      })])\n    });\n\n    var lazySink = function () {\n      return Result.value(sink);\n    };\n\n    var memAnchorBar = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-anchorbar']\n      }\n    });\n\n    var lazyAnchorBar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return memAnchorBar.getOpt(container);\n      }).getOrDie('Could not find a anchor bar element');\n    };\n\n    var lazyToolbar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getToolbar(container);\n      }).getOrDie('Could not find more toolbar element');\n    };\n\n    var lazyThrobber = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getThrobber(container);\n      }).getOrDie('Could not find throbber element');\n    };\n\n    var backstage = init$8(sink, editor, lazyAnchorBar);\n    var partMenubar = OuterContainer.parts.menubar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-menubar']\n      },\n      backstage: backstage,\n      onEscape: function () {\n        editor.focus();\n      }\n    });\n    var toolbarMode = getToolbarMode(editor);\n    var partToolbar = OuterContainer.parts.toolbar(__assign({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar']\n      },\n      getSink: lazySink,\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode,\n      lazyToolbar: lazyToolbar,\n      lazyHeader: function () {\n        return lazyHeader().getOrDie('Could not find header element');\n      }\n    }, verticalDirAttributes));\n    var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode\n    });\n    var partSocket = OuterContainer.parts.socket({\n      dom: {\n        tag: 'div',\n        classes: ['tox-edit-area']\n      }\n    });\n    var partSidebar = OuterContainer.parts.sidebar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar']\n      }\n    });\n    var partThrobber = OuterContainer.parts.throbber({\n      dom: {\n        tag: 'div',\n        classes: ['tox-throbber']\n      },\n      backstage: backstage\n    });\n    var sb = editor.getParam('statusbar', true, 'boolean');\n    var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n    var socketSidebarContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar-wrap']\n      },\n      components: [partSocket, partSidebar]\n    };\n    var hasMultipleToolbar = isMultipleToolbars(editor);\n    var hasToolbar = isToolbarEnabled(editor);\n    var hasMenubar = isMenubarEnabled(editor);\n\n    var getPartToolbar = function () {\n      if (hasMultipleToolbar) {\n        return [partMultipleToolbar];\n      } else if (hasToolbar) {\n        return [partToolbar];\n      } else {\n        return [];\n      }\n    };\n\n    var partHeader = OuterContainer.parts.header({\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-editor-header']\n      }, verticalDirAttributes),\n      components: flatten([hasMenubar ? [partMenubar] : [], getPartToolbar(), useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]]),\n      sticky: isStickyToolbar(editor),\n      editor: editor,\n      sharedBackstage: backstage.shared\n    });\n    var editorComponents = flatten([isToolbarBottom ? [] : [partHeader], isInline ? [] : [socketSidebarContainer], isToolbarBottom ? [partHeader] : []]);\n    var editorContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-editor-container']\n      },\n      components: editorComponents\n    };\n    var containerComponents = flatten([[editorContainer], isInline ? [] : statusbar.toArray(), [partThrobber]]);\n    var isHidden = isDistractionFree(editor);\n\n    var attributes = __assign(__assign({\n      role: 'application'\n    }, global$6.isRtl() ? {\n      dir: 'rtl'\n    } : {}), isHidden ? {\n      'aria-hidden': 'true'\n    } : {});\n\n    var outerContainer = build$1(OuterContainer.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox', 'tox-tinymce'].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n        styles: __assign({\n          visibility: 'hidden'\n        }, isHidden ? {\n          opacity: '0',\n          border: '0'\n        } : {}),\n        attributes: attributes\n      },\n      components: containerComponents,\n      behaviours: derive$1([Keying.config({\n        mode: 'cyclic',\n        selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a'\n      })])\n    }));\n    lazyOuterContainer = Optional.some(outerContainer);\n    editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n      OuterContainer.focusMenubar(outerContainer);\n    });\n    editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n      OuterContainer.focusToolbar(outerContainer);\n    });\n    editor.addCommand('ToggleToolbarDrawer', function () {\n      OuterContainer.toggleToolbarDrawer(outerContainer);\n    });\n    editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n      return OuterContainer.isToolbarDrawerToggled(outerContainer);\n    });\n    var mothership = takeover(outerContainer);\n    var uiMothership = takeover(sink);\n    setup$3(editor, mothership, uiMothership);\n\n    var getUi = function () {\n      var channels = {\n        broadcastAll: uiMothership.broadcast,\n        broadcastOn: uiMothership.broadcastOn,\n        register: function () {}\n      };\n      return {\n        channels: channels\n      };\n    };\n\n    var setEditorSize = function () {\n      var parsedHeight = numToPx(getHeightWithFallback(editor));\n      var parsedWidth = numToPx(getWidthWithFallback(editor));\n\n      if (!editor.inline) {\n        if (isValidValue('div', 'width', parsedWidth)) {\n          set$2(outerContainer.element, 'width', parsedWidth);\n        }\n\n        if (isValidValue('div', 'height', parsedHeight)) {\n          set$2(outerContainer.element, 'height', parsedHeight);\n        } else {\n          set$2(outerContainer.element, 'height', '200px');\n        }\n      }\n\n      return parsedHeight;\n    };\n\n    var renderUI = function () {\n      header.setup(editor, backstage.shared, lazyHeader);\n      setup$8(editor, backstage);\n      setup$9(editor, lazySink, backstage);\n      setup$6(editor);\n      setup$7(editor, lazyThrobber, backstage.shared);\n      map$2(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n        editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n      });\n\n      var _a = editor.ui.registry.getAll(),\n          buttons = _a.buttons,\n          menuItems = _a.menuItems,\n          contextToolbars = _a.contextToolbars,\n          sidebars = _a.sidebars;\n\n      var toolbarOpt = getMultipleToolbarsSetting(editor);\n      var rawUiConfig = {\n        menuItems: menuItems,\n        menus: getMenus(editor),\n        menubar: getMenubar(editor),\n        toolbar: toolbarOpt.getOrThunk(function () {\n          return getToolbar(editor);\n        }),\n        allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n        buttons: buttons,\n        sidebar: sidebars\n      };\n      register$4(editor, contextToolbars, sink, {\n        backstage: backstage\n      });\n      setup$a(editor, sink);\n      var elm = editor.getElement();\n      var height = setEditorSize();\n      var uiComponents = {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        outerContainer: outerContainer\n      };\n      var args = {\n        targetNode: elm,\n        height: height\n      };\n      return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n    };\n\n    return {\n      mothership: mothership,\n      uiMothership: uiMothership,\n      backstage: backstage,\n      renderUI: renderUI,\n      getUi: getUi\n    };\n  };\n\n  var describedBy = function (describedElement, describeElement) {\n    var describeId = Optional.from(get$2(describedElement, 'id')).fold(function () {\n      var id = generate$1('dialog-describe');\n      set$1(describeElement, 'id', id);\n      return id;\n    }, identity);\n    set$1(describedElement, 'aria-describedby', describeId);\n  };\n\n  var labelledBy = function (labelledElement, labelElement) {\n    var labelId = getOpt(labelledElement, 'id').fold(function () {\n      var id = generate$1('dialog-label');\n      set$1(labelElement, 'id', id);\n      return id;\n    }, identity);\n    set$1(labelledElement, 'aria-labelledby', labelId);\n  };\n\n  var schema$x = constant([strict$1('lazySink'), option('dragBlockClass'), defaultedFunction('getBounds', win), defaulted$1('useTabstopAt', always), defaulted$1('eventOrder', {}), field$1('modalBehaviours', [Keying]), onKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape')]);\n  var basic = {\n    sketch: identity\n  };\n  var parts$f = constant([optional({\n    name: 'draghandle',\n    overrides: function (detail, spec) {\n      return {\n        behaviours: derive$1([Dragging.config({\n          mode: 'mouse',\n          getTarget: function (handle) {\n            return ancestor$2(handle, '[role=\"dialog\"]').getOr(handle);\n          },\n          blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n          getBounds: detail.getDragBounds\n        })])\n      };\n    }\n  }), required({\n    schema: [strict$1('dom')],\n    name: 'title'\n  }), required({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'close'\n  }), required({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'body'\n  }), optional({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'footer'\n  }), external$1({\n    factory: {\n      sketch: function (spec, detail) {\n        return __assign(__assign({}, spec), {\n          dom: detail.dom,\n          components: detail.components\n        });\n      }\n    },\n    schema: [defaulted$1('dom', {\n      tag: 'div',\n      styles: {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        right: '0px',\n        bottom: '0px'\n      }\n    }), defaulted$1('components', [])],\n    name: 'blocker'\n  })]);\n\n  var factory$i = function (detail, components, spec, externals) {\n    var _a;\n\n    var dialogBusyEvent = generate$1('alloy.dialog.busy');\n    var dialogIdleEvent = generate$1('alloy.dialog.idle');\n    var busyBehaviours = derive$1([Keying.config({\n      mode: 'special',\n      onTab: function () {\n        return Optional.some(true);\n      },\n      onShiftTab: function () {\n        return Optional.some(true);\n      }\n    }), Focusing.config({})]);\n\n    var showDialog = function (dialog) {\n      var sink = detail.lazySink(dialog).getOrDie();\n      var busyComp = Cell(Optional.none());\n      var externalBlocker = externals.blocker();\n      var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n        components: externalBlocker.components.concat([premade$1(dialog)]),\n        behaviours: derive$1([Focusing.config({}), config('dialog-blocker-events', [runOnSource(focusin(), function () {\n          Keying.focusIn(dialog);\n        }), run(dialogIdleEvent, function (_blocker, _se) {\n          if (has$1(dialog.element, 'aria-busy')) {\n            remove$1(dialog.element, 'aria-busy');\n            busyComp.get().each(function (bc) {\n              return Replacing.remove(dialog, bc);\n            });\n          }\n        }), run(dialogBusyEvent, function (blocker, se) {\n          set$1(dialog.element, 'aria-busy', 'true');\n          var getBusySpec = se.event.getBusySpec;\n          busyComp.get().each(function (bc) {\n            Replacing.remove(dialog, bc);\n          });\n          var busySpec = getBusySpec(dialog, busyBehaviours);\n          var busy = blocker.getSystem().build(busySpec);\n          busyComp.set(Optional.some(busy));\n          Replacing.append(dialog, premade$1(busy));\n\n          if (busy.hasConfigured(Keying)) {\n            Keying.focusIn(busy);\n          }\n        })])])\n      }));\n      attach$1(sink, blocker);\n      Keying.focusIn(dialog);\n    };\n\n    var hideDialog = function (dialog) {\n      parent(dialog.element).each(function (blockerDom) {\n        dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n          detach(blocker);\n        });\n      });\n    };\n\n    var getDialogBody = function (dialog) {\n      return getPartOrDie(dialog, detail, 'body');\n    };\n\n    var getDialogFooter = function (dialog) {\n      return getPartOrDie(dialog, detail, 'footer');\n    };\n\n    var setBusy = function (dialog, getBusySpec) {\n      emitWith(dialog, dialogBusyEvent, {\n        getBusySpec: getBusySpec\n      });\n    };\n\n    var setIdle = function (dialog) {\n      emit(dialog, dialogIdleEvent);\n    };\n\n    var modalEventsId = generate$1('modal-events');\n\n    var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: {\n        show: showDialog,\n        hide: hideDialog,\n        getBody: getDialogBody,\n        getFooter: getDialogFooter,\n        setIdle: setIdle,\n        setBusy: setBusy\n      },\n      eventOrder: eventOrder,\n      domModification: {\n        attributes: {\n          'role': 'dialog',\n          'aria-modal': 'true'\n        }\n      },\n      behaviours: augment(detail.modalBehaviours, [Replacing.config({}), Keying.config({\n        mode: 'cyclic',\n        onEnter: detail.onExecute,\n        onEscape: detail.onEscape,\n        useTabstopAt: detail.useTabstopAt\n      }), config(modalEventsId, [runOnAttached(function (c) {\n        labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n        describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n      })])])\n    };\n  };\n\n  var ModalDialog = composite$1({\n    name: 'ModalDialog',\n    configFields: schema$x(),\n    partFields: parts$f(),\n    factory: factory$i,\n    apis: {\n      show: function (apis, dialog) {\n        apis.show(dialog);\n      },\n      hide: function (apis, dialog) {\n        apis.hide(dialog);\n      },\n      getBody: function (apis, dialog) {\n        return apis.getBody(dialog);\n      },\n      getFooter: function (apis, dialog) {\n        return apis.getFooter(dialog);\n      },\n      setBusy: function (apis, dialog, getBusySpec) {\n        apis.setBusy(dialog, getBusySpec);\n      },\n      setIdle: function (apis, dialog) {\n        apis.setIdle(dialog);\n      }\n    }\n  });\n  var dialogToggleMenuItemSchema = objOf([strictString('type'), strictString('name')].concat(commonMenuItemFields));\n  var dialogToggleMenuItemDataProcessor = boolean;\n  var baseFooterButtonFields = [field('name', 'name', defaultedThunk(function () {\n    return generate$1('button-name');\n  }), string), optionString('icon'), defaultedStringEnum('align', 'end', ['start', 'end']), defaultedBoolean('primary', false), defaultedBoolean('disabled', false)];\n\n  var dialogFooterButtonFields = __spreadArrays(baseFooterButtonFields, [strictString('text')]);\n\n  var normalFooterButtonFields = __spreadArrays([strictStringEnum('type', ['submit', 'cancel', 'custom'])], dialogFooterButtonFields);\n\n  var menuFooterButtonFields = __spreadArrays([strictStringEnum('type', ['menu']), optionString('text'), optionString('tooltip'), optionString('icon'), strictArrayOf('items', dialogToggleMenuItemSchema)], baseFooterButtonFields);\n\n  var dialogFooterButtonSchema = choose$1('type', {\n    submit: normalFooterButtonFields,\n    cancel: normalFooterButtonFields,\n    custom: normalFooterButtonFields,\n    menu: menuFooterButtonFields\n  });\n  var alertBannerFields = [strictString('type'), strictString('text'), strictStringEnum('level', ['info', 'warn', 'error', 'success']), strictString('icon'), defaulted$1('url', '')];\n  var alertBannerSchema = objOf(alertBannerFields);\n\n  var createBarFields = function (itemsField) {\n    return [strictString('type'), itemsField];\n  };\n\n  var buttonFields = [strictString('type'), strictString('text'), defaultedBoolean('disabled', false), defaultedBoolean('primary', false), field('name', 'name', defaultedThunk(function () {\n    return generate$1('button-name');\n  }), string), optionString('icon'), defaultedBoolean('borderless', false)];\n  var buttonSchema = objOf(buttonFields);\n  var checkboxFields = [strictString('type'), strictString('name'), strictString('label'), defaultedBoolean('disabled', false)];\n  var checkboxSchema = objOf(checkboxFields);\n  var checkboxDataProcessor = boolean;\n  var formComponentFields = [strictString('type'), strictString('name')];\n  var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n  var collectionFields = formComponentWithLabelFields.concat([defaulted$1('columns', 'auto')]);\n  var collectionSchema = objOf(collectionFields);\n  var collectionDataProcessor = arrOfObj$1([strictString('value'), strictString('text'), strictString('icon')]);\n  var colorInputFields = formComponentWithLabelFields;\n  var colorInputSchema = objOf(colorInputFields);\n  var colorInputDataProcessor = string;\n  var colorPickerFields = formComponentWithLabelFields;\n  var colorPickerSchema = objOf(colorPickerFields);\n  var colorPickerDataProcessor = string;\n  var customEditorFields = formComponentFields.concat([defaultedString('tag', 'textarea'), strictString('scriptId'), strictString('scriptUrl'), defaultedPostMsg('settings', undefined)]);\n  var customEditorFieldsOld = formComponentFields.concat([defaultedString('tag', 'textarea'), strictFunction('init')]);\n  var customEditorSchema = valueOf(function (v) {\n    return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n      return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n    });\n  });\n  var customEditorDataProcessor = string;\n  var dropZoneFields = formComponentWithLabelFields;\n  var dropZoneSchema = objOf(dropZoneFields);\n  var dropZoneDataProcessor = arrOfVal();\n\n  var createGridFields = function (itemsField) {\n    return [strictString('type'), strictNumber('columns'), itemsField];\n  };\n\n  var htmlPanelFields = [strictString('type'), strictString('html'), defaultedStringEnum('presets', 'presentation', ['presentation', 'document'])];\n  var htmlPanelSchema = objOf(htmlPanelFields);\n  var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n  var iframeSchema = objOf(iframeFields);\n  var iframeDataProcessor = string;\n  var imageToolsFields = formComponentWithLabelFields.concat([strictOf('currentState', objOf([strict$1('blob'), strictString('url')]))]);\n  var imageToolsSchema = objOf(imageToolsFields);\n  var inputFields = formComponentWithLabelFields.concat([optionString('inputMode'), optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var inputSchema = objOf(inputFields);\n  var inputDataProcessor = string;\n\n  var createLabelFields = function (itemsField) {\n    return [strictString('type'), strictString('label'), itemsField];\n  };\n\n  var listBoxSingleItemFields = [strictString('text'), strictString('value')];\n  var listBoxNestedItemFields = [strictString('text'), strictArrayOf('items', thunkOf('items', function () {\n    return listBoxItemSchema;\n  }))];\n  var listBoxItemSchema = oneOf([objOf(listBoxSingleItemFields), objOf(listBoxNestedItemFields)]);\n  var listBoxFields = formComponentWithLabelFields.concat([strictArrayOf('items', listBoxItemSchema), defaultedBoolean('disabled', false)]);\n  var listBoxSchema = objOf(listBoxFields);\n  var listBoxDataProcessor = string;\n  var selectBoxFields = formComponentWithLabelFields.concat([strictArrayOfObj('items', [strictString('text'), strictString('value')]), defaultedNumber('size', 1), defaultedBoolean('disabled', false)]);\n  var selectBoxSchema = objOf(selectBoxFields);\n  var selectBoxDataProcessor = string;\n  var sizeInputFields = formComponentWithLabelFields.concat([defaultedBoolean('constrain', true), defaultedBoolean('disabled', false)]);\n  var sizeInputSchema = objOf(sizeInputFields);\n  var sizeInputDataProcessor = objOf([strictString('width'), strictString('height')]);\n  var tableFields = [strictString('type'), strictArrayOf('header', string), strictArrayOf('cells', arrOf(string))];\n  var tableSchema = objOf(tableFields);\n  var textAreaFields = formComponentWithLabelFields.concat([optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var textAreaSchema = objOf(textAreaFields);\n  var textAreaDataProcessor = string;\n  var urlInputFields = formComponentWithLabelFields.concat([defaultedStringEnum('filetype', 'file', ['image', 'media', 'file']), defaulted$1('disabled', false)]);\n  var urlInputSchema = objOf(urlInputFields);\n  var urlInputDataProcessor = objOf([strictString('value'), defaulted$1('meta', {})]);\n\n  var createItemsField = function (name) {\n    return field('items', 'items', strict(), arrOf(valueOf(function (v) {\n      return asRaw('Checking item of ' + name, itemSchema$2, v).fold(function (sErr) {\n        return Result.error(formatError(sErr));\n      }, function (passValue) {\n        return Result.value(passValue);\n      });\n    })));\n  };\n\n  var itemSchema$2 = valueThunkOf(function () {\n    return chooseProcessor('type', {\n      alertbanner: alertBannerSchema,\n      bar: objOf(createBarFields(createItemsField('bar'))),\n      button: buttonSchema,\n      checkbox: checkboxSchema,\n      colorinput: colorInputSchema,\n      colorpicker: colorPickerSchema,\n      dropzone: dropZoneSchema,\n      grid: objOf(createGridFields(createItemsField('grid'))),\n      iframe: iframeSchema,\n      input: inputSchema,\n      listbox: listBoxSchema,\n      selectbox: selectBoxSchema,\n      sizeinput: sizeInputSchema,\n      textarea: textAreaSchema,\n      urlinput: urlInputSchema,\n      customeditor: customEditorSchema,\n      htmlpanel: htmlPanelSchema,\n      imagetools: imageToolsSchema,\n      collection: collectionSchema,\n      label: objOf(createLabelFields(createItemsField('label'))),\n      table: tableSchema,\n      panel: panelSchema\n    });\n  });\n  var panelFields = [strictString('type'), defaulted$1('classes', []), strictArrayOf('items', itemSchema$2)];\n  var panelSchema = objOf(panelFields);\n  var tabFields = [field('name', 'name', defaultedThunk(function () {\n    return generate$1('tab-name');\n  }), string), strictString('title'), strictArrayOf('items', itemSchema$2)];\n  var tabPanelFields = [strictString('type'), strictArrayOfObj('tabs', tabFields)];\n  var tabPanelSchema = objOf(tabPanelFields);\n  var dialogButtonFields = dialogFooterButtonFields;\n  var dialogButtonSchema = dialogFooterButtonSchema;\n  var dialogSchema = objOf([strictString('title'), strictOf('body', chooseProcessor('type', {\n    panel: panelSchema,\n    tabpanel: tabPanelSchema\n  })), defaultedString('size', 'normal'), strictArrayOf('buttons', dialogButtonSchema), defaulted$1('initialData', {}), defaultedFunction('onAction', noop), defaultedFunction('onChange', noop), defaultedFunction('onSubmit', noop), defaultedFunction('onClose', noop), defaultedFunction('onCancel', noop), defaulted$1('onTabChange', noop)]);\n\n  var createDialog = function (spec) {\n    return asRaw('dialog', dialogSchema, spec);\n  };\n\n  var urlDialogButtonSchema = objOf(__spreadArrays([strictStringEnum('type', ['cancel', 'custom'])], dialogButtonFields));\n  var urlDialogSchema = objOf([strictString('title'), strictString('url'), optionNumber('height'), optionNumber('width'), optionArrayOf('buttons', urlDialogButtonSchema), defaultedFunction('onAction', noop), defaultedFunction('onCancel', noop), defaultedFunction('onClose', noop), defaultedFunction('onMessage', noop)]);\n\n  var createUrlDialog = function (spec) {\n    return asRaw('dialog', urlDialogSchema, spec);\n  };\n\n  var getAllObjects = function (obj) {\n    if (isObject(obj)) {\n      return [obj].concat(bind(values(obj), getAllObjects));\n    } else if (isArray(obj)) {\n      return bind(obj, getAllObjects);\n    } else {\n      return [];\n    }\n  };\n\n  var isNamedItem = function (obj) {\n    return isString(obj.type) && isString(obj.name);\n  };\n\n  var dataProcessors = {\n    checkbox: checkboxDataProcessor,\n    colorinput: colorInputDataProcessor,\n    colorpicker: colorPickerDataProcessor,\n    dropzone: dropZoneDataProcessor,\n    input: inputDataProcessor,\n    iframe: iframeDataProcessor,\n    sizeinput: sizeInputDataProcessor,\n    selectbox: selectBoxDataProcessor,\n    listbox: listBoxDataProcessor,\n    size: sizeInputDataProcessor,\n    textarea: textAreaDataProcessor,\n    urlinput: urlInputDataProcessor,\n    customeditor: customEditorDataProcessor,\n    collection: collectionDataProcessor,\n    togglemenuitem: dialogToggleMenuItemDataProcessor\n  };\n\n  var getDataProcessor = function (item) {\n    return Optional.from(dataProcessors[item.type]);\n  };\n\n  var getNamedItems = function (structure) {\n    return filter(getAllObjects(structure), isNamedItem);\n  };\n\n  var createDataValidator = function (structure) {\n    var namedItems = getNamedItems(structure);\n    var fields = bind(namedItems, function (item) {\n      return getDataProcessor(item).fold(function () {\n        return [];\n      }, function (schema) {\n        return [strictOf(item.name, schema)];\n      });\n    });\n    return objOf(fields);\n  };\n\n  var extract$1 = function (structure) {\n    var internalDialog = getOrDie(createDialog(structure));\n    var dataValidator = createDataValidator(structure);\n    var initialData = structure.initialData;\n    return {\n      internalDialog: internalDialog,\n      dataValidator: dataValidator,\n      initialData: initialData\n    };\n  };\n\n  var DialogManager = {\n    open: function (factory, structure) {\n      var extraction = extract$1(structure);\n      return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n    },\n    openUrl: function (factory, structure) {\n      var internalDialog = getOrDie(createUrlDialog(structure));\n      return factory(internalDialog);\n    },\n    redial: function (structure) {\n      return extract$1(structure);\n    }\n  };\n\n  var toValidValues = function (values) {\n    var errors = [];\n    var result = {};\n    each$1(values, function (value, name) {\n      value.fold(function () {\n        errors.push(name);\n      }, function (v) {\n        result[name] = v;\n      });\n    });\n    return errors.length > 0 ? Result.error(errors) : Result.value(result);\n  };\n\n  var renderBodyPanel = function (spec, backstage) {\n    var memForm = record(Form.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form'].concat(spec.classes)\n        },\n        components: map(spec.items, function (item) {\n          return interpretInForm(parts, item, backstage);\n        })\n      };\n    }));\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [memForm.asSpec()]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      }), ComposingConfigs.memento(memForm), RepresentingConfigs.memento(memForm, {\n        postprocess: function (formValue) {\n          return toValidValues(formValue).fold(function (err) {\n            console.error(err);\n            return {};\n          }, function (vals) {\n            return vals;\n          });\n        }\n      })])\n    };\n  };\n\n  var factory$j = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events$7(detail.action),\n      behaviours: augment(detail.tabButtonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      })]),\n      domModification: detail.domModification\n    };\n  };\n\n  var TabButton = single$2({\n    name: 'TabButton',\n    configFields: [defaulted$1('uid', undefined), strict$1('value'), field('dom', 'dom', mergeWithThunk(function () {\n      return {\n        attributes: {\n          'role': 'tab',\n          'id': generate$1('aria'),\n          'aria-selected': 'false'\n        }\n      };\n    }), anyValue$1()), option('action'), defaulted$1('domModification', {}), field$1('tabButtonBehaviours', [Focusing, Keying, Representing]), strict$1('view')],\n    factory: factory$j\n  });\n  var schema$y = constant([strict$1('tabs'), strict$1('dom'), defaulted$1('clickToDismiss', false), field$1('tabbarBehaviours', [Highlighting, Keying]), markers(['tabClass', 'selectedClass'])]);\n  var tabsPart = group({\n    factory: TabButton,\n    name: 'tabs',\n    unit: 'tab',\n    overrides: function (barDetail) {\n      var dismissTab$1 = function (tabbar, button) {\n        Highlighting.dehighlight(tabbar, button);\n        emitWith(tabbar, dismissTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      var changeTab$1 = function (tabbar, button) {\n        Highlighting.highlight(tabbar, button);\n        emitWith(tabbar, changeTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      return {\n        action: function (button) {\n          var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n          var activeButton = Highlighting.isHighlighted(tabbar, button);\n\n          var response = function () {\n            if (activeButton && barDetail.clickToDismiss) {\n              return dismissTab$1;\n            } else if (!activeButton) {\n              return changeTab$1;\n            } else {\n              return noop;\n            }\n          }();\n\n          response(tabbar, button);\n        },\n        domModification: {\n          classes: [barDetail.markers.tabClass]\n        }\n      };\n    }\n  });\n  var parts$g = constant([tabsPart]);\n\n  var factory$k = function (detail, components, _spec, _externals) {\n    return {\n      'uid': detail.uid,\n      'dom': detail.dom,\n      components: components,\n      'debug.sketcher': 'Tabbar',\n      'domModification': {\n        attributes: {\n          role: 'tablist'\n        }\n      },\n      'behaviours': augment(detail.tabbarBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedClass,\n        itemClass: detail.markers.tabClass,\n        onHighlight: function (tabbar, tab) {\n          set$1(tab.element, 'aria-selected', 'true');\n        },\n        onDehighlight: function (tabbar, tab) {\n          set$1(tab.element, 'aria-selected', 'false');\n        }\n      }), Keying.config({\n        mode: 'flow',\n        getInitial: function (tabbar) {\n          return Highlighting.getHighlighted(tabbar).map(function (tab) {\n            return tab.element;\n          });\n        },\n        selector: '.' + detail.markers.tabClass,\n        executeOnMove: true\n      })])\n    };\n  };\n\n  var Tabbar = composite$1({\n    name: 'Tabbar',\n    configFields: schema$y(),\n    partFields: parts$g(),\n    factory: factory$k\n  });\n\n  var factory$l = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n      domModification: {\n        attributes: {\n          role: 'tabpanel'\n        }\n      }\n    };\n  };\n\n  var Tabview = single$2({\n    name: 'Tabview',\n    configFields: [field$1('tabviewBehaviours', [Replacing])],\n    factory: factory$l\n  });\n  var schema$z = constant([defaulted$1('selectFirst', true), onHandler('onChangeTab'), onHandler('onDismissTab'), defaulted$1('tabs', []), field$1('tabSectionBehaviours', [])]);\n  var barPart = required({\n    factory: Tabbar,\n    schema: [strict$1('dom'), strictObjOf('markers', [strict$1('tabClass'), strict$1('selectedClass')])],\n    name: 'tabbar',\n    defaults: function (detail) {\n      return {\n        tabs: detail.tabs\n      };\n    }\n  });\n  var viewPart = required({\n    factory: Tabview,\n    name: 'tabview'\n  });\n  var parts$h = constant([barPart, viewPart]);\n\n  var factory$m = function (detail, components, _spec, _externals) {\n    var changeTab$1 = function (button) {\n      var tabValue = Representing.getValue(button);\n      getPart(button, detail, 'tabview').each(function (tabview) {\n        var tabWithValue = find(detail.tabs, function (t) {\n          return t.value === tabValue;\n        });\n        tabWithValue.each(function (tabData) {\n          var panel = tabData.view();\n          getOpt(button.element, 'id').each(function (id) {\n            set$1(tabview.element, 'aria-labelledby', id);\n          });\n          Replacing.set(tabview, panel);\n          detail.onChangeTab(tabview, button, panel);\n        });\n      });\n    };\n\n    var changeTabBy = function (section, byPred) {\n      getPart(section, detail, 'tabbar').each(function (tabbar) {\n        byPred(tabbar).each(emitExecute);\n      });\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$c(detail.tabSectionBehaviours),\n      events: derive(flatten([detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n        changeTabBy(section, Highlighting.getFirst);\n      })] : [], [run(changeTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        changeTab$1(button);\n      }), run(dismissTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        detail.onDismissTab(section, button);\n      })]])),\n      apis: {\n        getViewItems: function (section) {\n          return getPart(section, detail, 'tabview').map(function (tabview) {\n            return Replacing.contents(tabview);\n          }).getOr([]);\n        },\n        showTab: function (section, tabKey) {\n          var getTabIfNotActive = function (tabbar) {\n            var candidates = Highlighting.getCandidates(tabbar);\n            var optTab = find(candidates, function (c) {\n              return Representing.getValue(c) === tabKey;\n            });\n            return optTab.filter(function (tab) {\n              return !Highlighting.isHighlighted(tabbar, tab);\n            });\n          };\n\n          changeTabBy(section, getTabIfNotActive);\n        }\n      }\n    };\n  };\n\n  var TabSection = composite$1({\n    name: 'TabSection',\n    configFields: schema$z(),\n    partFields: parts$h(),\n    factory: factory$m,\n    apis: {\n      getViewItems: function (apis, component) {\n        return apis.getViewItems(component);\n      },\n      showTab: function (apis, component, tabKey) {\n        apis.showTab(component, tabKey);\n      }\n    }\n  });\n\n  var measureHeights = function (allTabs, tabview, tabviewComp) {\n    return map(allTabs, function (_tab, i) {\n      Replacing.set(tabviewComp, allTabs[i].view());\n      var rect = tabview.dom.getBoundingClientRect();\n      Replacing.set(tabviewComp, []);\n      return rect.height;\n    });\n  };\n\n  var getMaxHeight = function (heights) {\n    return head(sort(heights, function (a, b) {\n      if (a > b) {\n        return -1;\n      } else if (a < b) {\n        return +1;\n      } else {\n        return 0;\n      }\n    }));\n  };\n\n  var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n    var documentElement$1 = documentElement(dialog).dom;\n    var rootElm = ancestor$2(dialog, '.tox-dialog-wrap').getOr(dialog);\n    var isFixed = get$4(rootElm, 'position') === 'fixed';\n    var maxHeight;\n\n    if (isFixed) {\n      maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n    } else {\n      maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n    }\n\n    var tabviewHeight = get$6(tabview);\n    var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$7(tablist);\n    var currentTabHeight = isTabListBeside ? Math.max(get$6(tablist), tabviewHeight) : tabviewHeight;\n    var dialogTopMargin = parseInt(get$4(dialog, 'margin-top'), 10) || 0;\n    var dialogBottomMargin = parseInt(get$4(dialog, 'margin-bottom'), 10) || 0;\n    var dialogHeight = get$6(dialog) + dialogTopMargin + dialogBottomMargin;\n    var chromeHeight = dialogHeight - currentTabHeight;\n    return maxHeight - chromeHeight;\n  };\n\n  var showTab = function (allTabs, comp) {\n    head(allTabs).each(function (tab) {\n      return TabSection.showTab(comp, tab.value);\n    });\n  };\n\n  var setTabviewHeight = function (tabview, height) {\n    set$2(tabview, 'height', height + 'px');\n\n    if (!detect$3().browser.isIE()) {\n      set$2(tabview, 'flex-basis', height + 'px');\n    } else {\n      remove$6(tabview, 'flex-basis');\n    }\n  };\n\n  var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n    ancestor$2(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n      descendant$1(dialog, '[role=\"tablist\"]').each(function (tablist) {\n        maxTabHeight.get().map(function (height) {\n          set$2(tabview, 'height', '0');\n          set$2(tabview, 'flex-basis', '0');\n          return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n        }).each(function (height) {\n          setTabviewHeight(tabview, height);\n        });\n      });\n    });\n  };\n\n  var getTabview = function (dialog) {\n    return descendant$1(dialog, '[role=\"tabpanel\"]');\n  };\n\n  var setMode = function (allTabs) {\n    var smartTabHeight = function () {\n      var maxTabHeight = Cell(Optional.none());\n      var extraEvents = [runOnAttached(function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          set$2(tabview, 'visibility', 'hidden');\n          comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n            var heights = measureHeights(allTabs, tabview, tabviewComp);\n            var maxTabHeightOpt = getMaxHeight(heights);\n            maxTabHeight.set(maxTabHeightOpt);\n          });\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n          remove$6(tabview, 'visibility');\n          showTab(allTabs, comp);\n          global$2.requestAnimationFrame(function () {\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          });\n        });\n      }), run(windowResize(), function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n        });\n      }), run(formResizeEvent, function (comp, _se) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          var oldFocus = active();\n          set$2(tabview, 'visibility', 'hidden');\n          var oldHeight = getRaw(tabview, 'height').map(function (h) {\n            return parseInt(h, 10);\n          });\n          remove$6(tabview, 'height');\n          remove$6(tabview, 'flex-basis');\n          var newHeight = tabview.dom.getBoundingClientRect().height;\n          var hasGrown = oldHeight.forall(function (h) {\n            return newHeight > h;\n          });\n\n          if (hasGrown) {\n            maxTabHeight.set(Optional.from(newHeight));\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          } else {\n            oldHeight.each(function (h) {\n              setTabviewHeight(tabview, h);\n            });\n          }\n\n          remove$6(tabview, 'visibility');\n          oldFocus.each(focus$1);\n        });\n      })];\n      var selectFirst = false;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    var naiveTabHeight = function () {\n      var extraEvents = [];\n      var selectFirst = true;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    return {\n      smartTabHeight: smartTabHeight,\n      naiveTabHeight: naiveTabHeight\n    };\n  };\n\n  var SendDataToSectionChannel = 'send-data-to-section';\n  var SendDataToViewChannel = 'send-data-to-view';\n\n  var renderTabPanel = function (spec, backstage) {\n    var storedValue = Cell({});\n\n    var updateDataWithForm = function (form) {\n      var formData = Representing.getValue(form);\n      var validData = toValidValues(formData).getOr({});\n      var currentData = storedValue.get();\n      var newData = deepMerge(currentData, validData);\n      storedValue.set(newData);\n    };\n\n    var setDataOnForm = function (form) {\n      var tabData = storedValue.get();\n      Representing.setValue(form, tabData);\n    };\n\n    var oldTab = Cell(null);\n    var allTabs = map(spec.tabs, function (tab) {\n      return {\n        value: tab.name,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav-item'],\n          innerHtml: backstage.shared.providers.translate(tab.title)\n        },\n        view: function () {\n          return [Form.sketch(function (parts) {\n            return {\n              dom: {\n                tag: 'div',\n                classes: ['tox-form']\n              },\n              components: map(tab.items, function (item) {\n                return interpretInForm(parts, item, backstage);\n              }),\n              formBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                useTabstopAt: not(isPseudoStop)\n              }), config('TabView.form.events', [runOnAttached(setDataOnForm), runOnDetached(updateDataWithForm)]), Receiving.config({\n                channels: wrapAll$1([{\n                  key: SendDataToSectionChannel,\n                  value: {\n                    onReceive: updateDataWithForm\n                  }\n                }, {\n                  key: SendDataToViewChannel,\n                  value: {\n                    onReceive: setDataOnForm\n                  }\n                }])\n              })])\n            };\n          })];\n        }\n      };\n    });\n    var tabMode = setMode(allTabs).smartTabHeight;\n    return TabSection.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      onChangeTab: function (section, button, _viewItems) {\n        var name = Representing.getValue(button);\n        emitWith(section, formTabChangeEvent, {\n          name: name,\n          oldName: oldTab.get()\n        });\n        oldTab.set(name);\n      },\n      tabs: allTabs,\n      components: [TabSection.parts.tabbar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav']\n        },\n        components: [Tabbar.parts.tabs({})],\n        markers: {\n          tabClass: 'tox-tab',\n          selectedClass: 'tox-dialog__body-nav-item--active'\n        },\n        tabbarBehaviours: derive$1([Tabstopping.config({})])\n      }), TabSection.parts.tabview({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        }\n      })],\n      selectFirst: tabMode.selectFirst,\n      tabSectionBehaviours: derive$1([config('tabpanel', tabMode.extraEvents), Keying.config({\n        mode: 'acyclic'\n      }), Composing.config({\n        find: function (comp) {\n          return head(TabSection.getViewItems(comp));\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (tsection) {\n            tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n            return storedValue.get();\n          },\n          setValue: function (tsection, value) {\n            storedValue.set(value);\n            tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n          }\n        }\n      })])\n    });\n  };\n\n  var dialogChannel = generate$1('update-dialog');\n  var titleChannel = generate$1('update-title');\n  var bodyChannel = generate$1('update-body');\n  var footerChannel = generate$1('update-footer');\n  var bodySendMessageChannel = generate$1('body-send-message');\n\n  var renderBody = function (spec, id, backstage, ariaAttrs) {\n    var renderComponents = function (incoming) {\n      switch (incoming.body.type) {\n        case 'tabpanel':\n          {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n\n        default:\n          {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n      }\n    };\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some({\n        isTabPanel: function () {\n          return incoming.body.type === 'tabpanel';\n        }\n      });\n    };\n\n    var ariaAttributes = {\n      'aria-live': 'polite'\n    };\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js'],\n        attributes: __assign(__assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({})), ariaAttrs ? ariaAttributes : {})\n      },\n      components: [],\n      behaviours: derive$1([ComposingConfigs.childAt(0), Reflecting.config({\n        channel: bodyChannel,\n        updateState: updateState,\n        renderComponents: renderComponents,\n        initialData: spec\n      })])\n    };\n  };\n\n  var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n    return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n  };\n\n  var renderModalBody = function (spec, backstage) {\n    var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var renderIframeBody = function (spec) {\n    var bodySpec = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-iframe']\n        },\n        components: [craft({\n          dom: {\n            tag: 'iframe',\n            attributes: {\n              src: spec.url\n            }\n          },\n          behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n        })]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      })])\n    };\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var isTouch = global$8.deviceType.isTouch();\n\n  var hiddenHeader = function (title, close) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          display: 'none'\n        },\n        classes: ['tox-dialog__header']\n      },\n      components: [title, close]\n    };\n  };\n\n  var pClose = function (onClose, providersBackstage) {\n    return ModalDialog.parts.close(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close')\n        }\n      },\n      action: onClose,\n      buttonBehaviours: derive$1([Tabstopping.config({})])\n    }));\n  };\n\n  var pUntitled = function () {\n    return ModalDialog.parts.title({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        innerHtml: '',\n        styles: {\n          display: 'none'\n        }\n      }\n    });\n  };\n\n  var pBodyMessage = function (message, providersBackstage) {\n    return ModalDialog.parts.body({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [{\n          dom: fromHtml$2('<p>' + providersBackstage.translate(message) + '</p>')\n        }]\n      }]\n    });\n  };\n\n  var pFooter = function (buttons) {\n    return ModalDialog.parts.footer({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer']\n      },\n      components: buttons\n    });\n  };\n\n  var pFooterGroup = function (startButtons, endButtons) {\n    return [Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-start']\n      },\n      components: startButtons\n    }), Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-end']\n      },\n      components: endButtons\n    })];\n  };\n\n  var renderDialog = function (spec) {\n    var _a;\n\n    var dialogClass = 'tox-dialog';\n    var blockerClass = dialogClass + '-wrap';\n    var blockerBackdropClass = blockerClass + '__backdrop';\n    var scrollLockClass = dialogClass + '__disable-scroll';\n    return ModalDialog.sketch({\n      lazySink: spec.lazySink,\n      onEscape: function (comp) {\n        spec.onEscape(comp);\n        return Optional.some(true);\n      },\n      useTabstopAt: function (elem) {\n        return !isPseudoStop(elem);\n      },\n      dom: {\n        tag: 'div',\n        classes: [dialogClass].concat(spec.extraClasses),\n        styles: __assign({\n          position: 'relative'\n        }, spec.extraStyles)\n      },\n      components: __spreadArrays([spec.header, spec.body], spec.footer.toArray()),\n      parts: {\n        blocker: {\n          dom: fromHtml$2('<div class=\"' + blockerClass + '\"></div>'),\n          components: [{\n            dom: {\n              tag: 'div',\n              classes: isTouch ? [blockerBackdropClass, blockerBackdropClass + '--opaque'] : [blockerBackdropClass]\n            }\n          }]\n        }\n      },\n      dragBlockClass: blockerClass,\n      modalBehaviours: derive$1(__spreadArrays([Focusing.config({}), config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), config('scroll-lock', [runOnAttached(function () {\n        add$2(body(), scrollLockClass);\n      }), runOnDetached(function () {\n        remove$4(body(), scrollLockClass);\n      })])], spec.extraBehaviours)),\n      eventOrder: __assign((_a = {}, _a[execute()] = ['dialog-events'], _a[attachedToDom()] = ['scroll-lock', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'scroll-lock'], _a), spec.eventOrder)\n    });\n  };\n\n  var renderClose = function (providersBackstage) {\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close'),\n          'title': providersBackstage.translate('Close')\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon'],\n          innerHtml: get$d('close', providersBackstage.icons)\n        }\n      }],\n      action: function (comp) {\n        emit(comp, formCancelEvent);\n      }\n    });\n  };\n\n  var renderTitle = function (spec, id, providersBackstage) {\n    var renderComponents = function (data) {\n      return [text(providersBackstage.translate(data.title))];\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        attributes: __assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({}))\n      },\n      components: renderComponents(spec),\n      behaviours: derive$1([Reflecting.config({\n        channel: titleChannel,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderDragHandle = function () {\n    return {\n      dom: fromHtml$2('<div class=\"tox-dialog__draghandle\"></div>')\n    };\n  };\n\n  var renderInlineHeader = function (spec, titleId, providersBackstage) {\n    return Container.sketch({\n      dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n      components: [renderTitle(spec, Optional.some(titleId), providersBackstage), renderDragHandle(), renderClose(providersBackstage)],\n      containerBehaviours: derive$1([Dragging.config({\n        mode: 'mouse',\n        blockerClass: 'blocker',\n        getTarget: function (handle) {\n          return closest$3(handle, '[role=\"dialog\"]').getOrDie();\n        },\n        snaps: {\n          getSnapPoints: function () {\n            return [];\n          },\n          leftAttr: 'data-drag-left',\n          topAttr: 'data-drag-top'\n        }\n      })])\n    });\n  };\n\n  var renderModalHeader = function (spec, providersBackstage) {\n    var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n    var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n    var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n    var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n    return Container.sketch({\n      dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n      components: components\n    });\n  };\n\n  var getHeader = function (title, backstage) {\n    return renderModalHeader({\n      title: backstage.shared.providers.translate(title),\n      draggable: backstage.dialog.isDraggableModal()\n    }, backstage.shared.providers);\n  };\n\n  var getEventExtras = function (lazyDialog, extra) {\n    return {\n      onClose: function () {\n        return extra.closeWindow();\n      },\n      onBlock: function (blockEvent) {\n        ModalDialog.setBusy(lazyDialog(), function (d, bs) {\n          return {\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__busy-spinner'],\n              attributes: {\n                'aria-label': blockEvent.message\n              },\n              styles: {\n                left: '0px',\n                right: '0px',\n                bottom: '0px',\n                top: '0px',\n                position: 'absolute'\n              }\n            },\n            behaviours: bs,\n            components: [{\n              dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n            }]\n          };\n        });\n      },\n      onUnblock: function () {\n        ModalDialog.setIdle(lazyDialog());\n      }\n    };\n  };\n\n  var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n    var _a;\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    return build$1(renderDialog(__assign(__assign({}, spec), {\n      lazySink: backstage.shared.getSink,\n      extraBehaviours: __spreadArrays([Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: initialData\n      }), RepresentingConfigs.memory({})], spec.extraBehaviours),\n      onEscape: function (comp) {\n        emit(comp, formCancelEvent);\n      },\n      dialogEvents: dialogEvents,\n      eventOrder: (_a = {}, _a[receive()] = ['reflecting', 'receiving'], _a[attachedToDom()] = ['scroll-lock', 'reflecting', 'messages', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'messages', 'reflecting', 'scroll-lock'], _a)\n    })));\n  };\n\n  var mapMenuButtons = function (buttons) {\n    var mapItems = function (button) {\n      var items = map(button.items, function (item) {\n        var cell = Cell(false);\n        return __assign(__assign({}, item), {\n          storage: cell\n        });\n      });\n      return __assign(__assign({}, button), {\n        items: items\n      });\n    };\n\n    return map(buttons, function (button) {\n      if (button.type === 'menu') {\n        return mapItems(button);\n      }\n\n      return button;\n    });\n  };\n\n  var extractCellsToObject = function (buttons) {\n    return foldl(buttons, function (acc, button) {\n      if (button.type === 'menu') {\n        var menuButton = button;\n        return foldl(menuButton.items, function (innerAcc, item) {\n          innerAcc[item.name] = item.storage;\n          return innerAcc;\n        }, acc);\n      }\n\n      return acc;\n    }, {});\n  };\n\n  var initCommonEvents = function (fireApiEvent, extras) {\n    return [runWithTarget(focusin(), onFocus$1), fireApiEvent(formCloseEvent, function (_api, spec) {\n      extras.onClose();\n      spec.onClose();\n    }), fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n      spec.onCancel(api);\n      emit(self, formCloseEvent);\n    }), run(formUnblockEvent, function (_c, _se) {\n      return extras.onUnblock();\n    }), run(formBlockEvent, function (_c, se) {\n      return extras.onBlock(se.event);\n    })];\n  };\n\n  var initUrlDialog = function (getInstanceApi, extras) {\n    var fireApiEvent = function (eventName, f) {\n      return run(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialog) {\n        f(currentDialog, c);\n      });\n    };\n\n    return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formActionEvent, function (api, spec, event) {\n      spec.onAction(api, {\n        name: event.name\n      });\n    })]);\n  };\n\n  var initDialog = function (getInstanceApi, extras, getSink) {\n    var fireApiEvent = function (eventName, f) {\n      return run(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialogInit) {\n        f(currentDialogInit.internalDialog, c);\n      });\n    };\n\n    return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formSubmitEvent, function (api, spec) {\n      return spec.onSubmit(api);\n    }), fireApiEvent(formChangeEvent, function (api, spec, event) {\n      spec.onChange(api, {\n        name: event.name\n      });\n    }), fireApiEvent(formActionEvent, function (api, spec, event, component) {\n      var focusIn = function () {\n        return Keying.focusIn(component);\n      };\n\n      var isDisabled = function (focused) {\n        return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n          return val === 'true';\n        });\n      };\n\n      var rootNode = getRootNode(component.element);\n      var current = active(rootNode);\n      spec.onAction(api, {\n        name: event.name,\n        value: event.value\n      });\n      active(rootNode).fold(focusIn, function (focused) {\n        if (isDisabled(focused)) {\n          focusIn();\n        } else if (current.exists(function (cur) {\n          return contains$2(focused, cur) && isDisabled(cur);\n        })) {\n          focusIn();\n        } else {\n          getSink().toOptional().filter(function (sink) {\n            return !contains$2(sink.element, focused);\n          }).each(focusIn);\n        }\n      });\n    }), fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n      spec.onTabChange(api, {\n        newTabName: event.name,\n        oldTabName: event.oldName\n      });\n    }), runOnDetached(function (component) {\n      var api = getInstanceApi();\n      Representing.setValue(component, api.getData());\n    })]);\n  };\n\n  var SilverDialogEvents = {\n    initUrlDialog: initUrlDialog,\n    initDialog: initDialog\n  };\n\n  var makeButton = function (button, backstage) {\n    return renderFooterButton(button, button.type, backstage);\n  };\n\n  var lookup$2 = function (compInSystem, footerButtons, buttonName) {\n    return find(footerButtons, function (button) {\n      return button.name === buttonName;\n    }).bind(function (memButton) {\n      return memButton.memento.getOpt(compInSystem);\n    });\n  };\n\n  var renderComponents = function (_data, state) {\n    var footerButtons = state.map(function (s) {\n      return s.footerButtons;\n    }).getOr([]);\n    var buttonGroups = partition(footerButtons, function (button) {\n      return button.align === 'start';\n    });\n\n    var makeGroup = function (edge, buttons) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer-' + edge]\n        },\n        components: map(buttons, function (button) {\n          return button.memento.asSpec();\n        })\n      });\n    };\n\n    var startButtons = makeGroup('start', buttonGroups.pass);\n    var endButtons = makeGroup('end', buttonGroups.fail);\n    return [startButtons, endButtons];\n  };\n\n  var renderFooter = function (initSpec, backstage) {\n    var updateState = function (_comp, data) {\n      var footerButtons = map(data.buttons, function (button) {\n        var memButton = record(makeButton(button, backstage));\n        return {\n          name: button.name,\n          align: button.align,\n          memento: memButton\n        };\n      });\n\n      var lookupByName = function (compInSystem, buttonName) {\n        return lookup$2(compInSystem, footerButtons, buttonName);\n      };\n\n      return Optional.some({\n        lookupByName: lookupByName,\n        footerButtons: footerButtons\n      });\n    };\n\n    return {\n      dom: fromHtml$2('<div class=\"tox-dialog__footer\"></div>'),\n      components: [],\n      behaviours: derive$1([Reflecting.config({\n        channel: footerChannel,\n        initialData: initSpec,\n        updateState: updateState,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderInlineFooter = function (initSpec, backstage) {\n    return renderFooter(initSpec, backstage);\n  };\n\n  var renderModalFooter = function (initSpec, backstage) {\n    return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n  };\n\n  var getCompByName = function (access, name) {\n    var root = access.getRoot();\n\n    if (root.getSystem().isConnected()) {\n      var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n      return Form.getField(form_1, name).fold(function () {\n        var footer = access.getFooter();\n        var footerState = Reflecting.getState(footer);\n        return footerState.get().bind(function (f) {\n          return f.lookupByName(form_1, name);\n        });\n      }, function (comp) {\n        return Optional.some(comp);\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var validateData = function (access, data) {\n    var root = access.getRoot();\n    return Reflecting.getState(root).get().map(function (dialogState) {\n      return getOrDie(asRaw('data', dialogState.dataValidator, data));\n    }).getOr(data);\n  };\n\n  var getDialogApi = function (access, doRedial, menuItemStates) {\n    var withRoot = function (f) {\n      var root = access.getRoot();\n\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var getData = function () {\n      var root = access.getRoot();\n      var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n      var representedValues = Representing.getValue(valueComp);\n      var menuItemCurrentState = map$2(menuItemStates, function (cell) {\n        return cell.get();\n      });\n      return __assign(__assign({}, representedValues), menuItemCurrentState);\n    };\n\n    var setData = function (newData) {\n      withRoot(function (_) {\n        var prevData = instanceApi.getData();\n\n        var mergedData = __assign(__assign({}, prevData), newData);\n\n        var newInternalData = validateData(access, mergedData);\n        var form = access.getFormWrapper();\n        Representing.setValue(form, newInternalData);\n        each$1(menuItemStates, function (v, k) {\n          if (has(mergedData, k)) {\n            v.set(mergedData[k]);\n          }\n        });\n      });\n    };\n\n    var disable = function (name) {\n      getCompByName(access, name).each(Disabling.disable);\n    };\n\n    var enable = function (name) {\n      getCompByName(access, name).each(Disabling.enable);\n    };\n\n    var focus = function (name) {\n      getCompByName(access, name).each(Focusing.focus);\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var showTab = function (name) {\n      withRoot(function (_) {\n        var body = access.getBody();\n        var bodyState = Reflecting.getState(body);\n\n        if (bodyState.get().exists(function (b) {\n          return b.isTabPanel();\n        })) {\n          Composing.getCurrent(body).each(function (tabSection) {\n            TabSection.showTab(tabSection, name);\n          });\n        }\n      });\n    };\n\n    var redial = function (d) {\n      withRoot(function (root) {\n        var dialogInit = doRedial(d);\n        root.getSystem().broadcastOn([dialogChannel], dialogInit);\n        root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n        instanceApi.setData(dialogInit.initialData);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var instanceApi = {\n      getData: getData,\n      setData: setData,\n      disable: disable,\n      enable: enable,\n      focus: focus,\n      block: block,\n      unblock: unblock,\n      showTab: showTab,\n      redial: redial,\n      close: close\n    };\n    return instanceApi;\n  };\n\n  var renderDialog$1 = function (dialogInit, extra, backstage) {\n    var header = getHeader(dialogInit.internalDialog.title, backstage);\n    var body = renderModalBody({\n      body: dialogInit.internalDialog.body\n    }, backstage);\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var footer = renderModalFooter({\n      buttons: storagedMenuButtons\n    }, backstage);\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, extra), backstage.shared.getSink);\n    var dialogSize = dialogInit.internalDialog.size !== 'normal' ? dialogInit.internalDialog.size === 'large' ? ['tox-dialog--width-lg'] : ['tox-dialog--width-md'] : [];\n    var spec = {\n      header: header,\n      body: body,\n      footer: Optional.some(footer),\n      extraClasses: dialogSize,\n      extraBehaviours: [],\n      extraStyles: {}\n    };\n    var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n\n    var modalAccess = function () {\n      var getForm = function () {\n        var outerForm = ModalDialog.getBody(dialog);\n        return Composing.getCurrent(outerForm).getOr(outerForm);\n      };\n\n      return {\n        getRoot: function () {\n          return dialog;\n        },\n        getBody: function () {\n          return ModalDialog.getBody(dialog);\n        },\n        getFooter: function () {\n          return ModalDialog.getFooter(dialog);\n        },\n        getFormWrapper: getForm\n      };\n    }();\n\n    var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n    var _a, _b;\n\n    var dialogLabelId = generate$1('dialog-label');\n    var dialogContentId = generate$1('dialog-content');\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    var memHeader = record(renderInlineHeader({\n      title: dialogInit.internalDialog.title,\n      draggable: true\n    }, dialogLabelId, backstage.shared.providers));\n    var memBody = record(renderInlineBody({\n      body: dialogInit.internalDialog.body\n    }, dialogContentId, backstage, ariaAttrs));\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var memFooter = record(renderInlineFooter({\n      buttons: storagedMenuButtons\n    }, backstage));\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, {\n      onBlock: function () {},\n      onUnblock: function () {},\n      onClose: function () {\n        return extra.closeWindow();\n      }\n    }, backstage.shared.getSink);\n    var dialog = build$1({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog', 'tox-dialog-inline'],\n        attributes: (_a = {\n          role: 'dialog'\n        }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = '' + dialogContentId, _a)\n      },\n      eventOrder: (_b = {}, _b[receive()] = [Reflecting.name(), Receiving.name()], _b[execute()] = ['execute-on-form'], _b[attachedToDom()] = ['reflecting', 'execute-on-form'], _b),\n      behaviours: derive$1([Keying.config({\n        mode: 'cyclic',\n        onEscape: function (c) {\n          emit(c, formCloseEvent);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem) && (name(elem) !== 'button' || get$2(elem, 'disabled') !== 'disabled');\n        }\n      }), Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: dialogInit\n      }), Focusing.config({}), config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), RepresentingConfigs.memory({})]),\n      components: [memHeader.asSpec(), memBody.asSpec(), memFooter.asSpec()]\n    });\n    var instanceApi = getDialogApi({\n      getRoot: function () {\n        return dialog;\n      },\n      getFooter: function () {\n        return memFooter.get(dialog);\n      },\n      getBody: function () {\n        return memBody.get(dialog);\n      },\n      getFormWrapper: function () {\n        var body = memBody.get(dialog);\n        return Composing.getCurrent(body).getOr(body);\n      }\n    }, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var global$g = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n  var getUrlDialogApi = function (root) {\n    var withRoot = function (f) {\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var sendMessage = function (data) {\n      withRoot(function (root) {\n        root.getSystem().broadcastOn([bodySendMessageChannel], data);\n      });\n    };\n\n    return {\n      block: block,\n      unblock: unblock,\n      close: close,\n      sendMessage: sendMessage\n    };\n  };\n\n  var SUPPORTED_MESSAGE_ACTIONS = ['insertContent', 'setContent', 'execCommand', 'close', 'block', 'unblock'];\n\n  var isSupportedMessage = function (data) {\n    return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n  };\n\n  var isCustomMessage = function (data) {\n    return !isSupportedMessage(data) && isObject(data) && has(data, 'mceAction');\n  };\n\n  var handleMessage = function (editor, api, data) {\n    switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n\n      case 'close':\n        api.close();\n        break;\n\n      case 'block':\n        api.block(data.message);\n        break;\n\n      case 'unblock':\n        api.unblock();\n        break;\n    }\n  };\n\n  var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n    var _a;\n\n    var header = getHeader(internalDialog.title, backstage);\n    var body = renderIframeBody(internalDialog);\n    var footer = internalDialog.buttons.bind(function (buttons) {\n      if (buttons.length === 0) {\n        return Optional.none();\n      } else {\n        return Optional.some(renderModalFooter({\n          buttons: buttons\n        }, backstage));\n      }\n    });\n    var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, extra));\n\n    var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n      return {};\n    }, function (height) {\n      return {\n        'height': height + 'px',\n        'max-height': height + 'px'\n      };\n    })), internalDialog.width.fold(function () {\n      return {};\n    }, function (width) {\n      return {\n        'width': width + 'px',\n        'max-width': width + 'px'\n      };\n    }));\n\n    var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n    var iframeUri = new global$g(internalDialog.url, {\n      base_uri: new global$g(window.location.href)\n    });\n    var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n    var messageHandlerUnbinder = Cell(Optional.none());\n    var extraBehaviours = [config('messages', [runOnAttached(function () {\n      var unbind = bind$3(SugarElement.fromDom(window), 'message', function (e) {\n        if (iframeUri.isSameOrigin(new global$g(e.raw.origin))) {\n          var data = e.raw.data;\n\n          if (isSupportedMessage(data)) {\n            handleMessage(editor, instanceApi, data);\n          } else if (isCustomMessage(data)) {\n            internalDialog.onMessage(instanceApi, data);\n          }\n        }\n      });\n      messageHandlerUnbinder.set(Optional.some(unbind));\n    }), runOnDetached(function () {\n      messageHandlerUnbinder.get().each(function (unbinder) {\n        return unbinder.unbind();\n      });\n    })]), Receiving.config({\n      channels: (_a = {}, _a[bodySendMessageChannel] = {\n        onReceive: function (comp, data) {\n          descendant$1(comp.element, 'iframe').each(function (iframeEle) {\n            var iframeWin = iframeEle.dom.contentWindow;\n            iframeWin.postMessage(data, iframeDomain);\n          });\n        }\n      }, _a)\n    })];\n    var spec = {\n      header: header,\n      body: body,\n      footer: footer,\n      extraClasses: classes,\n      extraBehaviours: extraBehaviours,\n      extraStyles: styles\n    };\n    var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n    var instanceApi = getUrlDialogApi(dialog);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var setup$c = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function () {\n        ModalDialog.hide(alertDialog);\n        callback();\n      };\n\n      var memFooterClose = record(renderFooterButton({\n        name: 'close-alert',\n        text: 'OK',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage));\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n      var alertDialog = build$1(renderDialog({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n        onEscape: closeDialog,\n        extraClasses: ['tox-alert-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run(formCancelEvent, closeDialog)],\n        eventOrder: {}\n      }));\n      ModalDialog.show(alertDialog);\n      var footerCloseButton = memFooterClose.get(alertDialog);\n      Focusing.focus(footerCloseButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var setup$d = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function (state) {\n        ModalDialog.hide(confirmDialog);\n        callback(state);\n      };\n\n      var memFooterYes = record(renderFooterButton({\n        name: 'yes',\n        text: 'Yes',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'submit', extras.backstage));\n      var footerNo = renderFooterButton({\n        name: 'no',\n        text: 'No',\n        primary: false,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage);\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(function () {\n        return closeDialog(false);\n      }, sharedBackstage.providers);\n      var confirmDialog = build$1(renderDialog({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [footerNo, memFooterYes.asSpec()]))),\n        onEscape: function () {\n          return closeDialog(false);\n        },\n        extraClasses: ['tox-confirm-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run(formCancelEvent, function () {\n          return closeDialog(false);\n        }), run(formSubmitEvent, function () {\n          return closeDialog(true);\n        })],\n        eventOrder: {}\n      }));\n      ModalDialog.show(confirmDialog);\n      var footerYesButton = memFooterYes.get(confirmDialog);\n      Focusing.focus(footerYesButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var validateData$1 = function (data, validator) {\n    return getOrDie(asRaw('data', validator, data));\n  };\n\n  var isAlertOrConfirmDialog = function (target) {\n    return closest$4(target, '.tox-alert-dialog') || closest$4(target, '.tox-confirm-dialog');\n  };\n\n  var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n    if (isStickyToolbar && isToolbarLocationTop) {\n      return [];\n    } else {\n      return [Docking.config({\n        contextual: {\n          lazyContext: function () {\n            return Optional.some(box(SugarElement.fromDom(editor.getContentAreaContainer())));\n          },\n          fadeInClass: 'tox-dialog-dock-fadein',\n          fadeOutClass: 'tox-dialog-dock-fadeout',\n          transitionClass: 'tox-dialog-dock-transition'\n        },\n        modes: ['top']\n      })];\n    }\n  };\n\n  var setup$e = function (extras) {\n    var backstage = extras.backstage;\n    var editor = extras.editor;\n    var isStickyToolbar$1 = isStickyToolbar(editor);\n    var alertDialog = setup$c(extras);\n    var confirmDialog = setup$d(extras);\n\n    var open = function (config, params, closeWindow) {\n      if (params !== undefined && params.inline === 'toolbar') {\n        return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n      } else if (params !== undefined && params.inline === 'cursor') {\n        return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n      } else {\n        return openModalDialog(config, closeWindow);\n      }\n    };\n\n    var openUrl = function (config, closeWindow) {\n      return openModalUrlDialog(config, closeWindow);\n    };\n\n    var openModalUrlDialog = function (config, closeWindow) {\n      var factory = function (contents) {\n        var dialog = renderUrlDialog(contents, {\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, editor, backstage);\n        ModalDialog.show(dialog.dialog);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.openUrl(factory, config);\n    };\n\n    var openModalDialog = function (config, closeWindow) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = internalInitialData;\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n        var dialog = renderDialog$1(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, backstage);\n        ModalDialog.show(dialog.dialog);\n        dialog.instanceApi.setData(initialData);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.open(factory, config);\n    };\n\n    var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = validateData$1(internalInitialData, dataValidator);\n        var inlineDialog = value$3();\n        var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n\n        var refreshDocking = function () {\n          return inlineDialog.on(function (dialog) {\n            InlineView.reposition(dialog);\n            Docking.refresh(dialog);\n          });\n        };\n\n        var dialogUi = renderInlineDialog(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            inlineDialog.on(InlineView.hide);\n            editor.off('ResizeEditor', refreshDocking);\n            inlineDialog.clear();\n            closeWindow(dialogUi.instanceApi);\n          }\n        }, backstage, ariaAttrs);\n        var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n          lazySink: backstage.shared.getSink,\n          dom: {\n            tag: 'div',\n            classes: []\n          },\n          fireDismissalEventInstead: {}\n        }, isToolbarLocationTop ? {} : {\n          fireRepositionEventInstead: {}\n        }), {\n          inlineBehaviours: derive$1(__spreadArrays([config('window-manager-inline-events', [run(dismissRequested(), function (_comp, _se) {\n            emit(dialogUi.dialog, formCancelEvent);\n          })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop))),\n          isExtraPart: function (_comp, target) {\n            return isAlertOrConfirmDialog(target);\n          }\n        })));\n        inlineDialog.set(inlineDialogComp);\n        InlineView.showWithin(inlineDialogComp, anchor, premade$1(dialogUi.dialog), Optional.some(body()));\n\n        if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n          Docking.refresh(inlineDialogComp);\n          editor.on('ResizeEditor', refreshDocking);\n        }\n\n        dialogUi.instanceApi.setData(initialData);\n        Keying.focusIn(dialogUi.dialog);\n        return dialogUi.instanceApi;\n      };\n\n      return DialogManager.open(factory, config$1);\n    };\n\n    var confirm = function (message, callback) {\n      confirmDialog.open(message, function (state) {\n        callback(state);\n      });\n    };\n\n    var alert = function (message, callback) {\n      alertDialog.open(message, function () {\n        callback();\n      });\n    };\n\n    var close = function (instanceApi) {\n      instanceApi.close();\n    };\n\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      close: close,\n      confirm: confirm\n    };\n  };\n\n  function Theme() {\n    global$1.add('silver', function (editor) {\n      var _a = setup$b(editor),\n          uiMothership = _a.uiMothership,\n          backstage = _a.backstage,\n          renderUI = _a.renderUI,\n          getUi = _a.getUi;\n\n      Autocompleter.register(editor, backstage.shared);\n      var windowMgr = setup$e({\n        editor: editor,\n        backstage: backstage\n      });\n      return {\n        renderUI: renderUI,\n        getWindowManagerImpl: constant(windowMgr),\n        getNotificationManagerImpl: function () {\n          return NotificationManagerImpl(editor, {\n            backstage: backstage\n          }, uiMothership);\n        },\n        ui: getUi()\n      };\n    });\n  }\n\n  Theme();\n})();","map":{"version":3,"sources":["/home/dani/Escritorio/Projects/blog-react/frontend-blog/node_modules/tinymce/themes/silver/theme.js"],"names":["noop","noarg","f","compose","fa","fb","args","_i","arguments","length","apply","compose1","fbc","fab","a","constant","value","identity","x","curry","fn","initialArgs","restArgs","all","concat","not","t","die","msg","Error","never","always","global$1","tinymce","util","Tools","resolve","__assign","Object","assign","s","i","n","p","prototype","hasOwnProperty","call","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","Array","k","j","jl","none","NONE","eq","o","isNone","thunk","id","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","v","elementEq","b","from","Optional","typeOf","isPrototypeOf","constructor","name","String","isType","type","isSimpleType","isString","isObject","isArray","isBoolean","isUndefined","isNullable","isNonNullable","isFunction","isNumber","isArrayOf","pred","len","nativeSlice","slice","nativeIndexOf","nativePush","push","rawIndexOf","ts","xs","contains","range","num","chunk","array","size","eachr","partition","pass","fail","arr","foldr","acc","foldl","findUntil","until","find","findIndex","flatten","reverse","difference","a1","a2","mapToObject","sort","comparator","copy","head","last","from$1","findMap","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","error","message","opt","onError","fromOption","err","Result","SimpleResultType","res","stype","serror","svalue","partition$1","results","values","errors","obj","val","map$1","Value","bind$1","bindError","toResult","fromResult","SimpleResult","keys","each$1","props","map$2","tupleMap","tuple","objAcc","internalFilter","onTrue","onFalse","filter$1","mapToArray","find$1","get","key","has","hasNonNullableKey","generate","cases","constructors","adt","acase","count","keys$1","argLength","match","branches","branchKeys","join","allReqd","reqKey","target","log","label","console","params","Adt","hasOwnProperty$1","shallow","old","nu","deep","bothObjects","deepMerge","baseMerge","merger","objects","ret","curObject","merge","cached","called","strict","defaultedThunk","asOption","asDefaultedOptionThunk","mergeWithThunk","defaulted","fallback","mergeWith","base","comparison","bothErrors","firstError","secondError","bothValues","partition$2","result","exclude","fields","wrap","_a","wrapAll","keyvalues","kv","exclude$1","wrap$1","wrapAll$1","mergeValues","mergeErrors","consolidate","objs","partitions","mergeValues$1","mergeErrors$1","consolidateObj","consolidateArr","ResultCombine","formatObj","input","JSON","stringify","formatErrors","es","path","getErrorInfo","missingStrict","missingKey","missingBranch","branch","unsupportedFields","unsupported","custom","adt$1","field","state","strictAccess","fallbackAccess","fallbackThunk","optionAccess","optionDefaultedAccess","cExtractOne","strength","okey","presence","prop","bundle","av","extract","bundleAsOption","optValue","outcome","ov","baseThunk","instantiator","cExtract","valueThunk","getDelegate","value$1","validator","getSetKeys","objOfOnly","delegate","objOf","fieldNames","extra","fieldStrings","_instantiator","arrOf","oneOf","props_1","setOf","validateKeys","validatedKeys","validKeys","schema","vk","desc","processor","getP","anyValue","arrOfObj","chooseFrom","ch","vp","choose","choice","chosen","_anyValue","arrOfObj$1","objFields","arrOfVal","valueThunkOf","valueOf","setOf$1","errs","asRaw","extraction","errInfo","formatError","asRawOrDie","chooseProcessor","choose$1","thunkOf","anyValue$1","typedValue","expectedType","actualType","number","string","boolean","functionProcessor","isPostMessageable","every","iter","callbackFn","next","done","postMessageable","validateEnum","strict$1","strictOf","strictNumber","strictString","strictStringEnum","strictBoolean","strictFunction","forbid","_v","strictObjOf","objSchema","strictArrayOfObj","strictArrayOf","option","optionOf","optionNumber","optionString","optionFunction","optionArrayOf","optionObjOf","optionObjOfOnly","defaulted$1","defaultedOf","defaultedNumber","defaultedString","defaultedStringEnum","defaultedBoolean","defaultedFunction","defaultedPostMsg","defaultedArrayOf","defaultedObjOf","state$1","Cell","initial","set","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","y","elementFromPoint","SugarElement","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$2","agent","major","minor","group","Number","replace","nu$1","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","detect$1","candidates","candidate","search","detectBrowser","browsers","version","current","detectOs","oses","UaString","checkRange","str","substr","start","contains$1","endsWith","suffix","blank","trim","normalVersionRegex","checkContains","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$2","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$2","nu$3","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","compareDocumentPosition","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","querySelectorAll","one","querySelector","eq$1","e1","e2","regularContains","d1","d2","ieContains","contains$2","ensureIsRoot","isRoot","ancestor","transform","stop","parentNode","el","transformed","closest","isSource","component","simulatedEvent","event","nu$4","parts","all$1","handlers","handler","any","read","can","abort","run","fuse","constant$1","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseout","mouseup","mouseover","focusin","focusout","keydown","keyup","change","click","transitionend","selectstart","prefixName","alloy","tap","focus","postBlur","postPaste","receive","execute","focusItem","longpress","sandboxClose","typeaheadCancel","systemInit","documentTouchmove","documentTouchend","windowScroll","windowResize","attachedToDom","detachedFromDom","dismissRequested","repositionRequested","focusShifted","slotVisibility","changeTab","dismissTab","highlight","dehighlight","emit","dispatchWith","emitWith","properties","emitExecute","dispatch","data","getSystem","triggerEvent","dispatchEvent","derive","configs","predicate","preventDefault","prevent","runActionExtra","action","runOnName","runOnSourceName","redirectToUid","uid","getByUid","redirectee","redirectToPart","detail","partName","partUids","runWithTarget","ev","getByDom","closest$1","c","cutter","cut","stopper","runOnSource","runOnAttached","runOnDetached","runOnInit","runOnExecute","Global","Function","nodeName","isType$1","isElement","isText","isDocument","isDocumentFragment","owner","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parent","offsetParent","nextSibling","children","child","index","cs","firstChild","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","appendAt","before$1","elements","append$1","empty","textContent","rogue","remove","removeChild","unwrap","wrapper","children$1","fromHtml$1","get$1","content","owner$1","docDom","fragment","createDocumentFragment","contentElements","getOuter","container","clone","cloneNode","rawSet","setAttribute","set$1","setAll","attrs","get$2","getAttribute","getOpt","has$1","hasAttribute","remove$1","removeAttribute","original","isDeep","shallow$1","getHtml","isRecursive","originator","events","warn","DefaultEvents","freeze","__proto__","unique","generate$1","prefix","date","Date","time","getTime","random","Math","floor","idAttr","prefix$1","idAttr$1","write","writeOnly","defineProperty","writable","read$1","generate$2","make","NoContextApi","getComp","debugInfo","triggerFocus","triggerEscape","build","addToWorld","removeFromWorld","addToGui","removeFromGui","broadcast","broadcastOn","broadcastEvent","isConnected","singleton","markAsBehaviourApi","apiName","apiFunction","endIndex","openBracketIndex","parameters","substring","split","toFunctionAnnotation","cleanParameters","markAsExtraApi","extraName","markAsSketchApi","premadeTag","premade","comp","getPremade","spec","makeApi","rest","getApis","NoState","init","nu$5","readState","generateFrom","validated","behaviours","list","optBlobThunk","output","blob","config","getBehaviours","bData","getData","byInnerKey","indexKey","chain","nu$6","classes","attributes","styles","merge$1","defnA","mod","combine","baseMod","modsByBehaviour","behaviour","exhibit","byAspect","modification","combineObjects","combinedClasses","combinedAttributes","combinedStyles","sortKeys","keyName","order","sorted","aKey","bKey","aIndex","bIndex","uncurried","purpose","curried","cHandler","curryArgs","descHandler","extraArgs","getCurried","behaviourTuple","nameToHandlers","groupByEvents","behaviourEvents","combine$1","eventOrder","byEventName","combineGroups","assemble","rawHandler","missingOrderError","eventName","tuples","fuse$1","sortedTuples","combined","assembled","baseBehaviour","toInfo","toDefinition","domChildren","components","toModification","domModification","toEvents","read$2","attr","add","remove$2","supports","classList","get$3","add$1","clazz","remove$3","add$2","cleanClass","remove$4","has$2","add$3","remove$5","isSupported","style","getPropertyValue","isShadowRoot","supported","Element","attachShadow","getRootNode","isSupported$1","getContentContainer","body","getShadowRoot","getShadowHost","host","getOriginalEventTarget","isOpenShadowHost","composed","composedPath","shadowRoot","inBody","getBody","internalSet","property","setProperty","internalRemove","removeProperty","set$2","setAll$1","css","setOptions","get$4","getComputedStyle","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","item","isValidValue","remove$6","reflow","offsetWidth","get$5","set$3","renderToDom","definition","subject","innerHtml","getBehaviours$1","generateFrom$1","generate$3","getDomDefinition","bList","infoModification","baseModification","getEvents","baseEvents","getMe","systemApi","bBlob","modDefinition","subcomponents","connect","newApi","disconnect","syncComponents","subs","hasConfigured","apis","behaviourName","buildSubcomponents","build$1","buildFromSpec","userSpec","specEvents","completeSpec","external","extSpec","uids","userSpecWithUid","prebuilt","premade$1","Dimension","getOffset","h","parseFloat","aggregate","parseInt","isNaN","max","cumulativeInclusions","absoluteMax","api","getBoundingClientRect","height","offsetHeight","get$6","getOuter$1","setMax","inclusions","absMax","left","top","translate","SugarPosition","boxPosition","box","firstDefinedOrZero","absolute","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","api$1","set$4","get$7","getOuter$2","setMax$1","mkEvent","kill","fromRawEvent","rawEvent","stopPropagation","clientX","clientY","handle","binder","useCapture","wrapped","addEventListener","unbind","bind$2","capture","removeEventListener","get$8","_DOC","to","scrollTo","get$9","_win","bounds","width","right","bottom","getBounds","scroll","clientWidth","clientHeight","visualViewport","pageLeft","pageTop","walkUp","navigation","frame","view","pathTo","d","paths","frameElement","Navigation","find$3","frames","offset","loc","pointed","point","rect","bounds$1","xy","w","absolute$1","position","ClosestOrAncestor","ancestor$1","descendant","descend","child_1","closest$2","ancestor$2","descendant$1","closest$3","is$1","find$4","queryElem","dependent","dep","manager","ariaId","link","unlink","isAriaPartOf","isPartOf","unknown$3","EventConfiguration","eventConfig","makeEventLogger","initialTarget","sequence","startTime","logEventCut","_name","logEventStopped","logNoParent","logEventNoHandlers","logEventResponse","finishTime","processEvent","status","patterns","NORMAL","noLogger","LOGGING","logger","STOP","getTrace","stack","lines","line","ignoreEvent","monitorEvent","menuFields","itemFields","itemSchema","_initSize","itemMarkers","tieredMenuMarkers","markers","required","onPresenceHandler","fieldName","trace","onHandler","onKeyboardHandler","onStrictHandler","onStrictKeyboardHandler","snapshot","initSize","nu$7","bubble","direction","boundsRestriction","adt$2","southeast","southwest","northeast","northwest","south","north","east","west","cata","cataVertical","middle","cataHorizontal","getRestriction","anchor","restriction","restrictions","dir","adjustBounds","boundsRestrictions","bubbleOffsets","applyRestriction","bubbleOffset","adjustedLeft","adjustedTop","adjustedRight","adjustedBottom","eastX","middleX","westX","northY","southY","centreY","eastEdgeX","westEdgeX","southeast$1","bubbles","southwest$1","northeast$1","northwest$1","north$1","south$1","east$1","west$1","all$2","allRtl","aboveOrBelow","aboveOrBelowRtl","belowOrAbove","belowOrAboveRtl","chooseChannels","channels","universal","events$1","receiveConfig","channelMap","receivingData","targetChannels","channelInfo","channelSchema","onReceive","ActiveReceiving","ReceivingSchema","executeEvent","bConfig","bState","executor","loadEvent","_simulatedEvent","create","active","configSchema","schemaSchema","doCreate","createModes","modes","wrapApi","bName","revokeBehaviour","getConfig","wrappedApis","apiF","wrappedExtra","extraF","revoke","prepared","configAsRaw","initialConfig","behaviourInfo","exhibitor","derive$1","capabilities","simpleSchema","create$1","modeSchema","createModes$1","branchKey","Receiving","posConfig","useFixed","ActivePosition","getDocument","focus$1","blur","hasFocus","root","activeElement","preserve","refocus","focused","oldFocus","newFocus","NuPositionCss","applyPositionCss","addPx","adt$3","relative","fixed","positionWithDirection","posName","decision","decisionX","decisionY","decisionWidth","decisionHeight","decisionRight","decisionBottom","reposition","origin","toBox","rel","viewport$1","pos","removeScroll","outerScroll","cata$1","onNone","onRelative","onFixed","none$1","anchorBox","box$1","cycleBy","delta","min","clamp","adt$4","fit","nofit","calcReposition","newX","newY","boundsX","boundsY","boundsWidth","boundsHeight","xInBounds","yInBounds","originInBounds","xFit","yFit","sizeInBounds","deltaW","abs","deltaH","maxX","maxY","limitX","limitY","attempt","candidateX","candidateY","bubbleLeft","bubbleTop","adjustedBounds","boundsBottom","boundsRight","upAvailable","downAvailable","maxHeight","westAvailable","eastAvailable","maxWidth","on","classesOn","off","classesOff","candidateYforTest","attempts","elementBox","panelWidth","panelHeight","attemptBestFit","layout","attemptLayout","newReposition","newDeltaW","newDeltaH","improved","abc","bestNext","elementSize","options","preference","setClasses","classInfo","setHeight","maxHeightFunction","setWidth","maxWidthFunction","setMaxHeight","anchored","available","expandable","defaultOr","dephault","simple","layouts","overrideOptions","go","allAlignments","nu$8","yoffset","getClasses","xDelta","yDelta","alignmentsOn","alignmentsOff","innerNorthwest","innerNortheast","innerNorth","innerSouthwest","innerSoutheast","innerSouth","innerWest","innerEast","nu$9","onDirection","isLtr","isRtl","getDirection","AttributeValue","Attribute","isBottomToTopDir","BottomToTop","schema$1","get$a","defaultLtr","defaultRtl","defaultBottomLtr","defaultBottomRtl","dirElement","isBottomToTop","customLtr","ls","onLtr","customRtl","onRtl","ltr","onBottomLtr","rtl","onBottomRtl","placement","anchorInfo","hotspot","overrides","placer","HotspotAnchor","placement$1","MakeshiftAnchor","zeroWidth","nbsp","create$2","soffset","finish","foffset","SimRange","adt$5","cata$2","onBefore","onOn","onAfter","getStart","situ","before$2","after$1","Situ","adt$6","domRange","exact","exactFromRange","simRange","getStart$1","selection","rng","startContainer","startSitu","_finishSitu","_soffset","_finish","_foffset","relative$1","getWin","range$1","SimSelection","setStart","setStartBefore","setStartAfter","setFinish","setEndBefore","setEnd","setEndAfter","relativeToNative","finishSitu","createRange","exactToNative","toRect","getFirstRect","rects","getClientRects","adt$7","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","NodeValue","getOption","nodeValue","api$2","get$b","getEnd","isTextNodeWithCursorPosition","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","last$1","descendantRtl","descendants","makeRange","after$2","same","getNativeSelection","getSelection","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchorNode","focusNode","focus_1","anchorOffset","focusOffset","getExact","sel","getFirstRect$1","descendOnce","adt$8","screen","toFixed","toAbsolute","sum","points","sumAsFixed","positions","sumAsAbsolute","absolute$2","hasSameOwner","frameOwner","compOwner","getRootPoint","capRect","newLeft","newTop","newWidth","newHeight","calcNewAnchor","optBox","rootPoint","topLeft","layoutsLtr","showAbove","layoutsRtl","point$1","descendOnce$1","getAnchorSelection","modStart","modFinish","placement$2","selectionBox","optRect","rawRect","targetElement","SelectionAnchor","placement$3","nodeBox","NodeAnchor","eastX$1","westX$1","northY$1","southY$1","southeast$2","southwest$2","northeast$2","northwest$2","all$3","allRtl$1","placement$4","submenuInfo","SubmenuAnchor","AnchorSchema","submenu","makeshift","getFixedOrigin","getRelativeOrigin","place","anchoring","placee","position$1","posState","positionWithin","boxElement","boundsBox","positionWithinBounds","anchorage","oldVisibility","doPlace","vis","getMode","pConfig","_pState","PositionApis","PositionSchema","Positioning","fireDetaching","fireAttaching","attach","detachChildren","childComp","replaceChildren","newChildren","deleted","attach$1","attachWith","insertion","doDetach","detach","detachChildren$1","attachSystem","guiSystem","attachSystemWith","attachSystemAfter","inserter","detachSystem","rebuild","sandbox","sConfig","sState","_data","getAttachPoint","built","open","newState","onOpen","setContent","openWhileCloaked","transaction","cloak","decloak","close","onClose","clear","isOpen","_sandbox","_sConfig","isPartOf$1","getState","store","cssKey","newValue","restore","oldValue","_sState","sink","cloakVisibilityAttr","hasPosition","SandboxApis","events$2","sandboxConfig","sandboxState","ActiveSandbox","SandboxSchema","contents","SandboxState","Sandboxing","dismissPopups","repositionPopups","mouseReleased","schema$2","receivingChannel","rawSpec","isPart","isExtraPart","fireEventInstead","fe","schema$3","receivingChannel$1","doReposition","onLoad","repConfig","repState","onUnload","setValue","getValue","getState$1","RepresentApis","events$3","resetOnDom","_se","ActiveRepresenting","memory","mode","isNotSet","manual","dataset","dataByValue","dataByText","lookup","itemString","update","items","currentDataByValue","currentDataByText","newDataByValue","newDataByText","meta","init$1","RepresentState","setValue$1","onSetValue","getValue$1","getDataKey","getFallbackEntry","onLoad$1","initialValue","onUnload$1","DatasetStore","getValue$2","_repState","setValue$2","onLoad$2","ManualStore","setValue$3","getValue$3","onLoad$3","initVal","onUnload$2","MemoryStore","RepresentSchema","Representing","setValueFrom","source","field$1","forbidden","get$c","dump","augment","SketchBehaviours","_placeholder","adt$9","single","multiple","isSubstituted","subPlaceholder","compSpec","placeholders","newSpec","scan","uiType","substitute","req","childSpecs","substituted","valuesThunk","preprocessor","preprocess","substituteAll","oneReplace","replacements","used","substitutePlaces","ps","ph","placeholder","adt$a","optional","fFactory","sketch","fSchema","fName","fPname","typeSpec","fGroupSchema","fDefaults","fOverrides","requiredSpec","externalSpec","optionalSpec","groupSpec","asNamedPart","part","name$1","asCommon","convert","adtConstructor","partSchema","external$1","PartType","combine$2","partSpec","partValidated","defaults","internals","externals","pname","factory","_partSpec","_partValidated","units","u","generate$4","np","g","doGenerateOne","generateOne","schemas","names","substitutes","getPart","partKey","getPartOrDie","getParts","partKeys","system","pk","getAllParts","pUid","_k","getAllPartNames","getPartsOrDie","defaultUids","baseUid","partTypes","partNames","pn","defaultUidsSchema","AlloyParts","partSchemas","partUidsSchemas","asRawOrDie$1","baseS","single$1","specWithUid","supplyUid","composite","partUidsSchema","components$1","hasUid","isSketchSpec","singleSchema","compositeSchema","single$2","rawConfig","configFields","extraApis","composite$1","partFields","cat","lift2","oa","ob","lift3","oc","mapFrom","someIf","inside","getCurrent","composeConfig","_composeState","ComposeApis","ComposeSchema","Composing","dehighlightAllExcept","hConfig","hState","skip","highlighted","highlightClass","skipComp","onDehighlight","dehighlightAll","dehighlight$1","isHighlighted","highlight$1","onHighlight","highlightFirst","getFirst","firstComp","highlightLast","getLast","lastComp","highlightAt","getByIndex","highlightBy","getCandidates","targetComp","queryTarget","getHighlighted","_hState","itemClass","getDelta","selected","dest","getPrevious","getNext","HighlightApis","HighlightSchema","Highlighting","BACKSPACE","TAB","ENTER","ESCAPE","SPACE","LEFT","UP","RIGHT","DOWN","cyclePrev","tryPrev","cycleNext","tryNext","inSet","which","and","preds","isShift","shiftKey","isControl","ctrlKey","isNotShift","rule","classification","choose$2","transitions","transition","reportFocusShifting","prevFocus","noChange","focusee","highlights","FocusInsideModes","typical","infoSchema","stateInit","getKeydownRules","getKeyupRules","optFocusIn","processKey","getRules","keyingConfig","keyingState","rules","onFocusHandler","focusInside","OnFocusMode","focusIn","tryGoInsideComponent","isEnterOrSpace","OnEnterOrSpaceMode","keyboardEvents","create$3","cyclicField","isVisible","tabbingConfig","visibilitySelector","findInitial","tabstops","visibles","firstTabstop","findCurrent","focusManager","isTabstop","useTabstopAt","_tabbingState","goFromTabstop","stopIndex","cycle","cyclic","tabstop","optStopIndex","goBackwards","navigate","goForwards","onEnter","exit","onEscape","AcyclicType","CyclicType","doDefaultExecute","defaultExecute","isComplex","stopEventForFirefox","_component","schema$4","execute$1","executeConfig","_executeState","spaceExec","useSpace","enterExec","useEnter","downExec","useDown","execKeys","useControlEnter","ExecutionType","flatgrid","dimensions","setGridSize","numRows","numColumns","getNumRows","getNumColumns","init$2","KeyingState","useH","movement","move","use","west$2","moveLeft","moveRight","east$2","useV","north$2","south$2","isHidden","locate","locateVisible","visible","findIndex$1","withGrid","numCols","oldRow","oldColumn","address","newIndex","row","column","cycleHorizontal","onLastRow","colsInRow","newColumn","cycleVertical","newRow","newCol","cycleRight","cycleLeft","cycleUp","cycleDown","schema$5","gridConfig","_gridState","first","execute$2","doMove","gridState","identified","handleTab","captureTab","doEscape","moveNorth","moveSouth","getKeydownRules$1","getKeyupRules$1","FlatgridType","horizontal","isDisabledButton","tryCycle","schema$6","findCurrent$1","flowConfig","execute$3","focusIn$1","_state","getInitial","moveLeft$1","moveRight$1","doMove$1","flowState","executeOnMove","doEscape$1","getKeydownRules$2","_flowState","westMovers","allowVertical","eastMovers","getKeyupRules$2","FlowType","toCell","matrix","rowIndex","columnIndex","cell","cycleHorizontal$1","startCol","deltaCol","newColIndex","cycleVertical$1","colIndex","startRow","deltaRow","nextRowIndex","colsInNextRow","nextColIndex","moveHorizontal","moveVertical","cycleRight$1","cycleLeft$1","cycleUp$1","cycleDown$1","moveLeft$2","moveRight$2","moveUp","moveDown","schema$7","focusIn$2","matrixConfig","previousSelector","selectors","execute$4","toMatrix","rows","doMove$2","ifCycle","ifMove","cycles","inRow","cellsInRow","allRows","moveLeft$3","moveRight$3","moveNorth$1","moveSouth$1","getKeydownRules$3","getKeyupRules$3","MatrixType","schema$8","execute$5","menuConfig","focusIn$3","moveUp$1","moveDown$1","fireShiftTab","menuState","moveOnTab","fireTab","getKeydownRules$4","getKeyupRules$4","MenuType","schema$9","getKeydownRules$5","specialInfo","onSpace","onShiftEnter","onShiftTab","onTab","onUp","onDown","onLeft","onRight","getKeyupRules$5","stopSpaceKeyup","SpecialType","acyclic","flow","flatgrid$1","execution","menu","special","KeyboardBranches","isFlatgridState","keyState","Keying","keyConfig","sendFocusIn","set$5","replaceConfig","replaceState","insert","childSpec","append$2","appendee","prepend$1","prependee","remove$7","removee","foundChild","_replaceConfig","replaceAt","replaceeIndex","replacer","replacee","replaceBy","replaceePred","ReplaceApis","Replacing","events$4","eventHandlers","focus$2","focusConfig","ignore","onFocus","blur$1","isFocused","FocusApis","exhibit$1","tabindex","events$5","stopMousedown","ActiveFocus","FocusSchema","Focusing","SetupBehaviourCellState","initialState","updateAriaState","toggleConfig","toggleState","ariaInfo","aria","updateClass","toggleClass","toggle","set$6","on$1","isOn","onLoad$4","ToggleApis","exhibit$2","events$6","load","toggleOnExecute","ActiveToggle","updatePressed","syncWithExpanded","updateExpanded","updateSelected","updateChecked","ToggleSchema","pressed","checked","expanded","Toggling","pointerEvents","onClick","events$7","optAction","executeHandler","hoverEvent","focusEvent","onHover","hover","focus$3","builder","toggling","hasSubmenu","itemBehaviours","tConfig","ignoreFocus","schema$a","builder$1","schema$b","owner$2","builder$2","focusWidget","widget","onHorizontalArrow","autofocus","setSource","_widget","widgetBehaviours","schema$c","itemSchema$1","separator","configureGrid","movementInfo","configureMatrix","rowSelector","configureMenu","parts$1","itemInfo","unit","fakeFocus","schema$d","grid","focus$4","make$1","_spec","_externals","menuBehaviours","selectedItem","role","Menu","transpose","byItem","byMenu","triggerItem","triggerMenu","generate$5","menus","expansions","menuItems","menuPaths","_triggerItem","init$3","primary","directory","isClear","setMenuBuilt","menuName","setContents","sPrimary","sMenus","sExpansions","sPaths","getTriggeringItem","menuValue","getTriggerData","getItemByValue","getPreparedMenu","triggeringItemValue","triggeredItem","triggeredMenu","triggeringItem","triggeringPath","getTriggeringPath","itemValue","extraPath","lookupItem","revPath","triggers","menuIndex","expand","collapse","refresh","lookupMenu","extractPreparedMenu","otherMenus","menuValues","getPrimary","getMenus","prep","LayeredState","make$2","_rawUiSpec","submenuParentItems","buildMenus","primaryName","makeSketch","nbMenu","layeredState","setup","componentMap","toDirectory","getItemValue","_container","_menuName","setActiveMenu","mv","closeOthers","others","backgroundMenu","stayInDom","getSubmenuParents","parentItems","itemComp","updateAriaExpansions","updateMenuPath","latestMenuName","menuPrep","activeMenu","ExpandHighlightDecision","buildIfRequired","expandRight","HighlightSubmenu","activeMenuPrep","onOpenSubmenu","collapseLeft","onCollapseMenu","updateView","keyOnItem","getSource","onExecute","onOpenMenu","highlightImmediately","navigateOnHover","HighlightParent","getActiveItem","collapseMenuApi","currentItem","highlightPrimary","extractMenuFromContainer","repositionMenus","maybeActivePrimary","allMenus","preparedMenus","primaryMenu","onRepositionMenu","collapseMenu","tmenuBehaviours","_keyInfo","selectedMenu","collapseItem","tieredData","singleData","collapseItem$1","tieredMenu","tmenu","makeMenu","menuSandbox","menuSpec","lazySink","isFirstTierSubmenu","triggeringPaths","getSubmenuLayouts","submenuTriggers","st","submenuLayouts","isPartOfRelated","related","getRelated","thing","showAt","showWithin","showWithinBounds","showMenuAt","showMenuWithinBounds","hide","getContent","inlineBehaviours","onShow","onHide","fireDismissalEventInstead","fireRepositionEventInstead","InlineView","westEdgeX$1","middleX$1","eastEdgeX$1","northY$2","southY$2","southeast$3","southwest$3","northeast$3","northwest$3","north$3","south$3","global$2","factory$1","lookupAttr","getModAttributes","roleAttrs","buttonBehaviours","Button","record","anyInSystem","asSpec","defaultIcon","icons","get$d","getFirst$1","notificationIconMap","success","warning","factory$2","memBannerText","translationProvider","renderPercentBar","percent","renderPercentText","memBannerProgress","progress","updateProgress","updateText","text$1","banner","iconChoices","icon","level","memButton","iconProvider","onAction","closeButton","Notification","NotificationManagerImpl","editor","extras","uiMothership","backstage","getLayoutDirection","prePositionNotifications","notifications","notification","moveTo","positionNotifications","firstItem","moveRel","getEl","settings","closeCallback","hideCloseButton","timeout","notificationWrapper","progressBar","shared","providers","getSink","header","isPositionedAtTop","setTimeout","layoutDirection_1","nodeAnchor","anchors","nuText","getArgs","rate","timer","cancel","clearTimeout","throttle","last$2","global$3","isBoundary","isBlock","getContentEditable","repeatLeft","process","rootNode","backwards","autocompleteSelector","create$4","detect$4","getNode","getDoc","extractContents","insertNode","elm","normalize","setCursorLocation","isValidTextRange","getText","isWhitespace","chr","stripTriggerChar","triggerCh","findChar","char","charAt","findStart","initRange","minChars","findTriggerChIndex","getParent","getRoot","spot","cloneRange","triggerCharIndex","lastIndexOf","triggerChar","getContext","createRng","selectNode","onKeypress","redirectKeyToItem","getItem","getView","isActive","cancelIfNecessary","isMenuOpen","stopImmediatePropagation","isProcessingAction","AutocompleterEditorEvents","global$4","point$2","isText$1","isElement$1","toLast","toLeaf","isPreviousCharContent","leaf","isStartOfWord","getTriggerContext","database","triggerChars","getDatabase","getRng","context","lookupWithContext","fetchOptions","startText","autocompleters","lookupByChar","autocompleter","lookupData","ac","fetchResult","fetch","maxResults","then","matchText","columns","separatorMenuItemSchema","createSeparatorMenuItem","autocompleterItemSchema","autocompleterSchema","createSeparatorItem","createAutocompleterItem","createAutocompleter","baseToolbarButtonFields","toolbarButtonSchema","createToolbarButton","baseToolbarToggleButtonFields","toggleButtonSchema","createToggleButton","contextBarFields","contextButtonFields","contextToggleButtonFields","launchButtonFields","launchToggleButtonFields","toggleOrNormal","contextformbutton","contextformtogglebutton","contextFormSchema","createContextForm","contextToolbarSchema","createContextToolbar","stringArray","register","popups","ui","registry","getAll","popup","datasetValues","dv","ItemResponse","ItemResponse$1","navClass","selectableClass","colorClass","presetClasses","normal","color","tickedClass","groupHeadingClass","iconClass","textClass","accessoryClass","caretClass","checkmarkClass","activeClass","iconClassRtl","classForPreset","presets","forMenu","hasIcons","markers$1","menuClasses","dom$1","chunk$1","rowDom","chunks","forSwatch","forToolbar","preprocessCollection","isSeparator","allSplits","currentSplit","forCollection","initItems","_hasIcons","_item","forHorizontalCollection","menuHasIcons","handleError","createHorizontalPartialMenuWithAlloyItems","_columns","_presets","structure","createPartialMenuWithAlloyItems","commonMenuItemFields","choiceMenuItemSchema","createChoiceMenuItem","fancyTypes","fancyMenuItemSchema","createFancyMenuItem","menuItemSchema","createMenuItem","nestedMenuItemSchema","createNestedMenuItem","toggleMenuItemSchema","createToggleMenuItem","detectSize","margin","selectorClass","descendants$1","columnLength","thisTop","cTop","ceil","namedEvents","unnamedEvents","SimpleBehaviours","TooltippingSchema","init$4","getTooltip","setTooltip","clearTooltip","clearTimer","resetTimer","delay","isShowing","TooltippingState","ExclusivityChannel","ShowTooltipEvent","HideTooltipEvent","hideAllExclusive","_tConfig","_tState","setComponents","tState","specs","tooltip","TooltippingApis","events$8","tooltipConfig","show","tooltipDom","tooltipComponents","ActiveTooltipping","Tooltipping","global$5","global$6","nativeDisabled","onLoad$5","disableConfig","disableState","disabled","disable","enable","hasNative","useNative","nativeIsDisabled","nativeDisable","nativeEnable","ariaIsDisabled","ariaDisable","ariaEnable","_disableState","disableClass","onDisabled","onEnabled","isDisabled","set$7","DisableApis","exhibit$3","events$9","ActiveDisable","DisableSchema","Disabling","global$7","getSkinUrl","skin","getParam","skinUrl","skinName","documentBaseURI","baseURL","isReadOnly","isSkinDisabled","getHeightSetting","getElement","getWidthSetting","DOM","getStyle","getMinWidthSetting","getMinHeightSetting","getMaxWidthSetting","getMaxHeightSetting","getUserStyleFormats","isMergeStyleFormats","getLineHeightFormats","getRemovedMenuItems","isMenubarEnabled","isToolbarEnabled","toolbar","isToolbarTrue","isToolbarString","isToolbarObjectArray","isMultipleToolbars","getMultipleToolbarsSetting","toolbars","toolbarArray","ToolbarMode","getToolbarMode","ToolbarLocation","getToolbarGroups","getToolbarLocation","auto","isToolbarLocationBottom","fixedContainerSelector","isToolbarPersist","fixedContainerElement","inline","useFixedContainer","getUiContainer","fixedContainer","isDistractionFree","isStickyToolbar","isDraggableModal","getMenubar","getToolbar","getFilePickerCallback","getFilePickerTypes","getFileBrowserCallbackTypes","noTypeaheadUrls","getAnchorTop","getAnchorBottom","getFilePickerValidatorHandler","ReadOnlyChannel","ReadOnlyDataSchema","broadcastReadonly","uiComponents","readonly","outerContainer","mothership","setupReadonlyModeSwitch","setMode","receivingConfig","button","splitButton","toolbarButton","DisablingConfigs","runWithApi","getApi","onControlAttached","editorOffCell","onDestroy","onSetup","onControlDetached","onMenuItemExecute","itemResponse","triggersSubmenu","CLOSE_ON_EXECUTE","menuItemEventOrder","componentRenderPipeline","renderCommonItem","providersbackstage","optComponents","buildData","global$8","convertText","mac","alt","ctrl","shift","access","other","shortcut","updated","segment","renderIcon","iconHtml","renderText","renderHtml","renderStyledText","renderShortcut","renderCheckmark","renderSubmenuCaret","renderDownwardsCaret","renderColorStructure","itemText","iconSvg","providerBackstage","colorPickerCommand","removeColorCommand","getDom","common","title","baseDom","renderNormalItemStructure","renderIcons","textRender","rtlClass","leftIcon","checkmark","checkMark","domTitle","ariaLabel","htmlContent","menuItem","shortcutContent","caret","rtlIcon","rtlTransform","renderItemStructure","providersBackstage","fallbackIcon","getIconName","iconName","needRtlClass","iconContent","tooltipBehaviour","sharedBackstage","tooltipWorker","_tooltip","escapeRegExp","encodeText","encode","replaceText","translated","encoded","escapedMatchRegex","RegExp","renderAutocompleteItem","useText","onItemValueHandler","_api","renderChoiceItem","isSelected","setActive","setDisabled","parts$2","hexColour","shorthandRegex","longformRegex","isHexString","hex","getLongForm","hexString","m","extractValues","longForm","splitForm","exec","toHex","fromRgba","rgbaColour","red","green","blue","round","rgbRegex","rgbaRegex","alpha","isRgbaComponent","fromHsv","hsv","hue","saturation","brightness","side","chroma","fromHex","fromStringValues","fromString","rgbaString","rgbMatch","rgbaMatch","rgba","fireSkinLoaded","fire","fireSkinLoadError","fireResizeEditor","fireResizeContent","fireScrollContent","fireTextColorChange","global$9","storageName","ColorCache","storageString","localstorage","parse","prune","diff","cache","unshift","pop","setItem","idx","splice","choiceItem","defaultColors","colorCache","mapColors","colorMap","colors","canvas","ctx","byteAsHex","colorByte","alphaByte","bg","colorByteWithWhiteBg","toUpperCase","asHexColor","clearRect","fillStyle","fillRect","getImageData","getColorCols","defaultCols","hasCustomColors","getColorMap","getColors","unmapped","getCurrentColors","addColor","getCurrentColor","format","getParents","applyFormat","undoManager","transact","formatter","nodeChanged","removeFormat","registerCommands","addCommand","calcCols","sqrt","getColorCols$1","getAdditionalColors","hasCustom","applyColor","onChoice","dialog","colorPickerDialog","colorOpt","execCommand","getColors$1","getFetch","callback","setIconColor","splitButtonApi","newColor","setIconFillAndStroke","pathId","setIconFill","setIconStroke","registerTextColorButton","lastColor","addSplitButton","select","optCurrentRgb","currentRgb","currentHex","_splitButtonApi","onItemAction","registerTextColorMenuItem","addNestedMenuItem","getSubmenuItems","fancytype","getOnSubmit","colorpicker","details","initialData","submit","windowManager","buttons","onSubmit","onCancel","register$1","lastForeColor","lastBackColor","createPartialChoiceMenu","presetItemTypes","alloyItems","createChoiceItems","itemPresets","deriveMenuMovement","menuMarkers","rowClass","deriveCollectionMovement","renderColorSwatchItem","colorinput","widgetSpec","cellOverEvent","cellExecuteEvent","makeCell","col","labelId","emitCellOver","se","makeCells","cells","selectCells","selectedRow","selectedColumn","makeComponents","cellRow","makeLabelText","renderInsertTableMenuItem","sizeLabelId","memLabel","fancyMenuItems","inserttable","colorswatch","valueOpt","renderFancyMenuItem","render","renderNestedItem","downwardsCaret","renderNormalItem","renderSeparatorItem","renderToggleMenuItem","autocomplete","nested","toggle$1","fancy","FocusMode","createMenuItemFromBridge","isHorizontalMenu","parseForHorizontalMenu","menuitem","createAutocompleteItems","createPartialMenu","itemHasIcon","createItem","createPartial","createTieredDataFrom","partialMenu","createMenuFrom","focusMode","ContentFocus","register$2","activeAutocompleter","processingAction","hideIfNecessary","lastElement","getAutocompleters","getCombinedItems","choices","itemMeta","nr","autocompleterApi","reload","BUBBLE_TO_SANDBOX","commenceIfNecessary","matchLength","display","ld","doLookup","newContext","lookupInfo","combinedItems","autocompleterUiApi","Autocompleter","filter$2","bind$3","capture$1","fromRawEvent$1","closest$4","DelayedFunction","fun","ref","schedule","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","touches","isFarEnough","touch","distX","distY","monitor","startData","longpressFired","longpress$1","handleTouchstart","handleTouchmove","handleTouchend","isSame","fireIfReady","isDangerous","keyEv","settingsSchema","bindFocus","bindBlur","setup$1","rawSettings","tapEvent","simpleEvents","tapStopped","stopped","pasteTimeout","onPaste","onKeydown","stopBackspace","onFocusIn","focusoutTimeout","onFocusOut","derive$2","rawTarget","fromSource","isStopped","isCut","fromExternal","adt$b","resume","complete","doTriggerHandler","eventType","handlerInfo","eventHandler","doTriggerOnUntilStopped","triggerHandler","listeners","_logger","listener","triggerUntilStopped","triggerOnUntilStopped","broadcastHandler","EventRegistry","registerId","findHandler","filterByType","isAboveRoot","unregisterId","handlersById","_eventName","Registry","readOrTag","failOnDuplicate","tagId","conflict","unregister","getById","factory$3","domWithoutAttributes","containerBehaviours","Container","takeover","domEvents","_alloyId","broadcast$1","destroy","broadcastData","receivers","receiver","renderBar","interpreter","schema$e","parts$3","excludeFactory","factory$4","fieldBehaviours","descriptor","descriptorId","getField","getLabel","FormField","exhibit$4","tabConfig","tabAttr","ActiveTabstopping","TabstopSchema","Tabstopping","renderFormFieldWith","pLabel","pField","extraClasses","extraBehaviours","renderFormFieldSpecWith","renderFormField","renderFormFieldDomWith","renderFormFieldDom","renderLabel","formChangeEvent","formCloseEvent","formCancelEvent","formActionEvent","formSubmitEvent","formBlockEvent","formUnblockEvent","formTabChangeEvent","formResizeEvent","renderCollection","runOnItem","escapeAttribute","htmlLines","mapItemName","readonlyClass","tgt","collectionEvents","currentActive","iterCollectionItems","applyAttributes","childElm","schema$f","focusBehaviours","selectOnFocus","setSelectionRange","inputBehaviours","dom$2","inputAttributes","inputStyles","inputClasses","factory$5","Input","exports$1","module","exports","define","require","amd","global","EphoxContactWrapper","code","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","runClearTimeout","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","nextTick","Item","env","argv","versions","addListener","once","removeListener","removeAllListeners","prependListener","prependOnceListener","binding","cwd","chdir","umask","setImmediate","setTimeoutFunc","thisArg","Promise","TypeError","_handled","_value","_deferreds","doResolve","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","promise","finale","_unhandledRejectionFn","Handler","reason","ex","prom","remaining","race","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","clearFn","_id","_clearFn","unref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","onTimeout","_onTimeout","onNextTick","promisePolyfill","boltExport","nu$a","baseFn","callbacks","nCallback","isReady","cbs","pure","LazyValue","errorReporter","make$3","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","nu$b","pure$1","Future","ariaElements","isAriaElement","markValid","invalidConfig","invalidClass","notify","notifyInfo","getContainer","validHtml","onValid","markInvalid","invalidState","onInvalid","_invalidState","validatorInfo","validate","run$1","onValidate","valid","isInvalid","InvalidateApis","events$a","onEvent","validateOnLoad","ActiveInvalidate","InvalidateSchema","Invalidating","validation","getCoupled","coupleConfig","coupleState","getOrCreate","CouplingApis","CouplingSchema","init$5","coupled","CouplingState","Coupling","partType","HighlightOnOpen","getAnchor","getHotspot","getAnchorOverrides","mapFetch","fetcher","openF","highlightOnOpen","futureData","getLazySink","tdata","HighlightFirst","open$1","onOpenSync","processed","close$1","_onOpenSync","_highlightOnOpen","togglePopup","showing","matchWidth","useMinWidth","buttonWidth","sinkDetail","internalSink","lazySinkFn","doRepositionMenus","makeSandbox","ariaOwner","sandboxClasses","sandboxBehaviours","sandboxFields","schema$g","parts$4","factory$6","switchToMenu","HighlightNone","triggerExecute","dropdownBehaviours","Dropdown","exhibit$5","unselectable","events$b","ActiveUnselecting","Unselecting","renderPanelButton","colorInputChangeEvent","colorSwatchChangeEvent","colorPickerCancelEvent","renderColorInput","colorInputBackstage","inputValue","span","emitSwatchChange","colorBit","memColorButton","colorPicker","colorButton","_field","hsvColour","fromRgb","minRGB","maxRGB","calcHex","rgb","fieldsUpdate","sliderUpdate","paletteUpdate","labelPart","edgePart","model","edgeActions","det","mouseIsDown","tlEdgePart","tedgePart","trEdgePart","redgePart","brEdgePart","bedgePart","blEdgePart","ledgePart","thumbPart","spectrumPart","modelDetail","getValueFromEvent","spectrum","SliderParts","_sliderChangeEvent","sliderChangeEvent","isTouchEvent","evt","getEventSource","touchEvent","mouseEvent","r$1","l","minX","minY","min1X","min1Y","max1X","max1Y","range$2","xRange","yRange","halfX","halfY","step","stepSize","snap","snapToGrid","snapStart","rounded","hasEdge","edgeName","hasLEdge","hasREdge","hasTEdge","hasBEdge","currentValue","xValue","yValue","xyValue","fireSliderChange","setToTLEdgeXY","setToTEdge","setToTEdgeXY","setToTREdgeXY","setToREdge","setToREdgeXY","setToBREdgeXY","setToBEdge","setToBEdgeXY","setToBLEdgeXY","setToLEdge","setToLEdgeXY","reduceBy","increaseBy","capValue","snapValueOf","initValue","extraValue","remainder","adjustment","rawSteps","maxSteps","numSteps","findOffsetOf","findValueOf","hasMinEdge","hasMaxEdge","minBound","maxBound","screenRange","capMin","capMax","findOffsetOfValue","maxOffset","centerMinEdge","centerMaxEdge","getBounds$1","getBoundsProperty","getMinXBounds","getMaxXBounds","getMinYBounds","getMaxYBounds","getXScreenRange","getYScreenRange","getCenterOffsetOf","componentMinEdge","componentMaxEdge","spectrumMinEdge","getXCenterOffSetOf","componentBounds","spectrumBounds","getYCenterOffSetOf","fireSliderChange$1","sliderValue","findValueOfOffset","sliderVal","setToMin","setToMax","moveBy","handleMovement","findOffsetOfValue$1","minEdge","maxEdge","minOffset","findPositionOfValue","slider","setPositionFromValue","thumb","edges","getSpectrum","getLeftEdge","getRightEdge","thumbRadius","HorizontalModel","fireSliderChange$2","sliderValue$1","findValueOfOffset$1","setValueFrom$1","setToMin$1","setToMax$1","moveBy$1","handleMovement$1","getValueFromEvent$1","findOffsetOfValue$2","findPositionOfValue$1","setPositionFromValue$1","getTopEdge","getBottomEdge","onLeft$1","onRight$1","onUp$1","onDown$1","edgeActions$1","VerticalModel","fireSliderChange$3","sliderValue$2","setValueFrom$2","moveBy$2","isVerticalMovement","handleMovement$2","setToMin$2","mX","mY","setToMax$2","getValueFromEvent$2","setPositionFromValue$2","xPos","yPos","thumbXRadius","thumbYRadius","onLeft$2","onRight$2","onUp$2","onDown$2","edgeActions$2","TwoDModel","SliderSchema","getThumb","changeValue","onChange","resetToMin","resetToMax","fireOnChoose","onChoose","wasDown","onDragStart","onDragEnd","sliderBehaviours","getInitialValue","onInit","Slider","sliderFactory","getClass","_thumb","owner$3","schema$h","getPartName","sketch$1","fSpec","fieldParts","make$4","toResult$1","formBehaviours","form","resPs","resPThunk","pName","Form","validInput","invalidInput","validatingInput","translatePrefix","rgbFormFactory","onValidHexx","onInvalidHexx","invalidation","isValid","renderTextField","description","helptext","comps","concats","copyRgbToHex","hexField","copyRgbToForm","memPreview","updatePreview","preview","copyHexToRgb","setValueRgb","getValueRgb","onInvalidInput","onValidHex","onValidRgb","isHexInputEvent","onValidInput","formPartStrings","redStrings","greenStrings","blueStrings","hexStrings","updateHex","rgbFormSketcher","paletteFactory","_translate","setColour","grdWhite","createLinearGradient","addColorStop","grdBlack","setSliderColour","_detail","_slider","saturationBrightnessPaletteSketcher","setRgba","_apis","makeFactory","rgbForm","onInvalidHex","sbPalette","paletteRgba","memPalette","memRgb","updatePalette","palette","updateFields","runUpdates","updates","paletteUpdates","oldRgb","hsvColour$1","newHsvColour","nuHex","sliderUpdates","colourPickerSketcher","self$1","memento","mem","childAt","ComposingConfigs","english","getEnglishText","translate$1","renderColorPicker","colourPickerFactory","memPicker","picker","optRgbForm","optHex","formValues","pattern","global$a","isOldCustomEditor","renderCustomEditor","editorApi","memReplaced","ta","scriptId","scriptUrl","ea","cvalue","ed","processors","memento$1","rawProcessors","rawValue","postprocess","withComp","optInitialValue","getter","setter","withElement","domValue","domHtml","memory$1","RepresentingConfigs","extensionsAccepted","filterByExtension","files","re","file","renderDropZone","actions","onDrop","transferEvent","handleFiles","dataTransfer","onSelect","memInput","accept","renderField","inputComp","renderGrid","beforeObject","afterObject","craftWithClasses","outline","craft","triggerTab","onFocus$1","isPseudoStop","platformNeedsSandboxing","getDynamicSource","isSandbox","cachedValue","_frameComponent","frameComponent","contentWindow","renderIFrame","sandboxed","sourcing","create$5","resize","clone$1","tCanvas","get2dContext","drawImage","getWidth","image","naturalWidth","getHeight","naturalHeight","anyWindow","asap","immediateFn","catch","values_1","Promise$1","blobToImage","blobUrl","URL","createObjectURL","Image","removeListeners","loaded","src","dataUriToBlobSync","uri","mimetype","base64","sliceSize","byteCharacters","atob","bytesLength","slicesCount","byteArrays","sliceIndex","begin","end","bytes","charCodeAt","Uint8Array","Blob","dataUriToBlob","canvasToBlob","quality","HTMLCanvasElement","toBlob","toDataURL","canvasToDataURL","blobToCanvas","revokeImageUrl","blobToDataUri","reader","FileReader","onloadend","readAsDataURL","revokeObjectURL","create$6","getCanvas","initialType","getType","toBase64","toAdjustedBlob","toAdjustedDataURL","toAdjustedBase64","dataurl","toCanvas","fromBlob","fromCanvas","blobToImageResult","clamp$1","parsedValue","identity$1","DELTA_INDEX","multiply","matrix1","matrix2","out","adjustContrast","adjustBrightness","adjustColors","adjustR","adjustG","adjustB","colorFilter","ir","applyColorFilter","applyMatrix","pixelsData","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","pixels","putImageData","convoluteFilter","applyConvoluteFilter","pIn","pOut","aMatrix","halfSide","drgba","cy","cx","scx","scy","innerOffset","wt","pixelsIn","pixelsOut","functionColorFilter","colorFn","filterImpl","applyLookup","complexAdjustableColorFilter","matrixAdjustFn","adjust","basicColorFilter","basicConvolutionFilter","kernel","invert","contrast","colorize","sharpen","gamma","pow","scale","dW","dH","sW","sH","wRatio","hRatio","scaleCapped","scaled","_scale","rotate","angle","applyRotate","translateX","translateY","PI","flip","axis","applyFlip","crop","applyCrop","resize$1","newCanvas","invert$1","sharpen$1","gamma$1","colorize$1","brightness$1","contrast$1","flip$1","crop$1","resize$2","rotate$1","renderIcon$1","renderIconFromPack","iconsProvider","renderReplacableIconFromPack","renderLabel$1","_a$1","internalToolbarButtonExecute","onToolbarButtonExecute","itemApi","buttonApi","toolbarButtonEventOrder","updateMenuText","updateMenuIcon","renderCommonDropdown","optMemDisplayText","optMemDisplayIcon","onLeftOrRightInMenu","dropdown","tooltipAttributes","translatedTooltip","memDropdown","displayText","displayIcon","isMenuItemReference","isExpandingMenuItem","separator$1","unwrapReferences","realItems","getFromExpandingItem","submenuItems","newMenus","newExpansions","getFromItem","generateValueIfRequired","itemWithValue","newData","build$2","mainMenu","submenus","getMenuButtonApi","renderMenuButton","_comp","getFetch$1","getButton","getMenuItemAction","storage","orig","getMenuItemSetup","renderCommonSpec","actionOpt","domFinal","renderIconButtonSpec","renderIconButton","iconButtonSpec","renderButtonSpec","translatedText","borderless","renderButton","buttonSpec","getAction","buttonType","isMenuFooterButtonSpec","isNormalFooterButtonSpec","renderFooterButton","memButton_1","menuButtonSpec","fixedSpec","renderDialogButton","schema$i","coupledPart","selfName","otherName","lock","onLockedChange","parts$5","locked","lockClass","factory$7","coupledFieldBehaviours","field1Name","field1","field2Name","field2","getField1","getField2","getLock","FormCoupledInputs","formatSize","unitDec","maxDecimal","numText","parseSize","sizeText","numPattern","convertUnit","inInch","noSizeConversion","_input","ratioSizeConversion","makeRatioConverter","currentFieldText","otherFieldText","cValue","oValue","cSize","oSize","renderSizeInput","converter","ratioEvent","pLock","formGroup","getFieldPart","isField1","widthField","heightField","_lock","newSize","optCurrent","optOther","value1","value2","undo","redo","zoom","back","swap","tempTransform","transformApply","internal","saveState","disable$1","enable$1","external$2","renderEditPanel","imagePanel","createButton","createIconButton","disableAllComponents","eventcomp","enableAllComponents","panelDom","noop$1","emit$1","emitDisable","emitEnable","emitTransform","emitTempTransform","getBackSwap","memContainer","ButtonPanel","emitTransformApply","createBackButton","createSpacer","createApplyButton","makeCropTransform","getRect","cropPanelComponents","hideCrop","CropPanel","memSize","constrain","makeResizeTransform","resizePanelComponents","sizeInput","ResizePanel","makeValueTransform","horizontalFlip","verticalFlip","counterclockwiseRotate","clockwiseRotate","flipRotateOnAction","operation","flipRotateComponents","FlipRotatePanel","makeSlider","makeVariableSlider","valTransform","variableFilterPanelComponents","createVariableFilterPanel","filterPanelComponents","FilterPanel","BrightnessPanel","ContrastPanel","GammaPanel","makeColorTransform","makeColorSlider","redOpt","memRed","blueOpt","memBlue","greenOpt","memGreen","colorizePanelComponents","ColorizePanel","getTransformPanelEvent","panel","cropPanelUpdate","_anyInSystem","showCrop","resizePanelUpdate","measurements","getMeasurements","sharpenTransform","invertTransform","buttonPanelComponents","getApplyButton","global$b","global$c","global$d","global$e","global$f","getDocumentSize","scrollWidth","scrollHeight","updateWithTouchData","changedTouches","DragHelper","$eventOverlay","downButton","startX","startY","handleElement","getElementById","docSize","cursor","handleElm","screenX","screenY","runtimeStyle","zIndex","opacity","appendTo","drag","deltaX","deltaY","create$7","currentRect","viewPortRect","clampRect","containerElm","dragHelpers","handles","xMul","yMul","blockers","getAbsoluteRect","outerRect","relativeRect","getRelativeRect","innerRect","getInnerRect","moveRect","startRect","instance","setInnerRect","createDragHelper","blocker","repaint","activeHandle","moveAndBlock","keyCode","SPACEBAR","toggleVisibility","updateElementRect","setRect","setViewPortRect","setClampRect","helper","extend","CropRect","loadImage","renderImagePanel","initialUrl","memBg","zoomState","cropRect","rectState","viewRectState","repaintImg","img","panelW","panelH","cRect","zoomFit","updateSrc","url","aImg","lastViewRect","viewRect","inflate","currentZoom","newZoom","newRect","setButtonEnabled","enabled","renderSideBar","updateButtonUndoStates","undoEnabled","redoEnabled","memUndo","memRedo","UndoStack","removed","canUndo","canRedo","makeState","blobState","tempState","undoStack","getBlobState","setBlobState","getTempState","temp","updateTempState","newTempState","createState","destroyTempState","destroyState","destroyStates","states","addBlobState","addTempState","applyTempState","postApply","currentState","getHistoryStates","renderImageTools","historyStates","sideBar","disableUndoRedo","_oImg","unblock","imageResultToBlob","block","editPanel","applyButton","blobManipulate","oImg","manipulate","tempManipulate","manipulateApply","currentUrl","renderLabel$2","backstageShared","isSingleListItem","dataAttribute","fetchItems","dropdownComp","selectedValue","findItemByValue","renderListBox","initialItem","sketchSpec","listBoxWrap","renderPanel","factory$8","initialValues","selectClasses","selectAttributes","selectBehaviours","found","HtmlSelect","renderSelectBox","translatedOptions","chevron","selectWrap","renderTable","renderTh","renderHeader","renderTd","renderTr","renderRows","baseInputBehaviours","multiline","validatingBehaviours","vl","inputMode","inputmode","classname","flex","extraClasses2","maximized","renderInput","renderTextarea","events$c","streamConfig","streamState","streams","stream","cancelEvent","ActiveStreaming","_config","setTimer","init$6","StreamingState","setup$2","streamInfo","sInfo","throttler","onStream","stopEvent","StreamingSchema","Streaming","setValueFromItem","itemData","setCursorAtEnd","setSelectionOn","setSelectionToEnd","attemptSelectOver","selectsOver","inputDisplay_1","getDisplayText","itemDisplay","itemExecute","make$5","navigateList","highlighter","previewing","focusBehaviours$1","responseTime","focusInInput","previousValue_1","pv","sandboxIsOpen","openClass","onItemExecute","dismissOnBlur","typeahead","typeaheadBehaviours","schema$j","parts$6","populateFromBrowse","Typeahead","wrap$2","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","nu$c","worker","value$2","error$1","fromResult$1","fromFuture","future","fromPromise","completer","FutureResult","separator$2","toMenuItem","staticMenuItem","toMenuItems","targets","filterLinkTargets","filteredTargets","headerTargets","linkInfo","anchorTargets","anchorTargetTop","anchorTop","anchorTargetBottom","anchorBottom","historyTargets","history","joinMenuLists","bothEmpty","filterByQuery","term","lowerCaseTerm","getItems","fileType","urlBackstage","urlInputValue","getLinkInformation","getHistory","errorId","renderUrlInput","updateHistory","urlEntry","addToHistory","filetype","memUrlBox","_newValue","getValidationHandler","memInvalidIcon","invalidComp","_menu","_entry","makeIcon","errId","memStatus","optUrlPicker","getUrlPicker","browseUrlEvent","memUrlPickerButton","controlHWrapper","openUrlPicker","componentData","urlData","fieldname","chosenData","renderAlertBanner","iconTooltip","renderCheckbox","repBehaviour","toggleCheckboxHandler","className","memIcons","renderHtmlPanel","make$6","makeIframe","iframeSpec","factories","bar","collection","alertbanner","textarea","iframe","checkbox","dropzone","listbox","selectbox","sizeinput","urlinput","customeditor","htmlpanel","imagetools","table","noFormParts","interpretInForm","oldBackstage","newBackstage","interpretParts","interpretWithoutForm","bubbleAlignments","valignCentre","alignCentre","alignLeft","alignRight","getInlineDialogAnchor","contentAreaElement","lazyAnchorbar","lazyUseEditableAreaAnchor","editableAreaAnchor","standardAnchor","getBannerAnchor","getCursorAnchor","bodyElement","getNodeAnchor","getAnchors","isToolbarTop","useFixedToolbarContainer","getContentAreaContainer","inlineDialog","hasCustomColors$1","getColors$2","getColorCols$2","ColorInputBackstage","isDraggableModal$1","DialogBackstage","HeaderBackstage","getDockingMode","setDockingMode","defaultStyleFormats","isNestedFormat","isBlockFormat","isInlineFormat","isSelectorFormat","mapFormats","userFormats","fmt","customFormats","formats","formatName","registerCustomFormats","registerFormats","getStyleFormats","registeredUserFormats","processBasic","isSelectedFor","getPreviewFor","formatterSpec","getStylePreview","register$3","enrichSupported","enrichMenu","submenuSpec","enrichCustom","customSpec","newItem","doEnrich","newItems_1","getStyleItems","init$7","parseStyle","getCssText","settingsFormats","settingsFlattenedFormats","eventsFormats","eventsFlattenedFormats","replaceSettings","_e","enriched","modifications","fromSettings","fromEvents","getFlattenedKeys","trim$1","hasContentEditableState","contentEditable","isContentEditableTrue","isContentEditableFalse","create$8","isChildOfContentEditableTrue","getElementText","innerText","getOrGenerateId","isAnchor","isValidAnchor","isEditable","isHeader","isValidHeader","getLevel","headerTarget","headerId","anchorTarget","anchorId","anchorText","getHeaderTargets","elms","getAnchorTargets","getTargetElements","hasTitle","find$5","LinkTargets","STORAGE_KEY","HISTORY_LENGTH","isHttpUrl","isArrayOfUrl","isRecordOfUrlArray","getAllHistory","unparsedHistory","SyntaxError","setAllHistory","itemsWithoutUrl","isTruthy","makeMap","getPicker","getPickerTypes","optFileTypes","optLegacyTypes","optTypes","_picker","types","getPickerSetting","pickerTypes","entry","getTextSetting","UrlInputBackstage","init$8","contextMenuState","styleselect","isContextMenuOpen","setContextMenuState","expandable$1","showContextToolbarEvent","hideContextToolbarEvent","schema$k","enhanceGroups","parts$7","factory$9","setGroups","groups","getGroupContainer","shell","toolbarBehaviours","Toolbar","generate$6","output$1","within","withinWidth","apportion","total","parray","toUnit","fitLast","fits","overflow","overflower","fitAll","tryFit","divide","partition$3","storedGroups","bGroups","findFocusedComp","focusedElm","setOverflow","overflowGroup","builtGroups","focusedComp","availableWidth","overflows","schema$l","schema$m","parts$8","schema$n","parts$9","toggledClass","toggle$2","toolbarSandbox","position$2","bounder","setGroups$1","makeSandbox$1","factory$a","FloatingToolbarButton","schema$o","parts$a","factory$b","tgroupBehaviours","itemSelector","ToolbarGroup","buildGroups","refresh$1","memFloatingToolbarButton","overflowGroups","floatingToolbarButton","factory$c","getOverflowBounds","overflowToggledClass","splitToolbarBehaviours","getOverflow","SplitFloatingToolbar","getAnimationRoot","slideConfig","getDimensionProperty","dimension","getDimension","disableTransitions","shrinkingClass","growingClass","setShrunk","closedClass","setGrown","doImmediateShrink","slideState","_calculatedSize","setCollapsed","onStartShrink","onShrunk","doStartShrink","calculatedSize","doStartSmartShrink","shrinker","doStartGrow","wasShrinking","beforeSize","fullSize","startPartialGrow","startCompleteGrow","setStartSize","setExpanded","onStartGrow","refresh$2","isExpanded","grow","shrink","immediateShrink","hasGrown","hasShrunk","isCollapsed","isGrowing","_slideState","isShrinking","isTransitioning","toggleGrow","SlidingApis","exhibit$6","events$d","propertyName","onGrown","ActiveSliding","SlidingSchema","init$9","SlidingState","Sliding","schema$p","parts$b","onClosed","onOpened","isOpen$1","toggleToolbar","overf","refresh$3","factory$d","toolbarToggleEvent","doSetGroups","_button","SplitSlidingToolbar","toolbarHeightChange","renderToolbarGroupCommon","toolbarGroup","renderToolbarGroup","getToolbarbehaviours","toolbarSpec","modeName","onAttached","initGroups","renderMoreToolbarCommon","cyclicKeying","renderFloatingMoreToolbar","baseSpec","overflowXOffset","headerElem","moreDrawerData","lazyHeader","headerBounds","docElem","docBounds","renderSlidingMoreToolbar","renderToolbar","scrolling","groupToolbarButtonSchema","createGroupToolbarButton","baseMenuButtonFields","MenuButtonSchema","createMenuButton","splitButtonSchema","createSplitButton","events$e","reflectingConfig","reflectingState","updateState","renderComponents","newComponents","channel","rawData","ActiveReflecting","getState$2","reflectState","ReflectingApis","ReflectingSchema","init$a","optS","ReflectingState","Reflecting","schema$q","arrowPart","arrow","buttonPart","btn","splitDropdown","parts$c","factory$e","openMenu","executeOnButton","buttonEvents","ariaDescriptor","splitDropdownBehaviours","SplitDropdown","getButtonApi","getToggleApi","getTooltipAttributes","focusButtonEvent","rtlIcon$1","rtlTransform$1","renderCommonStructure","_d","needsRtlClass","renderFloatingToolbarButton","identifyButtons","renderCommonToolbarButton","specialisation","toolbarButtonBehaviours","renderToolbarButton","renderToolbarButtonWith","bonusEvents","renderToolbarToggleButton","renderToolbarToggleButtonWith","fetchChoices","renderSplitButton","displayChannel","underlinePath","buttonComp","_b","_c","getFormApi","runOnExecute$1","formApi","renderContextButton","bridged","renderContextToggleButton","generateOne$1","generate$7","mementos","asSpecs","findPrimary","compInSystem","buildInitGroups","commands","renderContextForm","toolbarType","ContextForm","getHorizontalBounds","contentAreaBox","viewportBounds","contentBoxWidth","maxViewportWidth","getVerticalBounds","isToolbarLocationTop","headerBox","isToolbarBelowContentArea","isToolbarAbove","containerBounds","getContextToolbarBounds","toolbarOrMenubarEnabled","matchTargetWith","ctxs","toolbarApi","contextToolbars","contextForms","filterByPositionForStartNode","doesPositionExist","filterToolbarsByPosition","hasSelectionToolbars","hasNodeToolbars","nodeToolbars","selectionToolbars","filterByPositionForAncestorNode","findPosition_1","basePosition","matchStartNode","nodeCandidates","editorCandidates","nodeMatches","editorMatches","matchAncestor","startNode","scopes","ancestorElem","inNodeScope","lookup$1","rootElem","isOutsideRoot","inEditorScope","categorise","forms","formNavigators","lookupTable","registerForm","contextForm","launch","registerToolbar","contextToolbar","forwardSlideEvent","backSlideEvent","changeSlideEvent","resizingClass","renderContextToolbar","currentWidth","newContents","oldContents","forwardContents","generateSelectItems","_editor","generateItem","rawItem","response","si","invalid","validateItems","preItems","getCurrentValue","shouldHide","createMenuItems","createSelectButton","getComponent","setInitialValue","nodeChangeHandler","rawFormats","buildBasicStaticDataset","Delimiter","delimiter","SemiColon","buildBasicSettingsDataset","settingName","alignMenuItems","command","getSpec","getMatchingValue","_format","updateSelectMenuIcon","alignment","canApply","createAlignSelect","alignSelectMenu","defaultFontsFormats","systemStackFonts","splitFonts","fontFamily","fonts","font","isSystemFontStack","matchesSystemStack","getSpec$1","getFirstFont","queryCommandValue","matchOpt","updateSelectMenuText","createFontSelect","fontSelectMenu","defaultFontsizeFormats","legacyFontSizes","round$1","precision","factor","toPt","fontSize","toLegacy","getSpec$2","_loop_1","pt","legacy","Space","createFontsizeSelect","fontsizeSelectMenu","findNearest","getStyles","parents","matchNode","getCurrentSelectionParents","currentNode","revocable","doRevoke","isSet","destroyable","unbindable","value$3","onSetupFormatToggle","boundCallback","formatChanged","initialized","onActionToggleFormat","defaultBlocks","getSpec$3","nodeChangeEvent","detectedFormat","createFormatSelect","formatSelectMenu","getSpec$4","getFormatItems","flattenedItems","createStyleSelect","styleSelectMenu","defaultToolbar","renderFromBridge","bridgeBuilder","togglebutton","menubutton","splitbutton","grouptoolbarbutton","identify","allowToolbarGroups","TopToBottom","floating","styleSelectButton","fontsizeSelectButton","fontSelectButton","formatButton","alignMenuButton","extractFrom","bespokeButtons","fontsizeselect","fontselect","formatselect","align","removeUnusedDefaults","filteredItemGroups","subItem","convertStringToolbar","strToolbar","groupsStrings","isToolbarGroupSettingArray","createToolbar","toolbarConfig","lookupButton","toolbarItem","prefixes","toolbarGroups","bubbleSize","bubbleAlignments$1","anchorOverrides","desktopAnchorSpecLayouts","mobileAnchorSpecLayouts","getAnchorLayout","register$4","registryContextToolbars","contextbar","isRangeOverlapping","aTop","aBottom","bTop","bBottom","getLastElementVerticalBound","nodeBounds","ele","diffTop","shouldContextToolbarHide","lastElementBounds","contextToolbarBounds","forceHide","hideOrRepositionIfNecessary","lastAnchor","contextBarEle","wrapInPopDialog","shortcuts","getScopes","alloySpec","buildToolbar","buildContextToolbarGroups","allButtons","buildContextMenuGroups","default","toolbarKey","launchContext","sElem","launchContextToolbar","setEditorTimeout","setup$3","ship","fireDismissPopups","onTouchstart","onTouchmove","onTouchend","onMousedown","onMouseup","onContentClick","onContentMouseup","onWindowScroll","onWindowResize","onEditorResize","parts$d","partType$1","schema$r","customListDetail","itemsPart","parts$e","name$2","factory$f","_external","setItems","getListContainer","itemComps","numListsRequired","numListsToAdd","itemsToAdd","makeItem","itemsToRemove","builtLists","setupItem","listBehaviours","CustomList","setup$4","isDocked","getBehaviours$2","StaticHeader","getOffsetParent","isFixed","offsetParent$1","getOrigin","morphAdt","static","appear","contextualInfo","transitionClass","fadeOutClass","fadeInClass","disappear","isPartiallyVisible","isTopCompletelyVisible","isBottomCompletelyVisible","isVisibleForModes","getPrior","getInitialPosition","storePrior","setInitialPosition","revertToOriginal","offsetBox_1","_left","_top","_right","_bottom","morphToOriginal","getModes","morphToFixed","winBox","top_1","isTop","getMorph","getMorphToOriginal","morphToStatic","onUndocked","morphToCoord","method","onDocked","updateVisibility","morphToDocked","contextual","contextInfo","lazyContext","setVisible","refreshInternal","lazyViewport","morph","setDocked","resetInternal","refresh$4","reset","isDocked$1","setModes","DockingApis","events$f","dockInfo","dockState","onShown","onHidden","ActiveDocking","DockingSchema","init$b","docked","initialBounds","DockingState","Docking","visibility","editorStickyOnClass","editorStickyOffClass","scrollFromBehindHeader","containerHeader","viewHeight","innerHeight","scrollPos","markerElement","markerPos","markerHeight","markerTop","markerBottom","editorHeaderPos","editorHeaderHeight","editorHeaderTop","editorHeaderBottom","editorHeaderDockedAtTop","editorHeaderDockedAtBottom","isDockedMode","updateIframeContentFlow","getOccupiedHeight","parentElem","padding","parentWidth","updateSinkVisibility","sinkElem","updateEditorClasses","editorContainer","restoreFocus","focusedElem","ownerDoc","activeElm","findFocusedElem","rootElm","setup$5","isDocked$2","getIframeBehaviours","getBehaviours$3","runOnSinkElement","onDockingSwitch","additionalBehaviours","headerHeight","boxHeight","topBound","StickyHeader","sticky","factory$g","setMenus","activeButton","hoveredButton","activeComp","hoveredComp","prev","SilverMenubar","owner$4","schema$s","getPartName$1","sketch$2","sSpec","slot","make$7","getSlotNames","getSlot","onSlot","def","onSlots","doShowing","_key","doShow","doHide","hideSlot","hideSlots","hideAllSlots","showSlot","slotBehaviours","slotApis","SlotContainer","sidebarSchema","createSidebar","setup$6","sidebars","addToggleButton","handleToggle","makePanels","panelConfigs","sidepanel","optSidePanelSpec","sidePanelSpec","makeSidebar","slotContainer","setSidebar","sidebar","optSlider","toggleSidebar","optSlotContainer","whichSidebar","sidebarOpen","fixSize","autoSize","renderSidebar","getAttrs","fromHtml$2","renderSpinner","toggleThrobber","renderThrobber","setup$7","lazyThrobber","throbberState","timerId","factory$h","getSocket","getHeader","setToolbar","setToolbars","mToolbar","refreshToolbar","toggleToolbarDrawer","isToolbarDrawerToggled","getThrobber","focusToolbar","optToolbar","setMenubar","menubar","focusMenubar","partMenubar","toolbarFactory","sliding","partMultipleToolbar","_mToolbar","tc","_index","partToolbar","renderer","lazyToolbar","lazyMoreButton","partHeader","partSocket","partSidebar","partThrobber","OuterContainer","grps","grp","renderedToolbars","defaultMenubar","defaultMenus","edit","tools","help","make$8","removedMenuItems","itemName","removedMenuItem","parseItemsString","identifyMenus","rawMenuData","userDefinedMenus","validMenus","menuData","isNotSeparator","fireSkinLoaded$1","_skinLoaded","fireSkinLoadError$1","loadSkin","isInline","skinUiCss","contentCSS","styleSheetLoader_1","styleSheetLoader","unload","rawUiConfig","toolbarButtonsConfig","detection","isiOS12","setupEvents","initialDocEle","lastWindowDimensions","innerWidth","lastDocumentDimensions","resizeWindow","outer","resizeDocument","docEle","inner","elementLoad","lastToolbarWidth","eTargetNode","targetNode","uiRoot","socket","limit","_ui","addQueryValueHandler","toolbarMode","refreshDrawer","iframeContainer","Iframe","parseToInt","numToPx","calcCappedSize","minSize","maxSize","minOverride","maxOverride","getHeight$1","baseHeight","minHeight","getHeightWithFallback","getWidth$1","baseWidth","minWidth","getWidthWithFallback","InlineHeader","targetElm","floatContainer","isSticky","editorMaxWidthOpt","headerBackstage","isSplitToolbar","calcToolbarOffset","tbar","calcMode","toolbar_1","toolbarHeight","targetBounds","roomAtTop","docHeight","roomAtBottom","winBounds","isRoomAtBottomViewport","setupMode","verticalDir","updateChromeWidth","bodyMargin","updateChromePosition","repositionPopups$1","updateChromeUi","resetDocking","floatContainerComp","updateMode","updateUi","currentMode","newMode","addClass","removeClass","getTargetPosAndBounds","setupEvents$1","toolbarPersist","prevPosAndBounds","resizeContent","prevPos","prevBounds","hasResized","requestAnimationFrame","render$1","uiContainer","Inline","register$5","alignToolbarButtons","cmd","alignNoneToolbarButton","addButton","register$6","toggleOutdentState","queryCommandState","onNodeChange","registerButtons","register$7","toggleFormat","registerFormatButtons","_idx","name_1","registerCommandButtons","registerCommandToggleButtons","registerButtons$1","registerMenuItems","addMenuItem","register$8","toggleUndoRedoState","checkState","onUndoStateChange","registerMenuItems$1","registerButtons$2","register$9","toggleVisualAidState","hasVisual","onVisualAid","registerMenuItems$2","addToggleMenuItem","registerToolbarButton","register$a","unsupportedLength","decimalDigits","signedInteger","exponentPart","dot","unsignedDecimalLiteral","float","isUnit","accepted","check","unitRaw","normalise","normaliseLineHeight","getLineHeights","Map","lastApi","registerMenuItems$3","registerButtons$3","addMenuButton","register$b","setup$8","nu$d","transpose$1","dx","dy","isTouchEvent$1","fromPageXY","pageX","pageY","fromClientXY","transposeContentAreaContainer","containerPos","getPos","getPointAnchor","getSelectionAnchor","getNodeAnchor$1","initAndShow","buildMenu","contextmenu","useNodeAnchor","anchorSpec","bubbleSize$1","bubbleAlignments$2","isTouchWithinSelection","touch_1","rngRectOpt","rngRect","getPointAnchorSpec","setupiOSOverrides","originalSelection","selectionReset","setRng","unbindEventListeners","preventMousedown","clearSelectionReset","initAndShow$1","shouldHighlightImmediately","openiOS_1","patchPipeConfig","shouldNeverUseNative","getMenuItems","defaultItems","contextMenus","isContextMenuDisabled","getContextMenu","getAvoidOverlapSelector","isSeparator$1","separator$3","makeContextItem","addContextMenuGroup","groupItems","lastMenuItem","generateContextMenu","selectedElement","sections","allItems","isNativeOverrideKeyEvent","isTriggeredByKeyboard","pointerType","getSelectedElement","shouldUseNodeAnchor","setup$9","hideContextMenu","showContextMenu","initAndShow$2","hideEvents","adt$c","subtract","add$4","transform$1","changes","asFixed","coord","asAbsolute","asOffset","withinRange","coord1","coord2","getDeltas","toStyles","stylesOpt","translate$2","absolute$3","fixed$1","absorb","partialCoord","originalCoord","absorbOne","stencil","optX","optY","parseAttrToInt","NaN","get$e","snapsInfo","leftAttr","topAttr","set$8","getCoords","snapInfo","moveOrSnap","newCoord","mustSnap","findClosestSnap","findSnap","fixedCoord","spanned","stopDrag","findMatchingSnap","snaps","sensor","inRange","getSnapPoints","matchSnap","bestSnap","deltas","bestDeltas","currAvg","bestAvg","snapTo","snapTo$1","dragConfig","getTarget","repositionTarget","scroll_1","origin_1","snapPin","DraggingApis","initialAttribute","resetZIndex","changeZIndex","zindex","instigate","anyComponent","discard","createComponent","blockerClass","blockerEvents","SnapSchema","schema$t","getCurrentCoord","location","clampCoords","coords","absoluteCoord","newCoords","offset$1","calcNewCoord","optSnaps","currentCoord","snapping","onSensor","dragBy","onDrag","calcStartData","move$1","dragState","dragMode","dragStartData","getStartData","dlt","updateStartState","setStartData","init$c","dragApi","forceDrop","drop","delayDrop","getData$1","getDelta$1","MouseData","events$g","stop$1","schema$u","init$d","getDataFrom","getData$2","getDelta$2","TouchData","events$h","blockerCell","schema$v","events$i","schema$w","mouse","mouseOrTouch","DraggingBranches","init$e","previous","calculateDelta","dragEvent","nuData","DragState","Dragging","dragger","snapWidth","snapOffset","calcSnap","selectorOpt","td","selectorHandle","sensorLeft","sensorTop","sensorWidth","sensorHeight","getSnapsConfig","isSameCell","cellOpt","currentTd","createSelector","setup$a","tlTds","brTds","startCell","finishCell","getTopLeftSnap","memTopLeft","getTopLeftSnaps","getBottomRightSnap","memBottomRight","getBottomRightSnaps","topLeftSnaps","bottomRightSnaps","bottomRight","showOrHideHandle","isAbove","isBelow","cellRect","viewportHeight","aboveViewport","belowViewport","getSnapConfig","snapTopLeft","snapLastTopLeft","snapBottomRight","snapLastBottomRight","otherCells","upOrLeftCells","downOrRightCells","ResizeTypes","getDimensions","resizeType","originalHeight","originalWidth","Both","resize$3","dim","isHidden$1","renderElementPath","getDataPath","newPathElements","_btn","divider","newAcc","updatePath","newPath","parent_1","isDefaultPrevented","isPropagationStopped","renderWordCount","replaceCountText","words","characters","currentVal","wordCount","renderStatusbar","renderResizeHandlerIcon","renderBranding","linkHtml","getResizeType","hasPlugin","None","Vertical","getTextComponents","getComponents","setup$b","lazyOuterContainer","platformClasses","touchPlatformClass","deviceClasses","isToolbarBottom","dirAttributes","verticalDirAttributes","isHeaderDocked","memAnchorBar","lazyAnchorBar","throbber","sb","statusbar","socketSidebarContainer","hasMultipleToolbar","hasToolbar","hasMenubar","getPartToolbar","editorComponents","containerComponents","border","addQueryStateHandler","getUi","broadcastAll","setEditorSize","parsedHeight","parsedWidth","renderUI","toolbarGroupButtonConfig","addGroupToolbarButton","toolbarOpt","describedBy","describedElement","describeElement","describeId","labelledBy","labelledElement","labelElement","schema$x","basic","parts$f","dragBlockClass","getDragBounds","factory$i","dialogBusyEvent","dialogIdleEvent","busyBehaviours","showDialog","busyComp","externalBlocker","_blocker","bc","getBusySpec","busySpec","busy","hideDialog","blockerDom","getDialogBody","getDialogFooter","setBusy","setIdle","modalEventsId","getFooter","modalBehaviours","ModalDialog","dialogToggleMenuItemSchema","dialogToggleMenuItemDataProcessor","baseFooterButtonFields","dialogFooterButtonFields","normalFooterButtonFields","menuFooterButtonFields","dialogFooterButtonSchema","alertBannerFields","alertBannerSchema","createBarFields","itemsField","buttonFields","buttonSchema","checkboxFields","checkboxSchema","checkboxDataProcessor","formComponentFields","formComponentWithLabelFields","collectionFields","collectionSchema","collectionDataProcessor","colorInputFields","colorInputSchema","colorInputDataProcessor","colorPickerFields","colorPickerSchema","colorPickerDataProcessor","customEditorFields","customEditorFieldsOld","customEditorSchema","customEditorDataProcessor","dropZoneFields","dropZoneSchema","dropZoneDataProcessor","createGridFields","htmlPanelFields","htmlPanelSchema","iframeFields","iframeSchema","iframeDataProcessor","imageToolsFields","imageToolsSchema","inputFields","inputSchema","inputDataProcessor","createLabelFields","listBoxSingleItemFields","listBoxNestedItemFields","listBoxItemSchema","listBoxFields","listBoxSchema","listBoxDataProcessor","selectBoxFields","selectBoxSchema","selectBoxDataProcessor","sizeInputFields","sizeInputSchema","sizeInputDataProcessor","tableFields","tableSchema","textAreaFields","textAreaSchema","textAreaDataProcessor","urlInputFields","urlInputSchema","urlInputDataProcessor","createItemsField","itemSchema$2","sErr","passValue","panelSchema","panelFields","tabFields","tabPanelFields","tabPanelSchema","dialogButtonFields","dialogButtonSchema","dialogSchema","tabpanel","createDialog","urlDialogButtonSchema","urlDialogSchema","createUrlDialog","getAllObjects","isNamedItem","dataProcessors","togglemenuitem","getDataProcessor","getNamedItems","createDataValidator","namedItems","extract$1","internalDialog","dataValidator","DialogManager","openUrl","redial","toValidValues","renderBodyPanel","memForm","formValue","vals","factory$j","tabButtonBehaviours","TabButton","schema$y","tabsPart","barDetail","dismissTab$1","tabbar","changeTab$1","clickToDismiss","tabClass","parts$g","factory$k","tabbarBehaviours","selectedClass","tab","Tabbar","factory$l","tabviewBehaviours","Tabview","schema$z","barPart","tabs","viewPart","parts$h","factory$m","tabValue","tabview","tabWithValue","tabData","onChangeTab","changeTabBy","section","byPred","tabSectionBehaviours","selectFirst","onDismissTab","getViewItems","showTab","tabKey","getTabIfNotActive","optTab","TabSection","measureHeights","allTabs","tabviewComp","_tab","getMaxHeight","heights","getMaxTabviewHeight","tablist","documentElement$1","tabviewHeight","isTabListBeside","currentTabHeight","dialogTopMargin","dialogBottomMargin","dialogHeight","chromeHeight","setTabviewHeight","updateTabviewHeight","dialogBody","maxTabHeight","getTabview","smartTabHeight","extraEvents","maxTabHeightOpt","oldHeight","naiveTabHeight","SendDataToSectionChannel","SendDataToViewChannel","renderTabPanel","storedValue","updateDataWithForm","formData","validData","currentData","setDataOnForm","oldTab","tabMode","_viewItems","oldName","tsection","dialogChannel","titleChannel","bodyChannel","footerChannel","bodySendMessageChannel","renderBody","ariaAttrs","incoming","isTabPanel","ariaAttributes","renderInlineBody","contentId","renderModalBody","bodySpec","renderIframeBody","hiddenHeader","pClose","pUntitled","pBodyMessage","pFooter","footer","pFooterGroup","startButtons","endButtons","renderDialog","dialogClass","blockerBackdropClass","scrollLockClass","extraStyles","dialogEvents","renderClose","renderTitle","renderDragHandle","renderInlineHeader","titleId","renderModalHeader","pTitle","pHandle","draghandle","draggable","getEventExtras","lazyDialog","closeWindow","onBlock","blockEvent","bs","onUnblock","renderModalDialog","mapMenuButtons","mapItems","extractCellsToObject","menuButton","innerAcc","initCommonEvents","fireApiEvent","_event","initUrlDialog","getInstanceApi","withSpec","currentDialog","initDialog","currentDialogInit","cur","onTabChange","newTabName","oldTabName","SilverDialogEvents","makeButton","lookup$2","footerButtons","buttonName","buttonGroups","makeGroup","renderFooter","initSpec","lookupByName","renderInlineFooter","renderModalFooter","getCompByName","form_1","getFormWrapper","footerState","validateData","dialogState","getDialogApi","doRedial","menuItemStates","withRoot","valueComp","representedValues","menuItemCurrentState","setData","prevData","instanceApi","mergedData","newInternalData","bodyState","tabSection","dialogInit","renderDialog$1","storagedMenuButtons","objOfCells","dialogSize","modalAccess","getForm","outerForm","renderInlineDialog","dialogLabelId","dialogContentId","memHeader","memBody","memFooter","global$g","getUrlDialogApi","sendMessage","SUPPORTED_MESSAGE_ACTIONS","isSupportedMessage","mceAction","isCustomMessage","handleMessage","insertContent","renderUrlDialog","iframeUri","base_uri","href","iframeDomain","protocol","port","messageHandlerUnbinder","isSameOrigin","onMessage","unbinder","iframeEle","iframeWin","postMessage","setup$c","closeDialog","alertDialog","memFooterClose","titleSpec","closeSpec","footerCloseButton","setup$d","confirmDialog","memFooterYes","footerNo","footerYesButton","validateData$1","isAlertOrConfirmDialog","inlineAdditionalBehaviours","setup$e","isStickyToolbar$1","openInlineDialog","openModalDialog","openModalUrlDialog","internalInitialData","config$1","refreshDocking","dialogUi","inlineDialogComp","confirm","alert","Theme","windowMgr","getWindowManagerImpl","getNotificationManagerImpl"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.5.1 (2020-10-01)\n */\n(function () {\n    'use strict';\n\n    var noop = function () {\n    };\n    var noarg = function (f) {\n      return function () {\n        return f();\n      };\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n    var isArrayOf = function (value, pred) {\n      if (isArray(value)) {\n        for (var i = 0, len = value.length; i < len; ++i) {\n          if (!pred(value[i])) {\n            return false;\n          }\n        }\n        return true;\n      }\n      return false;\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var range = function (num, f) {\n      var r = [];\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var chunk = function (array, size) {\n      var r = [];\n      for (var i = 0; i < array.length; i += size) {\n        var s = nativeSlice.call(array, i, i + size);\n        r.push(s);\n      }\n      return r;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var head = function (xs) {\n      return xs.length === 0 ? Optional.none() : Optional.some(xs[0]);\n    };\n    var last = function (xs) {\n      return xs.length === 0 ? Optional.none() : Optional.some(xs[xs.length - 1]);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (_opt) {\n        return value(o);\n      };\n      var orThunk = function (_f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (_f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var SimpleResultType;\n    (function (SimpleResultType) {\n      SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n      SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n    }(SimpleResultType || (SimpleResultType = {})));\n    var fold = function (res, onError, onValue) {\n      return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n    };\n    var partition$1 = function (results) {\n      var values = [];\n      var errors = [];\n      each(results, function (obj) {\n        fold(obj, function (err) {\n          return errors.push(err);\n        }, function (val) {\n          return values.push(val);\n        });\n      });\n      return {\n        values: values,\n        errors: errors\n      };\n    };\n    var mapError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return {\n          stype: SimpleResultType.Error,\n          serror: f(res.serror)\n        };\n      } else {\n        return res;\n      }\n    };\n    var map$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return {\n          stype: SimpleResultType.Value,\n          svalue: f(res.svalue)\n        };\n      } else {\n        return res;\n      }\n    };\n    var bind$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return f(res.svalue);\n      } else {\n        return res;\n      }\n    };\n    var bindError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return f(res.serror);\n      } else {\n        return res;\n      }\n    };\n    var svalue = function (v) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: v\n      };\n    };\n    var serror = function (e) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: e\n      };\n    };\n    var toResult = function (res) {\n      return fold(res, Result.error, Result.value);\n    };\n    var fromResult = function (res) {\n      return res.fold(serror, svalue);\n    };\n    var SimpleResult = {\n      fromResult: fromResult,\n      toResult: toResult,\n      svalue: svalue,\n      partition: partition$1,\n      serror: serror,\n      bind: bind$1,\n      bindError: bindError,\n      map: map$1,\n      mapError: mapError,\n      fold: fold\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$2 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var find$1 = function (obj, pred) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        if (pred(x, i, obj)) {\n          return Optional.some(x);\n        }\n      }\n      return Optional.none();\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var get = function (obj, key) {\n      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var argLength = arguments.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var args = new Array(argLength);\n          for (var i = 0; i < args.length; i++) {\n            args[i] = arguments[i];\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              if (arguments.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n              }\n              var target = arguments[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = new Array(arguments.length);\n        for (var i = 0; i < objects.length; i++) {\n          objects[i] = arguments[i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$1.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var adt = Adt.generate([\n      { strict: [] },\n      { defaultedThunk: ['fallbackThunk'] },\n      { asOption: [] },\n      { asDefaultedOptionThunk: ['fallbackThunk'] },\n      { mergeWithThunk: ['baseThunk'] }\n    ]);\n    var defaulted = function (fallback) {\n      return adt.defaultedThunk(constant(fallback));\n    };\n    var mergeWith = function (base) {\n      return adt.mergeWithThunk(constant(base));\n    };\n    var strict = adt.strict;\n    var asOption = adt.asOption;\n    var defaultedThunk = adt.defaultedThunk;\n    var asDefaultedOptionThunk = adt.asDefaultedOptionThunk;\n    var mergeWithThunk = adt.mergeWithThunk;\n\n    var comparison = Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var partition$2 = function (results) {\n      var errors = [];\n      var values = [];\n      each(results, function (result) {\n        result.fold(function (err) {\n          errors.push(err);\n        }, function (value) {\n          values.push(value);\n        });\n      });\n      return {\n        errors: errors,\n        values: values\n      };\n    };\n\n    var exclude = function (obj, fields) {\n      var r = {};\n      each$1(obj, function (v, k) {\n        if (!contains(fields, k)) {\n          r[k] = v;\n        }\n      });\n      return r;\n    };\n\n    var wrap = function (key, value) {\n      var _a;\n      return _a = {}, _a[key] = value, _a;\n    };\n    var wrapAll = function (keyvalues) {\n      var r = {};\n      each(keyvalues, function (kv) {\n        r[kv.key] = kv.value;\n      });\n      return r;\n    };\n\n    var exclude$1 = function (obj, fields) {\n      return exclude(obj, fields);\n    };\n    var wrap$1 = function (key, value) {\n      return wrap(key, value);\n    };\n    var wrapAll$1 = function (keyvalues) {\n      return wrapAll(keyvalues);\n    };\n    var mergeValues = function (values, base) {\n      return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge.apply(undefined, values)));\n    };\n    var mergeErrors = function (errors) {\n      return Result.error(flatten(errors));\n    };\n    var consolidate = function (objs, base) {\n      var partitions = partition$2(objs);\n      return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n    };\n\n    var mergeValues$1 = function (values, base) {\n      return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge.apply(undefined, values))) : SimpleResult.svalue(base);\n    };\n    var mergeErrors$1 = function (errors) {\n      return compose(SimpleResult.serror, flatten)(errors);\n    };\n    var consolidateObj = function (objects, base) {\n      var partition = SimpleResult.partition(objects);\n      return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n    };\n    var consolidateArr = function (objects) {\n      var partitions = SimpleResult.partition(objects);\n      return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n    };\n    var ResultCombine = {\n      consolidateObj: consolidateObj,\n      consolidateArr: consolidateArr\n    };\n\n    var formatObj = function (input) {\n      return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n    };\n    var formatErrors = function (errors) {\n      var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n          path: [],\n          getErrorInfo: function () {\n            return '... (only showing first ten failures)';\n          }\n        }]) : errors;\n      return map(es, function (e) {\n        return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n      });\n    };\n\n    var nu = function (path, getErrorInfo) {\n      return SimpleResult.serror([{\n          path: path,\n          getErrorInfo: getErrorInfo\n        }]);\n    };\n    var missingStrict = function (path, key, obj) {\n      return nu(path, function () {\n        return 'Could not find valid *strict* value for \"' + key + '\" in ' + formatObj(obj);\n      });\n    };\n    var missingKey = function (path, key) {\n      return nu(path, function () {\n        return 'Choice schema did not contain choice key: \"' + key + '\"';\n      });\n    };\n    var missingBranch = function (path, branches, branch) {\n      return nu(path, function () {\n        return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n      });\n    };\n    var unsupportedFields = function (path, unsupported) {\n      return nu(path, function () {\n        return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n      });\n    };\n    var custom = function (path, err) {\n      return nu(path, function () {\n        return err;\n      });\n    };\n\n    var adt$1 = Adt.generate([\n      {\n        field: [\n          'key',\n          'okey',\n          'presence',\n          'prop'\n        ]\n      },\n      {\n        state: [\n          'okey',\n          'instantiator'\n        ]\n      }\n    ]);\n    var strictAccess = function (path, obj, key) {\n      return get(obj, key).fold(function () {\n        return missingStrict(path, key, obj);\n      }, SimpleResult.svalue);\n    };\n    var fallbackAccess = function (obj, key, fallbackThunk) {\n      var v = get(obj, key).fold(function () {\n        return fallbackThunk(obj);\n      }, identity);\n      return SimpleResult.svalue(v);\n    };\n    var optionAccess = function (obj, key) {\n      return SimpleResult.svalue(get(obj, key));\n    };\n    var optionDefaultedAccess = function (obj, key, fallback) {\n      var opt = get(obj, key).map(function (val) {\n        return val === true ? fallback(obj) : val;\n      });\n      return SimpleResult.svalue(opt);\n    };\n    var cExtractOne = function (path, obj, field, strength) {\n      return field.fold(function (key, okey, presence, prop) {\n        var bundle = function (av) {\n          var result = prop.extract(path.concat([key]), strength, av);\n          return SimpleResult.map(result, function (res) {\n            return wrap(okey, strength(res));\n          });\n        };\n        var bundleAsOption = function (optValue) {\n          return optValue.fold(function () {\n            var outcome = wrap(okey, strength(Optional.none()));\n            return SimpleResult.svalue(outcome);\n          }, function (ov) {\n            var result = prop.extract(path.concat([key]), strength, ov);\n            return SimpleResult.map(result, function (res) {\n              return wrap(okey, strength(Optional.some(res)));\n            });\n          });\n        };\n        return function () {\n          return presence.fold(function () {\n            return SimpleResult.bind(strictAccess(path, obj, key), bundle);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(fallbackAccess(obj, key, fallbackThunk), bundle);\n          }, function () {\n            return SimpleResult.bind(optionAccess(obj, key), bundleAsOption);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(optionDefaultedAccess(obj, key, fallbackThunk), bundleAsOption);\n          }, function (baseThunk) {\n            var base = baseThunk(obj);\n            var result = SimpleResult.map(fallbackAccess(obj, key, constant({})), function (v) {\n              return deepMerge(base, v);\n            });\n            return SimpleResult.bind(result, bundle);\n          });\n        }();\n      }, function (okey, instantiator) {\n        var state = instantiator(obj);\n        return SimpleResult.svalue(wrap(okey, strength(state)));\n      });\n    };\n    var cExtract = function (path, obj, fields, strength) {\n      var results = map(fields, function (field) {\n        return cExtractOne(path, obj, field, strength);\n      });\n      return ResultCombine.consolidateObj(results, {});\n    };\n    var valueThunk = function (getDelegate) {\n      var extract = function (path, strength, val) {\n        return getDelegate().extract(path, strength, val);\n      };\n      var toString = function () {\n        return getDelegate().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var value$1 = function (validator) {\n      var extract = function (path, strength, val) {\n        return SimpleResult.bindError(validator(val, strength), function (err) {\n          return custom(path, err);\n        });\n      };\n      var toString = function () {\n        return 'val';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var getSetKeys = function (obj) {\n      return keys(filter$1(obj, function (value) {\n        return value !== undefined && value !== null;\n      }));\n    };\n    var objOfOnly = function (fields) {\n      var delegate = objOf(fields);\n      var fieldNames = foldr(fields, function (acc, f) {\n        return f.fold(function (key) {\n          return deepMerge(acc, wrap$1(key, true));\n        }, constant(acc));\n      }, {});\n      var extract = function (path, strength, o) {\n        var keys = isBoolean(o) ? [] : getSetKeys(o);\n        var extra = filter(keys, function (k) {\n          return !hasNonNullableKey(fieldNames, k);\n        });\n        return extra.length === 0 ? delegate.extract(path, strength, o) : unsupportedFields(path, extra);\n      };\n      return {\n        extract: extract,\n        toString: delegate.toString\n      };\n    };\n    var objOf = function (fields) {\n      var extract = function (path, strength, o) {\n        return cExtract(path, o, fields, strength);\n      };\n      var toString = function () {\n        var fieldStrings = map(fields, function (field) {\n          return field.fold(function (key, okey, presence, prop) {\n            return key + ' -> ' + prop.toString();\n          }, function (okey, _instantiator) {\n            return 'state(' + okey + ')';\n          });\n        });\n        return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var arrOf = function (prop) {\n      var extract = function (path, strength, array) {\n        var results = map(array, function (a, i) {\n          return prop.extract(path.concat(['[' + i + ']']), strength, a);\n        });\n        return ResultCombine.consolidateArr(results);\n      };\n      var toString = function () {\n        return 'array(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var oneOf = function (props) {\n      var extract = function (path, strength, val) {\n        var errors = [];\n        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n          var prop = props_1[_i];\n          var res = prop.extract(path, strength, val);\n          if (res.stype === SimpleResultType.Value) {\n            return res;\n          }\n          errors.push(res);\n        }\n        return ResultCombine.consolidateArr(errors);\n      };\n      var toString = function () {\n        return 'oneOf(' + map(props, function (prop) {\n          return prop.toString();\n        }).join(', ') + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var setOf = function (validator, prop) {\n      var validateKeys = function (path, keys) {\n        return arrOf(value$1(validator)).extract(path, identity, keys);\n      };\n      var extract = function (path, strength, o) {\n        var keys$1 = keys(o);\n        var validatedKeys = validateKeys(path, keys$1);\n        return SimpleResult.bind(validatedKeys, function (validKeys) {\n          var schema = map(validKeys, function (vk) {\n            return adt$1.field(vk, vk, strict(), prop);\n          });\n          return objOf(schema).extract(path, strength, o);\n        });\n      };\n      var toString = function () {\n        return 'setOf(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var thunk = function (desc, processor) {\n      var getP = cached(function () {\n        return processor();\n      });\n      var extract = function (path, strength, val) {\n        return getP().extract(path, strength, val);\n      };\n      var toString = function () {\n        return getP().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var anyValue = constant(value$1(SimpleResult.svalue));\n    var arrOfObj = compose(arrOf, objOf);\n    var state = adt$1.state;\n    var field = adt$1.field;\n\n    var chooseFrom = function (path, strength, input, branches, ch) {\n      var fields = get(branches, ch);\n      return fields.fold(function () {\n        return missingBranch(path, branches, ch);\n      }, function (vp) {\n        return vp.extract(path.concat(['branch: ' + ch]), strength, input);\n      });\n    };\n    var choose = function (key, branches) {\n      var extract = function (path, strength, input) {\n        var choice = get(input, key);\n        return choice.fold(function () {\n          return missingKey(path, key);\n        }, function (chosen) {\n          return chooseFrom(path, strength, input, branches, chosen);\n        });\n      };\n      var toString = function () {\n        return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n\n    var _anyValue = value$1(SimpleResult.svalue);\n    var arrOfObj$1 = function (objFields) {\n      return arrOfObj(objFields);\n    };\n    var arrOfVal = function () {\n      return arrOf(_anyValue);\n    };\n    var valueThunkOf = valueThunk;\n    var valueOf = function (validator) {\n      return value$1(function (v) {\n        return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n      });\n    };\n    var setOf$1 = function (validator, prop) {\n      return setOf(function (v) {\n        return SimpleResult.fromResult(validator(v));\n      }, prop);\n    };\n    var extract = function (label, prop, strength, obj) {\n      var res = prop.extract([label], strength, obj);\n      return SimpleResult.mapError(res, function (errs) {\n        return {\n          input: obj,\n          errors: errs\n        };\n      });\n    };\n    var asRaw = function (label, prop, obj) {\n      return SimpleResult.toResult(extract(label, prop, identity, obj));\n    };\n    var getOrDie = function (extraction) {\n      return extraction.fold(function (errInfo) {\n        throw new Error(formatError(errInfo));\n      }, identity);\n    };\n    var asRawOrDie = function (label, prop, obj) {\n      return getOrDie(asRaw(label, prop, obj));\n    };\n    var formatError = function (errInfo) {\n      return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n    };\n    var chooseProcessor = function (key, branches) {\n      return choose(key, branches);\n    };\n    var choose$1 = function (key, branches) {\n      return choose(key, map$2(branches, objOf));\n    };\n    var thunkOf = function (desc, schema) {\n      return thunk(desc, schema);\n    };\n    var anyValue$1 = constant(_anyValue);\n    var typedValue = function (validator, expectedType) {\n      return value$1(function (a) {\n        var actualType = typeof a;\n        return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n      });\n    };\n    var number = typedValue(isNumber, 'number');\n    var string = typedValue(isString, 'string');\n    var boolean = typedValue(isBoolean, 'boolean');\n    var functionProcessor = typedValue(isFunction, 'function');\n    var isPostMessageable = function (val) {\n      var every = function (iter, callbackFn) {\n        var result = iter.next();\n        while (!result.done) {\n          if (!callbackFn(result.value)) {\n            return false;\n          }\n          result = iter.next();\n        }\n        return true;\n      };\n      if (Object(val) !== val) {\n        return true;\n      }\n      switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n      case 'Map':\n        return every(val.keys(), isPostMessageable) && every(val.values(), isPostMessageable);\n      case 'Set':\n        return every(val.keys(), isPostMessageable);\n      default:\n        return false;\n      }\n    };\n    var postMessageable = value$1(function (a) {\n      return isPostMessageable(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n    });\n\n    var validateEnum = function (values) {\n      return valueOf(function (value) {\n        return contains(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n      });\n    };\n    var strict$1 = function (key) {\n      return field(key, key, strict(), anyValue());\n    };\n    var strictOf = function (key, schema) {\n      return field(key, key, strict(), schema);\n    };\n    var strictNumber = function (key) {\n      return strictOf(key, number);\n    };\n    var strictString = function (key) {\n      return strictOf(key, string);\n    };\n    var strictStringEnum = function (key, values) {\n      return field(key, key, strict(), validateEnum(values));\n    };\n    var strictBoolean = function (key) {\n      return strictOf(key, boolean);\n    };\n    var strictFunction = function (key) {\n      return strictOf(key, functionProcessor);\n    };\n    var forbid = function (key, message) {\n      return field(key, key, asOption(), value$1(function (_v) {\n        return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n      }));\n    };\n    var strictObjOf = function (key, objSchema) {\n      return field(key, key, strict(), objOf(objSchema));\n    };\n    var strictArrayOfObj = function (key, objFields) {\n      return field(key, key, strict(), arrOfObj(objFields));\n    };\n    var strictArrayOf = function (key, schema) {\n      return field(key, key, strict(), arrOf(schema));\n    };\n    var option = function (key) {\n      return field(key, key, asOption(), anyValue());\n    };\n    var optionOf = function (key, schema) {\n      return field(key, key, asOption(), schema);\n    };\n    var optionNumber = function (key) {\n      return optionOf(key, number);\n    };\n    var optionString = function (key) {\n      return optionOf(key, string);\n    };\n    var optionFunction = function (key) {\n      return optionOf(key, functionProcessor);\n    };\n    var optionArrayOf = function (key, schema) {\n      return optionOf(key, arrOf(schema));\n    };\n    var optionObjOf = function (key, objSchema) {\n      return optionOf(key, objOf(objSchema));\n    };\n    var optionObjOfOnly = function (key, objSchema) {\n      return optionOf(key, objOfOnly(objSchema));\n    };\n    var defaulted$1 = function (key, fallback) {\n      return field(key, key, defaulted(fallback), anyValue());\n    };\n    var defaultedOf = function (key, fallback, schema) {\n      return field(key, key, defaulted(fallback), schema);\n    };\n    var defaultedNumber = function (key, fallback) {\n      return defaultedOf(key, fallback, number);\n    };\n    var defaultedString = function (key, fallback) {\n      return defaultedOf(key, fallback, string);\n    };\n    var defaultedStringEnum = function (key, fallback, values) {\n      return defaultedOf(key, fallback, validateEnum(values));\n    };\n    var defaultedBoolean = function (key, fallback) {\n      return defaultedOf(key, fallback, boolean);\n    };\n    var defaultedFunction = function (key, fallback) {\n      return defaultedOf(key, fallback, functionProcessor);\n    };\n    var defaultedPostMsg = function (key, fallback) {\n      return defaultedOf(key, fallback, postMessageable);\n    };\n    var defaultedArrayOf = function (key, fallback, schema) {\n      return defaultedOf(key, fallback, arrOf(schema));\n    };\n    var defaultedObjOf = function (key, fallback, objSchema) {\n      return defaultedOf(key, fallback, objOf(objSchema));\n    };\n    var state$1 = function (okey, instantiator) {\n      return state(okey, instantiator);\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$2 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$1(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$2(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu$1(0, 0);\n    };\n    var nu$1 = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$1,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$2,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$3({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$3 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$3,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$1 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$2 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n      });\n    };\n\n    var isSource = function (component, simulatedEvent) {\n      return eq$1(component.element, simulatedEvent.event.target);\n    };\n\n    var nu$4 = function (parts) {\n      if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n        throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n      }\n      return asRawOrDie('Extracting event.handler', objOfOnly([\n        defaulted$1('can', always),\n        defaulted$1('abort', never),\n        defaulted$1('run', noop)\n      ]), parts);\n    };\n    var all$1 = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc && f(handler).apply(undefined, args);\n        }, true);\n      };\n    };\n    var any = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc || f(handler).apply(undefined, args);\n        }, false);\n      };\n    };\n    var read = function (handler) {\n      return isFunction(handler) ? {\n        can: constant(true),\n        abort: constant(false),\n        run: handler\n      } : handler;\n    };\n    var fuse = function (handlers) {\n      var can = all$1(handlers, function (handler) {\n        return handler.can;\n      });\n      var abort = any(handlers, function (handler) {\n        return handler.abort;\n      });\n      var run = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        each(handlers, function (handler) {\n          handler.run.apply(undefined, args);\n        });\n      };\n      return nu$4({\n        can: can,\n        abort: abort,\n        run: run\n      });\n    };\n\n    var constant$1 = constant;\n    var touchstart = constant$1('touchstart');\n    var touchmove = constant$1('touchmove');\n    var touchend = constant$1('touchend');\n    var touchcancel = constant$1('touchcancel');\n    var mousedown = constant$1('mousedown');\n    var mousemove = constant$1('mousemove');\n    var mouseout = constant$1('mouseout');\n    var mouseup = constant$1('mouseup');\n    var mouseover = constant$1('mouseover');\n    var focusin = constant$1('focusin');\n    var focusout = constant$1('focusout');\n    var keydown = constant$1('keydown');\n    var keyup = constant$1('keyup');\n    var input = constant$1('input');\n    var change = constant$1('change');\n    var click = constant$1('click');\n    var transitionend = constant$1('transitionend');\n    var selectstart = constant$1('selectstart');\n\n    var prefixName = function (name) {\n      return constant('alloy.' + name);\n    };\n    var alloy = { tap: prefixName('tap') };\n    var focus = prefixName('focus');\n    var postBlur = prefixName('blur.post');\n    var postPaste = prefixName('paste.post');\n    var receive = prefixName('receive');\n    var execute = prefixName('execute');\n    var focusItem = prefixName('focus.item');\n    var tap = alloy.tap;\n    var longpress = prefixName('longpress');\n    var sandboxClose = prefixName('sandbox.close');\n    var typeaheadCancel = prefixName('typeahead.cancel');\n    var systemInit = prefixName('system.init');\n    var documentTouchmove = prefixName('system.touchmove');\n    var documentTouchend = prefixName('system.touchend');\n    var windowScroll = prefixName('system.scroll');\n    var windowResize = prefixName('system.resize');\n    var attachedToDom = prefixName('system.attached');\n    var detachedFromDom = prefixName('system.detached');\n    var dismissRequested = prefixName('system.dismissRequested');\n    var repositionRequested = prefixName('system.repositionRequested');\n    var focusShifted = prefixName('focusmanager.shifted');\n    var slotVisibility = prefixName('slotcontainer.visibility');\n    var changeTab = prefixName('change.tab');\n    var dismissTab = prefixName('dismiss.tab');\n    var highlight = prefixName('highlight');\n    var dehighlight = prefixName('dehighlight');\n\n    var emit = function (component, event) {\n      dispatchWith(component, component.element, event, {});\n    };\n    var emitWith = function (component, event, properties) {\n      dispatchWith(component, component.element, event, properties);\n    };\n    var emitExecute = function (component) {\n      emit(component, execute());\n    };\n    var dispatch = function (component, target, event) {\n      dispatchWith(component, target, event, {});\n    };\n    var dispatchWith = function (component, target, event, properties) {\n      var data = __assign({ target: target }, properties);\n      component.getSystem().triggerEvent(event, target, data);\n    };\n    var dispatchEvent = function (component, target, event, simulatedEvent) {\n      component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n    };\n\n    var derive = function (configs) {\n      return wrapAll$1(configs);\n    };\n    var abort = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ abort: predicate })\n      };\n    };\n    var can = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ can: predicate })\n      };\n    };\n    var preventDefault = function (name) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            simulatedEvent.event.prevent();\n          }\n        })\n      };\n    };\n    var run = function (name, handler) {\n      return {\n        key: name,\n        value: nu$4({ run: handler })\n      };\n    };\n    var runActionExtra = function (name, action, extra) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            action.apply(undefined, [\n              component,\n              simulatedEvent\n            ].concat(extra));\n          }\n        })\n      };\n    };\n    var runOnName = function (name) {\n      return function (handler) {\n        return run(name, handler);\n      };\n    };\n    var runOnSourceName = function (name) {\n      return function (handler) {\n        return {\n          key: name,\n          value: nu$4({\n            run: function (component, simulatedEvent) {\n              if (isSource(component, simulatedEvent)) {\n                handler(component, simulatedEvent);\n              }\n            }\n          })\n        };\n      };\n    };\n    var redirectToUid = function (name, uid) {\n      return run(name, function (component, simulatedEvent) {\n        component.getSystem().getByUid(uid).each(function (redirectee) {\n          dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n        });\n      });\n    };\n    var redirectToPart = function (name, detail, partName) {\n      var uid = detail.partUids[partName];\n      return redirectToUid(name, uid);\n    };\n    var runWithTarget = function (name, f) {\n      return run(name, function (component, simulatedEvent) {\n        var ev = simulatedEvent.event;\n        var target = component.getSystem().getByDom(ev.target).fold(function () {\n          var closest$1 = closest(ev.target, function (el) {\n            return component.getSystem().getByDom(el).toOptional();\n          }, never);\n          return closest$1.getOr(component);\n        }, function (c) {\n          return c;\n        });\n        f(component, target, simulatedEvent);\n      });\n    };\n    var cutter = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.cut();\n      });\n    };\n    var stopper = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.stop();\n      });\n    };\n    var runOnSource = function (name, f) {\n      return runOnSourceName(name)(f);\n    };\n    var runOnAttached = runOnSourceName(attachedToDom());\n    var runOnDetached = runOnSourceName(detachedFromDom());\n    var runOnInit = runOnSourceName(systemInit());\n    var runOnExecute = runOnName(execute());\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n    var isDocument = isType$1(DOCUMENT);\n    var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parentNode = function (element) {\n      return parent(element);\n    };\n    var offsetParent = function (element) {\n      return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var appendAt = function (parent, element, index) {\n      child(parent, index).fold(function () {\n        append(parent, element);\n      }, function (v) {\n        before(v, element);\n      });\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n\n    var get$1 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n    var getOuter = function (element) {\n      var container = SugarElement.fromTag('div');\n      var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n      append(container, clone);\n      return get$1(container);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set$1 = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$2 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$2(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n\n    var clone = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow$1 = function (original) {\n      return clone(original, false);\n    };\n\n    var getHtml = function (element) {\n      var clone = shallow$1(element);\n      return getOuter(clone);\n    };\n\n    var element = function (elem) {\n      return getHtml(elem);\n    };\n\n    var isRecursive = function (component, originator, target) {\n      return eq$1(originator, component.element) && !eq$1(originator, target);\n    };\n    var events = derive([can(focus(), function (component, simulatedEvent) {\n        var event = simulatedEvent.event;\n        var originator = event.originator;\n        var target = event.target;\n        if (isRecursive(component, originator, target)) {\n          console.warn(focus() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus() + ' event handlers');\n          return false;\n        } else {\n          return true;\n        }\n      })]);\n\n    var DefaultEvents = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events\n    });\n\n    var unique = 0;\n    var generate$1 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var prefix = constant('alloy-id-');\n    var idAttr = constant('data-alloy-id');\n\n    var prefix$1 = prefix();\n    var idAttr$1 = idAttr();\n    var write = function (label, elem) {\n      var id = generate$1(prefix$1 + label);\n      writeOnly(elem, id);\n      return id;\n    };\n    var writeOnly = function (elem, uid) {\n      Object.defineProperty(elem.dom, idAttr$1, {\n        value: uid,\n        writable: true\n      });\n    };\n    var read$1 = function (elem) {\n      var id = isElement(elem) ? elem.dom[idAttr$1] : null;\n      return Optional.from(id);\n    };\n    var generate$2 = function (prefix) {\n      return generate$1(prefix);\n    };\n\n    var make = identity;\n\n    var NoContextApi = function (getComp) {\n      var fail = function (event) {\n        return function () {\n          throw new Error('The component must be in a context to send: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : ''));\n        };\n      };\n      return {\n        debugInfo: constant('fake'),\n        triggerEvent: fail('triggerEvent'),\n        triggerFocus: fail('triggerFocus'),\n        triggerEscape: fail('triggerEscape'),\n        build: fail('build'),\n        addToWorld: fail('addToWorld'),\n        removeFromWorld: fail('removeFromWorld'),\n        addToGui: fail('addToGui'),\n        removeFromGui: fail('removeFromGui'),\n        getByUid: fail('getByUid'),\n        getByDom: fail('getByDom'),\n        broadcast: fail('broadcast'),\n        broadcastOn: fail('broadcastOn'),\n        broadcastEvent: fail('broadcastEvent'),\n        isConnected: never\n      };\n    };\n    var singleton = NoContextApi();\n\n    var markAsBehaviourApi = function (f, apiName, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: apiName,\n          parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n        };\n      };\n      return f;\n    };\n    var cleanParameters = function (parameters) {\n      return map(parameters, function (p) {\n        return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n      });\n    };\n    var markAsExtraApi = function (f, extraName) {\n      var delegate = f.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: extraName,\n          parameters: cleanParameters(parameters)\n        };\n      };\n      return f;\n    };\n    var markAsSketchApi = function (f, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: 'OVERRIDE',\n          parameters: cleanParameters(parameters.slice(1))\n        };\n      };\n      return f;\n    };\n\n    var premadeTag = generate$1('alloy-premade');\n    var premade = function (comp) {\n      return wrap$1(premadeTag, comp);\n    };\n    var getPremade = function (spec) {\n      return get(spec, premadeTag);\n    };\n    var makeApi = function (f) {\n      return markAsSketchApi(function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        return f.apply(void 0, __spreadArrays([\n          component.getApis(),\n          component\n        ], rest));\n      }, f);\n    };\n\n    var NoState = {\n      init: function () {\n        return nu$5({\n          readState: function () {\n            return 'No State required';\n          }\n        });\n      }\n    };\n    var nu$5 = function (spec) {\n      return spec;\n    };\n\n    var generateFrom = function (spec, all) {\n      var schema = map(all, function (a) {\n        return optionObjOf(a.name(), [\n          strict$1('config'),\n          defaulted$1('state', NoState)\n        ]);\n      });\n      var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n        throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n      }, function (v) {\n        return v;\n      });\n      return {\n        list: all,\n        data: map$2(validated, function (optBlobThunk) {\n          var output = optBlobThunk.map(function (blob) {\n            return {\n              config: blob.config,\n              state: blob.state.init(blob.config)\n            };\n          });\n          return function () {\n            return output;\n          };\n        })\n      };\n    };\n    var getBehaviours = function (bData) {\n      return bData.list;\n    };\n    var getData = function (bData) {\n      return bData.data;\n    };\n\n    var byInnerKey = function (data, tuple) {\n      var r = {};\n      each$1(data, function (detail, key) {\n        each$1(detail, function (value, indexKey) {\n          var chain = get(r, indexKey).getOr([]);\n          r[indexKey] = chain.concat([tuple(key, value)]);\n        });\n      });\n      return r;\n    };\n\n    var nu$6 = function (s) {\n      return {\n        classes: s.classes !== undefined ? s.classes : [],\n        attributes: s.attributes !== undefined ? s.attributes : {},\n        styles: s.styles !== undefined ? s.styles : {}\n      };\n    };\n    var merge$1 = function (defnA, mod) {\n      return __assign(__assign({}, defnA), {\n        attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n        styles: __assign(__assign({}, defnA.styles), mod.styles),\n        classes: defnA.classes.concat(mod.classes)\n      });\n    };\n\n    var combine = function (info, baseMod, behaviours, base) {\n      var modsByBehaviour = __assign({}, baseMod);\n      each(behaviours, function (behaviour) {\n        modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n      });\n      var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n        return {\n          name: name,\n          modification: modification\n        };\n      });\n      var combineObjects = function (objects) {\n        return foldr(objects, function (b, a) {\n          return __assign(__assign({}, a.modification), b);\n        }, {});\n      };\n      var combinedClasses = foldr(byAspect.classes, function (b, a) {\n        return a.modification.concat(b);\n      }, []);\n      var combinedAttributes = combineObjects(byAspect.attributes);\n      var combinedStyles = combineObjects(byAspect.styles);\n      return nu$6({\n        classes: combinedClasses,\n        attributes: combinedAttributes,\n        styles: combinedStyles\n      });\n    };\n\n    var sortKeys = function (label, keyName, array, order) {\n      try {\n        var sorted = sort(array, function (a, b) {\n          var aKey = a[keyName];\n          var bKey = b[keyName];\n          var aIndex = order.indexOf(aKey);\n          var bIndex = order.indexOf(bKey);\n          if (aIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (bIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (aIndex < bIndex) {\n            return -1;\n          } else if (bIndex < aIndex) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n        return Result.value(sorted);\n      } catch (err) {\n        return Result.error([err]);\n      }\n    };\n\n    var uncurried = function (handler, purpose) {\n      return {\n        handler: handler,\n        purpose: purpose\n      };\n    };\n    var curried = function (handler, purpose) {\n      return {\n        cHandler: handler,\n        purpose: purpose\n      };\n    };\n    var curryArgs = function (descHandler, extraArgs) {\n      return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n    };\n    var getCurried = function (descHandler) {\n      return descHandler.cHandler;\n    };\n\n    var behaviourTuple = function (name, handler) {\n      return {\n        name: name,\n        handler: handler\n      };\n    };\n    var nameToHandlers = function (behaviours, info) {\n      var r = {};\n      each(behaviours, function (behaviour) {\n        r[behaviour.name()] = behaviour.handlers(info);\n      });\n      return r;\n    };\n    var groupByEvents = function (info, behaviours, base) {\n      var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n      return byInnerKey(behaviourEvents, behaviourTuple);\n    };\n    var combine$1 = function (info, eventOrder, behaviours, base) {\n      var byEventName = groupByEvents(info, behaviours, base);\n      return combineGroups(byEventName, eventOrder);\n    };\n    var assemble = function (rawHandler) {\n      var handler = read(rawHandler);\n      return function (component, simulatedEvent) {\n        var rest = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n          rest[_i - 2] = arguments[_i];\n        }\n        var args = [\n          component,\n          simulatedEvent\n        ].concat(rest);\n        if (handler.abort.apply(undefined, args)) {\n          simulatedEvent.stop();\n        } else if (handler.can.apply(undefined, args)) {\n          handler.run.apply(undefined, args);\n        }\n      };\n    };\n    var missingOrderError = function (eventName, tuples) {\n      return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map(tuples, function (c) {\n          return c.name;\n        }), null, 2)]);\n    };\n    var fuse$1 = function (tuples, eventOrder, eventName) {\n      var order = eventOrder[eventName];\n      if (!order) {\n        return missingOrderError(eventName, tuples);\n      } else {\n        return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n          var handlers = map(sortedTuples, function (tuple) {\n            return tuple.handler;\n          });\n          return fuse(handlers);\n        });\n      }\n    };\n    var combineGroups = function (byEventName, eventOrder) {\n      var r = mapToArray(byEventName, function (tuples, eventName) {\n        var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse$1(tuples, eventOrder, eventName);\n        return combined.map(function (handler) {\n          var assembled = assemble(handler);\n          var purpose = tuples.length > 1 ? filter(eventOrder[eventName], function (o) {\n            return exists(tuples, function (t) {\n              return t.name === o;\n            });\n          }).join(' > ') : tuples[0].name;\n          return wrap$1(eventName, uncurried(assembled, purpose));\n        });\n      });\n      return consolidate(r, {});\n    };\n\n    var baseBehaviour = 'alloy.base.behaviour';\n    var toInfo = function (spec) {\n      var _a;\n      return asRaw('custom.definition', objOf([\n        field('dom', 'dom', strict(), objOf([\n          strict$1('tag'),\n          defaulted$1('styles', {}),\n          defaulted$1('classes', []),\n          defaulted$1('attributes', {}),\n          option('value'),\n          option('innerHtml')\n        ])),\n        strict$1('components'),\n        strict$1('uid'),\n        defaulted$1('events', {}),\n        defaulted$1('apis', {}),\n        field('eventOrder', 'eventOrder', mergeWith((_a = {}, _a[execute()] = [\n          'disabling',\n          baseBehaviour,\n          'toggling',\n          'typeaheadevents'\n        ], _a[focus()] = [\n          baseBehaviour,\n          'focusing',\n          'keying'\n        ], _a[systemInit()] = [\n          baseBehaviour,\n          'disabling',\n          'toggling',\n          'representing'\n        ], _a[input()] = [\n          baseBehaviour,\n          'representing',\n          'streaming',\n          'invalidating'\n        ], _a[detachedFromDom()] = [\n          baseBehaviour,\n          'representing',\n          'item-events',\n          'tooltipping'\n        ], _a[mousedown()] = [\n          'focusing',\n          baseBehaviour,\n          'item-type-events'\n        ], _a[touchstart()] = [\n          'focusing',\n          baseBehaviour,\n          'item-type-events'\n        ], _a[mouseover()] = [\n          'item-type-events',\n          'tooltipping'\n        ], _a[receive()] = [\n          'receiving',\n          'reflecting',\n          'tooltipping'\n        ], _a)), anyValue$1()),\n        option('domModification')\n      ]), spec);\n    };\n    var toDefinition = function (detail) {\n      return __assign(__assign({}, detail.dom), {\n        uid: detail.uid,\n        domChildren: map(detail.components, function (comp) {\n          return comp.element;\n        })\n      });\n    };\n    var toModification = function (detail) {\n      return detail.domModification.fold(function () {\n        return nu$6({});\n      }, nu$6);\n    };\n    var toEvents = function (info) {\n      return info.events;\n    };\n\n    var read$2 = function (element, attr) {\n      var value = get$2(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read$2(element, attr);\n      var nu = old.concat([id]);\n      set$1(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read$2(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set$1(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$3 = function (element) {\n      return read$2(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$3(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var add$3 = function (element, classes) {\n      each(classes, function (x) {\n        add$2(element, x);\n      });\n    };\n    var remove$5 = function (element, classes) {\n      each(classes, function (x) {\n        remove$4(element, x);\n      });\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported$1 = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getContentContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported$1() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n    var body = function () {\n      return getBody(SugarElement.fromDom(document));\n    };\n    var getBody = function (doc) {\n      var b = doc.dom.body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$2 = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var setOptions = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        v.fold(function () {\n          internalRemove(dom, k);\n        }, function (value) {\n          internalSet(dom, k, value);\n        });\n      });\n    };\n    var get$4 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var isValidValue = function (tag, property, value) {\n      var element = SugarElement.fromTag(tag);\n      set$2(element, property, value);\n      var style = getRaw(element, property);\n      return style.isSome();\n    };\n    var remove$6 = function (element, property) {\n      var dom = element.dom;\n      internalRemove(dom, property);\n      if (getOpt(element, 'style').map(trim).is('')) {\n        remove$1(element, 'style');\n      }\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var get$5 = function (element) {\n      return element.dom.value;\n    };\n    var set$3 = function (element, value) {\n      if (value === undefined) {\n        throw new Error('Value.set was undefined');\n      }\n      element.dom.value = value;\n    };\n\n    var renderToDom = function (definition) {\n      var subject = SugarElement.fromTag(definition.tag);\n      setAll(subject, definition.attributes);\n      add$3(subject, definition.classes);\n      setAll$1(subject, definition.styles);\n      definition.innerHtml.each(function (html) {\n        return set(subject, html);\n      });\n      var children = definition.domChildren;\n      append$1(subject, children);\n      definition.value.each(function (value) {\n        set$3(subject, value);\n      });\n      if (!definition.uid) {\n        debugger;\n      }\n      writeOnly(subject, definition.uid);\n      return subject;\n    };\n\n    var getBehaviours$1 = function (spec) {\n      var behaviours = get(spec, 'behaviours').getOr({});\n      var keys$1 = filter(keys(behaviours), function (k) {\n        return behaviours[k] !== undefined;\n      });\n      return map(keys$1, function (k) {\n        return behaviours[k].me;\n      });\n    };\n    var generateFrom$1 = function (spec, all) {\n      return generateFrom(spec, all);\n    };\n    var generate$3 = function (spec) {\n      var all = getBehaviours$1(spec);\n      return generateFrom$1(spec, all);\n    };\n\n    var getDomDefinition = function (info, bList, bData) {\n      var definition = toDefinition(info);\n      var infoModification = toModification(info);\n      var baseModification = { 'alloy.base.modification': infoModification };\n      var modification = bList.length > 0 ? combine(bData, baseModification, bList, definition) : infoModification;\n      return merge$1(definition, modification);\n    };\n    var getEvents = function (info, bList, bData) {\n      var baseEvents = { 'alloy.base.behaviour': toEvents(info) };\n      return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n    };\n    var build = function (spec) {\n      var getMe = function () {\n        return me;\n      };\n      var systemApi = Cell(singleton);\n      var info = getOrDie(toInfo(spec));\n      var bBlob = generate$3(spec);\n      var bList = getBehaviours(bBlob);\n      var bData = getData(bBlob);\n      var modDefinition = getDomDefinition(info, bList, bData);\n      var item = renderToDom(modDefinition);\n      var events = getEvents(info, bList, bData);\n      var subcomponents = Cell(info.components);\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(getMe));\n      };\n      var syncComponents = function () {\n        var children$1 = children(item);\n        var subs = bind(children$1, function (child) {\n          return systemApi.get().getByDom(child).fold(function () {\n            return [];\n          }, function (c) {\n            return [c];\n          });\n        });\n        subcomponents.set(subs);\n      };\n      var config = function (behaviour) {\n        var b = bData;\n        var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n          throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n        };\n        return f();\n      };\n      var hasConfigured = function (behaviour) {\n        return isFunction(bData[behaviour.name()]);\n      };\n      var getApis = function () {\n        return info.apis;\n      };\n      var readState = function (behaviourName) {\n        return bData[behaviourName]().map(function (b) {\n          return b.state.readState();\n        }).getOr('not enabled');\n      };\n      var me = {\n        getSystem: systemApi.get,\n        config: config,\n        hasConfigured: hasConfigured,\n        spec: spec,\n        readState: readState,\n        getApis: getApis,\n        connect: connect,\n        disconnect: disconnect,\n        element: item,\n        syncComponents: syncComponents,\n        components: subcomponents.get,\n        events: events\n      };\n      return me;\n    };\n\n    var buildSubcomponents = function (spec) {\n      var components = get(spec, 'components').getOr([]);\n      return map(components, build$1);\n    };\n    var buildFromSpec = function (userSpec) {\n      var _a = make(userSpec), specEvents = _a.events, spec = __rest(_a, ['events']);\n      var components = buildSubcomponents(spec);\n      var completeSpec = __assign(__assign({}, spec), {\n        events: __assign(__assign({}, DefaultEvents), specEvents),\n        components: components\n      });\n      return Result.value(build(completeSpec));\n    };\n    var text = function (textContent) {\n      var element = SugarElement.fromText(textContent);\n      return external({ element: element });\n    };\n    var external = function (spec) {\n      var extSpec = asRawOrDie('external.component', objOfOnly([\n        strict$1('element'),\n        option('uid')\n      ]), spec);\n      var systemApi = Cell(NoContextApi());\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(function () {\n          return me;\n        }));\n      };\n      extSpec.uid.each(function (uid) {\n        writeOnly(extSpec.element, uid);\n      });\n      var me = {\n        getSystem: systemApi.get,\n        config: Optional.none,\n        hasConfigured: never,\n        connect: connect,\n        disconnect: disconnect,\n        getApis: function () {\n          return {};\n        },\n        element: extSpec.element,\n        spec: spec,\n        readState: constant('No state'),\n        syncComponents: noop,\n        components: constant([]),\n        events: {}\n      };\n      return premade(me);\n    };\n    var uids = generate$2;\n    var build$1 = function (spec) {\n      return getPremade(spec).fold(function () {\n        var userSpecWithUid = spec.hasOwnProperty('uid') ? spec : __assign({ uid: uids('') }, spec);\n        return buildFromSpec(userSpecWithUid).getOrDie();\n      }, function (prebuilt) {\n        return prebuilt;\n      });\n    };\n    var premade$1 = premade;\n\n    function Dimension (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$4(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$4(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    }\n\n    var api = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$6 = function (element) {\n      return api.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api.getOuter(element);\n    };\n    var setMax = function (element, value) {\n      var inclusions = [\n        'margin-top',\n        'border-top-width',\n        'padding-top',\n        'padding-bottom',\n        'border-bottom-width',\n        'margin-bottom'\n      ];\n      var absMax = api.max(element, value, inclusions);\n      set$2(element, 'max-height', absMax + 'px');\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var api$1 = Dimension('width', function (element) {\n      return element.dom.offsetWidth;\n    });\n    var set$4 = function (element, h) {\n      return api$1.set(element, h);\n    };\n    var get$7 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter$2 = function (element) {\n      return api$1.getOuter(element);\n    };\n    var setMax$1 = function (element, value) {\n      var inclusions = [\n        'margin-left',\n        'border-left-width',\n        'padding-left',\n        'padding-right',\n        'border-right-width',\n        'margin-right'\n      ];\n      var absMax = api$1.max(element, value, inclusions);\n      set$2(element, 'max-width', absMax + 'px');\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: target,\n        x: x,\n        y: y,\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: raw\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n      var stop = function () {\n        return rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        return rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (filter(rawEvent)) {\n          handler(fromRawEvent(rawEvent));\n        }\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom.addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$2 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var capture = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, true);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom.removeEventListener(event, handler, useCapture);\n    };\n\n    var get$8 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n\n    var get$9 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      return Optional.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$8(SugarElement.fromDom(doc));\n      return get$9(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      var paths = walkUp(navigation, d);\n      return Optional.some(paths);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner$1 = function (element) {\n      return owner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$3 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$8(doc);\n      var path = pathTo(element, Navigation);\n      return path.fold(curry(absolute, element), function (frames) {\n        var offset = viewport(element);\n        var r = foldr(frames, function (b, a) {\n          var loc = viewport(a);\n          return {\n            left: b.left + loc.left,\n            top: b.top + loc.top\n          };\n        }, {\n          left: 0,\n          top: 0\n        });\n        return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n      });\n    };\n\n    var pointed = function (point, width, height) {\n      return {\n        point: point,\n        width: width,\n        height: height\n      };\n    };\n    var rect = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      };\n    };\n    var bounds$1 = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var box = function (element) {\n      var xy = absolute(element);\n      var w = getOuter$2(element);\n      var h = getOuter$1(element);\n      return bounds$1(xy.left, xy.top, w, h);\n    };\n    var absolute$1 = function (element) {\n      var position = find$3(element);\n      var width = getOuter$2(element);\n      var height = getOuter$1(element);\n      return bounds$1(position.left, position.top, width, height);\n    };\n    var win = function () {\n      return getBounds(window);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      return is(scope, a) ? Optional.some(scope) : isFunction(isRoot) && isRoot(scope) ? Optional.none() : ancestor(scope, a, isRoot);\n    }\n\n    var ancestor$1 = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$1 = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = SugarElement.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Optional.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope.dom);\n    };\n\n    var closest$2 = function (scope, predicate, isRoot) {\n      return closest$1(scope, predicate, isRoot).isSome();\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$3 = function (scope, selector, isRoot) {\n      var is$1 = function (element, selector) {\n        return is(element, selector);\n      };\n      return ClosestOrAncestor(is$1, ancestor$2, scope, selector, isRoot);\n    };\n\n    var find$4 = function (queryElem) {\n      var dependent = closest$1(queryElem, function (elem) {\n        if (!isElement(elem)) {\n          return false;\n        }\n        var id = get$2(elem, 'id');\n        return id !== undefined && id.indexOf('aria-owns') > -1;\n      });\n      return dependent.bind(function (dep) {\n        var id = get$2(dep, 'id');\n        var dos = getRootNode(dep);\n        return descendant$1(dos, '[aria-owns=\"' + id + '\"]');\n      });\n    };\n    var manager = function () {\n      var ariaId = generate$1('aria-owns');\n      var link = function (elem) {\n        set$1(elem, 'aria-owns', ariaId);\n      };\n      var unlink = function (elem) {\n        remove$1(elem, 'aria-owns');\n      };\n      return {\n        id: ariaId,\n        link: link,\n        unlink: unlink\n      };\n    };\n\n    var isAriaPartOf = function (component, queryElem) {\n      return find$4(queryElem).exists(function (owner) {\n        return isPartOf(component, owner);\n      });\n    };\n    var isPartOf = function (component, queryElem) {\n      return closest$2(queryElem, function (el) {\n        return eq$1(el, component.element);\n      }, never) || isAriaPartOf(component, queryElem);\n    };\n\n    var unknown$3 = 'unknown';\n    var EventConfiguration;\n    (function (EventConfiguration) {\n      EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n      EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n      EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n    }(EventConfiguration || (EventConfiguration = {})));\n    var eventConfig = Cell({});\n    var makeEventLogger = function (eventName, initialTarget) {\n      var sequence = [];\n      var startTime = new Date().getTime();\n      return {\n        logEventCut: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'cut',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventStopped: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'stopped',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logNoParent: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'no-parent',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventNoHandlers: function (_name, target) {\n          sequence.push({\n            outcome: 'no-handlers-left',\n            target: target\n          });\n        },\n        logEventResponse: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'response',\n            purpose: purpose,\n            target: target\n          });\n        },\n        write: function () {\n          var finishTime = new Date().getTime();\n          if (contains([\n              'mousemove',\n              'mouseover',\n              'mouseout',\n              systemInit()\n            ], eventName)) {\n            return;\n          }\n          console.log(eventName, {\n            event: eventName,\n            time: finishTime - startTime,\n            target: initialTarget.dom,\n            sequence: map(sequence, function (s) {\n              if (!contains([\n                  'cut',\n                  'stopped',\n                  'response'\n                ], s.outcome)) {\n                return s.outcome;\n              } else {\n                return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n              }\n            })\n          });\n        }\n      };\n    };\n    var processEvent = function (eventName, initialTarget, f) {\n      var status = get(eventConfig.get(), eventName).orThunk(function () {\n        var patterns = keys(eventConfig.get());\n        return findMap(patterns, function (p) {\n          return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n        });\n      }).getOr(EventConfiguration.NORMAL);\n      switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n      case EventConfiguration.LOGGING: {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n      case EventConfiguration.STOP:\n        return true;\n      }\n    };\n    var path = [\n      'alloy/data/Fields',\n      'alloy/debugging/Debugging'\n    ];\n    var getTrace = function () {\n      var err = new Error();\n      if (err.stack !== undefined) {\n        var lines = err.stack.split('\\n');\n        return find(lines, function (line) {\n          return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n            return line.indexOf(p) > -1;\n          });\n        }).getOr(unknown$3);\n      } else {\n        return unknown$3;\n      }\n    };\n    var ignoreEvent = {\n      logEventCut: noop,\n      logEventStopped: noop,\n      logNoParent: noop,\n      logEventNoHandlers: noop,\n      logEventResponse: noop,\n      write: noop\n    };\n    var monitorEvent = function (eventName, initialTarget, f) {\n      return processEvent(eventName, initialTarget, f);\n    };\n    var noLogger = constant(ignoreEvent);\n\n    var menuFields = constant([\n      strict$1('menu'),\n      strict$1('selectedMenu')\n    ]);\n    var itemFields = constant([\n      strict$1('item'),\n      strict$1('selectedItem')\n    ]);\n    var schema = constant(objOf(itemFields().concat(menuFields())));\n    var itemSchema = constant(objOf(itemFields()));\n\n    var _initSize = strictObjOf('initSize', [\n      strict$1('numColumns'),\n      strict$1('numRows')\n    ]);\n    var itemMarkers = function () {\n      return strictOf('markers', itemSchema());\n    };\n    var tieredMenuMarkers = function () {\n      return strictObjOf('markers', [strict$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n    };\n    var markers = function (required) {\n      return strictObjOf('markers', map(required, strict$1));\n    };\n    var onPresenceHandler = function (label, fieldName, presence) {\n      var trace = getTrace();\n      return field(fieldName, fieldName, presence, valueOf(function (f) {\n        return Result.value(function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f.apply(undefined, args);\n        });\n      }));\n    };\n    var onHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, defaulted(noop));\n    };\n    var onKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, defaulted(Optional.none));\n    };\n    var onStrictHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, strict());\n    };\n    var onStrictKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, strict());\n    };\n    var output = function (name, value) {\n      return state$1(name, constant(value));\n    };\n    var snapshot = function (name) {\n      return state$1(name, identity);\n    };\n    var initSize = constant(_initSize);\n\n    var nu$7 = function (x, y, bubble, direction, boundsRestriction, label) {\n      return {\n        x: x,\n        y: y,\n        bubble: bubble,\n        direction: direction,\n        boundsRestriction: boundsRestriction,\n        label: label\n      };\n    };\n\n    var adt$2 = Adt.generate([\n      { southeast: [] },\n      { southwest: [] },\n      { northeast: [] },\n      { northwest: [] },\n      { south: [] },\n      { north: [] },\n      { east: [] },\n      { west: [] }\n    ]);\n    var cata = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n      return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n    };\n    var cataVertical = function (subject, south, middle, north) {\n      return subject.fold(south, south, north, north, south, north, middle, middle);\n    };\n    var cataHorizontal = function (subject, east, middle, west) {\n      return subject.fold(east, west, east, west, middle, middle, east, west);\n    };\n    var southeast = adt$2.southeast;\n    var southwest = adt$2.southwest;\n    var northeast = adt$2.northeast;\n    var northwest = adt$2.northwest;\n    var south = adt$2.south;\n    var north = adt$2.north;\n    var east = adt$2.east;\n    var west = adt$2.west;\n\n    var getRestriction = function (anchor, restriction) {\n      switch (restriction) {\n      case 1:\n        return anchor.x;\n      case 0:\n        return anchor.x + anchor.width;\n      case 2:\n        return anchor.y;\n      case 3:\n        return anchor.y + anchor.height;\n      }\n    };\n    var boundsRestriction = function (anchor, restrictions) {\n      return mapToObject([\n        'left',\n        'right',\n        'top',\n        'bottom'\n      ], function (dir) {\n        return get(restrictions, dir).map(function (restriction) {\n          return getRestriction(anchor, restriction);\n        });\n      });\n    };\n    var adjustBounds = function (bounds, boundsRestrictions, bubbleOffsets) {\n      var applyRestriction = function (dir, current) {\n        var bubbleOffset = dir === 'top' || dir === 'bottom' ? bubbleOffsets.top : bubbleOffsets.left;\n        return get(boundsRestrictions, dir).bind(identity).bind(function (restriction) {\n          if (dir === 'left' || dir === 'top') {\n            return restriction >= current ? Optional.some(restriction) : Optional.none();\n          } else {\n            return restriction <= current ? Optional.some(restriction) : Optional.none();\n          }\n        }).map(function (restriction) {\n          return restriction + bubbleOffset;\n        }).getOr(current);\n      };\n      var adjustedLeft = applyRestriction('left', bounds.x);\n      var adjustedTop = applyRestriction('top', bounds.y);\n      var adjustedRight = applyRestriction('right', bounds.right);\n      var adjustedBottom = applyRestriction('bottom', bounds.bottom);\n      return bounds$1(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n    };\n\n    var eastX = function (anchor) {\n      return anchor.x;\n    };\n    var middleX = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var westX = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY = function (anchor, element) {\n      return anchor.y - element.height;\n    };\n    var southY = function (anchor) {\n      return anchor.y + anchor.height;\n    };\n    var centreY = function (anchor, element) {\n      return anchor.y + anchor.height / 2 - element.height / 2;\n    };\n    var eastEdgeX = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westEdgeX = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var southeast$1 = function (anchor, element, bubbles) {\n      return nu$7(eastX(anchor), southY(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n        left: 1,\n        top: 3\n      }), 'layout-se');\n    };\n    var southwest$1 = function (anchor, element, bubbles) {\n      return nu$7(westX(anchor, element), southY(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n        right: 0,\n        top: 3\n      }), 'layout-sw');\n    };\n    var northeast$1 = function (anchor, element, bubbles) {\n      return nu$7(eastX(anchor), northY(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n        left: 1,\n        bottom: 2\n      }), 'layout-ne');\n    };\n    var northwest$1 = function (anchor, element, bubbles) {\n      return nu$7(westX(anchor, element), northY(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n        right: 0,\n        bottom: 2\n      }), 'layout-nw');\n    };\n    var north$1 = function (anchor, element, bubbles) {\n      return nu$7(middleX(anchor, element), northY(anchor, element), bubbles.north(), north(), boundsRestriction(anchor, { bottom: 2 }), 'layout-n');\n    };\n    var south$1 = function (anchor, element, bubbles) {\n      return nu$7(middleX(anchor, element), southY(anchor), bubbles.south(), south(), boundsRestriction(anchor, { top: 3 }), 'layout-s');\n    };\n    var east$1 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX(anchor), centreY(anchor, element), bubbles.east(), east(), boundsRestriction(anchor, { left: 0 }), 'layout-e');\n    };\n    var west$1 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX(anchor, element), centreY(anchor, element), bubbles.west(), west(), boundsRestriction(anchor, { right: 1 }), 'layout-w');\n    };\n    var all$2 = function () {\n      return [\n        southeast$1,\n        southwest$1,\n        northeast$1,\n        northwest$1,\n        south$1,\n        north$1,\n        east$1,\n        west$1\n      ];\n    };\n    var allRtl = function () {\n      return [\n        southwest$1,\n        southeast$1,\n        northwest$1,\n        northeast$1,\n        south$1,\n        north$1,\n        east$1,\n        west$1\n      ];\n    };\n    var aboveOrBelow = function () {\n      return [\n        northeast$1,\n        northwest$1,\n        southeast$1,\n        southwest$1,\n        north$1,\n        south$1\n      ];\n    };\n    var aboveOrBelowRtl = function () {\n      return [\n        northwest$1,\n        northeast$1,\n        southwest$1,\n        southeast$1,\n        north$1,\n        south$1\n      ];\n    };\n    var belowOrAbove = function () {\n      return [\n        southeast$1,\n        southwest$1,\n        northeast$1,\n        northwest$1,\n        south$1,\n        north$1\n      ];\n    };\n    var belowOrAboveRtl = function () {\n      return [\n        southwest$1,\n        southeast$1,\n        northwest$1,\n        northeast$1,\n        south$1,\n        north$1\n      ];\n    };\n\n    var chooseChannels = function (channels, message) {\n      return message.universal ? channels : filter(channels, function (ch) {\n        return contains(message.channels, ch);\n      });\n    };\n    var events$1 = function (receiveConfig) {\n      return derive([run(receive(), function (component, message) {\n          var channelMap = receiveConfig.channels;\n          var channels = keys(channelMap);\n          var receivingData = message;\n          var targetChannels = chooseChannels(channels, receivingData);\n          each(targetChannels, function (ch) {\n            var channelInfo = channelMap[ch];\n            var channelSchema = channelInfo.schema;\n            var data = asRawOrDie('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n            channelInfo.onReceive(component, data);\n          });\n        })]);\n    };\n\n    var ActiveReceiving = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$1\n    });\n\n    var ReceivingSchema = [strictOf('channels', setOf$1(Result.value, objOfOnly([\n        onStrictHandler('onReceive'),\n        defaulted$1('schema', anyValue$1())\n      ])))];\n\n    var executeEvent = function (bConfig, bState, executor) {\n      return runOnExecute(function (component) {\n        executor(component, bConfig, bState);\n      });\n    };\n    var loadEvent = function (bConfig, bState, f) {\n      return runOnInit(function (component, _simulatedEvent) {\n        f(component, bConfig, bState);\n      });\n    };\n    var create = function (schema, name, active, apis, extra, state) {\n      var configSchema = objOfOnly(schema);\n      var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var createModes = function (modes, name, active, apis, extra, state) {\n      var configSchema = modes;\n      var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var wrapApi = function (bName, apiFunction, apiName) {\n      var f = function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        var args = [component].concat(rest);\n        return component.config({ name: constant(bName) }).fold(function () {\n          throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n        }, function (info) {\n          var rest = Array.prototype.slice.call(args, 1);\n          return apiFunction.apply(undefined, [\n            component,\n            info.config,\n            info.state\n          ].concat(rest));\n        });\n      };\n      return markAsBehaviourApi(f, apiName, apiFunction);\n    };\n    var revokeBehaviour = function (name) {\n      return {\n        key: name,\n        value: undefined\n      };\n    };\n    var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n      var getConfig = function (info) {\n        return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n      };\n      var wrappedApis = map$2(apis, function (apiF, apiName) {\n        return wrapApi(name, apiF, apiName);\n      });\n      var wrappedExtra = map$2(extra, function (extraF, extraName) {\n        return markAsExtraApi(extraF, extraName);\n      });\n      var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n        revoke: curry(revokeBehaviour, name),\n        config: function (spec) {\n          var prepared = asRawOrDie(name + '-config', configSchema, spec);\n          return {\n            key: name,\n            value: {\n              config: prepared,\n              me: me,\n              configAsRaw: cached(function () {\n                return asRawOrDie(name + '-config', configSchema, spec);\n              }),\n              initialConfig: spec,\n              state: state\n            }\n          };\n        },\n        schema: function () {\n          return schemaSchema;\n        },\n        exhibit: function (info, base) {\n          return getConfig(info).bind(function (behaviourInfo) {\n            return get(active, 'exhibit').map(function (exhibitor) {\n              return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n            });\n          }).getOr(nu$6({}));\n        },\n        name: function () {\n          return name;\n        },\n        handlers: function (info) {\n          return getConfig(info).map(function (behaviourInfo) {\n            var getEvents = get(active, 'events').getOr(function () {\n              return {};\n            });\n            return getEvents(behaviourInfo.config, behaviourInfo.state);\n          }).getOr({});\n        }\n      });\n      return me;\n    };\n\n    var derive$1 = function (capabilities) {\n      return wrapAll$1(capabilities);\n    };\n    var simpleSchema = objOfOnly([\n      strict$1('fields'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var create$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, simpleSchema, data);\n      return create(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var modeSchema = objOfOnly([\n      strict$1('branchKey'),\n      strict$1('branches'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var createModes$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, modeSchema, data);\n      return createModes(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var revoke = constant(undefined);\n\n    var Receiving = create$1({\n      fields: ReceivingSchema,\n      name: 'receiving',\n      active: ActiveReceiving\n    });\n\n    var exhibit = function (base, posConfig) {\n      return nu$6({\n        classes: [],\n        styles: posConfig.useFixed() ? {} : { position: 'relative' }\n      });\n    };\n\n    var ActivePosition = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit\n    });\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus$1 = function (element) {\n      return element.dom.focus();\n    };\n    var blur = function (element) {\n      return element.dom.blur();\n    };\n    var hasFocus = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var preserve = function (f, container) {\n      var dos = getRootNode(container);\n      var refocus = active(dos).bind(function (focused) {\n        var hasFocus = function (elem) {\n          return eq$1(focused, elem);\n        };\n        return hasFocus(container) ? Optional.some(container) : descendant(container, hasFocus);\n      });\n      var result = f(container);\n      refocus.each(function (oldFocus) {\n        active(dos).filter(function (newFocus) {\n          return eq$1(newFocus, oldFocus);\n        }).fold(function () {\n          focus$1(oldFocus);\n        }, noop);\n      });\n      return result;\n    };\n\n    var NuPositionCss = function (position, left, top, right, bottom) {\n      return {\n        position: position,\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      };\n    };\n    var applyPositionCss = function (element, position) {\n      var addPx = function (num) {\n        return num + 'px';\n      };\n      setOptions(element, {\n        position: Optional.some(position.position),\n        left: position.left.map(addPx),\n        top: position.top.map(addPx),\n        right: position.right.map(addPx),\n        bottom: position.bottom.map(addPx)\n      });\n    };\n\n    var adt$3 = Adt.generate([\n      { none: [] },\n      {\n        relative: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      }\n    ]);\n    var positionWithDirection = function (posName, decision, x, y, width, height) {\n      var decisionX = decision.x - x;\n      var decisionY = decision.y - y;\n      var decisionWidth = decision.width;\n      var decisionHeight = decision.height;\n      var decisionRight = width - (decisionX + decisionWidth);\n      var decisionBottom = height - (decisionY + decisionHeight);\n      var left = Optional.some(decisionX);\n      var top = Optional.some(decisionY);\n      var right = Optional.some(decisionRight);\n      var bottom = Optional.some(decisionBottom);\n      var none = Optional.none();\n      return cata(decision.direction, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, none, none, right, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      });\n    };\n    var reposition = function (origin, decision) {\n      return origin.fold(function () {\n        return NuPositionCss('absolute', Optional.some(decision.x), Optional.some(decision.y), Optional.none(), Optional.none());\n      }, function (x, y, width, height) {\n        return positionWithDirection('absolute', decision, x, y, width, height);\n      }, function (x, y, width, height) {\n        return positionWithDirection('fixed', decision, x, y, width, height);\n      });\n    };\n    var toBox = function (origin, element) {\n      var rel = curry(find$3, element);\n      var position = origin.fold(rel, rel, function () {\n        var scroll = get$8();\n        return find$3(element).translate(-scroll.left, -scroll.top);\n      });\n      var width = getOuter$2(element);\n      var height = getOuter$1(element);\n      return bounds$1(position.left, position.top, width, height);\n    };\n    var viewport$1 = function (origin, getBounds) {\n      return getBounds.fold(function () {\n        return origin.fold(win, win, bounds$1);\n      }, function (b) {\n        return origin.fold(b, b, function () {\n          var bounds = b();\n          var pos = translate(origin, bounds.x, bounds.y);\n          return bounds$1(pos.left, pos.top, bounds.width, bounds.height);\n        });\n      });\n    };\n    var translate = function (origin, x, y) {\n      var pos = SugarPosition(x, y);\n      var removeScroll = function () {\n        var outerScroll = get$8();\n        return pos.translate(-outerScroll.left, -outerScroll.top);\n      };\n      return origin.fold(constant(pos), constant(pos), removeScroll);\n    };\n    var cata$1 = function (subject, onNone, onRelative, onFixed) {\n      return subject.fold(onNone, onRelative, onFixed);\n    };\n    var none$1 = adt$3.none;\n    var relative = adt$3.relative;\n    var fixed = adt$3.fixed;\n\n    var anchor = function (anchorBox, origin) {\n      return {\n        anchorBox: anchorBox,\n        origin: origin\n      };\n    };\n    var box$1 = function (anchorBox, origin) {\n      return anchor(anchorBox, origin);\n    };\n\n    var cycleBy = function (value, delta, min, max) {\n      var r = value + delta;\n      return r > max ? min : r < min ? max : r;\n    };\n    var clamp = function (value, min, max) {\n      return Math.min(Math.max(value, min), max);\n    };\n\n    var adt$4 = Adt.generate([\n      { fit: ['reposition'] },\n      {\n        nofit: [\n          'reposition',\n          'deltaW',\n          'deltaH'\n        ]\n      }\n    ]);\n    var calcReposition = function (newX, newY, width, height, bounds) {\n      var boundsX = bounds.x;\n      var boundsY = bounds.y;\n      var boundsWidth = bounds.width;\n      var boundsHeight = bounds.height;\n      var xInBounds = newX >= boundsX;\n      var yInBounds = newY >= boundsY;\n      var originInBounds = xInBounds && yInBounds;\n      var xFit = newX + width <= boundsX + boundsWidth;\n      var yFit = newY + height <= boundsY + boundsHeight;\n      var sizeInBounds = xFit && yFit;\n      var deltaW = Math.abs(Math.min(width, xInBounds ? boundsX + boundsWidth - newX : boundsX - (newX + width)));\n      var deltaH = Math.abs(Math.min(height, yInBounds ? boundsY + boundsHeight - newY : boundsY - (newY + height)));\n      var maxX = Math.max(bounds.x, bounds.right - width);\n      var maxY = Math.max(bounds.y, bounds.bottom - height);\n      var limitX = clamp(newX, bounds.x, maxX);\n      var limitY = clamp(newY, bounds.y, maxY);\n      return {\n        originInBounds: originInBounds,\n        sizeInBounds: sizeInBounds,\n        limitX: limitX,\n        limitY: limitY,\n        deltaW: deltaW,\n        deltaH: deltaH\n      };\n    };\n    var attempt = function (candidate, width, height, bounds) {\n      var candidateX = candidate.x;\n      var candidateY = candidate.y;\n      var bubbleOffsets = candidate.bubble.offset;\n      var bubbleLeft = bubbleOffsets.left;\n      var bubbleTop = bubbleOffsets.top;\n      var adjustedBounds = adjustBounds(bounds, candidate.boundsRestriction, bubbleOffsets);\n      var boundsY = adjustedBounds.y;\n      var boundsBottom = adjustedBounds.bottom;\n      var boundsX = adjustedBounds.x;\n      var boundsRight = adjustedBounds.right;\n      var newX = candidateX + bubbleLeft;\n      var newY = candidateY + bubbleTop;\n      var _a = calcReposition(newX, newY, width, height, adjustedBounds), originInBounds = _a.originInBounds, sizeInBounds = _a.sizeInBounds, limitX = _a.limitX, limitY = _a.limitY, deltaW = _a.deltaW, deltaH = _a.deltaH;\n      var upAvailable = constant(limitY + deltaH - boundsY);\n      var downAvailable = constant(boundsBottom - limitY);\n      var maxHeight = cataVertical(candidate.direction, downAvailable, downAvailable, upAvailable);\n      var westAvailable = constant(limitX + deltaW - boundsX);\n      var eastAvailable = constant(boundsRight - limitX);\n      var maxWidth = cataHorizontal(candidate.direction, eastAvailable, eastAvailable, westAvailable);\n      var reposition = {\n        x: limitX,\n        y: limitY,\n        width: deltaW,\n        height: deltaH,\n        maxHeight: maxHeight,\n        maxWidth: maxWidth,\n        direction: candidate.direction,\n        classes: {\n          on: candidate.bubble.classesOn,\n          off: candidate.bubble.classesOff\n        },\n        label: candidate.label,\n        candidateYforTest: newY\n      };\n      return originInBounds && sizeInBounds ? adt$4.fit(reposition) : adt$4.nofit(reposition, deltaW, deltaH);\n    };\n    var attempts = function (candidates, anchorBox, elementBox, bubbles, bounds) {\n      var panelWidth = elementBox.width;\n      var panelHeight = elementBox.height;\n      var attemptBestFit = function (layout, reposition, deltaW, deltaH) {\n        var next = layout(anchorBox, elementBox, bubbles);\n        var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n        return attemptLayout.fold(adt$4.fit, function (newReposition, newDeltaW, newDeltaH) {\n          var improved = newDeltaH > deltaH || newDeltaW > deltaW;\n          return improved ? adt$4.nofit(newReposition, newDeltaW, newDeltaH) : adt$4.nofit(reposition, deltaW, deltaH);\n        });\n      };\n      var abc = foldl(candidates, function (b, a) {\n        var bestNext = curry(attemptBestFit, a);\n        return b.fold(adt$4.fit, bestNext);\n      }, adt$4.nofit({\n        x: anchorBox.x,\n        y: anchorBox.y,\n        width: elementBox.width,\n        height: elementBox.height,\n        maxHeight: elementBox.height,\n        maxWidth: elementBox.width,\n        direction: southeast(),\n        classes: {\n          on: [],\n          off: []\n        },\n        label: 'none',\n        candidateYforTest: anchorBox.y\n      }, -1, -1));\n      return abc.fold(identity, identity);\n    };\n\n    var elementSize = function (p) {\n      return {\n        width: getOuter$2(p),\n        height: getOuter$1(p)\n      };\n    };\n    var layout = function (anchorBox, element, bubbles, options) {\n      remove$6(element, 'max-height');\n      remove$6(element, 'max-width');\n      var elementBox = elementSize(element);\n      return attempts(options.preference, anchorBox, elementBox, bubbles, options.bounds);\n    };\n    var setClasses = function (element, decision) {\n      var classInfo = decision.classes;\n      remove$5(element, classInfo.off);\n      add$3(element, classInfo.on);\n    };\n    var setHeight = function (element, decision, options) {\n      var maxHeightFunction = options.maxHeightFunction;\n      maxHeightFunction(element, decision.maxHeight);\n    };\n    var setWidth = function (element, decision, options) {\n      var maxWidthFunction = options.maxWidthFunction;\n      maxWidthFunction(element, decision.maxWidth);\n    };\n    var position = function (element, decision, options) {\n      applyPositionCss(element, reposition(options.origin, decision));\n    };\n\n    var setMaxHeight = function (element, maxHeight) {\n      setMax(element, Math.floor(maxHeight));\n    };\n    var anchored = constant(function (element, available) {\n      setMaxHeight(element, available);\n      setAll$1(element, {\n        'overflow-x': 'hidden',\n        'overflow-y': 'auto'\n      });\n    });\n    var expandable = constant(function (element, available) {\n      setMaxHeight(element, available);\n    });\n\n    var defaultOr = function (options, key, dephault) {\n      return options[key] === undefined ? dephault : options[key];\n    };\n    var simple = function (anchor, element, bubble, layouts, getBounds, overrideOptions) {\n      var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n      var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n      var anchorBox = anchor.anchorBox;\n      var origin = anchor.origin;\n      var options = {\n        bounds: viewport$1(origin, getBounds),\n        origin: origin,\n        preference: layouts,\n        maxHeightFunction: maxHeightFunction,\n        maxWidthFunction: maxWidthFunction\n      };\n      go(anchorBox, element, bubble, options);\n    };\n    var go = function (anchorBox, element, bubble, options) {\n      var decision = layout(anchorBox, element, bubble, options);\n      position(element, decision, options);\n      setClasses(element, decision);\n      setHeight(element, decision, options);\n      setWidth(element, decision, options);\n    };\n\n    var allAlignments = [\n      'valignCentre',\n      'alignLeft',\n      'alignRight',\n      'alignCentre',\n      'top',\n      'bottom',\n      'left',\n      'right'\n    ];\n    var nu$8 = function (width, yoffset, classes) {\n      var getClasses = function (prop) {\n        return get(classes, prop).getOr([]);\n      };\n      var make = function (xDelta, yDelta, alignmentsOn) {\n        var alignmentsOff = difference(allAlignments, alignmentsOn);\n        return {\n          offset: SugarPosition(xDelta, yDelta),\n          classesOn: bind(alignmentsOn, getClasses),\n          classesOff: bind(alignmentsOff, getClasses)\n        };\n      };\n      return {\n        southeast: function () {\n          return make(-width, yoffset, [\n            'top',\n            'alignLeft'\n          ]);\n        },\n        southwest: function () {\n          return make(width, yoffset, [\n            'top',\n            'alignRight'\n          ]);\n        },\n        south: function () {\n          return make(-width / 2, yoffset, [\n            'top',\n            'alignCentre'\n          ]);\n        },\n        northeast: function () {\n          return make(-width, -yoffset, [\n            'bottom',\n            'alignLeft'\n          ]);\n        },\n        northwest: function () {\n          return make(width, -yoffset, [\n            'bottom',\n            'alignRight'\n          ]);\n        },\n        north: function () {\n          return make(-width / 2, -yoffset, [\n            'bottom',\n            'alignCentre'\n          ]);\n        },\n        east: function () {\n          return make(width, -yoffset / 2, [\n            'valignCentre',\n            'left'\n          ]);\n        },\n        west: function () {\n          return make(-width, -yoffset / 2, [\n            'valignCentre',\n            'right'\n          ]);\n        },\n        innerNorthwest: function () {\n          return make(-width, yoffset, [\n            'top',\n            'alignRight'\n          ]);\n        },\n        innerNortheast: function () {\n          return make(width, yoffset, [\n            'top',\n            'alignLeft'\n          ]);\n        },\n        innerNorth: function () {\n          return make(-width / 2, yoffset, [\n            'top',\n            'alignCentre'\n          ]);\n        },\n        innerSouthwest: function () {\n          return make(-width, -yoffset, [\n            'bottom',\n            'alignRight'\n          ]);\n        },\n        innerSoutheast: function () {\n          return make(width, -yoffset, [\n            'bottom',\n            'alignLeft'\n          ]);\n        },\n        innerSouth: function () {\n          return make(-width / 2, -yoffset, [\n            'bottom',\n            'alignCentre'\n          ]);\n        },\n        innerWest: function () {\n          return make(width, -yoffset / 2, [\n            'valignCentre',\n            'right'\n          ]);\n        },\n        innerEast: function () {\n          return make(-width, -yoffset / 2, [\n            'valignCentre',\n            'left'\n          ]);\n        }\n      };\n    };\n    var fallback = function () {\n      return nu$8(0, 0, {});\n    };\n\n    var nu$9 = function (x) {\n      return x;\n    };\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$4(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var AttributeValue;\n    (function (AttributeValue) {\n      AttributeValue['TopToBottom'] = 'toptobottom';\n      AttributeValue['BottomToTop'] = 'bottomtotop';\n    }(AttributeValue || (AttributeValue = {})));\n    var Attribute = 'data-alloy-vertical-dir';\n    var isBottomToTopDir = function (el) {\n      return closest$2(el, function (current) {\n        return isElement(current) && get$2(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n      });\n    };\n\n    var schema$1 = function () {\n      return optionObjOf('layouts', [\n        strict$1('onLtr'),\n        strict$1('onRtl'),\n        option('onBottomLtr'),\n        option('onBottomRtl')\n      ]);\n    };\n    var get$a = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n      var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n      var customLtr = info.layouts.map(function (ls) {\n        return ls.onLtr(elem);\n      });\n      var customRtl = info.layouts.map(function (ls) {\n        return ls.onRtl(elem);\n      });\n      var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomLtr.map(function (f) {\n          return f(elem);\n        });\n      }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n      var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomRtl.map(function (f) {\n          return f(elem);\n        });\n      }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n      var f = onDirection(ltr, rtl);\n      return f(elem);\n    };\n\n    var placement = function (component, anchorInfo, origin) {\n      var hotspot = anchorInfo.hotspot;\n      var anchorBox = toBox(origin, hotspot.element);\n      var layouts = get$a(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var HotspotAnchor = [\n      strict$1('hotspot'),\n      option('bubble'),\n      defaulted$1('overrides', {}),\n      schema$1(),\n      output('placement', placement)\n    ];\n\n    var placement$1 = function (component, anchorInfo, origin) {\n      var pos = translate(origin, anchorInfo.x, anchorInfo.y);\n      var anchorBox = bounds$1(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n      var layouts = get$a(component.element, anchorInfo, all$2(), allRtl(), all$2(), allRtl(), Optional.none());\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble,\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var MakeshiftAnchor = [\n      strict$1('x'),\n      strict$1('y'),\n      defaulted$1('height', 0),\n      defaulted$1('width', 0),\n      defaulted$1('bubble', fallback()),\n      defaulted$1('overrides', {}),\n      schema$1(),\n      output('placement', placement$1)\n    ];\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n\n    var create$2 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$2 };\n\n    var adt$5 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$2 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$5.before;\n    var on = adt$5.on;\n    var after$1 = adt$5.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$1,\n      cata: cata$2,\n      getStart: getStart\n    };\n\n    var adt$6 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$6.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$6.domRange;\n    var relative$1 = adt$6.relative;\n    var exact = adt$6.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative$1,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom);\n      }, function (e, o) {\n        rng.setStart(e.dom, o);\n      }, function (e) {\n        rng.setStartAfter(e.dom);\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom);\n      }, function (e, o) {\n        rng.setEnd(e.dom, o);\n      }, function (e) {\n        rng.setEndAfter(e.dom);\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: rect.width,\n        height: rect.height\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n\n    var adt$7 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Optional.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Optional.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$7.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$7.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$7.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom, soffset);\n          rng.setEnd(finish.dom, foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom, foffset);\n          rng.setEnd(start.dom, soffset);\n          return rng;\n        }\n      });\n    };\n    var ltr = adt$7.ltr;\n    var rtl = adt$7.rtl;\n\n    function NodeValue (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    }\n\n    var api$2 = NodeValue(isText, 'text');\n    var get$b = function (element) {\n      return api$2.get(element);\n    };\n    var getOption = function (element) {\n      return api$2.getOption(element);\n    };\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Optional.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope);\n    };\n\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var after$2 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq$1(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var getNativeSelection = function (win) {\n      return Optional.from(win.getSelection());\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      if (selection.anchorNode === null || selection.focusNode === null) {\n        return readRange(selection);\n      } else {\n        var anchor = SugarElement.fromDom(selection.anchorNode);\n        var focus_1 = SugarElement.fromDom(selection.focusNode);\n        return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n      }\n    };\n    var getExact = function (win) {\n      return getNativeSelection(win).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n\n    var point = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var descendOnce = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0) {\n        return point(element, offset);\n      } else if (offset < children$1.length) {\n        return point(children$1[offset], 0);\n      } else {\n        var last = children$1[children$1.length - 1];\n        var len = isText(last) ? get$b(last).length : children(last).length;\n        return point(last, len);\n      }\n    };\n\n    var adt$8 = Adt.generate([\n      { screen: ['point'] },\n      {\n        absolute: [\n          'point',\n          'scrollLeft',\n          'scrollTop'\n        ]\n      }\n    ]);\n    var toFixed = function (pos) {\n      return pos.fold(identity, function (point, scrollLeft, scrollTop) {\n        return point.translate(-scrollLeft, -scrollTop);\n      });\n    };\n    var toAbsolute = function (pos) {\n      return pos.fold(identity, identity);\n    };\n    var sum = function (points) {\n      return foldl(points, function (b, a) {\n        return b.translate(a.left, a.top);\n      }, SugarPosition(0, 0));\n    };\n    var sumAsFixed = function (positions) {\n      var points = map(positions, toFixed);\n      return sum(points);\n    };\n    var sumAsAbsolute = function (positions) {\n      var points = map(positions, toAbsolute);\n      return sum(points);\n    };\n    var screen = adt$8.screen;\n    var absolute$2 = adt$8.absolute;\n\n    var getOffset = function (component, origin, anchorInfo) {\n      var win = defaultView(anchorInfo.root).dom;\n      var hasSameOwner = function (frame) {\n        var frameOwner = owner(frame);\n        var compOwner = owner(component.element);\n        return eq$1(frameOwner, compOwner);\n      };\n      return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute);\n    };\n    var getRootPoint = function (component, origin, anchorInfo) {\n      var doc = owner(component.element);\n      var outerScroll = get$8(doc);\n      var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n      return absolute$2(offset, outerScroll.left, outerScroll.top);\n    };\n\n    var capRect = function (left, top, width, height) {\n      var newLeft = left, newTop = top, newWidth = width, newHeight = height;\n      if (left < 0) {\n        newLeft = 0;\n        newWidth = width + left;\n      }\n      if (top < 0) {\n        newTop = 0;\n        newHeight = height + top;\n      }\n      var point = screen(SugarPosition(newLeft, newTop));\n      return Optional.some(pointed(point, newWidth, newHeight));\n    };\n    var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n      return optBox.map(function (box) {\n        var points = [\n          rootPoint,\n          box.point\n        ];\n        var topLeft = cata$1(origin, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsFixed(points);\n        });\n        var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n        var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n        var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n        var layouts = get$a(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n        return nu$9({\n          anchorBox: anchorBox,\n          bubble: anchorInfo.bubble.getOr(fallback()),\n          overrides: anchorInfo.overrides,\n          layouts: layouts,\n          placer: Optional.none()\n        });\n      });\n    };\n\n    var point$1 = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var descendOnce$1 = function (element, offset) {\n      return isText(element) ? point$1(element, offset) : descendOnce(element, offset);\n    };\n    var getAnchorSelection = function (win, anchorInfo) {\n      var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n        return function () {\n          return getExact(win);\n        };\n      });\n      return getSelection().map(function (sel) {\n        var modStart = descendOnce$1(sel.start, sel.soffset);\n        var modFinish = descendOnce$1(sel.finish, sel.foffset);\n        return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n      });\n    };\n    var placement$2 = function (component, anchorInfo, origin) {\n      var win = defaultView(anchorInfo.root).dom;\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        var optRect = getFirstRect$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n          var x = SugarElement.fromText(zeroWidth);\n          before(sel.start, x);\n          return getFirstRect$1(win, SimSelection.exact(x, 0, x, 1)).map(function (rect) {\n            remove(x);\n            return rect;\n          });\n        });\n        return optRect.bind(function (rawRect) {\n          return capRect(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n        });\n      });\n      var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        return isElement(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n      });\n      var elem = targetElement.getOr(component.element);\n      return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n    };\n    var SelectionAnchor = [\n      option('getSelection'),\n      strict$1('root'),\n      option('bubble'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      defaulted$1('showAbove', false),\n      output('placement', placement$2)\n    ];\n\n    var placement$3 = function (component, anchorInfo, origin) {\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      return anchorInfo.node.bind(function (target) {\n        var rect = target.dom.getBoundingClientRect();\n        var nodeBox = capRect(rect.left, rect.top, rect.width, rect.height);\n        var elem = anchorInfo.node.getOr(component.element);\n        return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n      });\n    };\n    var NodeAnchor = [\n      strict$1('node'),\n      strict$1('root'),\n      option('bubble'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      defaulted$1('showAbove', false),\n      output('placement', placement$3)\n    ];\n\n    var eastX$1 = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westX$1 = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var northY$1 = function (anchor, element) {\n      return anchor.y - element.height + anchor.height;\n    };\n    var southY$1 = function (anchor) {\n      return anchor.y;\n    };\n    var southeast$2 = function (anchor, element, bubbles) {\n      return nu$7(eastX$1(anchor), southY$1(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n        left: 0,\n        top: 2\n      }), 'link-layout-se');\n    };\n    var southwest$2 = function (anchor, element, bubbles) {\n      return nu$7(westX$1(anchor, element), southY$1(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n        right: 1,\n        top: 2\n      }), 'link-layout-sw');\n    };\n    var northeast$2 = function (anchor, element, bubbles) {\n      return nu$7(eastX$1(anchor), northY$1(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n        left: 0,\n        bottom: 3\n      }), 'link-layout-ne');\n    };\n    var northwest$2 = function (anchor, element, bubbles) {\n      return nu$7(westX$1(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n        right: 1,\n        bottom: 3\n      }), 'link-layout-nw');\n    };\n    var all$3 = function () {\n      return [\n        southeast$2,\n        southwest$2,\n        northeast$2,\n        northwest$2\n      ];\n    };\n    var allRtl$1 = function () {\n      return [\n        southwest$2,\n        southeast$2,\n        northwest$2,\n        northeast$2\n      ];\n    };\n\n    var placement$4 = function (component, submenuInfo, origin) {\n      var anchorBox = toBox(origin, submenuInfo.item.element);\n      var layouts = get$a(component.element, submenuInfo, all$3(), allRtl$1(), all$3(), allRtl$1(), Optional.none());\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: fallback(),\n        overrides: submenuInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var SubmenuAnchor = [\n      strict$1('item'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      output('placement', placement$4)\n    ];\n\n    var AnchorSchema = choose$1('anchor', {\n      selection: SelectionAnchor,\n      node: NodeAnchor,\n      hotspot: HotspotAnchor,\n      submenu: SubmenuAnchor,\n      makeshift: MakeshiftAnchor\n    });\n\n    var getFixedOrigin = function () {\n      var html = document.documentElement;\n      return fixed(0, 0, html.clientWidth, html.clientHeight);\n    };\n    var getRelativeOrigin = function (component) {\n      var position = absolute(component.element);\n      var bounds = component.element.dom.getBoundingClientRect();\n      return relative(position.left, position.top, bounds.width, bounds.height);\n    };\n    var place = function (component, origin, anchoring, getBounds, placee) {\n      var anchor = box$1(anchoring.anchorBox, origin);\n      simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, getBounds, anchoring.overrides);\n    };\n    var position$1 = function (component, posConfig, posState, anchor, placee) {\n      positionWithin(component, posConfig, posState, anchor, placee, Optional.none());\n    };\n    var positionWithin = function (component, posConfig, posState, anchor, placee, boxElement) {\n      var boundsBox = boxElement.map(box);\n      return positionWithinBounds(component, posConfig, posState, anchor, placee, boundsBox);\n    };\n    var positionWithinBounds = function (component, posConfig, posState, anchor, placee, bounds) {\n      var anchorage = asRawOrDie('positioning anchor.info', AnchorSchema, anchor);\n      preserve(function () {\n        set$2(placee.element, 'position', 'fixed');\n        var oldVisibility = getRaw(placee.element, 'visibility');\n        set$2(placee.element, 'visibility', 'hidden');\n        var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n        var placer = anchorage.placement;\n        var getBounds = bounds.map(constant).or(posConfig.getBounds);\n        placer(component, anchorage, origin).each(function (anchoring) {\n          var doPlace = anchoring.placer.getOr(place);\n          doPlace(component, origin, anchoring, getBounds, placee);\n        });\n        oldVisibility.fold(function () {\n          remove$6(placee.element, 'visibility');\n        }, function (vis) {\n          set$2(placee.element, 'visibility', vis);\n        });\n        if (getRaw(placee.element, 'left').isNone() && getRaw(placee.element, 'top').isNone() && getRaw(placee.element, 'right').isNone() && getRaw(placee.element, 'bottom').isNone() && getRaw(placee.element, 'position').is('fixed')) {\n          remove$6(placee.element, 'position');\n        }\n      }, placee.element);\n    };\n    var getMode = function (component, pConfig, _pState) {\n      return pConfig.useFixed() ? 'fixed' : 'absolute';\n    };\n\n    var PositionApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        position: position$1,\n        positionWithin: positionWithin,\n        positionWithinBounds: positionWithinBounds,\n        getMode: getMode\n    });\n\n    var PositionSchema = [\n      defaulted$1('useFixed', never),\n      option('getBounds')\n    ];\n\n    var Positioning = create$1({\n      fields: PositionSchema,\n      name: 'positioning',\n      active: ActivePosition,\n      apis: PositionApis\n    });\n\n    var fireDetaching = function (component) {\n      emit(component, detachedFromDom());\n      var children = component.components();\n      each(children, fireDetaching);\n    };\n    var fireAttaching = function (component) {\n      var children = component.components();\n      each(children, fireAttaching);\n      emit(component, attachedToDom());\n    };\n    var attach = function (parent, child) {\n      append(parent.element, child.element);\n    };\n    var detachChildren = function (component) {\n      each(component.components(), function (childComp) {\n        return remove(childComp.element);\n      });\n      empty(component.element);\n      component.syncComponents();\n    };\n    var replaceChildren = function (component, newChildren) {\n      var subs = component.components();\n      detachChildren(component);\n      var deleted = difference(subs, newChildren);\n      each(deleted, function (comp) {\n        fireDetaching(comp);\n        component.getSystem().removeFromWorld(comp);\n      });\n      each(newChildren, function (childComp) {\n        if (!childComp.getSystem().isConnected()) {\n          component.getSystem().addToWorld(childComp);\n          attach(component, childComp);\n          if (inBody(component.element)) {\n            fireAttaching(childComp);\n          }\n        } else {\n          attach(component, childComp);\n        }\n        component.syncComponents();\n      });\n    };\n\n    var attach$1 = function (parent, child) {\n      attachWith(parent, child, append);\n    };\n    var attachWith = function (parent, child, insertion) {\n      parent.getSystem().addToWorld(child);\n      insertion(parent.element, child.element);\n      if (inBody(parent.element)) {\n        fireAttaching(child);\n      }\n      parent.syncComponents();\n    };\n    var doDetach = function (component) {\n      fireDetaching(component);\n      remove(component.element);\n      component.getSystem().removeFromWorld(component);\n    };\n    var detach = function (component) {\n      var parent$1 = parent(component.element).bind(function (p) {\n        return component.getSystem().getByDom(p).toOptional();\n      });\n      doDetach(component);\n      parent$1.each(function (p) {\n        p.syncComponents();\n      });\n    };\n    var detachChildren$1 = function (component) {\n      var subs = component.components();\n      each(subs, doDetach);\n      empty(component.element);\n      component.syncComponents();\n    };\n    var attachSystem = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, append);\n    };\n    var attachSystemAfter = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, after);\n    };\n    var attachSystemWith = function (element, guiSystem, inserter) {\n      inserter(element, guiSystem.element);\n      var children$1 = children(guiSystem.element);\n      each(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireAttaching);\n      });\n    };\n    var detachSystem = function (guiSystem) {\n      var children$1 = children(guiSystem.element);\n      each(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireDetaching);\n      });\n      remove(guiSystem.element);\n    };\n\n    var rebuild = function (sandbox, sConfig, sState, data) {\n      sState.get().each(function (_data) {\n        detachChildren$1(sandbox);\n      });\n      var point = sConfig.getAttachPoint(sandbox);\n      attach$1(point, sandbox);\n      var built = sandbox.getSystem().build(data);\n      attach$1(sandbox, built);\n      sState.set(built);\n      return built;\n    };\n    var open = function (sandbox, sConfig, sState, data) {\n      var newState = rebuild(sandbox, sConfig, sState, data);\n      sConfig.onOpen(sandbox, newState);\n      return newState;\n    };\n    var setContent = function (sandbox, sConfig, sState, data) {\n      return sState.get().map(function () {\n        return rebuild(sandbox, sConfig, sState, data);\n      });\n    };\n    var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n      cloak(sandbox, sConfig);\n      open(sandbox, sConfig, sState, data);\n      transaction();\n      decloak(sandbox, sConfig);\n    };\n    var close = function (sandbox, sConfig, sState) {\n      sState.get().each(function (data) {\n        detachChildren$1(sandbox);\n        detach(sandbox);\n        sConfig.onClose(sandbox, data);\n        sState.clear();\n      });\n    };\n    var isOpen = function (_sandbox, _sConfig, sState) {\n      return sState.isOpen();\n    };\n    var isPartOf$1 = function (sandbox, sConfig, sState, queryElem) {\n      return isOpen(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n        return sConfig.isPartOf(sandbox, data, queryElem);\n      });\n    };\n    var getState = function (_sandbox, _sConfig, sState) {\n      return sState.get();\n    };\n    var store = function (sandbox, cssKey, attr, newValue) {\n      getRaw(sandbox.element, cssKey).fold(function () {\n        remove$1(sandbox.element, attr);\n      }, function (v) {\n        set$1(sandbox.element, attr, v);\n      });\n      set$2(sandbox.element, cssKey, newValue);\n    };\n    var restore = function (sandbox, cssKey, attr) {\n      getOpt(sandbox.element, attr).fold(function () {\n        return remove$6(sandbox.element, cssKey);\n      }, function (oldValue) {\n        return set$2(sandbox.element, cssKey, oldValue);\n      });\n    };\n    var cloak = function (sandbox, sConfig, _sState) {\n      var sink = sConfig.getAttachPoint(sandbox);\n      set$2(sandbox.element, 'position', Positioning.getMode(sink));\n      store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n    };\n    var hasPosition = function (element) {\n      return exists([\n        'top',\n        'left',\n        'right',\n        'bottom'\n      ], function (pos) {\n        return getRaw(element, pos).isSome();\n      });\n    };\n    var decloak = function (sandbox, sConfig, _sState) {\n      if (!hasPosition(sandbox.element)) {\n        remove$6(sandbox.element, 'position');\n      }\n      restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n    };\n\n    var SandboxApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        cloak: cloak,\n        decloak: decloak,\n        open: open,\n        openWhileCloaked: openWhileCloaked,\n        close: close,\n        isOpen: isOpen,\n        isPartOf: isPartOf$1,\n        getState: getState,\n        setContent: setContent\n    });\n\n    var events$2 = function (sandboxConfig, sandboxState) {\n      return derive([run(sandboxClose(), function (sandbox, _simulatedEvent) {\n          close(sandbox, sandboxConfig, sandboxState);\n        })]);\n    };\n\n    var ActiveSandbox = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$2\n    });\n\n    var SandboxSchema = [\n      onHandler('onOpen'),\n      onHandler('onClose'),\n      strict$1('isPartOf'),\n      strict$1('getAttachPoint'),\n      defaulted$1('cloakVisibilityAttr', 'data-precloak-visibility')\n    ];\n\n    var init = function () {\n      var contents = Cell(Optional.none());\n      var readState = constant('not-implemented');\n      var isOpen = function () {\n        return contents.get().isSome();\n      };\n      var set = function (comp) {\n        contents.set(Optional.some(comp));\n      };\n      var get = function () {\n        return contents.get();\n      };\n      var clear = function () {\n        contents.set(Optional.none());\n      };\n      return nu$5({\n        readState: readState,\n        isOpen: isOpen,\n        clear: clear,\n        set: set,\n        get: get\n      });\n    };\n\n    var SandboxState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init\n    });\n\n    var Sandboxing = create$1({\n      fields: SandboxSchema,\n      name: 'sandboxing',\n      active: ActiveSandbox,\n      apis: SandboxApis,\n      state: SandboxState\n    });\n\n    var dismissPopups = constant('dismiss.popups');\n    var repositionPopups = constant('reposition.popups');\n    var mouseReleased = constant('mouse.released');\n\n    var schema$2 = objOfOnly([\n      defaulted$1('isExtraPart', never),\n      optionObjOf('fireEventInstead', [defaulted$1('event', dismissRequested())])\n    ]);\n    var receivingChannel = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie('Dismissal', schema$2, rawSpec);\n      return _a = {}, _a[dismissPopups()] = {\n        schema: objOfOnly([strict$1('target')]),\n        onReceive: function (sandbox, data) {\n          if (Sandboxing.isOpen(sandbox)) {\n            var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n            if (!isPart) {\n              detail.fireEventInstead.fold(function () {\n                return Sandboxing.close(sandbox);\n              }, function (fe) {\n                return emit(sandbox, fe.event);\n              });\n            }\n          }\n        }\n      }, _a;\n    };\n\n    var schema$3 = objOfOnly([\n      optionObjOf('fireEventInstead', [defaulted$1('event', repositionRequested())]),\n      strictFunction('doReposition')\n    ]);\n    var receivingChannel$1 = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie('Reposition', schema$3, rawSpec);\n      return _a = {}, _a[repositionPopups()] = {\n        onReceive: function (sandbox) {\n          if (Sandboxing.isOpen(sandbox)) {\n            detail.fireEventInstead.fold(function () {\n              return detail.doReposition(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }, _a;\n    };\n\n    var onLoad = function (component, repConfig, repState) {\n      repConfig.store.manager.onLoad(component, repConfig, repState);\n    };\n    var onUnload = function (component, repConfig, repState) {\n      repConfig.store.manager.onUnload(component, repConfig, repState);\n    };\n    var setValue = function (component, repConfig, repState, data) {\n      repConfig.store.manager.setValue(component, repConfig, repState, data);\n    };\n    var getValue = function (component, repConfig, repState) {\n      return repConfig.store.manager.getValue(component, repConfig, repState);\n    };\n    var getState$1 = function (component, repConfig, repState) {\n      return repState;\n    };\n\n    var RepresentApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad,\n        onUnload: onUnload,\n        setValue: setValue,\n        getValue: getValue,\n        getState: getState$1\n    });\n\n    var events$3 = function (repConfig, repState) {\n      var es = repConfig.resetOnDom ? [\n        runOnAttached(function (comp, _se) {\n          onLoad(comp, repConfig, repState);\n        }),\n        runOnDetached(function (comp, _se) {\n          onUnload(comp, repConfig, repState);\n        })\n      ] : [loadEvent(repConfig, repState, onLoad)];\n      return derive(es);\n    };\n\n    var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$3\n    });\n\n    var memory = function () {\n      var data = Cell(null);\n      var readState = function () {\n        return {\n          mode: 'memory',\n          value: data.get()\n        };\n      };\n      var isNotSet = function () {\n        return data.get() === null;\n      };\n      var clear = function () {\n        data.set(null);\n      };\n      return nu$5({\n        set: data.set,\n        get: data.get,\n        isNotSet: isNotSet,\n        clear: clear,\n        readState: readState\n      });\n    };\n    var manual = function () {\n      var readState = function () {\n      };\n      return nu$5({ readState: readState });\n    };\n    var dataset = function () {\n      var dataByValue = Cell({});\n      var dataByText = Cell({});\n      var readState = function () {\n        return {\n          mode: 'dataset',\n          dataByValue: dataByValue.get(),\n          dataByText: dataByText.get()\n        };\n      };\n      var clear = function () {\n        dataByValue.set({});\n        dataByText.set({});\n      };\n      var lookup = function (itemString) {\n        return get(dataByValue.get(), itemString).orThunk(function () {\n          return get(dataByText.get(), itemString);\n        });\n      };\n      var update = function (items) {\n        var currentDataByValue = dataByValue.get();\n        var currentDataByText = dataByText.get();\n        var newDataByValue = {};\n        var newDataByText = {};\n        each(items, function (item) {\n          newDataByValue[item.value] = item;\n          get(item, 'meta').each(function (meta) {\n            get(meta, 'text').each(function (text) {\n              newDataByText[text] = item;\n            });\n          });\n        });\n        dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n        dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n      };\n      return nu$5({\n        readState: readState,\n        lookup: lookup,\n        update: update,\n        clear: clear\n      });\n    };\n    var init$1 = function (spec) {\n      return spec.store.manager.state(spec);\n    };\n\n    var RepresentState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        memory: memory,\n        dataset: dataset,\n        manual: manual,\n        init: init$1\n    });\n\n    var setValue$1 = function (component, repConfig, repState, data) {\n      var store = repConfig.store;\n      repState.update([data]);\n      store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$1 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      var key = store.getDataKey(component);\n      return repState.lookup(key).fold(function () {\n        return store.getFallbackEntry(key);\n      }, function (data) {\n        return data;\n      });\n    };\n    var onLoad$1 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      store.initialValue.each(function (data) {\n        setValue$1(component, repConfig, repState, data);\n      });\n    };\n    var onUnload$1 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var DatasetStore = [\n      option('initialValue'),\n      strict$1('getFallbackEntry'),\n      strict$1('getDataKey'),\n      strict$1('setValue'),\n      output('manager', {\n        setValue: setValue$1,\n        getValue: getValue$1,\n        onLoad: onLoad$1,\n        onUnload: onUnload$1,\n        state: dataset\n      })\n    ];\n\n    var getValue$2 = function (component, repConfig, _repState) {\n      return repConfig.store.getValue(component);\n    };\n    var setValue$2 = function (component, repConfig, _repState, data) {\n      repConfig.store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var onLoad$2 = function (component, repConfig, _repState) {\n      repConfig.store.initialValue.each(function (data) {\n        repConfig.store.setValue(component, data);\n      });\n    };\n    var ManualStore = [\n      strict$1('getValue'),\n      defaulted$1('setValue', noop),\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$2,\n        getValue: getValue$2,\n        onLoad: onLoad$2,\n        onUnload: noop,\n        state: NoState.init\n      })\n    ];\n\n    var setValue$3 = function (component, repConfig, repState, data) {\n      repState.set(data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$3 = function (component, repConfig, repState) {\n      return repState.get();\n    };\n    var onLoad$3 = function (component, repConfig, repState) {\n      repConfig.store.initialValue.each(function (initVal) {\n        if (repState.isNotSet()) {\n          repState.set(initVal);\n        }\n      });\n    };\n    var onUnload$2 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var MemoryStore = [\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$3,\n        getValue: getValue$3,\n        onLoad: onLoad$3,\n        onUnload: onUnload$2,\n        state: memory\n      })\n    ];\n\n    var RepresentSchema = [\n      defaultedOf('store', { mode: 'memory' }, choose$1('mode', {\n        memory: MemoryStore,\n        manual: ManualStore,\n        dataset: DatasetStore\n      })),\n      onHandler('onSetValue'),\n      defaulted$1('resetOnDom', false)\n    ];\n\n    var Representing = create$1({\n      fields: RepresentSchema,\n      name: 'representing',\n      active: ActiveRepresenting,\n      apis: RepresentApis,\n      extra: {\n        setValueFrom: function (component, source) {\n          var value = Representing.getValue(source);\n          Representing.setValue(component, value);\n        }\n      },\n      state: RepresentState\n    });\n\n    var field$1 = function (name, forbidden) {\n      return defaultedObjOf(name, {}, map(forbidden, function (f) {\n        return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n      }).concat([state$1('dump', identity)]));\n    };\n    var get$c = function (data) {\n      return data.dump;\n    };\n    var augment = function (data, original) {\n      return __assign(__assign({}, data.dump), derive$1(original));\n    };\n    var SketchBehaviours = {\n      field: field$1,\n      augment: augment,\n      get: get$c\n    };\n\n    var _placeholder = 'placeholder';\n    var adt$9 = Adt.generate([\n      {\n        single: [\n          'required',\n          'valueThunk'\n        ]\n      },\n      {\n        multiple: [\n          'required',\n          'valueThunks'\n        ]\n      }\n    ]);\n    var isSubstituted = function (spec) {\n      return has(spec, 'uiType');\n    };\n    var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n      if (owner.exists(function (o) {\n          return o !== compSpec.owner;\n        })) {\n        return adt$9.single(true, constant(compSpec));\n      }\n      return get(placeholders, compSpec.name).fold(function () {\n        throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n      }, function (newSpec) {\n        return newSpec.replace();\n      });\n    };\n    var scan = function (owner, detail, compSpec, placeholders) {\n      if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n        return subPlaceholder(owner, detail, compSpec, placeholders);\n      } else {\n        return adt$9.single(false, constant(compSpec));\n      }\n    };\n    var substitute = function (owner, detail, compSpec, placeholders) {\n      var base = scan(owner, detail, compSpec, placeholders);\n      return base.fold(function (req, valueThunk) {\n        var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n        var childSpecs = get(value, 'components').getOr([]);\n        var substituted = bind(childSpecs, function (c) {\n          return substitute(owner, detail, c, placeholders);\n        });\n        return [__assign(__assign({}, value), { components: substituted })];\n      }, function (req, valuesThunk) {\n        if (isSubstituted(compSpec)) {\n          var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n          var preprocessor = compSpec.validated.preprocess.getOr(identity);\n          return preprocessor(values);\n        } else {\n          return valuesThunk(detail);\n        }\n      });\n    };\n    var substituteAll = function (owner, detail, components, placeholders) {\n      return bind(components, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n    };\n    var oneReplace = function (label, replacements) {\n      var called = false;\n      var used = function () {\n        return called;\n      };\n      var replace = function () {\n        if (called) {\n          throw new Error('Trying to use the same placeholder more than once: ' + label);\n        }\n        called = true;\n        return replacements;\n      };\n      var required = function () {\n        return replacements.fold(function (req, _) {\n          return req;\n        }, function (req, _) {\n          return req;\n        });\n      };\n      return {\n        name: constant(label),\n        required: required,\n        used: used,\n        replace: replace\n      };\n    };\n    var substitutePlaces = function (owner, detail, components, placeholders) {\n      var ps = map$2(placeholders, function (ph, name) {\n        return oneReplace(name, ph);\n      });\n      var outcome = substituteAll(owner, detail, components, ps);\n      each$1(ps, function (p) {\n        if (p.used() === false && p.required()) {\n          throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n        }\n      });\n      return outcome;\n    };\n    var single = adt$9.single;\n    var multiple = adt$9.multiple;\n    var placeholder = constant(_placeholder);\n\n    var adt$a = Adt.generate([\n      { required: ['data'] },\n      { external: ['data'] },\n      { optional: ['data'] },\n      { group: ['data'] }\n    ]);\n    var fFactory = defaulted$1('factory', { sketch: identity });\n    var fSchema = defaulted$1('schema', []);\n    var fName = strict$1('name');\n    var fPname = field('pname', 'pname', defaultedThunk(function (typeSpec) {\n      return '<alloy.' + generate$1(typeSpec.name) + '>';\n    }), anyValue$1());\n    var fGroupSchema = state$1('schema', function () {\n      return [option('preprocess')];\n    });\n    var fDefaults = defaulted$1('defaults', constant({}));\n    var fOverrides = defaulted$1('overrides', constant({}));\n    var requiredSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var externalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fDefaults,\n      fOverrides\n    ]);\n    var optionalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var groupSpec = objOf([\n      fFactory,\n      fGroupSchema,\n      fName,\n      strict$1('unit'),\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var asNamedPart = function (part) {\n      return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n    };\n    var name$1 = function (part) {\n      var get = function (data) {\n        return data.name;\n      };\n      return part.fold(get, get, get, get);\n    };\n    var asCommon = function (part) {\n      return part.fold(identity, identity, identity, identity);\n    };\n    var convert = function (adtConstructor, partSchema) {\n      return function (spec) {\n        var data = asRawOrDie('Converting part type', partSchema, spec);\n        return adtConstructor(data);\n      };\n    };\n    var required = convert(adt$a.required, requiredSpec);\n    var external$1 = convert(adt$a.external, externalSpec);\n    var optional = convert(adt$a.optional, optionalSpec);\n    var group = convert(adt$a.group, groupSpec);\n    var original = constant('entirety');\n\n    var PartType = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        required: required,\n        external: external$1,\n        optional: optional,\n        group: group,\n        asNamedPart: asNamedPart,\n        name: name$1,\n        asCommon: asCommon,\n        original: original\n    });\n\n    var combine$2 = function (detail, data, partSpec, partValidated) {\n      return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, { uid: detail.partUids[data.name] }, data.overrides(detail, partSpec, partValidated));\n    };\n    var subs = function (owner, detail, parts) {\n      var internals = {};\n      var externals = {};\n      each(parts, function (part) {\n        part.fold(function (data) {\n          internals[data.pname] = single(true, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          var partSpec = detail.parts[data.name];\n          externals[data.name] = constant(data.factory.sketch(combine$2(detail, data, partSpec[original()]), partSpec));\n        }, function (data) {\n          internals[data.pname] = single(false, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n            var units = detail[data.name];\n            return map(units, function (u) {\n              return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n            });\n          });\n        });\n      });\n      return {\n        internals: constant(internals),\n        externals: constant(externals)\n      };\n    };\n\n    var generate$4 = function (owner, parts) {\n      var r = {};\n      each(parts, function (part) {\n        asNamedPart(part).each(function (np) {\n          var g = doGenerateOne(owner, np.pname);\n          r[np.name] = function (config) {\n            var validated = asRawOrDie('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n            return __assign(__assign({}, g), {\n              config: config,\n              validated: validated\n            });\n          };\n        });\n      });\n      return r;\n    };\n    var doGenerateOne = function (owner, pname) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname\n      };\n    };\n    var generateOne = function (owner, pname, config) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname,\n        config: config,\n        validated: {}\n      };\n    };\n    var schemas = function (parts) {\n      return bind(parts, function (part) {\n        return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n          return strictObjOf(data.name, data.schema.concat([snapshot(original())]));\n        }).toArray();\n      });\n    };\n    var names = function (parts) {\n      return map(parts, name$1);\n    };\n    var substitutes = function (owner, detail, parts) {\n      return subs(owner, detail, parts);\n    };\n    var components = function (owner, detail, internals) {\n      return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n    };\n    var getPart = function (component, detail, partKey) {\n      var uid = detail.partUids[partKey];\n      return component.getSystem().getByUid(uid).toOptional();\n    };\n    var getPartOrDie = function (component, detail, partKey) {\n      return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n    };\n    var getParts = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each(partKeys, function (pk) {\n        r[pk] = constant(system.getByUid(uids[pk]));\n      });\n      return r;\n    };\n    var getAllParts = function (component, detail) {\n      var system = component.getSystem();\n      return map$2(detail.partUids, function (pUid, _k) {\n        return constant(system.getByUid(pUid));\n      });\n    };\n    var getAllPartNames = function (detail) {\n      return keys(detail.partUids);\n    };\n    var getPartsOrDie = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each(partKeys, function (pk) {\n        r[pk] = constant(system.getByUid(uids[pk]).getOrDie());\n      });\n      return r;\n    };\n    var defaultUids = function (baseUid, partTypes) {\n      var partNames = names(partTypes);\n      return wrapAll$1(map(partNames, function (pn) {\n        return {\n          key: pn,\n          value: baseUid + '-' + pn\n        };\n      }));\n    };\n    var defaultUidsSchema = function (partTypes) {\n      return field('partUids', 'partUids', mergeWithThunk(function (spec) {\n        return defaultUids(spec.uid, partTypes);\n      }), anyValue$1());\n    };\n\n    var AlloyParts = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        generate: generate$4,\n        generateOne: generateOne,\n        schemas: schemas,\n        names: names,\n        substitutes: substitutes,\n        components: components,\n        defaultUids: defaultUids,\n        defaultUidsSchema: defaultUidsSchema,\n        getAllParts: getAllParts,\n        getAllPartNames: getAllPartNames,\n        getPart: getPart,\n        getPartOrDie: getPartOrDie,\n        getParts: getParts,\n        getPartsOrDie: getPartsOrDie\n    });\n\n    var base = function (partSchemas, partUidsSchemas) {\n      var ps = partSchemas.length > 0 ? [strictObjOf('parts', partSchemas)] : [];\n      return ps.concat([\n        strict$1('uid'),\n        defaulted$1('dom', {}),\n        defaulted$1('components', []),\n        snapshot('originalSpec'),\n        defaulted$1('debug.sketcher', {})\n      ]).concat(partUidsSchemas);\n    };\n    var asRawOrDie$1 = function (label, schema, spec, partSchemas, partUidsSchemas) {\n      var baseS = base(partSchemas, partUidsSchemas);\n      return asRawOrDie(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n    };\n\n    var single$1 = function (owner, schema, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, [], []);\n      return factory(detail, specWithUid);\n    };\n    var composite = function (owner, schema, partTypes, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var partSchemas = schemas(partTypes);\n      var partUidsSchema = defaultUidsSchema(partTypes);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n      var subs = substitutes(owner, detail, partTypes);\n      var components$1 = components(owner, detail, subs.internals());\n      return factory(detail, components$1, specWithUid, subs.externals());\n    };\n    var hasUid = function (spec) {\n      return has(spec, 'uid');\n    };\n    var supplyUid = function (spec) {\n      return hasUid(spec) ? spec : __assign(__assign({}, spec), { uid: generate$2('uid') });\n    };\n\n    function isSketchSpec(spec) {\n      return spec.uid !== undefined;\n    }\n    var singleSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var compositeSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      strict$1('partFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var single$2 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n      var sketch = function (spec) {\n        return single$1(config.name, config.configFields, config.factory, spec);\n      };\n      var apis = map$2(config.apis, makeApi);\n      var extraApis = map$2(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        configFields: config.configFields,\n        sketch: sketch\n      }, apis), extraApis);\n    };\n    var composite$1 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n      var sketch = function (spec) {\n        return composite(config.name, config.configFields, config.partFields, config.factory, spec);\n      };\n      var parts = generate$4(config.name, config.partFields);\n      var apis = map$2(config.apis, makeApi);\n      var extraApis = map$2(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        partFields: config.partFields,\n        configFields: config.configFields,\n        sketch: sketch,\n        parts: parts\n      }, apis), extraApis);\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var sequence = function (arr) {\n      var r = [];\n      for (var i = 0; i < arr.length; i++) {\n        var x = arr[i];\n        if (x.isSome()) {\n          r.push(x.getOrDie());\n        } else {\n          return Optional.none();\n        }\n      }\n      return Optional.some(r);\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var mapFrom = function (a, f) {\n      return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var inside = function (target) {\n      return name(target) === 'input' && get$2(target, 'type') !== 'radio' || name(target) === 'textarea';\n    };\n\n    var getCurrent = function (component, composeConfig, _composeState) {\n      return composeConfig.find(component);\n    };\n\n    var ComposeApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCurrent: getCurrent\n    });\n\n    var ComposeSchema = [strict$1('find')];\n\n    var Composing = create$1({\n      fields: ComposeSchema,\n      name: 'composing',\n      apis: ComposeApis\n    });\n\n    var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n      var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n      each(highlighted, function (h) {\n        if (!exists(skip, function (skipComp) {\n            return skipComp.element === h;\n          })) {\n          remove$4(h, hConfig.highlightClass);\n          component.getSystem().getByDom(h).each(function (target) {\n            hConfig.onDehighlight(component, target);\n            emit(target, dehighlight());\n          });\n        }\n      });\n    };\n    var dehighlightAll = function (component, hConfig, hState) {\n      return dehighlightAllExcept(component, hConfig, hState, []);\n    };\n    var dehighlight$1 = function (component, hConfig, hState, target) {\n      if (isHighlighted(component, hConfig, hState, target)) {\n        remove$4(target.element, hConfig.highlightClass);\n        hConfig.onDehighlight(component, target);\n        emit(target, dehighlight());\n      }\n    };\n    var highlight$1 = function (component, hConfig, hState, target) {\n      dehighlightAllExcept(component, hConfig, hState, [target]);\n      if (!isHighlighted(component, hConfig, hState, target)) {\n        add$2(target.element, hConfig.highlightClass);\n        hConfig.onHighlight(component, target);\n        emit(target, highlight());\n      }\n    };\n    var highlightFirst = function (component, hConfig, hState) {\n      getFirst(component, hConfig).each(function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightLast = function (component, hConfig, hState) {\n      getLast(component, hConfig).each(function (lastComp) {\n        highlight$1(component, hConfig, hState, lastComp);\n      });\n    };\n    var highlightAt = function (component, hConfig, hState, index) {\n      getByIndex(component, hConfig, hState, index).fold(function (err) {\n        throw new Error(err);\n      }, function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightBy = function (component, hConfig, hState, predicate) {\n      var candidates = getCandidates(component, hConfig);\n      var targetComp = find(candidates, predicate);\n      targetComp.each(function (c) {\n        highlight$1(component, hConfig, hState, c);\n      });\n    };\n    var isHighlighted = function (component, hConfig, hState, queryTarget) {\n      return has$2(queryTarget.element, hConfig.highlightClass);\n    };\n    var getHighlighted = function (component, hConfig, _hState) {\n      return descendant$1(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getByIndex = function (component, hConfig, hState, index) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return Optional.from(items[index]).fold(function () {\n        return Result.error('No element found with index ' + index);\n      }, component.getSystem().getByDom);\n    };\n    var getFirst = function (component, hConfig, _hState) {\n      return descendant$1(component.element, '.' + hConfig.itemClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getLast = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n      return last.bind(function (c) {\n        return component.getSystem().getByDom(c).toOptional();\n      });\n    };\n    var getDelta = function (component, hConfig, hState, delta) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var current = findIndex(items, function (item) {\n        return has$2(item, hConfig.highlightClass);\n      });\n      return current.bind(function (selected) {\n        var dest = cycleBy(selected, delta, 0, items.length - 1);\n        return component.getSystem().getByDom(items[dest]).toOptional();\n      });\n    };\n    var getPrevious = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, -1);\n    };\n    var getNext = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, +1);\n    };\n    var getCandidates = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return cat(map(items, function (i) {\n        return component.getSystem().getByDom(i).toOptional();\n      }));\n    };\n\n    var HighlightApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        dehighlightAll: dehighlightAll,\n        dehighlight: dehighlight$1,\n        highlight: highlight$1,\n        highlightFirst: highlightFirst,\n        highlightLast: highlightLast,\n        highlightAt: highlightAt,\n        highlightBy: highlightBy,\n        isHighlighted: isHighlighted,\n        getHighlighted: getHighlighted,\n        getFirst: getFirst,\n        getLast: getLast,\n        getPrevious: getPrevious,\n        getNext: getNext,\n        getCandidates: getCandidates\n    });\n\n    var HighlightSchema = [\n      strict$1('highlightClass'),\n      strict$1('itemClass'),\n      onHandler('onHighlight'),\n      onHandler('onDehighlight')\n    ];\n\n    var Highlighting = create$1({\n      fields: HighlightSchema,\n      name: 'highlighting',\n      apis: HighlightApis\n    });\n\n    var BACKSPACE = [8];\n    var TAB = [9];\n    var ENTER = [13];\n    var ESCAPE = [27];\n    var SPACE = [32];\n    var LEFT = [37];\n    var UP = [38];\n    var RIGHT = [39];\n    var DOWN = [40];\n\n    var cyclePrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      var after = reverse(values.slice(index + 1));\n      return find(before.concat(after), predicate);\n    };\n    var tryPrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      return find(before, predicate);\n    };\n    var cycleNext = function (values, index, predicate) {\n      var before = values.slice(0, index);\n      var after = values.slice(index + 1);\n      return find(after.concat(before), predicate);\n    };\n    var tryNext = function (values, index, predicate) {\n      var after = values.slice(index + 1);\n      return find(after, predicate);\n    };\n\n    var inSet = function (keys) {\n      return function (event) {\n        var raw = event.raw;\n        return contains(keys, raw.which);\n      };\n    };\n    var and = function (preds) {\n      return function (event) {\n        return forall(preds, function (pred) {\n          return pred(event);\n        });\n      };\n    };\n    var isShift = function (event) {\n      var raw = event.raw;\n      return raw.shiftKey === true;\n    };\n    var isControl = function (event) {\n      var raw = event.raw;\n      return raw.ctrlKey === true;\n    };\n    var isNotShift = not(isShift);\n\n    var rule = function (matches, action) {\n      return {\n        matches: matches,\n        classification: action\n      };\n    };\n    var choose$2 = function (transitions, event) {\n      var transition = find(transitions, function (t) {\n        return t.matches(event);\n      });\n      return transition.map(function (t) {\n        return t.classification;\n      });\n    };\n\n    var reportFocusShifting = function (component, prevFocus, newFocus) {\n      var noChange = prevFocus.exists(function (p) {\n        return newFocus.exists(function (n) {\n          return eq$1(n, p);\n        });\n      });\n      if (!noChange) {\n        emitWith(component, focusShifted(), {\n          prevFocus: prevFocus,\n          newFocus: newFocus\n        });\n      }\n    };\n    var dom = function () {\n      var get = function (component) {\n        return search(component.element);\n      };\n      var set = function (component, focusee) {\n        var prevFocus = get(component);\n        component.getSystem().triggerFocus(focusee, component.element);\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n    var highlights = function () {\n      var get = function (component) {\n        return Highlighting.getHighlighted(component).map(function (item) {\n          return item.element;\n        });\n      };\n      var set = function (component, element) {\n        var prevFocus = get(component);\n        component.getSystem().getByDom(element).fold(noop, function (item) {\n          Highlighting.highlight(component, item);\n        });\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var FocusInsideModes;\n    (function (FocusInsideModes) {\n      FocusInsideModes['OnFocusMode'] = 'onFocus';\n      FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n      FocusInsideModes['OnApiMode'] = 'onApi';\n    }(FocusInsideModes || (FocusInsideModes = {})));\n\n    var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n      var schema = function () {\n        return infoSchema.concat([\n          defaulted$1('focusManager', dom()),\n          defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n            return contains([\n              'onFocus',\n              'onEnterOrSpace',\n              'onApi'\n            ], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n          })),\n          output('handler', me),\n          output('state', stateInit),\n          output('sendFocusIn', optFocusIn)\n        ]);\n      };\n      var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n        var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n        return choose$2(rules, simulatedEvent.event).bind(function (rule) {\n          return rule(component, simulatedEvent, keyingConfig, keyingState);\n        });\n      };\n      var toEvents = function (keyingConfig, keyingState) {\n        var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n          return run(focus(), function (component, simulatedEvent) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        });\n        var tryGoInsideComponent = function (component, simulatedEvent) {\n          var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n          if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n            optFocusIn(keyingConfig).each(function (focusIn) {\n              focusIn(component, keyingConfig, keyingState);\n              simulatedEvent.stop();\n            });\n          }\n        };\n        var keyboardEvents = [\n          run(keydown(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n              tryGoInsideComponent(component, simulatedEvent);\n            }, function (_) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(keyup(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n              simulatedEvent.stop();\n            });\n          })\n        ];\n        return derive(onFocusHandler.toArray().concat(keyboardEvents));\n      };\n      var me = {\n        schema: schema,\n        processKey: processKey,\n        toEvents: toEvents\n      };\n      return me;\n    };\n\n    var create$3 = function (cyclicField) {\n      var schema = [\n        option('onEscape'),\n        option('onEnter'),\n        defaulted$1('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'),\n        defaulted$1('firstTabstop', 0),\n        defaulted$1('useTabstopAt', always),\n        option('visibilitySelector')\n      ].concat([cyclicField]);\n      var isVisible = function (tabbingConfig, element) {\n        var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n          return closest$3(element, sel);\n        }).getOr(element);\n        return get$6(target) > 0;\n      };\n      var findInitial = function (component, tabbingConfig) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        var visibles = filter(tabstops, function (elem) {\n          return isVisible(tabbingConfig, elem);\n        });\n        return Optional.from(visibles[tabbingConfig.firstTabstop]);\n      };\n      var findCurrent = function (component, tabbingConfig) {\n        return tabbingConfig.focusManager.get(component).bind(function (elem) {\n          return closest$3(elem, tabbingConfig.selector);\n        });\n      };\n      var isTabstop = function (tabbingConfig, element) {\n        return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n      };\n      var focusIn = function (component, tabbingConfig, _tabbingState) {\n        findInitial(component, tabbingConfig).each(function (target) {\n          tabbingConfig.focusManager.set(component, target);\n        });\n      };\n      var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n        return cycle(tabstops, stopIndex, function (elem) {\n          return isTabstop(tabbingConfig, elem);\n        }).fold(function () {\n          return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n        }, function (target) {\n          tabbingConfig.focusManager.set(component, target);\n          return Optional.some(true);\n        });\n      };\n      var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n          var optStopIndex = findIndex(tabstops, curry(eq$1, tabstop));\n          return optStopIndex.bind(function (stopIndex) {\n            return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n          });\n        });\n      };\n      var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var goForwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var execute = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEnter.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var exit = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEscape.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var getKeydownRules = constant([\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), goBackwards),\n        rule(inSet(TAB), goForwards),\n        rule(inSet(ESCAPE), exit),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), execute)\n      ]);\n      var getKeyupRules = constant([]);\n      return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n        return Optional.some(focusIn);\n      });\n    };\n\n    var AcyclicType = create$3(state$1('cyclic', never));\n\n    var CyclicType = create$3(state$1('cyclic', always));\n\n    var doDefaultExecute = function (component, _simulatedEvent, focused) {\n      dispatch(component, focused, execute());\n      return Optional.some(true);\n    };\n    var defaultExecute = function (component, simulatedEvent, focused) {\n      var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n      return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n    };\n    var stopEventForFirefox = function (_component, _simulatedEvent) {\n      return Optional.some(true);\n    };\n\n    var schema$4 = [\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('useSpace', false),\n      defaulted$1('useEnter', true),\n      defaulted$1('useControlEnter', false),\n      defaulted$1('useDown', false)\n    ];\n    var execute$1 = function (component, simulatedEvent, executeConfig) {\n      return executeConfig.execute(component, simulatedEvent, component.element);\n    };\n    var getKeydownRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n      var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n      var enterExec = executeConfig.useEnter ? ENTER : [];\n      var downExec = executeConfig.useDown ? DOWN : [];\n      var execKeys = spaceExec.concat(enterExec).concat(downExec);\n      return [rule(inSet(execKeys), execute$1)].concat(executeConfig.useControlEnter ? [rule(and([\n          isControl,\n          inSet(ENTER)\n        ]), execute$1)] : []);\n    };\n    var getKeyupRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n      return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var ExecutionType = typical(schema$4, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Optional.none();\n    });\n\n    var flatgrid = function () {\n      var dimensions = Cell(Optional.none());\n      var setGridSize = function (numRows, numColumns) {\n        dimensions.set(Optional.some({\n          numRows: numRows,\n          numColumns: numColumns\n        }));\n      };\n      var getNumRows = function () {\n        return dimensions.get().map(function (d) {\n          return d.numRows;\n        });\n      };\n      var getNumColumns = function () {\n        return dimensions.get().map(function (d) {\n          return d.numColumns;\n        });\n      };\n      return nu$5({\n        readState: function () {\n          return dimensions.get().map(function (d) {\n            return {\n              numRows: String(d.numRows),\n              numColumns: String(d.numColumns)\n            };\n          }).getOr({\n            numRows: '?',\n            numColumns: '?'\n          });\n        },\n        setGridSize: setGridSize,\n        getNumRows: getNumRows,\n        getNumColumns: getNumColumns\n      });\n    };\n    var init$2 = function (spec) {\n      return spec.state(spec);\n    };\n\n    var KeyingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        flatgrid: flatgrid,\n        init: init$2\n    });\n\n    var useH = function (movement) {\n      return function (component, simulatedEvent, config, state) {\n        var move = movement(component.element);\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var west$2 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveLeft, moveRight);\n      return useH(movement);\n    };\n    var east$2 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveRight, moveLeft);\n      return useH(movement);\n    };\n    var useV = function (move) {\n      return function (component, simulatedEvent, config, state) {\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var use = function (move, component, simulatedEvent, config, state) {\n      var outcome = config.focusManager.get(component).bind(function (focused) {\n        return move(component.element, focused, config, state);\n      });\n      return outcome.map(function (newFocus) {\n        config.focusManager.set(component, newFocus);\n        return true;\n      });\n    };\n    var north$2 = useV;\n    var south$2 = useV;\n    var move = useV;\n\n    var isHidden = function (dom) {\n      return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n    };\n    var isVisible = function (element) {\n      return !isHidden(element.dom);\n    };\n\n    var locate = function (candidates, predicate) {\n      return findIndex(candidates, predicate).map(function (index) {\n        return {\n          index: index,\n          candidates: candidates\n        };\n      });\n    };\n\n    var locateVisible = function (container, current, selector) {\n      var predicate = function (x) {\n        return eq$1(x, current);\n      };\n      var candidates = descendants(container, selector);\n      var visible = filter(candidates, isVisible);\n      return locate(visible, predicate);\n    };\n    var findIndex$1 = function (elements, target) {\n      return findIndex(elements, function (elem) {\n        return eq$1(target, elem);\n      });\n    };\n\n    var withGrid = function (values, index, numCols, f) {\n      var oldRow = Math.floor(index / numCols);\n      var oldColumn = index % numCols;\n      return f(oldRow, oldColumn).bind(function (address) {\n        var newIndex = address.row * numCols + address.column;\n        return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n      });\n    };\n    var cycleHorizontal = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var onLastRow = oldRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n        var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n        return Optional.some({\n          row: oldRow,\n          column: newColumn\n        });\n      });\n    };\n    var cycleVertical = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n        var onLastRow = newRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n        var newCol = clamp(oldColumn, 0, colsInRow - 1);\n        return Optional.some({\n          row: newRow,\n          column: newCol\n        });\n      });\n    };\n    var cycleRight = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, +1);\n    };\n    var cycleLeft = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, -1);\n    };\n    var cycleUp = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, -1);\n    };\n    var cycleDown = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, +1);\n    };\n\n    var schema$5 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('captureTab', false),\n      initSize()\n    ];\n    var focusIn = function (component, gridConfig, _gridState) {\n      descendant$1(component.element, gridConfig.selector).each(function (first) {\n        gridConfig.focusManager.set(component, first);\n      });\n    };\n    var findCurrent = function (component, gridConfig) {\n      return gridConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, gridConfig.selector);\n      });\n    };\n    var execute$2 = function (component, simulatedEvent, gridConfig, _gridState) {\n      return findCurrent(component, gridConfig).bind(function (focused) {\n        return gridConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var doMove = function (cycle) {\n      return function (element, focused, gridConfig, gridState) {\n        return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n          return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n        });\n      };\n    };\n    var handleTab = function (_component, _simulatedEvent, gridConfig) {\n      return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n    };\n    var doEscape = function (component, simulatedEvent, gridConfig) {\n      return gridConfig.onEscape(component, simulatedEvent);\n    };\n    var moveLeft = doMove(cycleLeft);\n    var moveRight = doMove(cycleRight);\n    var moveNorth = doMove(cycleUp);\n    var moveSouth = doMove(cycleDown);\n    var getKeydownRules$1 = constant([\n      rule(inSet(LEFT), west$2(moveLeft, moveRight)),\n      rule(inSet(RIGHT), east$2(moveLeft, moveRight)),\n      rule(inSet(UP), north$2(moveNorth)),\n      rule(inSet(DOWN), south$2(moveSouth)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(inSet(ESCAPE), doEscape),\n      rule(inSet(SPACE.concat(ENTER)), execute$2)\n    ]);\n    var getKeyupRules$1 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlatgridType = typical(schema$5, flatgrid, getKeydownRules$1, getKeyupRules$1, function () {\n      return Optional.some(focusIn);\n    });\n\n    var horizontal = function (container, selector, current, delta) {\n      var isDisabledButton = function (candidate) {\n        return name(candidate) === 'button' && get$2(candidate, 'disabled') === 'disabled';\n      };\n      var tryCycle = function (initial, index, candidates) {\n        var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n        if (newIndex === initial) {\n          return Optional.none();\n        } else {\n          return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n        }\n      };\n      return locateVisible(container, current, selector).bind(function (identified) {\n        var index = identified.index;\n        var candidates = identified.candidates;\n        return tryCycle(index, index, candidates);\n      });\n    };\n\n    var schema$6 = [\n      strict$1('selector'),\n      defaulted$1('getInitial', Optional.none),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('executeOnMove', false),\n      defaulted$1('allowVertical', true)\n    ];\n    var findCurrent$1 = function (component, flowConfig) {\n      return flowConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, flowConfig.selector);\n      });\n    };\n    var execute$3 = function (component, simulatedEvent, flowConfig) {\n      return findCurrent$1(component, flowConfig).bind(function (focused) {\n        return flowConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$1 = function (component, flowConfig, _state) {\n      flowConfig.getInitial(component).orThunk(function () {\n        return descendant$1(component.element, flowConfig.selector);\n      }).each(function (first) {\n        flowConfig.focusManager.set(component, first);\n      });\n    };\n    var moveLeft$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveRight$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var doMove$1 = function (movement) {\n      return function (component, simulatedEvent, flowConfig, flowState) {\n        return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n          return flowConfig.executeOnMove ? execute$3(component, simulatedEvent, flowConfig) : Optional.some(true);\n        });\n      };\n    };\n    var doEscape$1 = function (component, simulatedEvent, flowConfig) {\n      return flowConfig.onEscape(component, simulatedEvent);\n    };\n    var getKeydownRules$2 = function (_component, _se, flowConfig, _flowState) {\n      var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n      var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n      return [\n        rule(inSet(westMovers), doMove$1(west$2(moveLeft$1, moveRight$1))),\n        rule(inSet(eastMovers), doMove$1(east$2(moveLeft$1, moveRight$1))),\n        rule(inSet(ENTER), execute$3),\n        rule(inSet(SPACE), execute$3),\n        rule(inSet(ESCAPE), doEscape$1)\n      ];\n    };\n    var getKeyupRules$2 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlowType = typical(schema$6, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n      return Optional.some(focusIn$1);\n    });\n\n    var toCell = function (matrix, rowIndex, columnIndex) {\n      return Optional.from(matrix[rowIndex]).bind(function (row) {\n        return Optional.from(row[columnIndex]).map(function (cell) {\n          return {\n            rowIndex: rowIndex,\n            columnIndex: columnIndex,\n            cell: cell\n          };\n        });\n      });\n    };\n    var cycleHorizontal$1 = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var cycleVertical$1 = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = clamp(startCol + deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = clamp(startRow + deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var cycleRight$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, +1);\n    };\n    var cycleLeft$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, -1);\n    };\n    var cycleUp$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, -1);\n    };\n    var cycleDown$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, +1);\n    };\n    var moveLeft$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, -1);\n    };\n    var moveRight$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, +1);\n    };\n    var moveUp = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, -1);\n    };\n    var moveDown = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, +1);\n    };\n\n    var schema$7 = [\n      strictObjOf('selectors', [\n        strict$1('row'),\n        strict$1('cell')\n      ]),\n      defaulted$1('cycles', true),\n      defaulted$1('previousSelector', Optional.none),\n      defaulted$1('execute', defaultExecute)\n    ];\n    var focusIn$2 = function (component, matrixConfig, _state) {\n      var focused = matrixConfig.previousSelector(component).orThunk(function () {\n        var selectors = matrixConfig.selectors;\n        return descendant$1(component.element, selectors.cell);\n      });\n      focused.each(function (cell) {\n        matrixConfig.focusManager.set(component, cell);\n      });\n    };\n    var execute$4 = function (component, simulatedEvent, matrixConfig) {\n      return search(component.element).bind(function (focused) {\n        return matrixConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var toMatrix = function (rows, matrixConfig) {\n      return map(rows, function (row) {\n        return descendants(row, matrixConfig.selectors.cell);\n      });\n    };\n    var doMove$2 = function (ifCycle, ifMove) {\n      return function (element, focused, matrixConfig) {\n        var move = matrixConfig.cycles ? ifCycle : ifMove;\n        return closest$3(focused, matrixConfig.selectors.row).bind(function (inRow) {\n          var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n          return findIndex$1(cellsInRow, focused).bind(function (colIndex) {\n            var allRows = descendants(element, matrixConfig.selectors.row);\n            return findIndex$1(allRows, inRow).bind(function (rowIndex) {\n              var matrix = toMatrix(allRows, matrixConfig);\n              return move(matrix, rowIndex, colIndex).map(function (next) {\n                return next.cell;\n              });\n            });\n          });\n        });\n      };\n    };\n    var moveLeft$3 = doMove$2(cycleLeft$1, moveLeft$2);\n    var moveRight$3 = doMove$2(cycleRight$1, moveRight$2);\n    var moveNorth$1 = doMove$2(cycleUp$1, moveUp);\n    var moveSouth$1 = doMove$2(cycleDown$1, moveDown);\n    var getKeydownRules$3 = constant([\n      rule(inSet(LEFT), west$2(moveLeft$3, moveRight$3)),\n      rule(inSet(RIGHT), east$2(moveLeft$3, moveRight$3)),\n      rule(inSet(UP), north$2(moveNorth$1)),\n      rule(inSet(DOWN), south$2(moveSouth$1)),\n      rule(inSet(SPACE.concat(ENTER)), execute$4)\n    ]);\n    var getKeyupRules$3 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MatrixType = typical(schema$7, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n      return Optional.some(focusIn$2);\n    });\n\n    var schema$8 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('moveOnTab', false)\n    ];\n    var execute$5 = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.focusManager.get(component).bind(function (focused) {\n        return menuConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$3 = function (component, menuConfig, _state) {\n      descendant$1(component.element, menuConfig.selector).each(function (first) {\n        menuConfig.focusManager.set(component, first);\n      });\n    };\n    var moveUp$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveDown$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move(moveUp$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move(moveDown$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var getKeydownRules$4 = constant([\n      rule(inSet(UP), move(moveUp$1)),\n      rule(inSet(DOWN), move(moveDown$1)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), fireShiftTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), fireTab),\n      rule(inSet(ENTER), execute$5),\n      rule(inSet(SPACE), execute$5)\n    ]);\n    var getKeyupRules$4 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MenuType = typical(schema$8, NoState.init, getKeydownRules$4, getKeyupRules$4, function () {\n      return Optional.some(focusIn$3);\n    });\n\n    var schema$9 = [\n      onKeyboardHandler('onSpace'),\n      onKeyboardHandler('onEnter'),\n      onKeyboardHandler('onShiftEnter'),\n      onKeyboardHandler('onLeft'),\n      onKeyboardHandler('onRight'),\n      onKeyboardHandler('onTab'),\n      onKeyboardHandler('onShiftTab'),\n      onKeyboardHandler('onUp'),\n      onKeyboardHandler('onDown'),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('stopSpaceKeyup', false),\n      option('focusIn')\n    ];\n    var getKeydownRules$5 = function (component, simulatedEvent, specialInfo) {\n      return [\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), specialInfo.onEnter),\n        rule(and([\n          isShift,\n          inSet(ENTER)\n        ]), specialInfo.onShiftEnter),\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), specialInfo.onShiftTab),\n        rule(and([\n          isNotShift,\n          inSet(TAB)\n        ]), specialInfo.onTab),\n        rule(inSet(UP), specialInfo.onUp),\n        rule(inSet(DOWN), specialInfo.onDown),\n        rule(inSet(LEFT), specialInfo.onLeft),\n        rule(inSet(RIGHT), specialInfo.onRight),\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(inSet(ESCAPE), specialInfo.onEscape)\n      ];\n    };\n    var getKeyupRules$5 = function (component, simulatedEvent, specialInfo) {\n      return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var SpecialType = typical(schema$9, NoState.init, getKeydownRules$5, getKeyupRules$5, function (specialInfo) {\n      return specialInfo.focusIn;\n    });\n\n    var acyclic = AcyclicType.schema();\n    var cyclic = CyclicType.schema();\n    var flow = FlowType.schema();\n    var flatgrid$1 = FlatgridType.schema();\n    var matrix = MatrixType.schema();\n    var execution = ExecutionType.schema();\n    var menu = MenuType.schema();\n    var special = SpecialType.schema();\n\n    var KeyboardBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        acyclic: acyclic,\n        cyclic: cyclic,\n        flow: flow,\n        flatgrid: flatgrid$1,\n        matrix: matrix,\n        execution: execution,\n        menu: menu,\n        special: special\n    });\n\n    var isFlatgridState = function (keyState) {\n      return hasNonNullableKey(keyState, 'setGridSize');\n    };\n    var Keying = createModes$1({\n      branchKey: 'mode',\n      branches: KeyboardBranches,\n      name: 'keying',\n      active: {\n        events: function (keyingConfig, keyingState) {\n          var handler = keyingConfig.handler;\n          return handler.toEvents(keyingConfig, keyingState);\n        }\n      },\n      apis: {\n        focusIn: function (component, keyConfig, keyState) {\n          keyConfig.sendFocusIn(keyConfig).fold(function () {\n            component.getSystem().triggerFocus(component.element, component.element);\n          }, function (sendFocusIn) {\n            sendFocusIn(component, keyConfig, keyState);\n          });\n        },\n        setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n          if (!isFlatgridState(keyState)) {\n            console.error('Layout does not support setGridSize');\n          } else {\n            keyState.setGridSize(numRows, numColumns);\n          }\n        }\n      },\n      state: KeyingState\n    });\n\n    var set$5 = function (component, replaceConfig, replaceState, data) {\n      preserve(function () {\n        var newChildren = map(data, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      }, component.element);\n    };\n    var insert = function (component, replaceConfig, insertion, childSpec) {\n      var child = component.getSystem().build(childSpec);\n      attachWith(component, child, insertion);\n    };\n    var append$2 = function (component, replaceConfig, replaceState, appendee) {\n      insert(component, replaceConfig, append, appendee);\n    };\n    var prepend$1 = function (component, replaceConfig, replaceState, prependee) {\n      insert(component, replaceConfig, prepend, prependee);\n    };\n    var remove$7 = function (component, replaceConfig, replaceState, removee) {\n      var children = contents(component);\n      var foundChild = find(children, function (child) {\n        return eq$1(removee.element, child.element);\n      });\n      foundChild.each(detach);\n    };\n    var contents = function (component, _replaceConfig) {\n      return component.components();\n    };\n    var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n      var children = contents(component);\n      return Optional.from(children[replaceeIndex]).map(function (replacee) {\n        remove$7(component, replaceConfig, replaceState, replacee);\n        replacer.each(function (r) {\n          insert(component, replaceConfig, function (p, c) {\n            appendAt(p, c, replaceeIndex);\n          }, r);\n        });\n        return replacee;\n      });\n    };\n    var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n      var children = contents(component);\n      return findIndex(children, replaceePred).bind(function (replaceeIndex) {\n        return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n      });\n    };\n\n    var ReplaceApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        append: append$2,\n        prepend: prepend$1,\n        remove: remove$7,\n        replaceAt: replaceAt,\n        replaceBy: replaceBy,\n        set: set$5,\n        contents: contents\n    });\n\n    var Replacing = create$1({\n      fields: [],\n      name: 'replacing',\n      apis: ReplaceApis\n    });\n\n    var events$4 = function (name, eventHandlers) {\n      var events = derive(eventHandlers);\n      return create$1({\n        fields: [strict$1('enabled')],\n        name: name,\n        active: { events: constant(events) }\n      });\n    };\n    var config = function (name, eventHandlers) {\n      var me = events$4(name, eventHandlers);\n      return {\n        key: name,\n        value: {\n          config: {},\n          me: me,\n          configAsRaw: constant({}),\n          initialConfig: {},\n          state: NoState\n        }\n      };\n    };\n\n    var focus$2 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        focus$1(component.element);\n        focusConfig.onFocus(component);\n      }\n    };\n    var blur$1 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        blur(component.element);\n      }\n    };\n    var isFocused = function (component) {\n      return hasFocus(component.element);\n    };\n\n    var FocusApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        focus: focus$2,\n        blur: blur$1,\n        isFocused: isFocused\n    });\n\n    var exhibit$1 = function (base, focusConfig) {\n      var mod = focusConfig.ignore ? {} : { attributes: { tabindex: '-1' } };\n      return nu$6(mod);\n    };\n    var events$5 = function (focusConfig) {\n      return derive([run(focus(), function (component, simulatedEvent) {\n          focus$2(component, focusConfig);\n          simulatedEvent.stop();\n        })].concat(focusConfig.stopMousedown ? [run(mousedown(), function (_, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        })] : []));\n    };\n\n    var ActiveFocus = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$1,\n        events: events$5\n    });\n\n    var FocusSchema = [\n      onHandler('onFocus'),\n      defaulted$1('stopMousedown', false),\n      defaulted$1('ignore', false)\n    ];\n\n    var Focusing = create$1({\n      fields: FocusSchema,\n      name: 'focusing',\n      active: ActiveFocus,\n      apis: FocusApis\n    });\n\n    var SetupBehaviourCellState = function (initialState) {\n      var init = function () {\n        var cell = Cell(initialState);\n        var get = function () {\n          return cell.get();\n        };\n        var set = function (newState) {\n          return cell.set(newState);\n        };\n        var clear = function () {\n          return cell.set(initialState);\n        };\n        var readState = function () {\n          return cell.get();\n        };\n        return {\n          get: get,\n          set: set,\n          clear: clear,\n          readState: readState\n        };\n      };\n      return { init: init };\n    };\n\n    var updateAriaState = function (component, toggleConfig, toggleState) {\n      var ariaInfo = toggleConfig.aria;\n      ariaInfo.update(component, ariaInfo, toggleState.get());\n    };\n    var updateClass = function (component, toggleConfig, toggleState) {\n      toggleConfig.toggleClass.each(function (toggleClass) {\n        if (toggleState.get()) {\n          add$2(component.element, toggleClass);\n        } else {\n          remove$4(component.element, toggleClass);\n        }\n      });\n    };\n    var toggle = function (component, toggleConfig, toggleState) {\n      set$6(component, toggleConfig, toggleState, !toggleState.get());\n    };\n    var on$1 = function (component, toggleConfig, toggleState) {\n      toggleState.set(true);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var off = function (component, toggleConfig, toggleState) {\n      toggleState.set(false);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var set$6 = function (component, toggleConfig, toggleState, state) {\n      var action = state ? on$1 : off;\n      action(component, toggleConfig, toggleState);\n    };\n    var isOn = function (component, toggleConfig, toggleState) {\n      return toggleState.get();\n    };\n    var onLoad$4 = function (component, toggleConfig, toggleState) {\n      set$6(component, toggleConfig, toggleState, toggleConfig.selected);\n    };\n\n    var ToggleApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad$4,\n        toggle: toggle,\n        isOn: isOn,\n        on: on$1,\n        off: off,\n        set: set$6\n    });\n\n    var exhibit$2 = function () {\n      return nu$6({});\n    };\n    var events$6 = function (toggleConfig, toggleState) {\n      var execute = executeEvent(toggleConfig, toggleState, toggle);\n      var load = loadEvent(toggleConfig, toggleState, onLoad$4);\n      return derive(flatten([\n        toggleConfig.toggleOnExecute ? [execute] : [],\n        [load]\n      ]));\n    };\n\n    var ActiveToggle = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$2,\n        events: events$6\n    });\n\n    var updatePressed = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-pressed', status);\n      if (ariaInfo.syncWithExpanded) {\n        updateExpanded(component, ariaInfo, status);\n      }\n    };\n    var updateSelected = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-selected', status);\n    };\n    var updateChecked = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-checked', status);\n    };\n    var updateExpanded = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-expanded', status);\n    };\n\n    var ToggleSchema = [\n      defaulted$1('selected', false),\n      option('toggleClass'),\n      defaulted$1('toggleOnExecute', true),\n      defaultedOf('aria', { mode: 'none' }, choose$1('mode', {\n        pressed: [\n          defaulted$1('syncWithExpanded', false),\n          output('update', updatePressed)\n        ],\n        checked: [output('update', updateChecked)],\n        expanded: [output('update', updateExpanded)],\n        selected: [output('update', updateSelected)],\n        none: [output('update', noop)]\n      }))\n    ];\n\n    var Toggling = create$1({\n      fields: ToggleSchema,\n      name: 'toggling',\n      active: ActiveToggle,\n      apis: ToggleApis,\n      state: SetupBehaviourCellState(false)\n    });\n\n    var pointerEvents = function () {\n      var onClick = function (component, simulatedEvent) {\n        simulatedEvent.stop();\n        emitExecute(component);\n      };\n      return [\n        run(click(), onClick),\n        run(tap(), onClick),\n        cutter(touchstart()),\n        cutter(mousedown())\n      ];\n    };\n    var events$7 = function (optAction) {\n      var executeHandler = function (action) {\n        return runOnExecute(function (component, simulatedEvent) {\n          action(component);\n          simulatedEvent.stop();\n        });\n      };\n      return derive(flatten([\n        optAction.map(executeHandler).toArray(),\n        pointerEvents()\n      ]));\n    };\n\n    var hoverEvent = 'alloy.item-hover';\n    var focusEvent = 'alloy.item-focus';\n    var onHover = function (item) {\n      if (search(item.element).isNone() || Focusing.isFocused(item)) {\n        if (!Focusing.isFocused(item)) {\n          Focusing.focus(item);\n        }\n        emitWith(item, hoverEvent, { item: item });\n      }\n    };\n    var onFocus = function (item) {\n      emitWith(item, focusEvent, { item: item });\n    };\n    var hover = constant(hoverEvent);\n    var focus$3 = constant(focusEvent);\n\n    var builder = function (detail) {\n      return {\n        dom: detail.dom,\n        domModification: __assign(__assign({}, detail.domModification), { attributes: __assign(__assign(__assign({ 'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem' }, detail.domModification.attributes), { 'aria-haspopup': detail.hasSubmenu }), detail.hasSubmenu ? { 'aria-expanded': false } : {}) }),\n        behaviours: SketchBehaviours.augment(detail.itemBehaviours, [\n          detail.toggling.fold(Toggling.revoke, function (tConfig) {\n            return Toggling.config(__assign({ aria: { mode: 'checked' } }, tConfig));\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            stopMousedown: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({ mode: 'execution' }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          config('item-type-events', __spreadArrays(pointerEvents(), [\n            run(mouseover(), onHover),\n            run(focusItem(), Focusing.focus)\n          ]))\n        ]),\n        components: detail.components,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var schema$a = [\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('hasSubmenu', false),\n      option('toggling'),\n      SketchBehaviours.field('itemBehaviours', [\n        Toggling,\n        Focusing,\n        Keying,\n        Representing\n      ]),\n      defaulted$1('ignoreFocus', false),\n      defaulted$1('domModification', {}),\n      output('builder', builder),\n      defaulted$1('eventOrder', {})\n    ];\n\n    var builder$1 = function (detail) {\n      return {\n        dom: detail.dom,\n        components: detail.components,\n        events: derive([stopper(focusItem())])\n      };\n    };\n    var schema$b = [\n      strict$1('dom'),\n      strict$1('components'),\n      output('builder', builder$1)\n    ];\n\n    var owner$2 = function () {\n      return 'item-widget';\n    };\n    var parts = constant([required({\n        name: 'widget',\n        overrides: function (detail) {\n          return {\n            behaviours: derive$1([Representing.config({\n                store: {\n                  mode: 'manual',\n                  getValue: function (_component) {\n                    return detail.data;\n                  },\n                  setValue: function () {\n                  }\n                }\n              })])\n          };\n        }\n      })]);\n\n    var builder$2 = function (detail) {\n      var subs = substitutes(owner$2(), detail, parts());\n      var components$1 = components(owner$2(), detail, subs.internals());\n      var focusWidget = function (component) {\n        return getPart(component, detail, 'widget').map(function (widget) {\n          Keying.focusIn(widget);\n          return widget;\n        });\n      };\n      var onHorizontalArrow = function (component, simulatedEvent) {\n        return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n          if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }();\n      };\n      return {\n        dom: detail.dom,\n        components: components$1,\n        domModification: detail.domModification,\n        events: derive([\n          runOnExecute(function (component, simulatedEvent) {\n            focusWidget(component).each(function (_widget) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(mouseover(), onHover),\n          run(focusItem(), function (component, _simulatedEvent) {\n            if (detail.autofocus) {\n              focusWidget(component);\n            } else {\n              Focusing.focus(component);\n            }\n          })\n        ]),\n        behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            focusIn: detail.autofocus ? function (component) {\n              focusWidget(component);\n            } : revoke(),\n            onLeft: onHorizontalArrow,\n            onRight: onHorizontalArrow,\n            onEscape: function (component, simulatedEvent) {\n              if (!Focusing.isFocused(component) && !detail.autofocus) {\n                Focusing.focus(component);\n                return Optional.some(true);\n              } else if (detail.autofocus) {\n                simulatedEvent.setSource(component.element);\n                return Optional.none();\n              } else {\n                return Optional.none();\n              }\n            }\n          })\n        ])\n      };\n    };\n    var schema$c = [\n      strict$1('uid'),\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('autofocus', false),\n      defaulted$1('ignoreFocus', false),\n      SketchBehaviours.field('widgetBehaviours', [\n        Representing,\n        Focusing,\n        Keying\n      ]),\n      defaulted$1('domModification', {}),\n      defaultUidsSchema(parts()),\n      output('builder', builder$2)\n    ];\n\n    var itemSchema$1 = choose$1('type', {\n      widget: schema$c,\n      item: schema$a,\n      separator: schema$b\n    });\n    var configureGrid = function (detail, movementInfo) {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + detail.markers.item,\n        initSize: {\n          numColumns: movementInfo.initSize.numColumns,\n          numRows: movementInfo.initSize.numRows\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMatrix = function (detail, movementInfo) {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: movementInfo.rowSelector,\n          cell: '.' + detail.markers.item\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMenu = function (detail, movementInfo) {\n      return {\n        mode: 'menu',\n        selector: '.' + detail.markers.item,\n        moveOnTab: movementInfo.moveOnTab,\n        focusManager: detail.focusManager\n      };\n    };\n    var parts$1 = constant([group({\n        factory: {\n          sketch: function (spec) {\n            var itemInfo = asRawOrDie('menu.spec item', itemSchema$1, spec);\n            return itemInfo.builder(itemInfo);\n          }\n        },\n        name: 'items',\n        unit: 'item',\n        defaults: function (detail, u) {\n          return u.hasOwnProperty('uid') ? u : __assign(__assign({}, u), { uid: generate$2('item') });\n        },\n        overrides: function (detail, u) {\n          return {\n            type: u.type,\n            ignoreFocus: detail.fakeFocus,\n            domModification: { classes: [detail.markers.item] }\n          };\n        }\n      })]);\n    var schema$d = constant([\n      strict$1('value'),\n      strict$1('items'),\n      strict$1('dom'),\n      strict$1('components'),\n      defaulted$1('eventOrder', {}),\n      field$1('menuBehaviours', [\n        Highlighting,\n        Representing,\n        Composing,\n        Keying\n      ]),\n      defaultedOf('movement', {\n        mode: 'menu',\n        moveOnTab: true\n      }, choose$1('mode', {\n        grid: [\n          initSize(),\n          output('config', configureGrid)\n        ],\n        matrix: [\n          output('config', configureMatrix),\n          strict$1('rowSelector')\n        ],\n        menu: [\n          defaulted$1('moveOnTab', true),\n          output('config', configureMenu)\n        ]\n      })),\n      itemMarkers(),\n      defaulted$1('fakeFocus', false),\n      defaulted$1('focusManager', dom()),\n      onHandler('onHighlight')\n    ]);\n\n    var focus$4 = constant('alloy.menu-focus');\n\n    var make$1 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.menuBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedItem,\n            itemClass: detail.markers.item,\n            onHighlight: detail.onHighlight\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          }),\n          Composing.config({ find: Optional.some }),\n          Keying.config(detail.movement.config(detail, detail.movement))\n        ]),\n        events: derive([\n          run(focus$3(), function (menu, simulatedEvent) {\n            var event = simulatedEvent.event;\n            menu.getSystem().getByDom(event.target).each(function (item) {\n              Highlighting.highlight(menu, item);\n              simulatedEvent.stop();\n              emitWith(menu, focus$4(), {\n                menu: menu,\n                item: item\n              });\n            });\n          }),\n          run(hover(), function (menu, simulatedEvent) {\n            var item = simulatedEvent.event.item;\n            Highlighting.highlight(menu, item);\n          })\n        ]),\n        components: components,\n        eventOrder: detail.eventOrder,\n        domModification: { attributes: { role: 'menu' } }\n      };\n    };\n\n    var Menu = composite$1({\n      name: 'Menu',\n      configFields: schema$d(),\n      partFields: parts$1(),\n      factory: make$1\n    });\n\n    var transpose = function (obj) {\n      return tupleMap(obj, function (v, k) {\n        return {\n          k: v,\n          v: k\n        };\n      });\n    };\n    var trace = function (items, byItem, byMenu, finish) {\n      return get(byMenu, finish).bind(function (triggerItem) {\n        return get(items, triggerItem).bind(function (triggerMenu) {\n          var rest = trace(items, byItem, byMenu, triggerMenu);\n          return Optional.some([triggerMenu].concat(rest));\n        });\n      }).getOr([]);\n    };\n    var generate$5 = function (menus, expansions) {\n      var items = {};\n      each$1(menus, function (menuItems, menu) {\n        each(menuItems, function (item) {\n          items[item] = menu;\n        });\n      });\n      var byItem = expansions;\n      var byMenu = transpose(expansions);\n      var menuPaths = map$2(byMenu, function (_triggerItem, submenu) {\n        return [submenu].concat(trace(items, byItem, byMenu, submenu));\n      });\n      return map$2(items, function (menu) {\n        return get(menuPaths, menu).getOr([menu]);\n      });\n    };\n\n    var init$3 = function () {\n      var expansions = Cell({});\n      var menus = Cell({});\n      var paths = Cell({});\n      var primary = Cell(Optional.none());\n      var directory = Cell({});\n      var clear = function () {\n        expansions.set({});\n        menus.set({});\n        paths.set({});\n        primary.set(Optional.none());\n      };\n      var isClear = function () {\n        return primary.get().isNone();\n      };\n      var setMenuBuilt = function (menuName, built) {\n        var _a;\n        menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n          type: 'prepared',\n          menu: built\n        }, _a)));\n      };\n      var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n        primary.set(Optional.some(sPrimary));\n        expansions.set(sExpansions);\n        menus.set(sMenus);\n        directory.set(dir);\n        var sPaths = generate$5(dir, sExpansions);\n        paths.set(sPaths);\n      };\n      var getTriggeringItem = function (menuValue) {\n        return find$1(expansions.get(), function (v, _k) {\n          return v === menuValue;\n        });\n      };\n      var getTriggerData = function (menuValue, getItemByValue, path) {\n        return getPreparedMenu(menuValue).bind(function (menu) {\n          return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n            return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n              return {\n                triggeredMenu: menu,\n                triggeringItem: triggeredItem,\n                triggeringPath: path\n              };\n            });\n          });\n        });\n      };\n      var getTriggeringPath = function (itemValue, getItemByValue) {\n        var extraPath = filter(lookupItem(itemValue).toArray(), function (menuValue) {\n          return getPreparedMenu(menuValue).isSome();\n        });\n        return get(paths.get(), itemValue).bind(function (path) {\n          var revPath = reverse(extraPath.concat(path));\n          var triggers = bind(revPath, function (menuValue, menuIndex) {\n            return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n              return primary.get().is(menuValue) ? [] : [Optional.none()];\n            }, function (data) {\n              return [Optional.some(data)];\n            });\n          });\n          return sequence(triggers);\n        });\n      };\n      var expand = function (itemValue) {\n        return get(expansions.get(), itemValue).map(function (menu) {\n          var current = get(paths.get(), itemValue).getOr([]);\n          return [menu].concat(current);\n        });\n      };\n      var collapse = function (itemValue) {\n        return get(paths.get(), itemValue).bind(function (path) {\n          return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n        });\n      };\n      var refresh = function (itemValue) {\n        return get(paths.get(), itemValue);\n      };\n      var getPreparedMenu = function (menuValue) {\n        return lookupMenu(menuValue).bind(extractPreparedMenu);\n      };\n      var lookupMenu = function (menuValue) {\n        return get(menus.get(), menuValue);\n      };\n      var lookupItem = function (itemValue) {\n        return get(expansions.get(), itemValue);\n      };\n      var otherMenus = function (path) {\n        var menuValues = directory.get();\n        return difference(keys(menuValues), path);\n      };\n      var getPrimary = function () {\n        return primary.get().bind(getPreparedMenu);\n      };\n      var getMenus = function () {\n        return menus.get();\n      };\n      return {\n        setMenuBuilt: setMenuBuilt,\n        setContents: setContents,\n        expand: expand,\n        refresh: refresh,\n        collapse: collapse,\n        lookupMenu: lookupMenu,\n        lookupItem: lookupItem,\n        otherMenus: otherMenus,\n        getPrimary: getPrimary,\n        getMenus: getMenus,\n        clear: clear,\n        isClear: isClear,\n        getTriggeringPath: getTriggeringPath\n      };\n    };\n    var extractPreparedMenu = function (prep) {\n      return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n    };\n    var LayeredState = {\n      init: init$3,\n      extractPreparedMenu: extractPreparedMenu\n    };\n\n    var make$2 = function (detail, _rawUiSpec) {\n      var submenuParentItems = Cell(Optional.none());\n      var buildMenus = function (container, primaryName, menus) {\n        return map$2(menus, function (spec, name) {\n          var makeSketch = function () {\n            return Menu.sketch(__assign(__assign({}, spec), {\n              value: name,\n              markers: detail.markers,\n              fakeFocus: detail.fakeFocus,\n              onHighlight: detail.onHighlight,\n              focusManager: detail.fakeFocus ? highlights() : dom()\n            }));\n          };\n          return name === primaryName ? {\n            type: 'prepared',\n            menu: container.getSystem().build(makeSketch())\n          } : {\n            type: 'notbuilt',\n            nbMenu: makeSketch\n          };\n        });\n      };\n      var layeredState = LayeredState.init();\n      var setup = function (container) {\n        var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n        var directory = toDirectory();\n        layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n        return layeredState.getPrimary();\n      };\n      var getItemValue = function (item) {\n        return Representing.getValue(item).value;\n      };\n      var getItemByValue = function (_container, menus, itemValue) {\n        return findMap(menus, function (menu) {\n          if (!menu.getSystem().isConnected()) {\n            return Optional.none();\n          }\n          var candidates = Highlighting.getCandidates(menu);\n          return find(candidates, function (c) {\n            return getItemValue(c) === itemValue;\n          });\n        });\n      };\n      var toDirectory = function (_container) {\n        return map$2(detail.data.menus, function (data, _menuName) {\n          return bind(data.items, function (item) {\n            return item.type === 'separator' ? [] : [item.data.value];\n          });\n        });\n      };\n      var setActiveMenu = function (container, menu) {\n        Highlighting.highlight(container, menu);\n        Highlighting.getHighlighted(menu).orThunk(function () {\n          return Highlighting.getFirst(menu);\n        }).each(function (item) {\n          dispatch(container, item.element, focusItem());\n        });\n      };\n      var getMenus = function (state, menuValues) {\n        return cat(map(menuValues, function (mv) {\n          return state.lookupMenu(mv).bind(function (prep) {\n            return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n          });\n        }));\n      };\n      var closeOthers = function (container, state, path) {\n        var others = getMenus(state, state.otherMenus(path));\n        each(others, function (o) {\n          remove$5(o.element, [detail.markers.backgroundMenu]);\n          if (!detail.stayInDom) {\n            Replacing.remove(container, o);\n          }\n        });\n      };\n      var getSubmenuParents = function (container) {\n        return submenuParentItems.get().getOrThunk(function () {\n          var r = {};\n          var items = descendants(container.element, '.' + detail.markers.item);\n          var parentItems = filter(items, function (i) {\n            return get$2(i, 'aria-haspopup') === 'true';\n          });\n          each(parentItems, function (i) {\n            container.getSystem().getByDom(i).each(function (itemComp) {\n              var key = getItemValue(itemComp);\n              r[key] = itemComp;\n            });\n          });\n          submenuParentItems.set(Optional.some(r));\n          return r;\n        });\n      };\n      var updateAriaExpansions = function (container, path) {\n        var parentItems = getSubmenuParents(container);\n        each$1(parentItems, function (v, k) {\n          var expanded = contains(path, k);\n          set$1(v.element, 'aria-expanded', expanded);\n        });\n      };\n      var updateMenuPath = function (container, state, path) {\n        return Optional.from(path[0]).bind(function (latestMenuName) {\n          return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n            if (menuPrep.type === 'notbuilt') {\n              return Optional.none();\n            } else {\n              var activeMenu = menuPrep.menu;\n              var rest = getMenus(state, path.slice(1));\n              each(rest, function (r) {\n                add$2(r.element, detail.markers.backgroundMenu);\n              });\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              remove$5(activeMenu.element, [detail.markers.backgroundMenu]);\n              setActiveMenu(container, activeMenu);\n              closeOthers(container, state, path);\n              return Optional.some(activeMenu);\n            }\n          });\n        });\n      };\n      var ExpandHighlightDecision;\n      (function (ExpandHighlightDecision) {\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n      }(ExpandHighlightDecision || (ExpandHighlightDecision = {})));\n      var buildIfRequired = function (container, menuName, menuPrep) {\n        if (menuPrep.type === 'notbuilt') {\n          var menu = container.getSystem().build(menuPrep.nbMenu());\n          layeredState.setMenuBuilt(menuName, menu);\n          return menu;\n        } else {\n          return menuPrep.menu;\n        }\n      };\n      var expandRight = function (container, item, decision) {\n        if (decision === void 0) {\n          decision = ExpandHighlightDecision.HighlightSubmenu;\n        }\n        var value = getItemValue(item);\n        return layeredState.expand(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return Optional.from(path[0]).bind(function (menuName) {\n            return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n              var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n              if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n                Highlighting.highlightFirst(activeMenu);\n                return updateMenuPath(container, layeredState, path);\n              } else {\n                Highlighting.dehighlightAll(activeMenu);\n                return Optional.some(item);\n              }\n            });\n          });\n        });\n      };\n      var collapseLeft = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.collapse(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n            detail.onCollapseMenu(container, item, activeMenu);\n            return activeMenu;\n          });\n        });\n      };\n      var updateView = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.refresh(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path);\n        });\n      };\n      var onRight = function (container, item) {\n        return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n      };\n      var onLeft = function (container, item) {\n        return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n      };\n      var onEscape = function (container, item) {\n        return collapseLeft(container, item).orThunk(function () {\n          return detail.onEscape(container, item).map(function () {\n            return container;\n          });\n        });\n      };\n      var keyOnItem = function (f) {\n        return function (container, simulatedEvent) {\n          return closest$3(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n            return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n              return f(container, item).map(function () {\n                return true;\n              });\n            });\n          });\n        };\n      };\n      var events = derive([\n        run(focus$4(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          layeredState.lookupItem(getItemValue(item)).each(function () {\n            var menu = simulatedEvent.event.menu;\n            Highlighting.highlight(sandbox, menu);\n            var value = getItemValue(simulatedEvent.event.item);\n            layeredState.refresh(value).each(function (path) {\n              return closeOthers(sandbox, layeredState, path);\n            });\n          });\n        }),\n        runOnExecute(function (component, simulatedEvent) {\n          var target = simulatedEvent.event.target;\n          component.getSystem().getByDom(target).each(function (item) {\n            var itemValue = getItemValue(item);\n            if (itemValue.indexOf('collapse-item') === 0) {\n              collapseLeft(component, item);\n            }\n            expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n              detail.onExecute(component, item);\n            }, function () {\n            });\n          });\n        }),\n        runOnAttached(function (container, _simulatedEvent) {\n          setup(container).each(function (primary) {\n            Replacing.append(container, premade$1(primary));\n            detail.onOpenMenu(container, primary);\n            if (detail.highlightImmediately) {\n              setActiveMenu(container, primary);\n            }\n          });\n        })\n      ].concat(detail.navigateOnHover ? [run(hover(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          updateView(sandbox, item);\n          expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n          detail.onHover(sandbox, item);\n        })] : []));\n      var getActiveItem = function (container) {\n        return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n      };\n      var collapseMenuApi = function (container) {\n        getActiveItem(container).each(function (currentItem) {\n          collapseLeft(container, currentItem);\n        });\n      };\n      var highlightPrimary = function (container) {\n        layeredState.getPrimary().each(function (primary) {\n          setActiveMenu(container, primary);\n        });\n      };\n      var extractMenuFromContainer = function (container) {\n        return Optional.from(container.components()[0]).filter(function (comp) {\n          return get$2(comp.element, 'role') === 'menu';\n        });\n      };\n      var repositionMenus = function (container) {\n        var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n          return getActiveItem(container).bind(function (currentItem) {\n            var itemValue = getItemValue(currentItem);\n            var allMenus = values(layeredState.getMenus());\n            var preparedMenus = cat(map(allMenus, LayeredState.extractPreparedMenu));\n            return layeredState.getTriggeringPath(itemValue, function (v) {\n              return getItemByValue(container, preparedMenus, v);\n            });\n          }).map(function (triggeringPath) {\n            return {\n              primary: primary,\n              triggeringPath: triggeringPath\n            };\n          });\n        });\n        maybeActivePrimary.fold(function () {\n          extractMenuFromContainer(container).each(function (primaryMenu) {\n            detail.onRepositionMenu(container, primaryMenu, []);\n          });\n        }, function (_a) {\n          var primary = _a.primary, triggeringPath = _a.triggeringPath;\n          detail.onRepositionMenu(container, primary, triggeringPath);\n        });\n      };\n      var apis = {\n        collapseMenu: collapseMenuApi,\n        highlightPrimary: highlightPrimary,\n        repositionMenus: repositionMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.tmenuBehaviours, [\n          Keying.config({\n            mode: 'special',\n            onRight: keyOnItem(onRight),\n            onLeft: keyOnItem(onLeft),\n            onEscape: keyOnItem(onEscape),\n            focusIn: function (container, _keyInfo) {\n              layeredState.getPrimary().each(function (primary) {\n                dispatch(container, primary.element, focusItem());\n              });\n            }\n          }),\n          Highlighting.config({\n            highlightClass: detail.markers.selectedMenu,\n            itemClass: detail.markers.menu\n          }),\n          Composing.config({\n            find: function (container) {\n              return Highlighting.getHighlighted(container);\n            }\n          }),\n          Replacing.config({})\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis,\n        events: events\n      };\n    };\n    var collapseItem = constant('collapse-item');\n\n    var tieredData = function (primary, menus, expansions) {\n      return {\n        primary: primary,\n        menus: menus,\n        expansions: expansions\n      };\n    };\n    var singleData = function (name, menu) {\n      return {\n        primary: name,\n        menus: wrap$1(name, menu),\n        expansions: {}\n      };\n    };\n    var collapseItem$1 = function (text) {\n      return {\n        value: generate$1(collapseItem()),\n        meta: { text: text }\n      };\n    };\n    var tieredMenu = single$2({\n      name: 'TieredMenu',\n      configFields: [\n        onStrictKeyboardHandler('onExecute'),\n        onStrictKeyboardHandler('onEscape'),\n        onStrictHandler('onOpenMenu'),\n        onStrictHandler('onOpenSubmenu'),\n        onHandler('onRepositionMenu'),\n        onHandler('onCollapseMenu'),\n        defaulted$1('highlightImmediately', true),\n        strictObjOf('data', [\n          strict$1('primary'),\n          strict$1('menus'),\n          strict$1('expansions')\n        ]),\n        defaulted$1('fakeFocus', false),\n        onHandler('onHighlight'),\n        onHandler('onHover'),\n        tieredMenuMarkers(),\n        strict$1('dom'),\n        defaulted$1('navigateOnHover', true),\n        defaulted$1('stayInDom', false),\n        field$1('tmenuBehaviours', [\n          Keying,\n          Highlighting,\n          Composing,\n          Replacing\n        ]),\n        defaulted$1('eventOrder', {})\n      ],\n      apis: {\n        collapseMenu: function (apis, tmenu) {\n          apis.collapseMenu(tmenu);\n        },\n        highlightPrimary: function (apis, tmenu) {\n          apis.highlightPrimary(tmenu);\n        },\n        repositionMenus: function (apis, tmenu) {\n          apis.repositionMenus(tmenu);\n        }\n      },\n      factory: make$2,\n      extraApis: {\n        tieredData: tieredData,\n        singleData: singleData,\n        collapseItem: collapseItem$1\n      }\n    });\n\n    var makeMenu = function (detail, menuSandbox, anchor, menuSpec, getBounds) {\n      var lazySink = function () {\n        return detail.lazySink(menuSandbox);\n      };\n      var layouts = menuSpec.type === 'horizontal' ? {\n        layouts: {\n          onLtr: function () {\n            return belowOrAbove();\n          },\n          onRtl: function () {\n            return belowOrAboveRtl();\n          }\n        }\n      } : {};\n      var isFirstTierSubmenu = function (triggeringPaths) {\n        return triggeringPaths.length === 2;\n      };\n      var getSubmenuLayouts = function (triggeringPaths) {\n        return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n      };\n      return tieredMenu.sketch({\n        dom: { tag: 'div' },\n        data: menuSpec.data,\n        markers: menuSpec.menu.markers,\n        highlightImmediately: menuSpec.menu.highlightImmediately,\n        onEscape: function () {\n          Sandboxing.close(menuSandbox);\n          detail.onEscape.map(function (handler) {\n            return handler(menuSandbox);\n          });\n          return Optional.some(true);\n        },\n        onExecute: function () {\n          return Optional.some(true);\n        },\n        onOpenMenu: function (tmenu, menu) {\n          Positioning.positionWithinBounds(lazySink().getOrDie(), anchor, menu, getBounds());\n        },\n        onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n          var sink = lazySink().getOrDie();\n          Positioning.position(sink, __assign({\n            anchor: 'submenu',\n            item: item\n          }, getSubmenuLayouts(triggeringPaths)), submenu);\n        },\n        onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n          var sink = lazySink().getOrDie();\n          Positioning.positionWithinBounds(sink, anchor, primaryMenu, getBounds());\n          each(submenuTriggers, function (st) {\n            var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n            Positioning.position(sink, __assign({\n              anchor: 'submenu',\n              item: st.triggeringItem\n            }, submenuLayouts), st.triggeredMenu);\n          });\n        }\n      });\n    };\n    var factory = function (detail, spec) {\n      var isPartOfRelated = function (sandbox, queryElem) {\n        var related = detail.getRelated(sandbox);\n        return related.exists(function (rel) {\n          return isPartOf(rel, queryElem);\n        });\n      };\n      var setContent = function (sandbox, thing) {\n        Sandboxing.setContent(sandbox, thing);\n      };\n      var showAt = function (sandbox, anchor, thing) {\n        showWithin(sandbox, anchor, thing, Optional.none());\n      };\n      var showWithin = function (sandbox, anchor, thing, boxElement) {\n        showWithinBounds(sandbox, anchor, thing, function () {\n          return boxElement.map(function (elem) {\n            return box(elem);\n          });\n        });\n      };\n      var showWithinBounds = function (sandbox, anchor, thing, getBounds) {\n        var sink = detail.lazySink(sandbox).getOrDie();\n        Sandboxing.openWhileCloaked(sandbox, thing, function () {\n          return Positioning.positionWithinBounds(sink, anchor, sandbox, getBounds());\n        });\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'position',\n          anchor: anchor,\n          getBounds: getBounds\n        }));\n      };\n      var showMenuAt = function (sandbox, anchor, menuSpec) {\n        showMenuWithinBounds(sandbox, anchor, menuSpec, function () {\n          return Optional.none();\n        });\n      };\n      var showMenuWithinBounds = function (sandbox, anchor, menuSpec, getBounds) {\n        var menu = makeMenu(detail, sandbox, anchor, menuSpec, getBounds);\n        Sandboxing.open(sandbox, menu);\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'menu',\n          menu: menu\n        }));\n      };\n      var hide = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.setValue(sandbox, Optional.none());\n          Sandboxing.close(sandbox);\n        }\n      };\n      var getContent = function (sandbox) {\n        return Sandboxing.getState(sandbox);\n      };\n      var reposition = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.getValue(sandbox).each(function (state) {\n            switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(function (tmenu) {\n                tieredMenu.repositionMenus(tmenu);\n              });\n              break;\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, state.anchor, sandbox, state.getBounds());\n              break;\n            }\n          });\n        }\n      };\n      var apis = {\n        setContent: setContent,\n        showAt: showAt,\n        showWithin: showWithin,\n        showWithinBounds: showWithinBounds,\n        showMenuAt: showMenuAt,\n        showMenuWithinBounds: showMenuWithinBounds,\n        hide: hide,\n        getContent: getContent,\n        reposition: reposition,\n        isOpen: Sandboxing.isOpen\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.inlineBehaviours, [\n          Sandboxing.config({\n            isPartOf: function (sandbox, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n            },\n            getAttachPoint: function (sandbox) {\n              return detail.lazySink(sandbox).getOrDie();\n            },\n            onOpen: function (sandbox) {\n              detail.onShow(sandbox);\n            },\n            onClose: function (sandbox) {\n              detail.onHide(sandbox);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: Optional.none()\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel(__assign({ isExtraPart: spec.isExtraPart }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel$1(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})), { doReposition: reposition })))\n          })\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis\n      };\n    };\n    var InlineView = single$2({\n      name: 'InlineView',\n      configFields: [\n        strict$1('lazySink'),\n        onHandler('onShow'),\n        onHandler('onHide'),\n        optionFunction('onEscape'),\n        field$1('inlineBehaviours', [\n          Sandboxing,\n          Representing,\n          Receiving\n        ]),\n        optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]),\n        optionObjOf('fireRepositionEventInstead', [defaulted$1('event', repositionRequested())]),\n        defaulted$1('getRelated', Optional.none),\n        defaulted$1('isExtraPart', never),\n        defaulted$1('eventOrder', Optional.none)\n      ],\n      factory: factory,\n      apis: {\n        showAt: function (apis, component, anchor, thing) {\n          apis.showAt(component, anchor, thing);\n        },\n        showWithin: function (apis, component, anchor, thing, boxElement) {\n          apis.showWithin(component, anchor, thing, boxElement);\n        },\n        showWithinBounds: function (apis, component, anchor, thing, bounds) {\n          apis.showWithinBounds(component, anchor, thing, bounds);\n        },\n        showMenuAt: function (apis, component, anchor, menuSpec) {\n          apis.showMenuAt(component, anchor, menuSpec);\n        },\n        showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n          apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n        },\n        hide: function (apis, component) {\n          apis.hide(component);\n        },\n        isOpen: function (apis, component) {\n          return apis.isOpen(component);\n        },\n        getContent: function (apis, component) {\n          return apis.getContent(component);\n        },\n        setContent: function (apis, component, thing) {\n          apis.setContent(component, thing);\n        },\n        reposition: function (apis, component) {\n          apis.reposition(component);\n        }\n      }\n    });\n\n    var westEdgeX$1 = function (anchor) {\n      return anchor.x;\n    };\n    var middleX$1 = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var eastEdgeX$1 = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY$2 = function (anchor) {\n      return anchor.y;\n    };\n    var southY$2 = function (anchor, element) {\n      return anchor.y + anchor.height - element.height;\n    };\n    var southeast$3 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX$1(anchor, element), southY$2(anchor, element), bubbles.innerSoutheast(), northwest(), boundsRestriction(anchor, {\n        right: 0,\n        bottom: 3\n      }), 'layout-inner-se');\n    };\n    var southwest$3 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX$1(anchor), southY$2(anchor, element), bubbles.innerSouthwest(), northeast(), boundsRestriction(anchor, {\n        left: 1,\n        bottom: 3\n      }), 'layout-inner-sw');\n    };\n    var northeast$3 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX$1(anchor, element), northY$2(anchor), bubbles.innerNortheast(), southwest(), boundsRestriction(anchor, {\n        right: 0,\n        top: 2\n      }), 'layout-inner-ne');\n    };\n    var northwest$3 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX$1(anchor), northY$2(anchor), bubbles.innerNorthwest(), southeast(), boundsRestriction(anchor, {\n        left: 1,\n        top: 2\n      }), 'layout-inner-nw');\n    };\n    var north$3 = function (anchor, element, bubbles) {\n      return nu$7(middleX$1(anchor, element), northY$2(anchor), bubbles.innerNorth(), south(), boundsRestriction(anchor, { top: 2 }), 'layout-inner-n');\n    };\n    var south$3 = function (anchor, element, bubbles) {\n      return nu$7(middleX$1(anchor, element), southY$2(anchor, element), bubbles.innerSouth(), north(), boundsRestriction(anchor, { bottom: 3 }), 'layout-inner-s');\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var factory$1 = function (detail) {\n      var events = events$7(detail.action);\n      var tag = detail.dom.tag;\n      var lookupAttr = function (attr) {\n        return get(detail.dom, 'attributes').bind(function (attrs) {\n          return get(attrs, attr);\n        });\n      };\n      var getModAttributes = function () {\n        if (tag === 'button') {\n          var type = lookupAttr('type').getOr('button');\n          var roleAttrs = lookupAttr('role').map(function (role) {\n            return { role: role };\n          }).getOr({});\n          return __assign({ type: type }, roleAttrs);\n        } else {\n          var role = lookupAttr('role').getOr('button');\n          return { role: role };\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events,\n        behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          })\n        ]),\n        domModification: { attributes: getModAttributes() },\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Button = single$2({\n      name: 'Button',\n      factory: factory$1,\n      configFields: [\n        defaulted$1('uid', undefined),\n        strict$1('dom'),\n        defaulted$1('components', []),\n        SketchBehaviours.field('buttonBehaviours', [\n          Focusing,\n          Keying\n        ]),\n        option('action'),\n        option('role'),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var record = function (spec) {\n      var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$2('memento');\n      var get = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).getOrDie();\n      };\n      var getOpt = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).toOptional();\n      };\n      var asSpec = function () {\n        return __assign(__assign({}, spec), { uid: uid });\n      };\n      return {\n        get: get,\n        getOpt: getOpt,\n        asSpec: asSpec\n      };\n    };\n\n    var defaultIcon = function (icons) {\n      return Optional.from(icons()['temporary-placeholder']).getOr('!not found!');\n    };\n    var get$d = function (name, icons) {\n      return Optional.from(icons()[name.toLowerCase()]).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n    var getOr = function (name, icons, fallback) {\n      return Optional.from(icons()[name.toLowerCase()]).or(fallback).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n    var getFirst$1 = function (names, icons) {\n      return findMap(names, function (name) {\n        return Optional.from(icons()[name.toLowerCase()]);\n      }).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n\n    var notificationIconMap = {\n      success: 'checkmark',\n      error: 'warning',\n      err: 'error',\n      warning: 'warning',\n      warn: 'warning',\n      info: 'info'\n    };\n    var factory$2 = function (detail) {\n      var memBannerText = record({\n        dom: {\n          tag: 'p',\n          innerHtml: detail.translationProvider(detail.text)\n        },\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var renderPercentBar = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-bar'],\n            attributes: { style: 'width: ' + percent + '%' }\n          }\n        };\n      };\n      var renderPercentText = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-text'],\n            innerHtml: percent + '%'\n          }\n        };\n      };\n      var memBannerProgress = record({\n        dom: {\n          tag: 'div',\n          classes: detail.progress ? [\n            'tox-progress-bar',\n            'tox-progress-indicator'\n          ] : ['tox-progress-bar']\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(0)]\n          },\n          renderPercentText(0)\n        ],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var updateProgress = function (comp, percent) {\n        if (comp.getSystem().isConnected()) {\n          memBannerProgress.getOpt(comp).each(function (progress) {\n            Replacing.set(progress, [\n              {\n                dom: {\n                  tag: 'div',\n                  classes: ['tox-bar-container']\n                },\n                components: [renderPercentBar(percent)]\n              },\n              renderPercentText(percent)\n            ]);\n          });\n        }\n      };\n      var updateText = function (comp, text$1) {\n        if (comp.getSystem().isConnected()) {\n          var banner = memBannerText.get(comp);\n          Replacing.set(banner, [text(text$1)]);\n        }\n      };\n      var apis = {\n        updateProgress: updateProgress,\n        updateText: updateText\n      };\n      var iconChoices = flatten([\n        detail.icon.toArray(),\n        detail.level.toArray(),\n        detail.level.bind(function (level) {\n          return Optional.from(notificationIconMap[level]);\n        }).toArray()\n      ]);\n      var memButton = record(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-notification__dismiss',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ]\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-icon'],\n              innerHtml: get$d('close', detail.iconProvider),\n              attributes: { 'aria-label': detail.translationProvider('Close') }\n            }\n          }],\n        action: function (comp) {\n          detail.onAction(comp);\n        }\n      }));\n      var components = [\n        {\n          dom: {\n            tag: 'div',\n            classes: ['tox-notification__icon'],\n            innerHtml: getFirst$1(iconChoices, detail.iconProvider)\n          }\n        },\n        {\n          dom: {\n            tag: 'div',\n            classes: ['tox-notification__body']\n          },\n          components: [memBannerText.asSpec()],\n          behaviours: derive$1([Replacing.config({})])\n        }\n      ];\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: detail.level.map(function (level) {\n            return [\n              'tox-notification',\n              'tox-notification--in',\n              'tox-notification--' + level\n            ];\n          }).getOr([\n            'tox-notification',\n            'tox-notification--in'\n          ])\n        },\n        behaviours: derive$1([\n          Focusing.config({}),\n          config('notification-events', [run(focusin(), function (comp) {\n              memButton.getOpt(comp).each(Focusing.focus);\n            })])\n        ]),\n        components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n        apis: apis\n      };\n    };\n    var Notification = single$2({\n      name: 'Notification',\n      factory: factory$2,\n      configFields: [\n        option('level'),\n        strict$1('progress'),\n        strict$1('icon'),\n        strict$1('onAction'),\n        strict$1('text'),\n        strict$1('iconProvider'),\n        strict$1('translationProvider'),\n        defaultedBoolean('closeButton', true)\n      ],\n      apis: {\n        updateProgress: function (apis, comp, percent) {\n          apis.updateProgress(comp, percent);\n        },\n        updateText: function (apis, comp, text) {\n          apis.updateText(comp, text);\n        }\n      }\n    });\n\n    function NotificationManagerImpl (editor, extras, uiMothership) {\n      var backstage = extras.backstage;\n      var getLayoutDirection = function (rel) {\n        switch (rel) {\n        case 'bc-bc':\n          return south$3;\n        case 'tc-tc':\n          return north$3;\n        case 'tc-bc':\n          return north$1;\n        case 'bc-tc':\n        default:\n          return south$1;\n        }\n      };\n      var prePositionNotifications = function (notifications) {\n        each(notifications, function (notification) {\n          return notification.moveTo(0, 0);\n        });\n      };\n      var positionNotifications = function (notifications) {\n        if (notifications.length > 0) {\n          head(notifications).each(function (firstItem) {\n            return firstItem.moveRel(null, 'banner');\n          });\n          each(notifications, function (notification, index) {\n            if (index > 0) {\n              notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n            }\n          });\n        }\n      };\n      var reposition = function (notifications) {\n        prePositionNotifications(notifications);\n        positionNotifications(notifications);\n      };\n      var open = function (settings, closeCallback) {\n        var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n        var close = function () {\n          closeCallback();\n          InlineView.hide(notificationWrapper);\n        };\n        var notification = build$1(Notification.sketch({\n          text: settings.text,\n          level: contains([\n            'success',\n            'error',\n            'warning',\n            'warn',\n            'info'\n          ], settings.type) ? settings.type : undefined,\n          progress: settings.progressBar === true,\n          icon: Optional.from(settings.icon),\n          closeButton: !hideCloseButton,\n          onAction: close,\n          iconProvider: backstage.shared.providers.icons,\n          translationProvider: backstage.shared.providers.translate\n        }));\n        var notificationWrapper = build$1(InlineView.sketch(__assign({\n          dom: {\n            tag: 'div',\n            classes: ['tox-notifications-container']\n          },\n          lazySink: extras.backstage.shared.getSink,\n          fireDismissalEventInstead: {}\n        }, backstage.shared.header.isPositionedAtTop() ? {} : { fireRepositionEventInstead: {} })));\n        uiMothership.add(notificationWrapper);\n        if (settings.timeout > 0) {\n          global$2.setTimeout(function () {\n            close();\n          }, settings.timeout);\n        }\n        return {\n          close: close,\n          moveTo: function (x, y) {\n            InlineView.showAt(notificationWrapper, {\n              anchor: 'makeshift',\n              x: x,\n              y: y\n            }, premade$1(notification));\n          },\n          moveRel: function (element, rel) {\n            if (rel !== 'banner') {\n              var layoutDirection_1 = getLayoutDirection(rel);\n              var nodeAnchor = {\n                anchor: 'node',\n                root: body(),\n                node: Optional.some(SugarElement.fromDom(element)),\n                layouts: {\n                  onRtl: function () {\n                    return [layoutDirection_1];\n                  },\n                  onLtr: function () {\n                    return [layoutDirection_1];\n                  }\n                }\n              };\n              InlineView.showAt(notificationWrapper, nodeAnchor, premade$1(notification));\n            } else {\n              InlineView.showAt(notificationWrapper, extras.backstage.shared.anchors.banner(), premade$1(notification));\n            }\n          },\n          text: function (nuText) {\n            Notification.updateText(notification, nuText);\n          },\n          settings: settings,\n          getEl: function () {\n            return notification.element.dom;\n          },\n          progressBar: {\n            value: function (percent) {\n              Notification.updateProgress(notification, percent);\n            }\n          }\n        };\n      };\n      var close = function (notification) {\n        notification.close();\n      };\n      var getArgs = function (notification) {\n        return notification.settings;\n      };\n      return {\n        open: open,\n        close: close,\n        reposition: reposition,\n        getArgs: getArgs\n      };\n    }\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n    var isBoundary = function (dom, node) {\n      return dom.isBlock(node) || contains([\n        'BR',\n        'IMG',\n        'HR',\n        'INPUT'\n      ], node.nodeName) || dom.getContentEditable(node) === 'false';\n    };\n    var repeatLeft = function (dom, node, offset, process, rootNode) {\n      var search = global$3(dom, function (node) {\n        return isBoundary(dom, node);\n      });\n      return Optional.from(search.backwards(node, offset, process, rootNode));\n    };\n\n    var autocompleteSelector = '[data-mce-autocompleter]';\n    var create$4 = function (editor, range) {\n      return detect$4(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n        var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n        append(wrapper, SugarElement.fromDom(range.extractContents()));\n        range.insertNode(wrapper.dom);\n        parent(wrapper).each(function (elm) {\n          return elm.dom.normalize();\n        });\n        last$1(wrapper).map(function (last) {\n          editor.selection.setCursorLocation(last.dom, getEnd(last));\n        });\n        return wrapper;\n      });\n    };\n    var detect$4 = function (elm) {\n      return closest$3(elm, autocompleteSelector);\n    };\n\n    var isValidTextRange = function (rng) {\n      return rng.collapsed && rng.startContainer.nodeType === 3;\n    };\n    var getText = function (rng) {\n      return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n    };\n    var isWhitespace = function (chr) {\n      return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n\n    var stripTriggerChar = function (text, triggerCh) {\n      return text.substring(triggerCh.length);\n    };\n    var findChar = function (text, index, ch) {\n      var i;\n      for (i = index - 1; i >= 0; i--) {\n        var char = text.charAt(i);\n        if (isWhitespace(char)) {\n          return Optional.none();\n        }\n        if (char === ch) {\n          break;\n        }\n      }\n      return Optional.some(i);\n    };\n    var findStart = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      if (!isValidTextRange(initRange)) {\n        return Optional.none();\n      }\n      var findTriggerChIndex = function (element, offset, text) {\n        return findChar(text, offset, ch).getOr(offset);\n      };\n      var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n      return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n        var range = initRange.cloneRange();\n        range.setStart(spot.container, spot.offset);\n        range.setEnd(initRange.endContainer, initRange.endOffset);\n        if (range.collapsed) {\n          return Optional.none();\n        }\n        var text = getText(range);\n        var triggerCharIndex = text.lastIndexOf(ch);\n        if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            text: stripTriggerChar(text, ch),\n            range: range,\n            triggerChar: ch\n          });\n        }\n      });\n    };\n    var getContext = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      return detect$4(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n        return findStart(dom, initRange, ch, minChars);\n      }, function (elm) {\n        var range = dom.createRng();\n        range.selectNode(elm.dom);\n        var text = getText(range);\n        return Optional.some({\n          range: range,\n          text: stripTriggerChar(text, ch),\n          triggerChar: ch\n        });\n      });\n    };\n\n    var setup = function (api, editor) {\n      editor.on('keypress compositionend', api.onKeypress.throttle);\n      editor.on('remove', api.onKeypress.cancel);\n      var redirectKeyToItem = function (item, e) {\n        emitWith(item, keydown(), { raw: e });\n      };\n      editor.on('keydown', function (e) {\n        var getItem = function () {\n          return api.getView().bind(Highlighting.getHighlighted);\n        };\n        if (e.which === 8) {\n          api.onKeypress.throttle(e);\n        }\n        if (api.isActive()) {\n          if (e.which === 27) {\n            api.cancelIfNecessary();\n          }\n          if (api.isMenuOpen()) {\n            if (e.which === 13) {\n              getItem().each(emitExecute);\n              e.preventDefault();\n            } else if (e.which === 40) {\n              getItem().fold(function () {\n                api.getView().each(Highlighting.highlightFirst);\n              }, function (item) {\n                redirectKeyToItem(item, e);\n              });\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n              getItem().each(function (item) {\n                redirectKeyToItem(item, e);\n                e.preventDefault();\n                e.stopImmediatePropagation();\n              });\n            }\n          } else {\n            if (e.which === 13 || e.which === 38 || e.which === 40) {\n              api.cancelIfNecessary();\n            }\n          }\n        }\n      });\n      editor.on('NodeChange', function (e) {\n        if (api.isActive() && !api.isProcessingAction() && detect$4(SugarElement.fromDom(e.element)).isNone()) {\n          api.cancelIfNecessary();\n        }\n      });\n    };\n    var AutocompleterEditorEvents = { setup: setup };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var point$2 = function (container, offset) {\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n\n    var isText$1 = function (node) {\n      return node.nodeType === TEXT;\n    };\n    var isElement$1 = function (node) {\n      return node.nodeType === ELEMENT;\n    };\n    var toLast = function (node) {\n      if (isText$1(node)) {\n        return point$2(node, node.data.length);\n      } else {\n        var children = node.childNodes;\n        return children.length > 0 ? toLast(children[children.length - 1]) : point$2(node, children.length);\n      }\n    };\n    var toLeaf = function (node, offset) {\n      var children = node.childNodes;\n      if (children.length > 0 && offset < children.length) {\n        return toLeaf(children[offset], 0);\n      } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n        return toLast(children[children.length - 1]);\n      } else {\n        return point$2(node, offset);\n      }\n    };\n\n    var isPreviousCharContent = function (dom, leaf) {\n      return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n        return offset === 0 ? -1 : offset;\n      }, dom.getRoot()).filter(function (spot) {\n        var char = spot.container.data.charAt(spot.offset - 1);\n        return !isWhitespace(char);\n      }).isSome();\n    };\n    var isStartOfWord = function (dom) {\n      return function (rng) {\n        var leaf = toLeaf(rng.startContainer, rng.startOffset);\n        return !isPreviousCharContent(dom, leaf);\n      };\n    };\n    var getTriggerContext = function (dom, initRange, database) {\n      return findMap(database.triggerChars, function (ch) {\n        return getContext(dom, initRange, ch);\n      });\n    };\n    var lookup = function (editor, getDatabase) {\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n        return lookupWithContext(editor, getDatabase, context);\n      });\n    };\n    var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n      if (fetchOptions === void 0) {\n        fetchOptions = {};\n      }\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      var startText = rng.startContainer.nodeValue;\n      var autocompleters = filter(database.lookupByChar(context.triggerChar), function (autocompleter) {\n        return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n          return isStartOfWord(editor.dom);\n        })(context.range, startText, context.text);\n      });\n      if (autocompleters.length === 0) {\n        return Optional.none();\n      }\n      var lookupData = global$4.all(map(autocompleters, function (ac) {\n        var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n        return fetchResult.then(function (results) {\n          return {\n            matchText: context.text,\n            items: results,\n            columns: ac.columns,\n            onAction: ac.onAction\n          };\n        });\n      }));\n      return Optional.some({\n        lookupData: lookupData,\n        context: context\n      });\n    };\n\n    var separatorMenuItemSchema = objOf([\n      strictString('type'),\n      optionString('text')\n    ]);\n    var createSeparatorMenuItem = function (spec) {\n      return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n    };\n\n    var autocompleterItemSchema = objOf([\n      defaulted$1('type', 'autocompleteitem'),\n      defaulted$1('active', false),\n      defaulted$1('disabled', false),\n      defaulted$1('meta', {}),\n      strictString('value'),\n      optionString('text'),\n      optionString('icon')\n    ]);\n    var autocompleterSchema = objOf([\n      strictString('type'),\n      strictString('ch'),\n      defaultedNumber('minChars', 1),\n      defaulted$1('columns', 1),\n      defaultedNumber('maxResults', 10),\n      optionFunction('matches'),\n      strictFunction('fetch'),\n      strictFunction('onAction')\n    ]);\n    var createSeparatorItem = function (spec) {\n      return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n    };\n    var createAutocompleterItem = function (spec) {\n      return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n    };\n    var createAutocompleter = function (spec) {\n      return asRaw('Autocompleter', autocompleterSchema, spec);\n    };\n\n    var baseToolbarButtonFields = [\n      defaultedBoolean('disabled', false),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n    var toolbarButtonSchema = objOf([\n      strictString('type'),\n      strictFunction('onAction')\n    ].concat(baseToolbarButtonFields));\n    var createToolbarButton = function (spec) {\n      return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n    };\n\n    var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n    var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([\n      strictString('type'),\n      strictFunction('onAction')\n    ]));\n    var createToggleButton = function (spec) {\n      return asRaw('ToggleButton', toggleButtonSchema, spec);\n    };\n\n    var contextBarFields = [\n      defaultedFunction('predicate', function () {\n        return false;\n      }),\n      defaultedStringEnum('scope', 'node', [\n        'node',\n        'editor'\n      ]),\n      defaultedStringEnum('position', 'selection', [\n        'node',\n        'selection',\n        'line'\n      ])\n    ];\n\n    var contextButtonFields = baseToolbarButtonFields.concat([\n      defaulted$1('type', 'contextformbutton'),\n      defaulted$1('primary', false),\n      strictFunction('onAction'),\n      state$1('original', identity)\n    ]);\n    var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([\n      defaulted$1('type', 'contextformbutton'),\n      defaulted$1('primary', false),\n      strictFunction('onAction'),\n      state$1('original', identity)\n    ]);\n    var launchButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton')]);\n    var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformtogglebutton')]);\n    var toggleOrNormal = choose$1('type', {\n      contextformbutton: contextButtonFields,\n      contextformtogglebutton: contextToggleButtonFields\n    });\n    var contextFormSchema = objOf([\n      defaulted$1('type', 'contextform'),\n      defaultedFunction('initValue', function () {\n        return '';\n      }),\n      optionString('label'),\n      strictArrayOf('commands', toggleOrNormal),\n      optionOf('launch', choose$1('type', {\n        contextformbutton: launchButtonFields,\n        contextformtogglebutton: launchToggleButtonFields\n      }))\n    ].concat(contextBarFields));\n    var createContextForm = function (spec) {\n      return asRaw('ContextForm', contextFormSchema, spec);\n    };\n\n    var contextToolbarSchema = objOf([\n      defaulted$1('type', 'contexttoolbar'),\n      strictString('items')\n    ].concat(contextBarFields));\n    var createContextToolbar = function (spec) {\n      return asRaw('ContextToolbar', contextToolbarSchema, spec);\n    };\n\n    var stringArray = function (a) {\n      var all = {};\n      each(a, function (key) {\n        all[key] = {};\n      });\n      return keys(all);\n    };\n\n    var register = function (editor) {\n      var popups = editor.ui.registry.getAll().popups;\n      var dataset = map$2(popups, function (popup) {\n        return createAutocompleter(popup).fold(function (err) {\n          throw new Error(formatError(err));\n        }, function (x) {\n          return x;\n        });\n      });\n      var triggerChars = stringArray(mapToArray(dataset, function (v) {\n        return v.ch;\n      }));\n      var datasetValues = values(dataset);\n      var lookupByChar = function (ch) {\n        return filter(datasetValues, function (dv) {\n          return dv.ch === ch;\n        });\n      };\n      return {\n        dataset: dataset,\n        triggerChars: triggerChars,\n        lookupByChar: lookupByChar\n      };\n    };\n\n    var ItemResponse;\n    (function (ItemResponse) {\n      ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n      ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n    }(ItemResponse || (ItemResponse = {})));\n    var ItemResponse$1 = ItemResponse;\n\n    var navClass = 'tox-menu-nav__js';\n    var selectableClass = 'tox-collection__item';\n    var colorClass = 'tox-swatch';\n    var presetClasses = {\n      normal: navClass,\n      color: colorClass\n    };\n    var tickedClass = 'tox-collection__item--enabled';\n    var groupHeadingClass = 'tox-collection__group-heading';\n    var iconClass = 'tox-collection__item-icon';\n    var textClass = 'tox-collection__item-label';\n    var accessoryClass = 'tox-collection__item-accessory';\n    var caretClass = 'tox-collection__item-caret';\n    var checkmarkClass = 'tox-collection__item-checkmark';\n    var activeClass = 'tox-collection__item--active';\n    var iconClassRtl = 'tox-collection__item-icon-rtl';\n    var classForPreset = function (presets) {\n      return get(presetClasses, presets).getOr(navClass);\n    };\n\n    var forMenu = function (presets) {\n      if (presets === 'color') {\n        return 'tox-swatches';\n      } else {\n        return 'tox-menu';\n      }\n    };\n    var classes = function (presets) {\n      return {\n        backgroundMenu: 'tox-background-menu',\n        selectedMenu: 'tox-selected-menu',\n        selectedItem: 'tox-collection__item--active',\n        hasIcons: 'tox-menu--has-icons',\n        menu: forMenu(presets),\n        tieredMenu: 'tox-tiered-menu'\n      };\n    };\n\n    var markers$1 = function (presets) {\n      var menuClasses = classes(presets);\n      return {\n        backgroundMenu: menuClasses.backgroundMenu,\n        selectedMenu: menuClasses.selectedMenu,\n        menu: menuClasses.menu,\n        selectedItem: menuClasses.selectedItem,\n        item: classForPreset(presets)\n      };\n    };\n    var dom$1 = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      return {\n        tag: 'div',\n        classes: flatten([\n          [\n            menuClasses.menu,\n            'tox-menu-' + columns + '-column'\n          ],\n          hasIcons ? [menuClasses.hasIcons] : []\n        ])\n      };\n    };\n    var components$1 = [Menu.parts.items({})];\n    var part = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      var d = {\n        tag: 'div',\n        classes: flatten([[menuClasses.tieredMenu]])\n      };\n      return {\n        dom: d,\n        markers: markers$1(presets)\n      };\n    };\n\n    var chunk$1 = function (rowDom, numColumns) {\n      return function (items) {\n        var chunks = chunk(items, numColumns);\n        return map(chunks, function (c) {\n          return {\n            dom: rowDom,\n            components: c\n          };\n        });\n      };\n    };\n    var forSwatch = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-swatches-menu'\n          ]\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-swatches']\n            },\n            components: [Menu.parts.items({\n                preprocess: columns !== 'auto' ? chunk$1({\n                  tag: 'div',\n                  classes: ['tox-swatches__row']\n                }, columns) : identity\n              })]\n          }]\n      };\n    };\n    var forToolbar = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection',\n            'tox-collection--toolbar',\n            'tox-collection--toolbar-lg'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: chunk$1({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)\n          })]\n      };\n    };\n    var preprocessCollection = function (items, isSeparator) {\n      var allSplits = [];\n      var currentSplit = [];\n      each(items, function (item, i) {\n        if (isSeparator(item, i)) {\n          if (currentSplit.length > 0) {\n            allSplits.push(currentSplit);\n          }\n          currentSplit = [];\n          if (has(item.dom, 'innerHtml')) {\n            currentSplit.push(item);\n          }\n        } else {\n          currentSplit.push(item);\n        }\n      });\n      if (currentSplit.length > 0) {\n        allSplits.push(currentSplit);\n      }\n      return map(allSplits, function (s) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-collection__group']\n          },\n          components: s\n        };\n      });\n    };\n    var forCollection = function (columns, initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection'\n          ].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              if (columns !== 'auto' && columns > 1) {\n                return chunk$1({\n                  tag: 'div',\n                  classes: ['tox-collection__group']\n                }, columns)(items);\n              } else {\n                return preprocessCollection(items, function (_item, i) {\n                  return initItems[i].type === 'separator';\n                });\n              }\n            }\n          })]\n      };\n    };\n    var forHorizontalCollection = function (initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-collection',\n            'tox-collection--horizontal'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              return preprocessCollection(items, function (_item, i) {\n                return initItems[i].type === 'separator';\n              });\n            }\n          })]\n      };\n    };\n\n    var menuHasIcons = function (xs) {\n      return exists(xs, function (item) {\n        return 'icon' in item && item.icon !== undefined;\n      });\n    };\n    var handleError = function (error) {\n      console.error(formatError(error));\n      console.log(error);\n      return Optional.none();\n    };\n    var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n      var structure = forHorizontalCollection(items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    };\n    var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n      if (presets === 'color') {\n        var structure = forSwatch(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 'auto') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 1) {\n        var structure = forCollection(1, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'listpreview' && columns !== 'auto') {\n        var structure = forToolbar(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      return {\n        value: value,\n        dom: dom$1(hasIcons, columns, presets),\n        components: components$1,\n        items: items\n      };\n    };\n\n    var commonMenuItemFields = [\n      defaultedBoolean('disabled', false),\n      optionString('text'),\n      optionString('shortcut'),\n      field('value', 'value', defaultedThunk(function () {\n        return generate$1('menuitem-value');\n      }), anyValue$1()),\n      defaulted$1('meta', {})\n    ];\n\n    var choiceMenuItemSchema = objOf([\n      strictString('type'),\n      defaultedBoolean('active', false),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createChoiceMenuItem = function (spec) {\n      return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n    };\n\n    var fancyTypes = [\n      'inserttable',\n      'colorswatch'\n    ];\n    var fancyMenuItemSchema = objOf([\n      strictString('type'),\n      strictStringEnum('fancytype', fancyTypes),\n      defaultedFunction('onAction', noop)\n    ]);\n    var createFancyMenuItem = function (spec) {\n      return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n    };\n\n    var menuItemSchema = objOf([\n      strictString('type'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedFunction('onAction', noop),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createMenuItem = function (spec) {\n      return asRaw('menuitem', menuItemSchema, spec);\n    };\n\n    var nestedMenuItemSchema = objOf([\n      strictString('type'),\n      strictFunction('getSubmenuItems'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createNestedMenuItem = function (spec) {\n      return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n    };\n\n    var toggleMenuItemSchema = objOf([\n      strictString('type'),\n      optionString('icon'),\n      defaultedBoolean('active', false),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      strictFunction('onAction')\n    ].concat(commonMenuItemFields));\n    var createToggleMenuItem = function (spec) {\n      return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n    };\n\n    var detectSize = function (comp, margin, selectorClass) {\n      var descendants$1 = descendants(comp.element, '.' + selectorClass);\n      if (descendants$1.length > 0) {\n        var columnLength = findIndex(descendants$1, function (c) {\n          var thisTop = c.dom.getBoundingClientRect().top;\n          var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n          return Math.abs(thisTop - cTop) > margin;\n        }).getOr(descendants$1.length);\n        return Optional.some({\n          numColumns: columnLength,\n          numRows: Math.ceil(descendants$1.length / columnLength)\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var namedEvents = function (name, handlers) {\n      return derive$1([config(name, handlers)]);\n    };\n    var unnamedEvents = function (handlers) {\n      return namedEvents(generate$1('unnamed-events'), handlers);\n    };\n    var SimpleBehaviours = {\n      namedEvents: namedEvents,\n      unnamedEvents: unnamedEvents\n    };\n\n    var TooltippingSchema = [\n      strict$1('lazySink'),\n      strict$1('tooltipDom'),\n      defaulted$1('exclusive', true),\n      defaulted$1('tooltipComponents', []),\n      defaulted$1('delay', 300),\n      defaultedStringEnum('mode', 'normal', [\n        'normal',\n        'follow-highlight'\n      ]),\n      defaulted$1('anchor', function (comp) {\n        return {\n          anchor: 'hotspot',\n          hotspot: comp,\n          layouts: {\n            onLtr: constant([\n              south$1,\n              north$1,\n              southeast$1,\n              northeast$1,\n              southwest$1,\n              northwest$1\n            ]),\n            onRtl: constant([\n              south$1,\n              north$1,\n              southeast$1,\n              northeast$1,\n              southwest$1,\n              northwest$1\n            ])\n          }\n        };\n      }),\n      onHandler('onHide'),\n      onHandler('onShow')\n    ];\n\n    var init$4 = function () {\n      var timer = Cell(Optional.none());\n      var popup = Cell(Optional.none());\n      var getTooltip = function () {\n        return popup.get();\n      };\n      var setTooltip = function (comp) {\n        popup.set(Optional.some(comp));\n      };\n      var clearTooltip = function () {\n        popup.set(Optional.none());\n      };\n      var clearTimer = function () {\n        timer.get().each(function (t) {\n          clearTimeout(t);\n        });\n      };\n      var resetTimer = function (f, delay) {\n        clearTimer();\n        timer.set(Optional.some(setTimeout(function () {\n          f();\n        }, delay)));\n      };\n      var isShowing = function () {\n        return popup.get().isSome();\n      };\n      var readState = constant('not-implemented');\n      return nu$5({\n        getTooltip: getTooltip,\n        isShowing: isShowing,\n        setTooltip: setTooltip,\n        clearTooltip: clearTooltip,\n        clearTimer: clearTimer,\n        resetTimer: resetTimer,\n        readState: readState\n      });\n    };\n\n    var TooltippingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$4\n    });\n\n    var ExclusivityChannel = generate$1('tooltip.exclusive');\n    var ShowTooltipEvent = generate$1('tooltip.show');\n    var HideTooltipEvent = generate$1('tooltip.hide');\n\n    var hideAllExclusive = function (component, _tConfig, _tState) {\n      component.getSystem().broadcastOn([ExclusivityChannel], {});\n    };\n    var setComponents = function (component, tConfig, tState, specs) {\n      tState.getTooltip().each(function (tooltip) {\n        if (tooltip.getSystem().isConnected()) {\n          Replacing.set(tooltip, specs);\n        }\n      });\n    };\n\n    var TooltippingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        hideAllExclusive: hideAllExclusive,\n        setComponents: setComponents\n    });\n\n    var events$8 = function (tooltipConfig, state) {\n      var hide = function (comp) {\n        state.getTooltip().each(function (p) {\n          detach(p);\n          tooltipConfig.onHide(comp, p);\n          state.clearTooltip();\n        });\n        state.clearTimer();\n      };\n      var show = function (comp) {\n        if (!state.isShowing()) {\n          hideAllExclusive(comp);\n          var sink = tooltipConfig.lazySink(comp).getOrDie();\n          var popup = comp.getSystem().build({\n            dom: tooltipConfig.tooltipDom,\n            components: tooltipConfig.tooltipComponents,\n            events: derive(tooltipConfig.mode === 'normal' ? [\n              run(mouseover(), function (_) {\n                emit(comp, ShowTooltipEvent);\n              }),\n              run(mouseout(), function (_) {\n                emit(comp, HideTooltipEvent);\n              })\n            ] : []),\n            behaviours: derive$1([Replacing.config({})])\n          });\n          state.setTooltip(popup);\n          attach$1(sink, popup);\n          tooltipConfig.onShow(comp, popup);\n          Positioning.position(sink, tooltipConfig.anchor(comp), popup);\n        }\n      };\n      return derive(flatten([\n        [\n          run(ShowTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              show(comp);\n            }, tooltipConfig.delay);\n          }),\n          run(HideTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              hide(comp);\n            }, tooltipConfig.delay);\n          }),\n          run(receive(), function (comp, message) {\n            var receivingData = message;\n            if (!receivingData.universal) {\n              if (contains(receivingData.channels, ExclusivityChannel)) {\n                hide(comp);\n              }\n            }\n          }),\n          runOnDetached(function (comp) {\n            hide(comp);\n          })\n        ],\n        tooltipConfig.mode === 'normal' ? [\n          run(focusin(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(postBlur(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          }),\n          run(mouseover(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(mouseout(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ] : [\n          run(highlight(), function (comp, _se) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(dehighlight(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ]\n      ]));\n    };\n\n    var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$8\n    });\n\n    var Tooltipping = create$1({\n      fields: TooltippingSchema,\n      name: 'tooltipping',\n      active: ActiveTooltipping,\n      state: TooltippingState,\n      apis: TooltippingApis\n    });\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n\n    var nativeDisabled = [\n      'input',\n      'button',\n      'textarea',\n      'select'\n    ];\n    var onLoad$5 = function (component, disableConfig, disableState) {\n      var f = disableConfig.disabled() ? disable : enable;\n      f(component, disableConfig);\n    };\n    var hasNative = function (component, config) {\n      return config.useNative === true && contains(nativeDisabled, name(component.element));\n    };\n    var nativeIsDisabled = function (component) {\n      return has$1(component.element, 'disabled');\n    };\n    var nativeDisable = function (component) {\n      set$1(component.element, 'disabled', 'disabled');\n    };\n    var nativeEnable = function (component) {\n      remove$1(component.element, 'disabled');\n    };\n    var ariaIsDisabled = function (component) {\n      return get$2(component.element, 'aria-disabled') === 'true';\n    };\n    var ariaDisable = function (component) {\n      set$1(component.element, 'aria-disabled', 'true');\n    };\n    var ariaEnable = function (component) {\n      set$1(component.element, 'aria-disabled', 'false');\n    };\n    var disable = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        add$2(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n      f(component);\n      disableConfig.onDisabled(component);\n    };\n    var enable = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        remove$4(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n      f(component);\n      disableConfig.onEnabled(component);\n    };\n    var isDisabled = function (component, disableConfig) {\n      return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n    };\n    var set$7 = function (component, disableConfig, disableState, disabled) {\n      var f = disabled ? disable : enable;\n      f(component, disableConfig);\n    };\n\n    var DisableApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        enable: enable,\n        disable: disable,\n        isDisabled: isDisabled,\n        onLoad: onLoad$5,\n        set: set$7\n    });\n\n    var exhibit$3 = function (base, disableConfig) {\n      return nu$6({ classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : [] });\n    };\n    var events$9 = function (disableConfig, disableState) {\n      return derive([\n        abort(execute(), function (component, _simulatedEvent) {\n          return isDisabled(component, disableConfig);\n        }),\n        loadEvent(disableConfig, disableState, onLoad$5)\n      ]);\n    };\n\n    var ActiveDisable = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$3,\n        events: events$9\n    });\n\n    var DisableSchema = [\n      defaultedFunction('disabled', never),\n      defaulted$1('useNative', true),\n      option('disableClass'),\n      onHandler('onDisabled'),\n      onHandler('onEnabled')\n    ];\n\n    var Disabling = create$1({\n      fields: DisableSchema,\n      name: 'disabling',\n      active: ActiveDisable,\n      apis: DisableApis\n    });\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n    var getSkinUrl = function (editor) {\n      var skin = editor.getParam('skin');\n      var skinUrl = editor.getParam('skin_url');\n      if (skin !== false) {\n        var skinName = skin ? skin : 'oxide';\n        if (skinUrl) {\n          skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n        } else {\n          skinUrl = global$7.baseURL + '/skins/ui/' + skinName;\n        }\n      }\n      return skinUrl;\n    };\n    var isReadOnly = function (editor) {\n      return editor.getParam('readonly', false, 'boolean');\n    };\n    var isSkinDisabled = function (editor) {\n      return editor.getParam('skin') === false;\n    };\n    var getHeightSetting = function (editor) {\n      return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n    };\n    var getWidthSetting = function (editor) {\n      return editor.getParam('width', global$5.DOM.getStyle(editor.getElement(), 'width'));\n    };\n    var getMinWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('min_width')).filter(isNumber);\n    };\n    var getMinHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('min_height')).filter(isNumber);\n    };\n    var getMaxWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('max_width')).filter(isNumber);\n    };\n    var getMaxHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('max_height')).filter(isNumber);\n    };\n    var getUserStyleFormats = function (editor) {\n      return Optional.from(editor.getParam('style_formats')).filter(isArray);\n    };\n    var isMergeStyleFormats = function (editor) {\n      return editor.getParam('style_formats_merge', false, 'boolean');\n    };\n    var getLineHeightFormats = function (editor) {\n      return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n    };\n    var getRemovedMenuItems = function (editor) {\n      return editor.getParam('removed_menuitems', '');\n    };\n    var isMenubarEnabled = function (editor) {\n      return editor.getParam('menubar', true, 'boolean') !== false;\n    };\n    var isToolbarEnabled = function (editor) {\n      var toolbar = editor.getParam('toolbar', true);\n      var isToolbarTrue = toolbar === true;\n      var isToolbarString = isString(toolbar);\n      var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n      return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n    };\n    var getMultipleToolbarsSetting = function (editor) {\n      var toolbars = range(9, function (num) {\n        return editor.getParam('toolbar' + (num + 1), false, 'string');\n      });\n      var toolbarArray = filter(toolbars, function (toolbar) {\n        return typeof toolbar === 'string';\n      });\n      return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n    };\n    var isMultipleToolbars = function (editor) {\n      return getMultipleToolbarsSetting(editor).fold(function () {\n        var toolbar = editor.getParam('toolbar', [], 'string[]');\n        return toolbar.length > 0;\n      }, function () {\n        return true;\n      });\n    };\n    var ToolbarMode;\n    (function (ToolbarMode) {\n      ToolbarMode['default'] = 'wrap';\n      ToolbarMode['floating'] = 'floating';\n      ToolbarMode['sliding'] = 'sliding';\n      ToolbarMode['scrolling'] = 'scrolling';\n    }(ToolbarMode || (ToolbarMode = {})));\n    var getToolbarMode = function (editor) {\n      return editor.getParam('toolbar_mode', '', 'string');\n    };\n    var ToolbarLocation;\n    (function (ToolbarLocation) {\n      ToolbarLocation['auto'] = 'auto';\n      ToolbarLocation['top'] = 'top';\n      ToolbarLocation['bottom'] = 'bottom';\n    }(ToolbarLocation || (ToolbarLocation = {})));\n    var getToolbarGroups = function (editor) {\n      return editor.getParam('toolbar_groups', {}, 'object');\n    };\n    var getToolbarLocation = function (editor) {\n      return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n    };\n    var isToolbarLocationBottom = function (editor) {\n      return getToolbarLocation(editor) === ToolbarLocation.bottom;\n    };\n    var fixedContainerSelector = function (editor) {\n      return editor.getParam('fixed_toolbar_container', '', 'string');\n    };\n    var isToolbarPersist = function (editor) {\n      return editor.getParam('toolbar_persist', false, 'boolean');\n    };\n    var fixedContainerElement = function (editor) {\n      var selector = fixedContainerSelector(editor);\n      return selector.length > 0 && editor.inline ? descendant$1(body(), selector) : Optional.none();\n    };\n    var useFixedContainer = function (editor) {\n      return editor.inline && fixedContainerElement(editor).isSome();\n    };\n    var getUiContainer = function (editor) {\n      var fixedContainer = fixedContainerElement(editor);\n      return fixedContainer.getOrThunk(function () {\n        return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n      });\n    };\n    var isDistractionFree = function (editor) {\n      return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n    };\n    var isStickyToolbar = function (editor) {\n      var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n      return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n    };\n    var isDraggableModal = function (editor) {\n      return editor.getParam('draggable_modal', false, 'boolean');\n    };\n    var getMenus = function (editor) {\n      var menu = editor.getParam('menu');\n      if (menu) {\n        return map$2(menu, function (menu) {\n          return __assign(__assign({}, menu), { items: menu.items });\n        });\n      } else {\n        return {};\n      }\n    };\n    var getMenubar = function (editor) {\n      return editor.getParam('menubar');\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('toolbar', true);\n    };\n    var getFilePickerCallback = function (editor) {\n      return editor.getParam('file_picker_callback');\n    };\n    var getFilePickerTypes = function (editor) {\n      return editor.getParam('file_picker_types');\n    };\n    var getFileBrowserCallbackTypes = function (editor) {\n      return editor.getParam('file_browser_callback_types');\n    };\n    var noTypeaheadUrls = function (editor) {\n      return editor.getParam('typeahead_urls') === false;\n    };\n    var getAnchorTop = function (editor) {\n      return editor.getParam('anchor_top', '#top');\n    };\n    var getAnchorBottom = function (editor) {\n      return editor.getParam('anchor_bottom', '#bottom');\n    };\n    var getFilePickerValidatorHandler = function (editor) {\n      var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n      if (handler === undefined) {\n        return editor.getParam('filepicker_validator_handler', undefined, 'function');\n      } else {\n        return handler;\n      }\n    };\n\n    var ReadOnlyChannel = 'silver.readonly';\n    var ReadOnlyDataSchema = objOf([strictBoolean('readonly')]);\n    var broadcastReadonly = function (uiComponents, readonly) {\n      var outerContainer = uiComponents.outerContainer;\n      var target = outerContainer.element;\n      if (readonly) {\n        uiComponents.mothership.broadcastOn([dismissPopups()], { target: target });\n        uiComponents.uiMothership.broadcastOn([dismissPopups()], { target: target });\n      }\n      uiComponents.mothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n      uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n    };\n    var setupReadonlyModeSwitch = function (editor, uiComponents) {\n      editor.on('init', function () {\n        if (editor.mode.isReadOnly()) {\n          broadcastReadonly(uiComponents, true);\n        }\n      });\n      editor.on('SwitchMode', function () {\n        return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n      });\n      if (isReadOnly(editor)) {\n        editor.setMode('readonly');\n      }\n    };\n    var receivingConfig = function () {\n      var _a;\n      return Receiving.config({\n        channels: (_a = {}, _a[ReadOnlyChannel] = {\n          schema: ReadOnlyDataSchema,\n          onReceive: function (comp, data) {\n            Disabling.set(comp, data.readonly);\n          }\n        }, _a)\n      });\n    };\n\n    var item = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-collection__item--state-disabled'\n      });\n    };\n    var button = function (disabled) {\n      return Disabling.config({ disabled: disabled });\n    };\n    var splitButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled'\n      });\n    };\n    var toolbarButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled',\n        useNative: false\n      });\n    };\n    var DisablingConfigs = {\n      item: item,\n      button: button,\n      splitButton: splitButton,\n      toolbarButton: toolbarButton\n    };\n\n    var runWithApi = function (info, comp) {\n      var api = info.getApi(comp);\n      return function (f) {\n        f(api);\n      };\n    };\n    var onControlAttached = function (info, editorOffCell) {\n      return runOnAttached(function (comp) {\n        var run = runWithApi(info, comp);\n        run(function (api) {\n          var onDestroy = info.onSetup(api);\n          if (onDestroy !== null && onDestroy !== undefined) {\n            editorOffCell.set(onDestroy);\n          }\n        });\n      });\n    };\n    var onControlDetached = function (getApi, editorOffCell) {\n      return runOnDetached(function (comp) {\n        return runWithApi(getApi, comp)(editorOffCell.get());\n      });\n    };\n\n    var _a;\n    var onMenuItemExecute = function (info, itemResponse) {\n      return runOnExecute(function (comp, simulatedEvent) {\n        runWithApi(info, comp)(info.onAction);\n        if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n          emit(comp, sandboxClose());\n          simulatedEvent.stop();\n        }\n      });\n    };\n    var menuItemEventOrder = (_a = {}, _a[execute()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'item-events'\n    ], _a);\n\n    var componentRenderPipeline = function (xs) {\n      return bind(xs, function (o) {\n        return o.toArray();\n      });\n    };\n    var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n      var editorOffCell = Cell(noop);\n      return {\n        type: 'item',\n        dom: structure.dom,\n        components: componentRenderPipeline(structure.optComponents),\n        data: spec.data,\n        eventOrder: menuItemEventOrder,\n        hasSubmenu: spec.triggersSubmenu,\n        itemBehaviours: derive$1([\n          config('item-events', [\n            onMenuItemExecute(spec, itemResponse),\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          DisablingConfigs.item(function () {\n            return spec.disabled || providersbackstage.isReadOnly();\n          }),\n          receivingConfig(),\n          Replacing.config({})\n        ].concat(spec.itemBehaviours))\n      };\n    };\n    var buildData = function (source) {\n      return {\n        value: source.value,\n        meta: __assign({ text: source.text.getOr('') }, source.meta)\n      };\n    };\n\n    var global$8 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var convertText = function (source) {\n      var mac = {\n        alt: '&#x2325;',\n        ctrl: '&#x2303;',\n        shift: '&#x21E7;',\n        meta: '&#x2318;',\n        access: '&#x2303;&#x2325;'\n      };\n      var other = {\n        meta: 'Ctrl',\n        access: 'Shift+Alt'\n      };\n      var replace = global$8.mac ? mac : other;\n      var shortcut = source.split('+');\n      var updated = map(shortcut, function (segment) {\n        var search = segment.toLowerCase().trim();\n        return has(replace, search) ? replace[search] : segment;\n      });\n      return global$8.mac ? updated.join('') : updated.join('+');\n    };\n\n    var renderIcon = function (iconHtml) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [iconClass],\n          innerHtml: iconHtml\n        }\n      };\n    };\n    var renderText = function (text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [text(global$6.translate(text$1))]\n      };\n    };\n    var renderHtml = function (html) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass],\n          innerHtml: html\n        }\n      };\n    };\n    var renderStyledText = function (style, text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [{\n            dom: {\n              tag: style.tag,\n              styles: style.styles\n            },\n            components: [text(global$6.translate(text$1))]\n          }]\n      };\n    };\n    var renderShortcut = function (shortcut) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [accessoryClass],\n          innerHtml: convertText(shortcut)\n        }\n      };\n    };\n    var renderCheckmark = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [checkmarkClass],\n          innerHtml: get$d('checkmark', icons)\n        }\n      };\n    };\n    var renderSubmenuCaret = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [caretClass],\n          innerHtml: get$d('chevron-right', icons)\n        }\n      };\n    };\n    var renderDownwardsCaret = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [caretClass],\n          innerHtml: get$d('chevron-down', icons)\n        }\n      };\n    };\n\n    var renderColorStructure = function (itemText, itemValue, iconSvg, providerBackstage) {\n      var colorPickerCommand = 'custom';\n      var removeColorCommand = 'remove';\n      var getDom = function () {\n        var common = colorClass;\n        var icon = iconSvg.getOr('');\n        var attributes = itemText.map(function (text) {\n          return { title: providerBackstage.translate(text) };\n        }).getOr({});\n        var baseDom = {\n          tag: 'div',\n          attributes: attributes,\n          classes: [common]\n        };\n        if (itemValue === colorPickerCommand) {\n          return __assign(__assign({}, baseDom), {\n            tag: 'button',\n            classes: __spreadArrays(baseDom.classes, ['tox-swatches__picker-btn']),\n            innerHtml: icon\n          });\n        } else if (itemValue === removeColorCommand) {\n          return __assign(__assign({}, baseDom), {\n            classes: __spreadArrays(baseDom.classes, ['tox-swatch--remove']),\n            innerHtml: icon\n          });\n        } else {\n          return __assign(__assign({}, baseDom), {\n            attributes: __assign(__assign({}, baseDom.attributes), { 'data-mce-color': itemValue }),\n            styles: { 'background-color': itemValue }\n          });\n        }\n      };\n      return {\n        dom: getDom(),\n        optComponents: []\n      };\n    };\n    var renderNormalItemStructure = function (info, icon, renderIcons, textRender, rtlClass) {\n      var leftIcon = renderIcons ? icon.or(Optional.some('')).map(renderIcon) : Optional.none();\n      var checkmark = info.checkMark;\n      var domTitle = info.ariaLabel.map(function (label) {\n        return { attributes: { title: global$6.translate(label) } };\n      }).getOr({});\n      var dom = __assign({\n        tag: 'div',\n        classes: [\n          navClass,\n          selectableClass\n        ].concat(rtlClass ? [iconClassRtl] : [])\n      }, domTitle);\n      var content = info.htmlContent.fold(function () {\n        return info.textContent.map(textRender);\n      }, function (html) {\n        return Optional.some(renderHtml(html));\n      });\n      var menuItem = {\n        dom: dom,\n        optComponents: [\n          leftIcon,\n          content,\n          info.shortcutContent.map(renderShortcut),\n          checkmark,\n          info.caret\n        ]\n      };\n      return menuItem;\n    };\n    var rtlIcon = [\n      'list-num-default',\n      'list-num-lower-alpha',\n      'list-num-lower-greek',\n      'list-num-lower-roman',\n      'list-num-upper-alpha',\n      'list-num-upper-roman'\n    ];\n    var rtlTransform = [\n      'list-bull-circle',\n      'list-bull-default',\n      'list-bull-square'\n    ];\n    var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n      if (fallbackIcon === void 0) {\n        fallbackIcon = Optional.none();\n      }\n      var getIconName = function (iconName) {\n        return iconName.map(function (name) {\n          return global$6.isRtl() && contains(rtlIcon, name) ? name + '-rtl' : name;\n        });\n      };\n      var needRtlClass = global$6.isRtl() && info.iconContent.exists(function (name) {\n        return contains(rtlTransform, name);\n      });\n      var icon = getIconName(info.iconContent).map(function (iconName) {\n        return getOr(iconName, providersBackstage.icons, fallbackIcon);\n      });\n      var textRender = Optional.from(info.meta).fold(function () {\n        return renderText;\n      }, function (meta) {\n        return has(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n      });\n      if (info.presets === 'color') {\n        return renderColorStructure(info.ariaLabel, info.value, icon, providersBackstage);\n      } else {\n        return renderNormalItemStructure(info, icon, renderIcons, textRender, needRtlClass);\n      }\n    };\n\n    var tooltipBehaviour = function (meta, sharedBackstage) {\n      return get(meta, 'tooltipWorker').map(function (tooltipWorker) {\n        return [Tooltipping.config({\n            lazySink: sharedBackstage.getSink,\n            tooltipDom: {\n              tag: 'div',\n              classes: ['tox-tooltip-worker-container']\n            },\n            tooltipComponents: [],\n            anchor: function (comp) {\n              return {\n                anchor: 'submenu',\n                item: comp,\n                overrides: { maxHeightFunction: expandable }\n              };\n            },\n            mode: 'follow-highlight',\n            onShow: function (component, _tooltip) {\n              tooltipWorker(function (elm) {\n                Tooltipping.setComponents(component, [external({ element: SugarElement.fromDom(elm) })]);\n              });\n            }\n          })];\n      }).getOr([]);\n    };\n    var escapeRegExp = function (text) {\n      return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    };\n    var encodeText = function (text) {\n      return global$5.DOM.encode(text);\n    };\n    var replaceText = function (text, matchText) {\n      var translated = global$6.translate(text);\n      var encoded = encodeText(translated);\n      if (matchText.length > 0) {\n        var escapedMatchRegex = new RegExp(escapeRegExp(matchText), 'gi');\n        return encoded.replace(escapedMatchRegex, function (match) {\n          return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n        });\n      } else {\n        return encoded;\n      }\n    };\n    var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: Optional.none(),\n        htmlContent: useText ? spec.text.map(function (text) {\n          return replaceText(text, matchText);\n        }) : Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: Optional.none(),\n        checkMark: Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, sharedBackstage.providers, renderIcons, spec.icon);\n      return renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: function () {\n          return {};\n        },\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value, spec.meta);\n        },\n        onSetup: function () {\n          return function () {\n          };\n        },\n        triggersSubmenu: false,\n        itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n      }, structure, itemResponse, sharedBackstage.providers);\n    };\n\n    var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: useText ? spec.text : Optional.none(),\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: useText ? spec.shortcut : Optional.none(),\n        checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value);\n        },\n        onSetup: function (api) {\n          api.setActive(isSelected);\n          return function () {\n          };\n        },\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var parts$2 = generate$4(owner$2(), parts());\n\n    var hexColour = function (value) {\n      return { value: value };\n    };\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n    var isHexString = function (hex) {\n      return shorthandRegex.test(hex) || longformRegex.test(hex);\n    };\n    var getLongForm = function (hex) {\n      var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n        return r + r + g + g + b + b;\n      });\n      return { value: hexString };\n    };\n    var extractValues = function (hex) {\n      var longForm = getLongForm(hex);\n      var splitForm = longformRegex.exec(longForm.value);\n      return splitForm === null ? [\n        'FFFFFF',\n        'FF',\n        'FF',\n        'FF'\n      ] : splitForm;\n    };\n    var toHex = function (component) {\n      var hex = component.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    };\n    var fromRgba = function (rgbaColour) {\n      var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n      return hexColour(value);\n    };\n\n    var min = Math.min;\n    var max = Math.max;\n    var round = Math.round;\n    var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n    var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n    var rgbaColour = function (red, green, blue, alpha) {\n      return {\n        red: red,\n        green: green,\n        blue: blue,\n        alpha: alpha\n      };\n    };\n    var isRgbaComponent = function (value) {\n      var num = parseInt(value, 10);\n      return num.toString() === value && num >= 0 && num <= 255;\n    };\n    var fromHsv = function (hsv) {\n      var r;\n      var g;\n      var b;\n      var hue = (hsv.hue || 0) % 360;\n      var saturation = hsv.saturation / 100;\n      var brightness = hsv.value / 100;\n      saturation = max(0, min(saturation, 1));\n      brightness = max(0, min(brightness, 1));\n      if (saturation === 0) {\n        r = g = b = round(255 * brightness);\n        return rgbaColour(r, g, b, 1);\n      }\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n      switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n      default:\n        r = g = b = 0;\n      }\n      r = round(255 * (r + match));\n      g = round(255 * (g + match));\n      b = round(255 * (b + match));\n      return rgbaColour(r, g, b, 1);\n    };\n    var fromHex = function (hexColour) {\n      var result = extractValues(hexColour);\n      var red = parseInt(result[1], 16);\n      var green = parseInt(result[2], 16);\n      var blue = parseInt(result[3], 16);\n      return rgbaColour(red, green, blue, 1);\n    };\n    var fromStringValues = function (red, green, blue, alpha) {\n      var r = parseInt(red, 10);\n      var g = parseInt(green, 10);\n      var b = parseInt(blue, 10);\n      var a = parseFloat(alpha);\n      return rgbaColour(r, g, b, a);\n    };\n    var fromString = function (rgbaString) {\n      if (rgbaString === 'transparent') {\n        return Optional.some(rgbaColour(0, 0, 0, 0));\n      }\n      var rgbMatch = rgbRegex.exec(rgbaString);\n      if (rgbMatch !== null) {\n        return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n      }\n      var rgbaMatch = rgbaRegex.exec(rgbaString);\n      if (rgbaMatch !== null) {\n        return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n      }\n      return Optional.none();\n    };\n    var toString = function (rgba) {\n      return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n    };\n    var red = rgbaColour(255, 0, 0, 1);\n\n    var fireSkinLoaded = function (editor) {\n      return editor.fire('SkinLoaded');\n    };\n    var fireSkinLoadError = function (editor, error) {\n      return editor.fire('SkinLoadError', error);\n    };\n    var fireResizeEditor = function (editor) {\n      return editor.fire('ResizeEditor');\n    };\n    var fireResizeContent = function (editor, e) {\n      return editor.fire('ResizeContent', e);\n    };\n    var fireScrollContent = function (editor, e) {\n      return editor.fire('ScrollContent', e);\n    };\n    var fireTextColorChange = function (editor, data) {\n      return editor.fire('TextColorChange', data);\n    };\n\n    var global$9 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n\n    var storageName = 'tinymce-custom-colors';\n    function ColorCache (max) {\n      if (max === void 0) {\n        max = 10;\n      }\n      var storageString = global$9.getItem(storageName);\n      var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n      var prune = function (list) {\n        var diff = max - list.length;\n        return diff < 0 ? list.slice(0, max) : list;\n      };\n      var cache = prune(localstorage);\n      var add = function (key) {\n        indexOf(cache, key).each(remove);\n        cache.unshift(key);\n        if (cache.length > max) {\n          cache.pop();\n        }\n        global$9.setItem(storageName, JSON.stringify(cache));\n      };\n      var remove = function (idx) {\n        cache.splice(idx, 1);\n      };\n      var state = function () {\n        return cache.slice(0);\n      };\n      return {\n        add: add,\n        state: state\n      };\n    }\n\n    var choiceItem = 'choiceitem';\n    var defaultColors = [\n      {\n        type: choiceItem,\n        text: 'Light Green',\n        value: '#BFEDD2'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Yellow',\n        value: '#FBEEB8'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Red',\n        value: '#F8CAC6'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Purple',\n        value: '#ECCAFA'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Blue',\n        value: '#C2E0F4'\n      },\n      {\n        type: choiceItem,\n        text: 'Green',\n        value: '#2DC26B'\n      },\n      {\n        type: choiceItem,\n        text: 'Yellow',\n        value: '#F1C40F'\n      },\n      {\n        type: choiceItem,\n        text: 'Red',\n        value: '#E03E2D'\n      },\n      {\n        type: choiceItem,\n        text: 'Purple',\n        value: '#B96AD9'\n      },\n      {\n        type: choiceItem,\n        text: 'Blue',\n        value: '#3598DB'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Turquoise',\n        value: '#169179'\n      },\n      {\n        type: choiceItem,\n        text: 'Orange',\n        value: '#E67E23'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Red',\n        value: '#BA372A'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Purple',\n        value: '#843FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Blue',\n        value: '#236FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Gray',\n        value: '#ECF0F1'\n      },\n      {\n        type: choiceItem,\n        text: 'Medium Gray',\n        value: '#CED4D9'\n      },\n      {\n        type: choiceItem,\n        text: 'Gray',\n        value: '#95A5A6'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Gray',\n        value: '#7E8C8D'\n      },\n      {\n        type: choiceItem,\n        text: 'Navy Blue',\n        value: '#34495E'\n      },\n      {\n        type: choiceItem,\n        text: 'Black',\n        value: '#000000'\n      },\n      {\n        type: choiceItem,\n        text: 'White',\n        value: '#ffffff'\n      }\n    ];\n    var colorCache = ColorCache(10);\n    var mapColors = function (colorMap) {\n      var colors = [];\n      var canvas = document.createElement('canvas');\n      canvas.height = 1;\n      canvas.width = 1;\n      var ctx = canvas.getContext('2d');\n      var byteAsHex = function (colorByte, alphaByte) {\n        var bg = 255;\n        var alpha = alphaByte / 255;\n        var colorByteWithWhiteBg = Math.round(colorByte * alpha + bg * (1 - alpha));\n        return ('0' + colorByteWithWhiteBg.toString(16)).slice(-2).toUpperCase();\n      };\n      var asHexColor = function (color) {\n        if (/^[0-9A-Fa-f]{6}$/.test(color)) {\n          return '#' + color.toUpperCase();\n        }\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.fillStyle = '#FFFFFF';\n        ctx.fillStyle = color;\n        ctx.fillRect(0, 0, 1, 1);\n        var rgba = ctx.getImageData(0, 0, 1, 1).data;\n        var r = rgba[0], g = rgba[1], b = rgba[2], a = rgba[3];\n        return '#' + byteAsHex(r, a) + byteAsHex(g, a) + byteAsHex(b, a);\n      };\n      for (var i = 0; i < colorMap.length; i += 2) {\n        colors.push({\n          text: colorMap[i + 1],\n          value: asHexColor(colorMap[i]),\n          type: 'choiceitem'\n        });\n      }\n      return colors;\n    };\n    var getColorCols = function (editor, defaultCols) {\n      return editor.getParam('color_cols', defaultCols, 'number');\n    };\n    var hasCustomColors = function (editor) {\n      return editor.getParam('custom_colors') !== false;\n    };\n    var getColorMap = function (editor) {\n      return editor.getParam('color_map');\n    };\n    var getColors = function (editor) {\n      var unmapped = getColorMap(editor);\n      return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n    };\n    var getCurrentColors = function () {\n      return map(colorCache.state(), function (color) {\n        return {\n          type: choiceItem,\n          text: color,\n          value: color\n        };\n      });\n    };\n    var addColor = function (color) {\n      colorCache.add(color);\n    };\n\n    var getCurrentColor = function (editor, format) {\n      var color;\n      editor.dom.getParents(editor.selection.getStart(), function (elm) {\n        var value;\n        if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n          color = color ? color : value;\n        }\n      });\n      return color;\n    };\n    var applyFormat = function (editor, format, value) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.apply(format, { value: value });\n        editor.nodeChanged();\n      });\n    };\n    var removeFormat = function (editor, format) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.remove(format, { value: null }, null, true);\n        editor.nodeChanged();\n      });\n    };\n    var registerCommands = function (editor) {\n      editor.addCommand('mceApplyTextcolor', function (format, value) {\n        applyFormat(editor, format, value);\n      });\n      editor.addCommand('mceRemoveTextcolor', function (format) {\n        removeFormat(editor, format);\n      });\n    };\n    var calcCols = function (colors) {\n      return Math.max(5, Math.ceil(Math.sqrt(colors)));\n    };\n    var getColorCols$1 = function (editor) {\n      var colors = getColors(editor);\n      var defaultCols = calcCols(colors.length);\n      return getColorCols(editor, defaultCols);\n    };\n    var getAdditionalColors = function (hasCustom) {\n      var type = 'choiceitem';\n      var remove = {\n        type: type,\n        text: 'Remove color',\n        icon: 'color-swatch-remove-color',\n        value: 'remove'\n      };\n      var custom = {\n        type: type,\n        text: 'Custom color',\n        icon: 'color-picker',\n        value: 'custom'\n      };\n      return hasCustom ? [\n        remove,\n        custom\n      ] : [remove];\n    };\n    var applyColor = function (editor, format, value, onChoice) {\n      if (value === 'custom') {\n        var dialog = colorPickerDialog(editor);\n        dialog(function (colorOpt) {\n          colorOpt.each(function (color) {\n            addColor(color);\n            editor.execCommand('mceApplyTextcolor', format, color);\n            onChoice(color);\n          });\n        }, '#000000');\n      } else if (value === 'remove') {\n        onChoice('');\n        editor.execCommand('mceRemoveTextcolor', format);\n      } else {\n        onChoice(value);\n        editor.execCommand('mceApplyTextcolor', format, value);\n      }\n    };\n    var getColors$1 = function (colors, hasCustom) {\n      return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n    };\n    var getFetch = function (colors, hasCustom) {\n      return function (callback) {\n        callback(getColors$1(colors, hasCustom));\n      };\n    };\n    var setIconColor = function (splitButtonApi, name, newColor) {\n      var setIconFillAndStroke = function (pathId, color) {\n        splitButtonApi.setIconFill(pathId, color);\n        splitButtonApi.setIconStroke(pathId, color);\n      };\n      var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n      setIconFillAndStroke(id, newColor);\n    };\n    var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n      editor.ui.registry.addSplitButton(name, {\n        tooltip: tooltip,\n        presets: 'color',\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        select: function (value) {\n          var optCurrentRgb = Optional.from(getCurrentColor(editor, format));\n          return optCurrentRgb.bind(function (currentRgb) {\n            return fromString(currentRgb).map(function (rgba) {\n              var currentHex = fromRgba(rgba).value;\n              return contains$1(value.toLowerCase(), currentHex);\n            });\n          }).getOr(false);\n        },\n        columns: getColorCols$1(editor),\n        fetch: getFetch(getColors(editor), hasCustomColors(editor)),\n        onAction: function (_splitButtonApi) {\n          if (lastColor.get() !== null) {\n            applyColor(editor, format, lastColor.get(), function () {\n            });\n          }\n        },\n        onItemAction: function (_splitButtonApi, value) {\n          applyColor(editor, format, value, function (newColor) {\n            lastColor.set(newColor);\n            fireTextColorChange(editor, {\n              name: name,\n              color: newColor\n            });\n          });\n        },\n        onSetup: function (splitButtonApi) {\n          if (lastColor.get() !== null) {\n            setIconColor(splitButtonApi, name, lastColor.get());\n          }\n          var handler = function (e) {\n            if (e.name === name) {\n              setIconColor(splitButtonApi, e.name, e.color);\n            }\n          };\n          editor.on('TextColorChange', handler);\n          return function () {\n            editor.off('TextColorChange', handler);\n          };\n        }\n      });\n    };\n    var registerTextColorMenuItem = function (editor, name, format, text) {\n      editor.ui.registry.addNestedMenuItem(name, {\n        text: text,\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        getSubmenuItems: function () {\n          return [{\n              type: 'fancymenuitem',\n              fancytype: 'colorswatch',\n              onAction: function (data) {\n                applyColor(editor, format, data.value, noop);\n              }\n            }];\n        }\n      });\n    };\n    var colorPickerDialog = function (editor) {\n      return function (callback, value) {\n        var getOnSubmit = function (callback) {\n          return function (api) {\n            var data = api.getData();\n            callback(Optional.from(data.colorpicker));\n            api.close();\n          };\n        };\n        var onAction = function (api, details) {\n          if (details.name === 'hex-valid') {\n            if (details.value) {\n              api.enable('ok');\n            } else {\n              api.disable('ok');\n            }\n          }\n        };\n        var initialData = { colorpicker: value };\n        var submit = getOnSubmit(callback);\n        editor.windowManager.open({\n          title: 'Color Picker',\n          size: 'normal',\n          body: {\n            type: 'panel',\n            items: [{\n                type: 'colorpicker',\n                name: 'colorpicker',\n                label: 'Color'\n              }]\n          },\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: initialData,\n          onAction: onAction,\n          onSubmit: submit,\n          onClose: function () {\n          },\n          onCancel: function () {\n            callback(Optional.none());\n          }\n        });\n      };\n    };\n    var register$1 = function (editor) {\n      registerCommands(editor);\n      var lastForeColor = Cell(null);\n      var lastBackColor = Cell(null);\n      registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n      registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n      registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n      registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n    };\n\n    var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n      var hasIcons = menuHasIcons(items);\n      var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n      var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n      return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n    };\n    var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n      return cat(map(items, function (item) {\n        if (item.type === 'choiceitem') {\n          return createChoiceMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n          });\n        } else {\n          return Optional.none();\n        }\n      }));\n    };\n\n    var deriveMenuMovement = function (columns, presets) {\n      var menuMarkers = markers$1(presets);\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: true\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'grid',\n          selector: '.' + menuMarkers.item,\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n        return {\n          mode: 'matrix',\n          rowSelector: '.' + rowClass\n        };\n      }\n    };\n    var deriveCollectionMovement = function (columns, presets) {\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: false,\n          selector: '.tox-collection__item'\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'flatgrid',\n          selector: '.' + 'tox-collection__item',\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        return {\n          mode: 'matrix',\n          selectors: {\n            row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n            cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n          }\n        };\n      }\n    };\n\n    function renderColorSwatchItem(spec, backstage) {\n      var items = getColors$1(backstage.colorinput.getColors(), backstage.colorinput.hasCustomColors());\n      var columns = backstage.colorinput.getColorCols();\n      var presets = 'color';\n      var menuSpec = createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n        spec.onAction({ value: value });\n      }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, function () {\n        return false;\n      }, backstage.shared.providers);\n      var widgetSpec = __assign(__assign({}, menuSpec), {\n        markers: markers$1(presets),\n        movement: deriveMenuMovement(columns, presets)\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$1('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$2.widget(Menu.sketch(widgetSpec))]\n      };\n    }\n\n    var cellOverEvent = generate$1('cell-over');\n    var cellExecuteEvent = generate$1('cell-execute');\n    var makeCell = function (row, col, labelId) {\n      var _a;\n      var emitCellOver = function (c) {\n        return emitWith(c, cellOverEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var emitExecute = function (c) {\n        return emitWith(c, cellExecuteEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var onClick = function (c, se) {\n        se.stop();\n        emitExecute(c);\n      };\n      return build$1({\n        dom: {\n          tag: 'div',\n          attributes: (_a = { role: 'button' }, _a['aria-labelledby'] = labelId, _a)\n        },\n        behaviours: derive$1([\n          config('insert-table-picker-cell', [\n            run(mouseover(), Focusing.focus),\n            run(execute(), emitExecute),\n            run(click(), onClick),\n            run(tap(), onClick)\n          ]),\n          Toggling.config({\n            toggleClass: 'tox-insert-table-picker__selected',\n            toggleOnExecute: false\n          }),\n          Focusing.config({ onFocus: emitCellOver })\n        ])\n      });\n    };\n    var makeCells = function (labelId, numRows, numCols) {\n      var cells = [];\n      for (var i = 0; i < numRows; i++) {\n        var row = [];\n        for (var j = 0; j < numCols; j++) {\n          row.push(makeCell(i, j, labelId));\n        }\n        cells.push(row);\n      }\n      return cells;\n    };\n    var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n      for (var i = 0; i < numRows; i++) {\n        for (var j = 0; j < numColumns; j++) {\n          Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n        }\n      }\n    };\n    var makeComponents = function (cells) {\n      return bind(cells, function (cellRow) {\n        return map(cellRow, premade$1);\n      });\n    };\n    var makeLabelText = function (row, col) {\n      return text(col + 1 + 'x' + (row + 1));\n    };\n    var renderInsertTableMenuItem = function (spec) {\n      var numRows = 10;\n      var numColumns = 10;\n      var sizeLabelId = generate$1('size-label');\n      var cells = makeCells(sizeLabelId, numRows, numColumns);\n      var memLabel = record({\n        dom: {\n          tag: 'span',\n          classes: ['tox-insert-table-picker__label'],\n          attributes: { id: sizeLabelId }\n        },\n        components: [text('0x0')],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$1('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$2.widget({\n            dom: {\n              tag: 'div',\n              classes: ['tox-insert-table-picker']\n            },\n            components: makeComponents(cells).concat(memLabel.asSpec()),\n            behaviours: derive$1([\n              config('insert-table-picker', [\n                runWithTarget(cellOverEvent, function (c, t, e) {\n                  var row = e.event.row;\n                  var col = e.event.col;\n                  selectCells(cells, row, col, numRows, numColumns);\n                  Replacing.set(memLabel.get(c), [makeLabelText(row, col)]);\n                }),\n                runWithTarget(cellExecuteEvent, function (c, _, e) {\n                  spec.onAction({\n                    numRows: e.event.row + 1,\n                    numColumns: e.event.col + 1\n                  });\n                  emit(c, sandboxClose());\n                })\n              ]),\n              Keying.config({\n                initSize: {\n                  numRows: numRows,\n                  numColumns: numColumns\n                },\n                mode: 'flatgrid',\n                selector: '[role=\"button\"]'\n              })\n            ])\n          })]\n      };\n    };\n\n    var fancyMenuItems = {\n      inserttable: renderInsertTableMenuItem,\n      colorswatch: renderColorSwatchItem\n    };\n    var valueOpt = function (obj, key) {\n      return Object.prototype.hasOwnProperty.call(obj, key) ? Optional.some(obj[key]) : Optional.none();\n    };\n    var renderFancyMenuItem = function (spec, backstage) {\n      return valueOpt(fancyMenuItems, spec.fancytype).map(function (render) {\n        return render(spec, backstage);\n      });\n    };\n\n    var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      if (downwardsCaret === void 0) {\n        downwardsCaret = false;\n      }\n      var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.some(caret),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: noop,\n        onSetup: spec.onSetup,\n        triggersSubmenu: true,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.none(),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderSeparatorItem = function (spec) {\n      var innerHtml = spec.text.fold(function () {\n        return {};\n      }, function (text) {\n        return { innerHtml: text };\n      });\n      return {\n        type: 'separator',\n        dom: __assign({\n          tag: 'div',\n          classes: [\n            selectableClass,\n            groupHeadingClass\n          ]\n        }, innerHtml),\n        components: []\n      };\n    };\n\n    var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n        caret: Optional.none(),\n        shortcutContent: spec.shortcut,\n        presets: 'normal',\n        meta: spec.meta\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var autocomplete = renderAutocompleteItem;\n    var separator = renderSeparatorItem;\n    var normal = renderNormalItem;\n    var nested = renderNestedItem;\n    var toggle$1 = renderToggleMenuItem;\n    var fancy = renderFancyMenuItem;\n\n    var FocusMode;\n    (function (FocusMode) {\n      FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n      FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n    }(FocusMode || (FocusMode = {})));\n    var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n      var providersBackstage = backstage.shared.providers;\n      var parseForHorizontalMenu = function (menuitem) {\n        return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n          shortcut: Optional.none(),\n          icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n        });\n      };\n      switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator(d));\n        });\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n      default: {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n      }\n    };\n    var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage) {\n      var renderText = columns === 1;\n      var renderIcons = !renderText || menuHasIcons(items);\n      return cat(map(items, function (item) {\n        if (item.type === 'separator') {\n          return createSeparatorItem(item).fold(handleError, function (d) {\n            return Optional.some(separator(d));\n          });\n        } else {\n          return createAutocompleterItem(item).fold(handleError, function (d) {\n            return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n          });\n        }\n      }));\n    };\n    var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n      var hasIcons = menuHasIcons(items);\n      var alloyItems = cat(map(items, function (item) {\n        var itemHasIcon = function (i) {\n          return isHorizontalMenu ? !i.hasOwnProperty('text') : hasIcons;\n        };\n        var createItem = function (i) {\n          return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n        };\n        if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n          return createItem(__assign(__assign({}, item), { disabled: true }));\n        } else {\n          return createItem(item);\n        }\n      }));\n      var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n      return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n    };\n    var createTieredDataFrom = function (partialMenu) {\n      return tieredMenu.singleData(partialMenu.value, partialMenu);\n    };\n    var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n      var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom();\n      var movement = deriveMenuMovement(columns, presets);\n      var menuMarkers = markers$1(presets);\n      return {\n        dom: partialMenu.dom,\n        components: partialMenu.components,\n        items: partialMenu.items,\n        value: partialMenu.value,\n        markers: {\n          selectedItem: menuMarkers.selectedItem,\n          item: menuMarkers.item\n        },\n        movement: movement,\n        fakeFocus: focusMode === FocusMode.ContentFocus,\n        focusManager: focusManager,\n        menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n              var numColumns = _a.numColumns, numRows = _a.numRows;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n      };\n    };\n\n    var register$2 = function (editor, sharedBackstage) {\n      var activeAutocompleter = Cell(Optional.none());\n      var processingAction = Cell(false);\n      var autocompleter = build$1(InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-autocompleter']\n        },\n        components: [],\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissAutocompleter', [run(dismissRequested(), function () {\n              return cancelIfNecessary();\n            })])]),\n        lazySink: sharedBackstage.getSink\n      }));\n      var isMenuOpen = function () {\n        return InlineView.isOpen(autocompleter);\n      };\n      var isActive = function () {\n        return activeAutocompleter.get().isSome();\n      };\n      var hideIfNecessary = function () {\n        if (isActive()) {\n          InlineView.hide(autocompleter);\n        }\n      };\n      var cancelIfNecessary = function () {\n        if (isActive()) {\n          var lastElement = activeAutocompleter.get().map(function (ac) {\n            return ac.element;\n          });\n          detect$4(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n          hideIfNecessary();\n          activeAutocompleter.set(Optional.none());\n          processingAction.set(false);\n        }\n      };\n      var getAutocompleters = cached(function () {\n        return register(editor);\n      });\n      var getCombinedItems = function (triggerChar, matches) {\n        var columns = findMap(matches, function (m) {\n          return Optional.from(m.columns);\n        }).getOr(1);\n        return bind(matches, function (match) {\n          var choices = match.items;\n          return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n            var nr = editor.selection.getRng();\n            getContext(editor.dom, nr, triggerChar).fold(function () {\n              return console.error('Lost context. Cursor probably moved');\n            }, function (_a) {\n              var range = _a.range;\n              var autocompleterApi = {\n                hide: function () {\n                  cancelIfNecessary();\n                },\n                reload: function (fetchOptions) {\n                  hideIfNecessary();\n                  load(fetchOptions);\n                }\n              };\n              processingAction.set(true);\n              match.onAction(autocompleterApi, range, itemValue, itemMeta);\n              processingAction.set(false);\n            });\n          }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage);\n        });\n      };\n      var commenceIfNecessary = function (context) {\n        if (!isActive()) {\n          var wrapper = create$4(editor, context.range);\n          activeAutocompleter.set(Optional.some({\n            triggerChar: context.triggerChar,\n            element: wrapper,\n            matchLength: context.text.length\n          }));\n          processingAction.set(false);\n        }\n      };\n      var display = function (ac, context, lookupData, items) {\n        ac.matchLength = context.text.length;\n        var columns = findMap(lookupData, function (ld) {\n          return Optional.from(ld.columns);\n        }).getOr(1);\n        InlineView.showAt(autocompleter, {\n          anchor: 'node',\n          root: SugarElement.fromDom(editor.getBody()),\n          node: Optional.from(ac.element)\n        }, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')));\n        InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n      };\n      var doLookup = function (fetchOptions) {\n        return activeAutocompleter.get().map(function (ac) {\n          return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n            return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n          });\n        }).getOrThunk(function () {\n          return lookup(editor, getAutocompleters);\n        });\n      };\n      var load = function (fetchOptions) {\n        doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n          commenceIfNecessary(lookupInfo.context);\n          lookupInfo.lookupData.then(function (lookupData) {\n            activeAutocompleter.get().map(function (ac) {\n              var context = lookupInfo.context;\n              if (ac.triggerChar === context.triggerChar) {\n                var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n                if (combinedItems.length > 0) {\n                  display(ac, context, lookupData, combinedItems);\n                } else if (context.text.length - ac.matchLength >= 10) {\n                  cancelIfNecessary();\n                } else {\n                  hideIfNecessary();\n                }\n              }\n            });\n          });\n        });\n      };\n      var onKeypress = last$2(function (e) {\n        if (e.which === 27) {\n          return;\n        }\n        load();\n      }, 50);\n      var autocompleterUiApi = {\n        onKeypress: onKeypress,\n        cancelIfNecessary: cancelIfNecessary,\n        isMenuOpen: isMenuOpen,\n        isActive: isActive,\n        isProcessingAction: processingAction.get,\n        getView: function () {\n          return InlineView.getContent(autocompleter);\n        }\n      };\n      AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n    };\n    var Autocompleter = { register: register$2 };\n\n    var filter$2 = always;\n    var bind$3 = function (element, event, handler) {\n      return bind$2(element, event, filter$2, handler);\n    };\n    var capture$1 = function (element, event, handler) {\n      return capture(element, event, filter$2, handler);\n    };\n    var fromRawEvent$1 = fromRawEvent;\n\n    var closest$4 = function (scope, selector, isRoot) {\n      return closest$3(scope, selector, isRoot).isSome();\n    };\n\n    function DelayedFunction (fun, delay) {\n      var ref = null;\n      var schedule = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        ref = setTimeout(function () {\n          fun.apply(null, args);\n          ref = null;\n        }, delay);\n      };\n      var cancel = function () {\n        if (ref !== null) {\n          clearTimeout(ref);\n          ref = null;\n        }\n      };\n      return {\n        cancel: cancel,\n        schedule: schedule\n      };\n    }\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      var raw = event.raw;\n      if (raw.touches === undefined || raw.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(raw.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var monitor = function (settings) {\n      var startData = Cell(Optional.none());\n      var longpressFired = Cell(false);\n      var longpress$1 = DelayedFunction(function (event) {\n        settings.triggerEvent(longpress(), event);\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      var handleTouchstart = function (event) {\n        getTouch(event).each(function (touch) {\n          longpress$1.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: event.target\n          };\n          longpress$1.schedule(event);\n          longpressFired.set(false);\n          startData.set(Optional.some(data));\n        });\n        return Optional.none();\n      };\n      var handleTouchmove = function (event) {\n        longpress$1.cancel();\n        getTouch(event).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Optional.none());\n            }\n          });\n        });\n        return Optional.none();\n      };\n      var handleTouchend = function (event) {\n        longpress$1.cancel();\n        var isSame = function (data) {\n          return eq$1(data.target, event.target);\n        };\n        return startData.get().filter(isSame).map(function (_data) {\n          if (longpressFired.get()) {\n            event.prevent();\n            return false;\n          } else {\n            return settings.triggerEvent(tap(), event);\n          }\n        });\n      };\n      var handlers = wrapAll$1([\n        {\n          key: touchstart(),\n          value: handleTouchstart\n        },\n        {\n          key: touchmove(),\n          value: handleTouchmove\n        },\n        {\n          key: touchend(),\n          value: handleTouchend\n        }\n      ]);\n      var fireIfReady = function (event, type) {\n        return get(handlers, type).bind(function (handler) {\n          return handler(event);\n        });\n      };\n      return { fireIfReady: fireIfReady };\n    };\n\n    var isDangerous = function (event) {\n      var keyEv = event.raw;\n      return keyEv.which === BACKSPACE[0] && !contains([\n        'input',\n        'textarea'\n      ], name(event.target)) && !closest$4(event.target, '[contenteditable=\"true\"]');\n    };\n    var isFirefox = function () {\n      return detect$3().browser.isFirefox();\n    };\n    var settingsSchema = objOfOnly([\n      strictFunction('triggerEvent'),\n      defaulted$1('stopBackspace', true)\n    ]);\n    var bindFocus = function (container, handler) {\n      if (isFirefox()) {\n        return capture$1(container, 'focus', handler);\n      } else {\n        return bind$3(container, 'focusin', handler);\n      }\n    };\n    var bindBlur = function (container, handler) {\n      if (isFirefox()) {\n        return capture$1(container, 'blur', handler);\n      } else {\n        return bind$3(container, 'focusout', handler);\n      }\n    };\n    var setup$1 = function (container, rawSettings) {\n      var settings = asRawOrDie('Getting GUI events settings', settingsSchema, rawSettings);\n      var pointerEvents = [\n        'touchstart',\n        'touchmove',\n        'touchend',\n        'touchcancel',\n        'gesturestart',\n        'mousedown',\n        'mouseup',\n        'mouseover',\n        'mousemove',\n        'mouseout',\n        'click'\n      ];\n      var tapEvent = monitor(settings);\n      var simpleEvents = map(pointerEvents.concat([\n        'selectstart',\n        'input',\n        'contextmenu',\n        'change',\n        'transitionend',\n        'drag',\n        'dragstart',\n        'dragend',\n        'dragenter',\n        'dragleave',\n        'dragover',\n        'drop',\n        'keyup'\n      ]), function (type) {\n        return bind$3(container, type, function (event) {\n          tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n            if (tapStopped) {\n              event.kill();\n            }\n          });\n          var stopped = settings.triggerEvent(type, event);\n          if (stopped) {\n            event.kill();\n          }\n        });\n      });\n      var pasteTimeout = Cell(Optional.none());\n      var onPaste = bind$3(container, 'paste', function (event) {\n        tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent('paste', event);\n        if (stopped) {\n          event.kill();\n        }\n        pasteTimeout.set(Optional.some(setTimeout(function () {\n          settings.triggerEvent(postPaste(), event);\n        }, 0)));\n      });\n      var onKeydown = bind$3(container, 'keydown', function (event) {\n        var stopped = settings.triggerEvent('keydown', event);\n        if (stopped) {\n          event.kill();\n        } else if (settings.stopBackspace === true && isDangerous(event)) {\n          event.prevent();\n        }\n      });\n      var onFocusIn = bindFocus(container, function (event) {\n        var stopped = settings.triggerEvent('focusin', event);\n        if (stopped) {\n          event.kill();\n        }\n      });\n      var focusoutTimeout = Cell(Optional.none());\n      var onFocusOut = bindBlur(container, function (event) {\n        var stopped = settings.triggerEvent('focusout', event);\n        if (stopped) {\n          event.kill();\n        }\n        focusoutTimeout.set(Optional.some(setTimeout(function () {\n          settings.triggerEvent(postBlur(), event);\n        }, 0)));\n      });\n      var unbind = function () {\n        each(simpleEvents, function (e) {\n          e.unbind();\n        });\n        onKeydown.unbind();\n        onFocusIn.unbind();\n        onFocusOut.unbind();\n        onPaste.unbind();\n        pasteTimeout.get().each(clearTimeout);\n        focusoutTimeout.get().each(clearTimeout);\n      };\n      return { unbind: unbind };\n    };\n\n    var derive$2 = function (rawEvent, rawTarget) {\n      var source = get(rawEvent, 'target').getOr(rawTarget);\n      return Cell(source);\n    };\n\n    var fromSource = function (event, source) {\n      var stopper = Cell(false);\n      var cutter = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      var cut = function () {\n        cutter.set(true);\n      };\n      return {\n        stop: stop,\n        cut: cut,\n        isStopped: stopper.get,\n        isCut: cutter.get,\n        event: event,\n        setSource: source.set,\n        getSource: source.get\n      };\n    };\n    var fromExternal = function (event) {\n      var stopper = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      return {\n        stop: stop,\n        cut: noop,\n        isStopped: stopper.get,\n        isCut: never,\n        event: event,\n        setSource: die('Cannot set source of a broadcasted event'),\n        getSource: die('Cannot get source of a broadcasted event')\n      };\n    };\n\n    var adt$b = Adt.generate([\n      { stopped: [] },\n      { resume: ['element'] },\n      { complete: [] }\n    ]);\n    var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n      var handler = lookup(eventType, target);\n      var simulatedEvent = fromSource(rawEvent, source);\n      return handler.fold(function () {\n        logger.logEventNoHandlers(eventType, target);\n        return adt$b.complete();\n      }, function (handlerInfo) {\n        var descHandler = handlerInfo.descHandler;\n        var eventHandler = getCurried(descHandler);\n        eventHandler(simulatedEvent);\n        if (simulatedEvent.isStopped()) {\n          logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.stopped();\n        } else if (simulatedEvent.isCut()) {\n          logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.complete();\n        } else {\n          return parent(handlerInfo.element).fold(function () {\n            logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$b.complete();\n          }, function (parent) {\n            logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$b.resume(parent);\n          });\n        }\n      });\n    };\n    var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n      return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(function () {\n        return true;\n      }, function (parent) {\n        return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n      }, function () {\n        return false;\n      });\n    };\n    var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n      var source = derive$2(rawEvent, target);\n      return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n    };\n    var broadcast = function (listeners, rawEvent, _logger) {\n      var simulatedEvent = fromExternal(rawEvent);\n      each(listeners, function (listener) {\n        var descHandler = listener.descHandler;\n        var handler = getCurried(descHandler);\n        handler(simulatedEvent);\n      });\n      return simulatedEvent.isStopped();\n    };\n    var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n      return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n    };\n    var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n      var source = derive$2(rawEvent, rawTarget);\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n    };\n\n    var eventHandler = function (element, descHandler) {\n      return {\n        element: element,\n        descHandler: descHandler\n      };\n    };\n    var broadcastHandler = function (id, handler) {\n      return {\n        id: id,\n        descHandler: handler\n      };\n    };\n    function EventRegistry () {\n      var registry = {};\n      var registerId = function (extraArgs, id, events) {\n        each$1(events, function (v, k) {\n          var handlers = registry[k] !== undefined ? registry[k] : {};\n          handlers[id] = curryArgs(v, extraArgs);\n          registry[k] = handlers;\n        });\n      };\n      var findHandler = function (handlers, elem) {\n        return read$1(elem).fold(function () {\n          return Optional.none();\n        }, function (id) {\n          return handlers.bind(function (h) {\n            return get(h, id);\n          }).map(function (descHandler) {\n            return eventHandler(elem, descHandler);\n          });\n        });\n      };\n      var filterByType = function (type) {\n        return get(registry, type).map(function (handlers) {\n          return mapToArray(handlers, function (f, id) {\n            return broadcastHandler(id, f);\n          });\n        }).getOr([]);\n      };\n      var find = function (isAboveRoot, type, target) {\n        var handlers = get(registry, type);\n        return closest(target, function (elem) {\n          return findHandler(handlers, elem);\n        }, isAboveRoot);\n      };\n      var unregisterId = function (id) {\n        each$1(registry, function (handlersById, _eventName) {\n          if (handlersById.hasOwnProperty(id)) {\n            delete handlersById[id];\n          }\n        });\n      };\n      return {\n        registerId: registerId,\n        unregisterId: unregisterId,\n        filterByType: filterByType,\n        find: find\n      };\n    }\n\n    function Registry () {\n      var events = EventRegistry();\n      var components = {};\n      var readOrTag = function (component) {\n        var elem = component.element;\n        return read$1(elem).fold(function () {\n          return write('uid-', component.element);\n        }, function (uid) {\n          return uid;\n        });\n      };\n      var failOnDuplicate = function (component, tagId) {\n        var conflict = components[tagId];\n        if (conflict === component) {\n          unregister(component);\n        } else {\n          throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n        }\n      };\n      var register = function (component) {\n        var tagId = readOrTag(component);\n        if (hasNonNullableKey(components, tagId)) {\n          failOnDuplicate(component, tagId);\n        }\n        var extraArgs = [component];\n        events.registerId(extraArgs, tagId, component.events);\n        components[tagId] = component;\n      };\n      var unregister = function (component) {\n        read$1(component.element).each(function (tagId) {\n          delete components[tagId];\n          events.unregisterId(tagId);\n        });\n      };\n      var filter = function (type) {\n        return events.filterByType(type);\n      };\n      var find = function (isAboveRoot, type, target) {\n        return events.find(isAboveRoot, type, target);\n      };\n      var getById = function (id) {\n        return get(components, id);\n      };\n      return {\n        find: find,\n        filter: filter,\n        register: register,\n        unregister: unregister,\n        getById: getById\n      };\n    }\n\n    var factory$3 = function (detail) {\n      var _a = detail.dom, attributes = _a.attributes, domWithoutAttributes = __rest(_a, ['attributes']);\n      return {\n        uid: detail.uid,\n        dom: __assign({\n          tag: 'div',\n          attributes: __assign({ role: 'presentation' }, attributes)\n        }, domWithoutAttributes),\n        components: detail.components,\n        behaviours: get$c(detail.containerBehaviours),\n        events: detail.events,\n        domModification: detail.domModification,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Container = single$2({\n      name: 'Container',\n      factory: factory$3,\n      configFields: [\n        defaulted$1('components', []),\n        field$1('containerBehaviours', []),\n        defaulted$1('events', {}),\n        defaulted$1('domModification', {}),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var takeover = function (root) {\n      var isAboveRoot = function (el) {\n        return parent(root.element).fold(function () {\n          return true;\n        }, function (parent) {\n          return eq$1(el, parent);\n        });\n      };\n      var registry = Registry();\n      var lookup = function (eventName, target) {\n        return registry.find(isAboveRoot, eventName, target);\n      };\n      var domEvents = setup$1(root.element, {\n        triggerEvent: function (eventName, event) {\n          return monitorEvent(eventName, event.target, function (logger) {\n            return triggerUntilStopped(lookup, eventName, event, logger);\n          });\n        }\n      });\n      var systemApi = {\n        debugInfo: constant('real'),\n        triggerEvent: function (eventName, target, data) {\n          monitorEvent(eventName, target, function (logger) {\n            return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n          });\n        },\n        triggerFocus: function (target, originator) {\n          read$1(target).fold(function () {\n            focus$1(target);\n          }, function (_alloyId) {\n            monitorEvent(focus(), target, function (logger) {\n              triggerHandler(lookup, focus(), {\n                originator: originator,\n                kill: noop,\n                prevent: noop,\n                target: target\n              }, target, logger);\n              return false;\n            });\n          });\n        },\n        triggerEscape: function (comp, simulatedEvent) {\n          systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n        },\n        getByUid: function (uid) {\n          return getByUid(uid);\n        },\n        getByDom: function (elem) {\n          return getByDom(elem);\n        },\n        build: build$1,\n        addToGui: function (c) {\n          add(c);\n        },\n        removeFromGui: function (c) {\n          remove$1(c);\n        },\n        addToWorld: function (c) {\n          addToWorld(c);\n        },\n        removeFromWorld: function (c) {\n          removeFromWorld(c);\n        },\n        broadcast: function (message) {\n          broadcast$1(message);\n        },\n        broadcastOn: function (channels, message) {\n          broadcastOn(channels, message);\n        },\n        broadcastEvent: function (eventName, event) {\n          broadcastEvent(eventName, event);\n        },\n        isConnected: always\n      };\n      var addToWorld = function (component) {\n        component.connect(systemApi);\n        if (!isText(component.element)) {\n          registry.register(component);\n          each(component.components(), addToWorld);\n          systemApi.triggerEvent(systemInit(), component.element, { target: component.element });\n        }\n      };\n      var removeFromWorld = function (component) {\n        if (!isText(component.element)) {\n          each(component.components(), removeFromWorld);\n          registry.unregister(component);\n        }\n        component.disconnect();\n      };\n      var add = function (component) {\n        attach$1(root, component);\n      };\n      var remove$1 = function (component) {\n        detach(component);\n      };\n      var destroy = function () {\n        domEvents.unbind();\n        remove(root.element);\n      };\n      var broadcastData = function (data) {\n        var receivers = registry.filter(receive());\n        each(receivers, function (receiver) {\n          var descHandler = receiver.descHandler;\n          var handler = getCurried(descHandler);\n          handler(data);\n        });\n      };\n      var broadcast$1 = function (message) {\n        broadcastData({\n          universal: true,\n          data: message\n        });\n      };\n      var broadcastOn = function (channels, message) {\n        broadcastData({\n          universal: false,\n          channels: channels,\n          data: message\n        });\n      };\n      var broadcastEvent = function (eventName, event) {\n        var listeners = registry.filter(eventName);\n        return broadcast(listeners, event);\n      };\n      var getByUid = function (uid) {\n        return registry.getById(uid).fold(function () {\n          return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n        }, Result.value);\n      };\n      var getByDom = function (elem) {\n        var uid = read$1(elem).getOr('not found');\n        return getByUid(uid);\n      };\n      addToWorld(root);\n      return {\n        root: root,\n        element: root.element,\n        destroy: destroy,\n        add: add,\n        remove: remove$1,\n        getByUid: getByUid,\n        getByDom: getByDom,\n        addToWorld: addToWorld,\n        removeFromWorld: removeFromWorld,\n        broadcast: broadcast$1,\n        broadcastOn: broadcastOn,\n        broadcastEvent: broadcastEvent\n      };\n    };\n\n    var renderBar = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-bar',\n            'tox-form__controls-h-stack'\n          ]\n        },\n        components: map(spec.items, backstage.interpreter)\n      };\n    };\n\n    var schema$e = constant([\n      defaulted$1('prefix', 'form-field'),\n      field$1('fieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var parts$3 = constant([\n      optional({\n        schema: [strict$1('dom')],\n        name: 'label'\n      }),\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [strict$1('text')],\n        name: 'aria-descriptor'\n      }),\n      required({\n        factory: {\n          sketch: function (spec) {\n            var excludeFactory = exclude$1(spec, ['factory']);\n            return spec.factory.sketch(excludeFactory);\n          }\n        },\n        schema: [strict$1('factory')],\n        name: 'field'\n      })\n    ]);\n\n    var factory$4 = function (detail, components, _spec, _externals) {\n      var behaviours = augment(detail.fieldBehaviours, [\n        Composing.config({\n          find: function (container) {\n            return getPart(container, detail, 'field');\n          }\n        }),\n        Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (field) {\n              return Composing.getCurrent(field).bind(Representing.getValue);\n            },\n            setValue: function (field, value) {\n              Composing.getCurrent(field).each(function (current) {\n                Representing.setValue(current, value);\n              });\n            }\n          }\n        })\n      ]);\n      var events = derive([runOnAttached(function (component, _simulatedEvent) {\n          var ps = getParts(component, detail, [\n            'label',\n            'field',\n            'aria-descriptor'\n          ]);\n          ps.field().each(function (field) {\n            var id = generate$1(detail.prefix);\n            ps.label().each(function (label) {\n              set$1(label.element, 'for', id);\n              set$1(field.element, 'id', id);\n            });\n            ps['aria-descriptor']().each(function (descriptor) {\n              var descriptorId = generate$1(detail.prefix);\n              set$1(descriptor.element, 'id', descriptorId);\n              set$1(field.element, 'aria-describedby', descriptorId);\n            });\n          });\n        })]);\n      var apis = {\n        getField: function (container) {\n          return getPart(container, detail, 'field');\n        },\n        getLabel: function (container) {\n          return getPart(container, detail, 'label');\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: behaviours,\n        events: events,\n        apis: apis\n      };\n    };\n    var FormField = composite$1({\n      name: 'FormField',\n      configFields: schema$e(),\n      partFields: parts$3(),\n      factory: factory$4,\n      apis: {\n        getField: function (apis, comp) {\n          return apis.getField(comp);\n        },\n        getLabel: function (apis, comp) {\n          return apis.getLabel(comp);\n        }\n      }\n    });\n\n    var exhibit$4 = function (base, tabConfig) {\n      return nu$6({\n        attributes: wrapAll$1([{\n            key: tabConfig.tabAttr,\n            value: 'true'\n          }])\n      });\n    };\n\n    var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$4\n    });\n\n    var TabstopSchema = [defaulted$1('tabAttr', 'data-alloy-tabstop')];\n\n    var Tabstopping = create$1({\n      fields: TabstopSchema,\n      name: 'tabstopping',\n      active: ActiveTabstopping\n    });\n\n    var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n      return FormField.sketch(spec);\n    };\n    var renderFormField = function (pLabel, pField) {\n      return renderFormFieldWith(pLabel, pField, [], []);\n    };\n    var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      return {\n        dom: renderFormFieldDomWith(extraClasses),\n        components: pLabel.toArray().concat([pField]),\n        fieldBehaviours: derive$1(extraBehaviours)\n      };\n    };\n    var renderFormFieldDom = function () {\n      return renderFormFieldDomWith([]);\n    };\n    var renderFormFieldDomWith = function (extraClasses) {\n      return {\n        tag: 'div',\n        classes: ['tox-form__group'].concat(extraClasses)\n      };\n    };\n    var renderLabel = function (label, providersBackstage) {\n      return FormField.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n    };\n\n    var formChangeEvent = generate$1('form-component-change');\n    var formCloseEvent = generate$1('form-close');\n    var formCancelEvent = generate$1('form-cancel');\n    var formActionEvent = generate$1('form-action');\n    var formSubmitEvent = generate$1('form-submit');\n    var formBlockEvent = generate$1('form-block');\n    var formUnblockEvent = generate$1('form-unblock');\n    var formTabChangeEvent = generate$1('form-tabchange');\n    var formResizeEvent = generate$1('form-resize');\n\n    var renderCollection = function (spec, providersBackstage) {\n      var _a;\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var runOnItem = function (f) {\n        return function (comp, se) {\n          closest$3(se.event.target, '[data-collection-item-value]').each(function (target) {\n            f(comp, se, target, get$2(target, 'data-collection-item-value'));\n          });\n        };\n      };\n      var escapeAttribute = function (ch) {\n        if (ch === '\"') {\n          return '&quot;';\n        }\n        return ch;\n      };\n      var setContents = function (comp, items) {\n        var htmlLines = map(items, function (item) {\n          var itemText = global$6.translate(item.text);\n          var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n          var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n          var mapItemName = {\n            '_': ' ',\n            ' - ': ' ',\n            '-': ' '\n          };\n          var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n            return mapItemName[match];\n          });\n          var readonlyClass = providersBackstage.isReadOnly() ? ' tox-collection__item--state-disabled' : '';\n          return '<div class=\"tox-collection__item' + readonlyClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + escapeAttribute(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n        });\n        var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk(htmlLines, spec.columns) : [htmlLines];\n        var html = map(chunks, function (ch) {\n          return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n        });\n        set(comp.element, html.join(''));\n      };\n      var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n        se.stop();\n        if (!providersBackstage.isReadOnly()) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }\n      });\n      var collectionEvents = [\n        run(mouseover(), runOnItem(function (comp, se, tgt) {\n          focus$1(tgt);\n        })),\n        run(click(), onClick),\n        run(tap(), onClick),\n        run(focusin(), runOnItem(function (comp, se, tgt) {\n          descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$4(currentActive, activeClass);\n          });\n          add$2(tgt, activeClass);\n        })),\n        run(focusout(), runOnItem(function (comp) {\n          descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$4(currentActive, activeClass);\n          });\n        })),\n        runOnExecute(runOnItem(function (comp, se, tgt, itemValue) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }))\n      ];\n      var iterCollectionItems = function (comp, applyAttributes) {\n        return map(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n      };\n      var pField = FormField.parts.field({\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n        },\n        components: [],\n        factory: { sketch: identity },\n        behaviours: derive$1([\n          Disabling.config({\n            disabled: providersBackstage.isReadOnly,\n            onDisabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                add$2(childElm, 'tox-collection__item--state-disabled');\n                set$1(childElm, 'aria-disabled', true);\n              });\n            },\n            onEnabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                remove$4(childElm, 'tox-collection__item--state-disabled');\n                remove$1(childElm, 'aria-disabled');\n              });\n            }\n          }),\n          receivingConfig(),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: []\n            },\n            onSetValue: function (comp, items) {\n              setContents(comp, items);\n              if (spec.columns === 'auto') {\n                detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n                  var numRows = _a.numRows, numColumns = _a.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              }\n              emit(comp, formResizeEvent);\n            }\n          }),\n          Tabstopping.config({}),\n          Keying.config(deriveCollectionMovement(spec.columns, 'normal')),\n          config('collection-events', collectionEvents)\n        ]),\n        eventOrder: (_a = {}, _a[execute()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'collection-events'\n        ], _a)\n      });\n      var extraClasses = ['tox-form__group--collection'];\n      return renderFormFieldWith(pLabel, pField, extraClasses, []);\n    };\n\n    var schema$f = constant([\n      option('data'),\n      defaulted$1('inputAttributes', {}),\n      defaulted$1('inputStyles', {}),\n      defaulted$1('tag', 'input'),\n      defaulted$1('inputClasses', []),\n      onHandler('onSetValue'),\n      defaulted$1('styles', {}),\n      defaulted$1('eventOrder', {}),\n      field$1('inputBehaviours', [\n        Representing,\n        Focusing\n      ]),\n      defaulted$1('selectOnFocus', true)\n    ]);\n    var focusBehaviours = function (detail) {\n      return derive$1([Focusing.config({\n          onFocus: !detail.selectOnFocus ? noop : function (component) {\n            var input = component.element;\n            var value = get$5(input);\n            input.dom.setSelectionRange(0, value.length);\n          }\n        })]);\n    };\n    var behaviours = function (detail) {\n      return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n          store: __assign(__assign({ mode: 'manual' }, detail.data.map(function (data) {\n            return { initialValue: data };\n          }).getOr({})), {\n            getValue: function (input) {\n              return get$5(input.element);\n            },\n            setValue: function (input, data) {\n              var current = get$5(input.element);\n              if (current !== data) {\n                set$3(input.element, data);\n              }\n            }\n          }),\n          onSetValue: detail.onSetValue\n        })]));\n    };\n    var dom$2 = function (detail) {\n      return {\n        tag: detail.tag,\n        attributes: __assign({ type: 'text' }, detail.inputAttributes),\n        styles: detail.inputStyles,\n        classes: detail.inputClasses\n      };\n    };\n\n    var factory$5 = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: dom$2(detail),\n        components: [],\n        behaviours: behaviours(detail),\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Input = single$2({\n      name: 'Input',\n      configFields: schema$f(),\n      factory: factory$5\n    });\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu$a = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$a(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$a(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$a,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make$3 = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make$3(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make$3(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make$3(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make$3(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$b = function (baseFn) {\n      return make$3(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make$3(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$b,\n      pure: pure$1\n    };\n\n    var ariaElements = [\n      'input',\n      'textarea'\n    ];\n    var isAriaElement = function (elem) {\n      var name$1 = name(elem);\n      return contains(ariaElements, name$1);\n    };\n    var markValid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      remove$4(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$1(component.element, 'aria-invalid', false);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set(container, notifyInfo.validHtml);\n        });\n        notifyInfo.onValid(component);\n      });\n    };\n    var markInvalid = function (component, invalidConfig, invalidState, text) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      add$2(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$1(component.element, 'aria-invalid', true);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set(container, text);\n        });\n        notifyInfo.onInvalid(component, text);\n      });\n    };\n    var query = function (component, invalidConfig, _invalidState) {\n      return invalidConfig.validator.fold(function () {\n        return Future.pure(Result.value(true));\n      }, function (validatorInfo) {\n        return validatorInfo.validate(component);\n      });\n    };\n    var run$1 = function (component, invalidConfig, invalidState) {\n      invalidConfig.notify.each(function (notifyInfo) {\n        notifyInfo.onValidate(component);\n      });\n      return query(component, invalidConfig).map(function (valid) {\n        if (component.getSystem().isConnected()) {\n          return valid.fold(function (err) {\n            markInvalid(component, invalidConfig, invalidState, err);\n            return Result.error(err);\n          }, function (v) {\n            markValid(component, invalidConfig);\n            return Result.value(v);\n          });\n        } else {\n          return Result.error('No longer in system');\n        }\n      });\n    };\n    var isInvalid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      return has$2(elem, invalidConfig.invalidClass);\n    };\n\n    var InvalidateApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        markValid: markValid,\n        markInvalid: markInvalid,\n        query: query,\n        run: run$1,\n        isInvalid: isInvalid\n    });\n\n    var events$a = function (invalidConfig, invalidState) {\n      return invalidConfig.validator.map(function (validatorInfo) {\n        return derive([run(validatorInfo.onEvent, function (component) {\n            run$1(component, invalidConfig, invalidState).get(identity);\n          })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n            run$1(component, invalidConfig, invalidState).get(noop);\n          })] : []));\n      }).getOr({});\n    };\n\n    var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$a\n    });\n\n    var InvalidateSchema = [\n      strict$1('invalidClass'),\n      defaulted$1('getRoot', Optional.none),\n      optionObjOf('notify', [\n        defaulted$1('aria', 'alert'),\n        defaulted$1('getContainer', Optional.none),\n        defaulted$1('validHtml', ''),\n        onHandler('onValid'),\n        onHandler('onInvalid'),\n        onHandler('onValidate')\n      ]),\n      optionObjOf('validator', [\n        strict$1('validate'),\n        defaulted$1('onEvent', 'input'),\n        defaulted$1('validateOnLoad', true)\n      ])\n    ];\n\n    var Invalidating = create$1({\n      fields: InvalidateSchema,\n      name: 'invalidating',\n      active: ActiveInvalidate,\n      apis: InvalidateApis,\n      extra: {\n        validation: function (validator) {\n          return function (component) {\n            var v = Representing.getValue(component);\n            return Future.pure(validator(v));\n          };\n        }\n      }\n    });\n\n    var getCoupled = function (component, coupleConfig, coupleState, name) {\n      return coupleState.getOrCreate(component, coupleConfig, name);\n    };\n\n    var CouplingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCoupled: getCoupled\n    });\n\n    var CouplingSchema = [strictOf('others', setOf$1(Result.value, anyValue$1()))];\n\n    var init$5 = function () {\n      var coupled = {};\n      var getOrCreate = function (component, coupleConfig, name) {\n        var available = keys(coupleConfig.others);\n        if (!available) {\n          throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n        } else {\n          return get(coupled, name).getOrThunk(function () {\n            var builder = get(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n            var spec = builder(component);\n            var built = component.getSystem().build(spec);\n            coupled[name] = built;\n            return built;\n          });\n        }\n      };\n      var readState = constant({});\n      return nu$5({\n        readState: readState,\n        getOrCreate: getOrCreate\n      });\n    };\n\n    var CouplingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$5\n    });\n\n    var Coupling = create$1({\n      fields: CouplingSchema,\n      name: 'coupling',\n      apis: CouplingApis,\n      state: CouplingState\n    });\n\n    var suffix = constant('sink');\n    var partType = constant(optional({\n      name: suffix(),\n      overrides: constant({\n        dom: { tag: 'div' },\n        behaviours: derive$1([Positioning.config({ useFixed: always })]),\n        events: derive([\n          cutter(keydown()),\n          cutter(mousedown()),\n          cutter(click())\n        ])\n      })\n    }));\n\n    var HighlightOnOpen;\n    (function (HighlightOnOpen) {\n      HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n      HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n    }(HighlightOnOpen || (HighlightOnOpen = {})));\n    var getAnchor = function (detail, component) {\n      var hotspot = detail.getHotspot(component).getOr(component);\n      var anchor = 'hotspot';\n      var overrides = detail.getAnchorOverrides();\n      return detail.layouts.fold(function () {\n        return {\n          anchor: anchor,\n          hotspot: hotspot,\n          overrides: overrides\n        };\n      }, function (layouts) {\n        return {\n          anchor: anchor,\n          hotspot: hotspot,\n          overrides: overrides,\n          layouts: layouts\n        };\n      });\n    };\n    var fetch = function (detail, mapFetch, component) {\n      var fetcher = detail.fetch;\n      return fetcher(component).map(mapFetch);\n    };\n    var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n      var futureData = fetch(detail, mapFetch, component);\n      var getLazySink = getSink(component, detail);\n      return futureData.map(function (tdata) {\n        return tdata.bind(function (data) {\n          return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n            uid: generate$2(''),\n            data: data,\n            highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n            onOpenMenu: function (tmenu, menu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, anchor, menu);\n              Sandboxing.decloak(sandbox);\n            },\n            onOpenSubmenu: function (tmenu, item, submenu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, {\n                anchor: 'submenu',\n                item: item\n              }, submenu);\n              Sandboxing.decloak(sandbox);\n            },\n            onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, anchor, primaryMenu);\n              each(submenuTriggers, function (st) {\n                Positioning.position(sink, {\n                  anchor: 'submenu',\n                  item: st.triggeringItem\n                }, st.triggeredMenu);\n              });\n            },\n            onEscape: function () {\n              Focusing.focus(component);\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n          })));\n        });\n      });\n    };\n    var open$1 = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n      var anchor = getAnchor(detail, hotspot);\n      var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n      return processed.map(function (tdata) {\n        tdata.fold(function () {\n          if (Sandboxing.isOpen(sandbox)) {\n            Sandboxing.close(sandbox);\n          }\n        }, function (data) {\n          Sandboxing.cloak(sandbox);\n          Sandboxing.open(sandbox, data);\n          onOpenSync(sandbox);\n        });\n        return sandbox;\n      });\n    };\n    var close$1 = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n      Sandboxing.close(sandbox);\n      return Future.pure(sandbox);\n    };\n    var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n      var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n      var showing = Sandboxing.isOpen(sandbox);\n      var action = showing ? close$1 : open$1;\n      return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n    };\n    var matchWidth = function (hotspot, container, useMinWidth) {\n      var menu = Composing.getCurrent(container).getOr(container);\n      var buttonWidth = get$7(hotspot.element);\n      if (useMinWidth) {\n        set$2(menu.element, 'min-width', buttonWidth + 'px');\n      } else {\n        set$4(menu.element, buttonWidth);\n      }\n    };\n    var getSink = function (anyInSystem, sinkDetail) {\n      return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n        return function () {\n          return Result.value(internalSink);\n        };\n      }).getOrThunk(function () {\n        return sinkDetail.lazySink.fold(function () {\n          return function () {\n            return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n          };\n        }, function (lazySinkFn) {\n          return function () {\n            return lazySinkFn(anyInSystem);\n          };\n        });\n      });\n    };\n    var doRepositionMenus = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.repositionMenus(tmenu);\n      });\n    };\n    var makeSandbox = function (detail, hotspot, extras) {\n      var ariaOwner = manager();\n      var onOpen = function (component, menu) {\n        var anchor = getAnchor(detail, hotspot);\n        ariaOwner.link(hotspot.element);\n        if (detail.matchWidth) {\n          matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n        }\n        detail.onOpen(anchor, component, menu);\n        if (extras !== undefined && extras.onOpen !== undefined) {\n          extras.onOpen(component, menu);\n        }\n      };\n      var onClose = function (component, menu) {\n        ariaOwner.unlink(hotspot.element);\n        if (extras !== undefined && extras.onClose !== undefined) {\n          extras.onClose(component, menu);\n        }\n      };\n      var lazySink = getSink(hotspot, detail);\n      return {\n        dom: {\n          tag: 'div',\n          classes: detail.sandboxClasses,\n          attributes: {\n            id: ariaOwner.id,\n            role: 'listbox'\n          }\n        },\n        behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: hotspot\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOf(hotspot, queryElem);\n            },\n            getAttachPoint: function () {\n              return lazySink().getOrDie();\n            }\n          }),\n          Composing.config({\n            find: function (sandbox) {\n              return Sandboxing.getState(sandbox).bind(function (menu) {\n                return Composing.getCurrent(menu);\n              });\n            }\n          }),\n          Receiving.config({ channels: __assign(__assign({}, receivingChannel({ isExtraPart: never })), receivingChannel$1({ doReposition: doRepositionMenus })) })\n        ])\n      };\n    };\n    var repositionMenus = function (comp) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      doRepositionMenus(sandbox);\n    };\n\n    var sandboxFields = function () {\n      return [\n        defaulted$1('sandboxClasses', []),\n        SketchBehaviours.field('sandboxBehaviours', [\n          Composing,\n          Receiving,\n          Sandboxing,\n          Representing\n        ])\n      ];\n    };\n\n    var schema$g = constant([\n      strict$1('dom'),\n      strict$1('fetch'),\n      onHandler('onOpen'),\n      onKeyboardHandler('onExecute'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      schema$1(),\n      field$1('dropdownBehaviours', [\n        Toggling,\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      strict$1('toggleClass'),\n      defaulted$1('eventOrder', {}),\n      option('lazySink'),\n      defaulted$1('matchWidth', false),\n      defaulted$1('useMinWidth', false),\n      option('role')\n    ].concat(sandboxFields()));\n    var parts$4 = constant([\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return { onExecute: detail.onExecute };\n        }\n      }),\n      partType()\n    ]);\n\n    var factory$6 = function (detail, components, _spec, externals) {\n      var _a;\n      var lookupAttr = function (attr) {\n        return get(detail.dom, 'attributes').bind(function (attrs) {\n          return get(attrs, attr);\n        });\n      };\n      var switchToMenu = function (sandbox) {\n        Sandboxing.getState(sandbox).each(function (tmenu) {\n          tieredMenu.highlightPrimary(tmenu);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, function (x) {\n          return x;\n        }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var apis = {\n        expand: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n          }\n        },\n        open: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        isOpen: Toggling.isOn,\n        close: function (comp) {\n          if (Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      var triggerExecute = function (comp, _se) {\n        emitExecute(comp);\n        return Optional.some(true);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.dropdownBehaviours, [\n          Toggling.config({\n            toggleClass: detail.toggleClass,\n            aria: { mode: 'expanded' }\n          }),\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                return makeSandbox(detail, hotspot, {\n                  onOpen: function () {\n                    Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    Toggling.off(hotspot);\n                  }\n                });\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: triggerExecute,\n            onEnter: triggerExecute,\n            onDown: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                var sandbox = Coupling.getCoupled(comp, 'sandbox');\n                switchToMenu(sandbox);\n              } else {\n                Dropdown.open(comp);\n              }\n              return Optional.some(true);\n            },\n            onEscape: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                Dropdown.close(comp);\n                return Optional.some(true);\n              } else {\n                return Optional.none();\n              }\n            }\n          }),\n          Focusing.config({})\n        ]),\n        events: events$7(Optional.some(action)),\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        apis: apis,\n        domModification: {\n          attributes: __assign(__assign({ 'aria-haspopup': 'true' }, detail.role.fold(function () {\n            return {};\n          }, function (role) {\n            return { role: role };\n          })), detail.dom.tag === 'button' ? { type: lookupAttr('type').getOr('button') } : {})\n        }\n      };\n    };\n    var Dropdown = composite$1({\n      name: 'Dropdown',\n      configFields: schema$g(),\n      partFields: parts$4(),\n      factory: factory$6,\n      apis: {\n        open: function (apis, comp) {\n          return apis.open(comp);\n        },\n        expand: function (apis, comp) {\n          return apis.expand(comp);\n        },\n        close: function (apis, comp) {\n          return apis.close(comp);\n        },\n        isOpen: function (apis, comp) {\n          return apis.isOpen(comp);\n        },\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var exhibit$5 = function () {\n      return nu$6({\n        styles: {\n          '-webkit-user-select': 'none',\n          'user-select': 'none',\n          '-ms-user-select': 'none',\n          '-moz-user-select': '-moz-none'\n        },\n        attributes: { unselectable: 'on' }\n      });\n    };\n    var events$b = function () {\n      return derive([abort(selectstart(), always)]);\n    };\n\n    var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$b,\n        exhibit: exhibit$5\n    });\n\n    var Unselecting = create$1({\n      fields: [],\n      name: 'unselecting',\n      active: ActiveUnselecting\n    });\n\n    var renderPanelButton = function (spec, sharedBackstage) {\n      return Dropdown.sketch({\n        dom: spec.dom,\n        components: spec.components,\n        toggleClass: 'mce-active',\n        dropdownBehaviours: derive$1([\n          DisablingConfigs.button(sharedBackstage.providers.isReadOnly),\n          receivingConfig(),\n          Unselecting.config({}),\n          Tabstopping.config({})\n        ]),\n        layouts: spec.layouts,\n        sandboxClasses: ['tox-dialog__popups'],\n        lazySink: sharedBackstage.getSink,\n        fetch: function (comp) {\n          return Future.nu(function (callback) {\n            return spec.fetch(callback);\n          }).map(function (items) {\n            return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n              spec.onItemAction(comp, value);\n            }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, function () {\n              return false;\n            }, sharedBackstage.providers), { movement: deriveMenuMovement(spec.columns, spec.presets) })));\n          });\n        },\n        parts: { menu: part(false, 1, spec.presets) }\n      });\n    };\n\n    var colorInputChangeEvent = generate$1('color-input-change');\n    var colorSwatchChangeEvent = generate$1('color-swatch-change');\n    var colorPickerCancelEvent = generate$1('color-picker-cancel');\n    var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n      var pField = FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        onSetValue: function (c) {\n          return Invalidating.run(c).get(function () {\n          });\n        },\n        inputBehaviours: derive$1([\n          Disabling.config({ disabled: sharedBackstage.providers.isReadOnly }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Invalidating.config({\n            invalidClass: 'tox-textbox-field-invalid',\n            getRoot: function (comp) {\n              return parent(comp.element);\n            },\n            notify: {\n              onValid: function (comp) {\n                var val = Representing.getValue(comp);\n                emitWith(comp, colorInputChangeEvent, { color: val });\n              }\n            },\n            validator: {\n              validateOnLoad: false,\n              validate: function (input) {\n                var inputValue = Representing.getValue(input);\n                if (inputValue.length === 0) {\n                  return Future.pure(Result.value(true));\n                } else {\n                  var span = SugarElement.fromTag('span');\n                  set$2(span, 'background-color', inputValue);\n                  var res = getRaw(span, 'background-color').fold(function () {\n                    return Result.error('blah');\n                  }, function (_) {\n                    return Result.value(inputValue);\n                  });\n                  return Future.pure(res);\n                }\n              }\n            }\n          })\n        ]),\n        selectOnFocus: false\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, sharedBackstage.providers);\n      });\n      var emitSwatchChange = function (colorBit, value) {\n        emitWith(colorBit, colorSwatchChangeEvent, { value: value });\n      };\n      var onItemAction = function (comp, value) {\n        memColorButton.getOpt(comp).each(function (colorBit) {\n          if (value === 'custom') {\n            colorInputBackstage.colorPicker(function (valueOpt) {\n              valueOpt.fold(function () {\n                return emit(colorBit, colorPickerCancelEvent);\n              }, function (value) {\n                emitSwatchChange(colorBit, value);\n                addColor(value);\n              });\n            }, '#ffffff');\n          } else if (value === 'remove') {\n            emitSwatchChange(colorBit, '');\n          } else {\n            emitSwatchChange(colorBit, value);\n          }\n        });\n      };\n      var memColorButton = record(renderPanelButton({\n        dom: {\n          tag: 'span',\n          attributes: { 'aria-label': sharedBackstage.providers.translate('Color swatch') }\n        },\n        layouts: {\n          onRtl: function () {\n            return [\n              southwest$1,\n              southeast$1,\n              south$1\n            ];\n          },\n          onLtr: function () {\n            return [\n              southeast$1,\n              southwest$1,\n              south$1\n            ];\n          }\n        },\n        components: [],\n        fetch: getFetch(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n        columns: colorInputBackstage.getColorCols(),\n        presets: 'color',\n        onItemAction: onItemAction\n      }, sharedBackstage));\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: pLabel.toArray().concat([{\n            dom: {\n              tag: 'div',\n              classes: ['tox-color-input']\n            },\n            components: [\n              pField,\n              memColorButton.asSpec()\n            ]\n          }]),\n        fieldBehaviours: derive$1([config('form-field-events', [\n            run(colorInputChangeEvent, function (comp, se) {\n              memColorButton.getOpt(comp).each(function (colorButton) {\n                set$2(colorButton.element, 'background-color', se.event.color);\n              });\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            }),\n            run(colorSwatchChangeEvent, function (comp, se) {\n              FormField.getField(comp).each(function (field) {\n                Representing.setValue(field, se.event.value);\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            }),\n            run(colorPickerCancelEvent, function (comp, _se) {\n              FormField.getField(comp).each(function (_field) {\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            })\n          ])])\n      });\n    };\n\n    var hsvColour = function (hue, saturation, value) {\n      return {\n        hue: hue,\n        saturation: saturation,\n        value: value\n      };\n    };\n    var fromRgb = function (rgbaColour) {\n      var h = 0;\n      var s = 0;\n      var v = 0;\n      var r = rgbaColour.red / 255;\n      var g = rgbaColour.green / 255;\n      var b = rgbaColour.blue / 255;\n      var minRGB = Math.min(r, Math.min(g, b));\n      var maxRGB = Math.max(r, Math.max(g, b));\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return hsvColour(0, 0, v * 100);\n      }\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n    };\n\n    var calcHex = function (value) {\n      var hue = (100 - value) / 100 * 360;\n      var hsv = hsvColour(hue, 100, 100);\n      var rgb = fromHsv(hsv);\n      return fromRgba(rgb);\n    };\n\n    var fieldsUpdate = generate$1('rgb-hex-update');\n    var sliderUpdate = generate$1('slider-update');\n    var paletteUpdate = generate$1('palette-update');\n\n    var labelPart = optional({\n      schema: [strict$1('dom')],\n      name: 'label'\n    });\n    var edgePart = function (name) {\n      return optional({\n        name: '' + name + '-edge',\n        overrides: function (detail) {\n          var action = detail.model.manager.edgeActions[name];\n          return action.fold(function () {\n            return {};\n          }, function (a) {\n            return {\n              events: derive([\n                runActionExtra(touchstart(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousedown(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousemove(), function (comp, se, det) {\n                  if (det.mouseIsDown.get()) {\n                    a(comp, det);\n                  }\n                }, [detail])\n              ])\n            };\n          });\n        }\n      });\n    };\n    var tlEdgePart = edgePart('top-left');\n    var tedgePart = edgePart('top');\n    var trEdgePart = edgePart('top-right');\n    var redgePart = edgePart('right');\n    var brEdgePart = edgePart('bottom-right');\n    var bedgePart = edgePart('bottom');\n    var blEdgePart = edgePart('bottom-left');\n    var ledgePart = edgePart('left');\n    var thumbPart = required({\n      name: 'thumb',\n      defaults: constant({ dom: { styles: { position: 'absolute' } } }),\n      overrides: function (detail) {\n        return {\n          events: derive([\n            redirectToPart(touchstart(), detail, 'spectrum'),\n            redirectToPart(touchmove(), detail, 'spectrum'),\n            redirectToPart(touchend(), detail, 'spectrum'),\n            redirectToPart(mousedown(), detail, 'spectrum'),\n            redirectToPart(mousemove(), detail, 'spectrum'),\n            redirectToPart(mouseup(), detail, 'spectrum')\n          ])\n        };\n      }\n    });\n    var spectrumPart = required({\n      schema: [state$1('mouseIsDown', function () {\n          return Cell(false);\n        })],\n      name: 'spectrum',\n      overrides: function (detail) {\n        var modelDetail = detail.model;\n        var model = modelDetail.manager;\n        var setValueFrom = function (component, simulatedEvent) {\n          return model.getValueFromEvent(simulatedEvent).map(function (value) {\n            return model.setValueFrom(component, detail, value);\n          });\n        };\n        return {\n          behaviours: derive$1([\n            Keying.config({\n              mode: 'special',\n              onLeft: function (spectrum) {\n                return model.onLeft(spectrum, detail);\n              },\n              onRight: function (spectrum) {\n                return model.onRight(spectrum, detail);\n              },\n              onUp: function (spectrum) {\n                return model.onUp(spectrum, detail);\n              },\n              onDown: function (spectrum) {\n                return model.onDown(spectrum, detail);\n              }\n            }),\n            Focusing.config({})\n          ]),\n          events: derive([\n            run(touchstart(), setValueFrom),\n            run(touchmove(), setValueFrom),\n            run(mousedown(), setValueFrom),\n            run(mousemove(), function (spectrum, se) {\n              if (detail.mouseIsDown.get()) {\n                setValueFrom(spectrum, se);\n              }\n            })\n          ])\n        };\n      }\n    });\n    var SliderParts = [\n      labelPart,\n      ledgePart,\n      redgePart,\n      tedgePart,\n      bedgePart,\n      tlEdgePart,\n      trEdgePart,\n      blEdgePart,\n      brEdgePart,\n      thumbPart,\n      spectrumPart\n    ];\n\n    var _sliderChangeEvent = 'slider.change.value';\n    var sliderChangeEvent = constant(_sliderChangeEvent);\n    var isTouchEvent = function (evt) {\n      return evt.type.indexOf('touch') !== -1;\n    };\n    var getEventSource = function (simulatedEvent) {\n      var evt = simulatedEvent.event.raw;\n      if (isTouchEvent(evt)) {\n        var touchEvent = evt;\n        return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n          return SugarPosition(t.clientX, t.clientY);\n        }) : Optional.none();\n      } else {\n        var mouseEvent = evt;\n        return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n          return SugarPosition(me.clientX, me.clientY);\n        }) : Optional.none();\n      }\n    };\n\n    var t = 'top', r$1 = 'right', b = 'bottom', l = 'left';\n    var minX = function (detail) {\n      return detail.model.minX;\n    };\n    var minY = function (detail) {\n      return detail.model.minY;\n    };\n    var min1X = function (detail) {\n      return detail.model.minX - 1;\n    };\n    var min1Y = function (detail) {\n      return detail.model.minY - 1;\n    };\n    var maxX = function (detail) {\n      return detail.model.maxX;\n    };\n    var maxY = function (detail) {\n      return detail.model.maxY;\n    };\n    var max1X = function (detail) {\n      return detail.model.maxX + 1;\n    };\n    var max1Y = function (detail) {\n      return detail.model.maxY + 1;\n    };\n    var range$2 = function (detail, max, min) {\n      return max(detail) - min(detail);\n    };\n    var xRange = function (detail) {\n      return range$2(detail, maxX, minX);\n    };\n    var yRange = function (detail) {\n      return range$2(detail, maxY, minY);\n    };\n    var halfX = function (detail) {\n      return xRange(detail) / 2;\n    };\n    var halfY = function (detail) {\n      return yRange(detail) / 2;\n    };\n    var step = function (detail) {\n      return detail.stepSize;\n    };\n    var snap = function (detail) {\n      return detail.snapToGrid;\n    };\n    var snapStart = function (detail) {\n      return detail.snapStart;\n    };\n    var rounded = function (detail) {\n      return detail.rounded;\n    };\n    var hasEdge = function (detail, edgeName) {\n      return detail[edgeName + '-edge'] !== undefined;\n    };\n    var hasLEdge = function (detail) {\n      return hasEdge(detail, l);\n    };\n    var hasREdge = function (detail) {\n      return hasEdge(detail, r$1);\n    };\n    var hasTEdge = function (detail) {\n      return hasEdge(detail, t);\n    };\n    var hasBEdge = function (detail) {\n      return hasEdge(detail, b);\n    };\n    var currentValue = function (detail) {\n      return detail.model.value.get();\n    };\n\n    var xValue = function (x) {\n      return { x: x };\n    };\n    var yValue = function (y) {\n      return { y: y };\n    };\n    var xyValue = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var fireSliderChange = function (component, value) {\n      emitWith(component, sliderChangeEvent(), { value: value });\n    };\n    var setToTLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), min1Y(detail)));\n    };\n    var setToTEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(min1Y(detail)));\n    };\n    var setToTEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), min1Y(detail)));\n    };\n    var setToTREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), min1Y(detail)));\n    };\n    var setToREdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(max1X(detail)));\n    };\n    var setToREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), halfY(detail)));\n    };\n    var setToBREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), max1Y(detail)));\n    };\n    var setToBEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(max1Y(detail)));\n    };\n    var setToBEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), max1Y(detail)));\n    };\n    var setToBLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), max1Y(detail)));\n    };\n    var setToLEdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(min1X(detail)));\n    };\n    var setToLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), halfY(detail)));\n    };\n\n    var reduceBy = function (value, min, max, step) {\n      if (value < min) {\n        return value;\n      } else if (value > max) {\n        return max;\n      } else if (value === min) {\n        return min - 1;\n      } else {\n        return Math.max(min, value - step);\n      }\n    };\n    var increaseBy = function (value, min, max, step) {\n      if (value > max) {\n        return value;\n      } else if (value < min) {\n        return min;\n      } else if (value === max) {\n        return max + 1;\n      } else {\n        return Math.min(max, value + step);\n      }\n    };\n    var capValue = function (value, min, max) {\n      return Math.max(min, Math.min(max, value));\n    };\n    var snapValueOf = function (value, min, max, step, snapStart) {\n      return snapStart.fold(function () {\n        var initValue = value - min;\n        var extraValue = Math.round(initValue / step) * step;\n        return capValue(min + extraValue, min - 1, max + 1);\n      }, function (start) {\n        var remainder = (value - start) % step;\n        var adjustment = Math.round(remainder / step);\n        var rawSteps = Math.floor((value - start) / step);\n        var maxSteps = Math.floor((max - start) / step);\n        var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n        var r = start + numSteps * step;\n        return Math.max(start, r);\n      });\n    };\n    var findOffsetOf = function (value, min, max) {\n      return Math.min(max, Math.max(value, min)) - min;\n    };\n    var findValueOf = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, step = args.step, snap = args.snap, snapStart = args.snapStart, rounded = args.rounded, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, minBound = args.minBound, maxBound = args.maxBound, screenRange = args.screenRange;\n      var capMin = hasMinEdge ? min - 1 : min;\n      var capMax = hasMaxEdge ? max + 1 : max;\n      if (value < minBound) {\n        return capMin;\n      } else if (value > maxBound) {\n        return capMax;\n      } else {\n        var offset = findOffsetOf(value, minBound, maxBound);\n        var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n        if (snap && newValue >= min && newValue <= max) {\n          return snapValueOf(newValue, min, max, step, snapStart);\n        } else if (rounded) {\n          return Math.round(newValue);\n        } else {\n          return newValue;\n        }\n      }\n    };\n    var findOffsetOfValue = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, maxBound = args.maxBound, maxOffset = args.maxOffset, centerMinEdge = args.centerMinEdge, centerMaxEdge = args.centerMaxEdge;\n      if (value < min) {\n        return hasMinEdge ? 0 : centerMinEdge;\n      } else if (value > max) {\n        return hasMaxEdge ? maxBound : centerMaxEdge;\n      } else {\n        return (value - min) / range * maxOffset;\n      }\n    };\n\n    var top = 'top', right = 'right', bottom = 'bottom', left = 'left', width = 'width', height = 'height';\n    var getBounds$1 = function (component) {\n      return component.element.dom.getBoundingClientRect();\n    };\n    var getBoundsProperty = function (bounds, property) {\n      return bounds[property];\n    };\n    var getMinXBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, left);\n    };\n    var getMaxXBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, right);\n    };\n    var getMinYBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, top);\n    };\n    var getMaxYBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, bottom);\n    };\n    var getXScreenRange = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, width);\n    };\n    var getYScreenRange = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, height);\n    };\n    var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n      return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n    };\n    var getXCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds$1(component);\n      var spectrumBounds = getBounds$1(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, left);\n      var componentMaxEdge = getBoundsProperty(componentBounds, right);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n    var getYCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds$1(component);\n      var spectrumBounds = getBounds$1(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, top);\n      var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n\n    var fireSliderChange$1 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue = function (x) {\n      return { x: x };\n    };\n    var findValueOfOffset = function (spectrum, detail, left) {\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: left,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        maxBound: getMaxXBounds(spectrum),\n        screenRange: getXScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value);\n      var sliderVal = sliderValue(xValue);\n      fireSliderChange$1(spectrum, sliderVal);\n      return xValue;\n    };\n    var setToMin = function (spectrum, detail) {\n      var min = minX(detail);\n      fireSliderChange$1(spectrum, sliderValue(min));\n    };\n    var setToMax = function (spectrum, detail) {\n      var max = maxX(detail);\n      fireSliderChange$1(spectrum, sliderValue(max));\n    };\n    var moveBy = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      fireSliderChange$1(spectrum, sliderValue(xValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy(direction, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var getValueFromEvent = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.left;\n      });\n    };\n    var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getXScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: value,\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxXBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n      return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n    };\n    var setPositionFromValue = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var thumbRadius = get$7(thumb.element) / 2;\n      set$2(thumb.element, 'left', pos - thumbRadius + 'px');\n    };\n    var onLeft = handleMovement(-1);\n    var onRight = handleMovement(1);\n    var onUp = Optional.none;\n    var onDown = Optional.none;\n    var edgeActions = {\n      'top-left': Optional.none(),\n      'top': Optional.none(),\n      'top-right': Optional.none(),\n      'right': Optional.some(setToREdge),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.none(),\n      'bottom-left': Optional.none(),\n      'left': Optional.some(setToLEdge)\n    };\n\n    var HorizontalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom,\n        setToMin: setToMin,\n        setToMax: setToMax,\n        findValueOfOffset: findValueOfOffset,\n        getValueFromEvent: getValueFromEvent,\n        findPositionOfValue: findPositionOfValue,\n        setPositionFromValue: setPositionFromValue,\n        onLeft: onLeft,\n        onRight: onRight,\n        onUp: onUp,\n        onDown: onDown,\n        edgeActions: edgeActions\n    });\n\n    var fireSliderChange$2 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$1 = function (y) {\n      return { y: y };\n    };\n    var findValueOfOffset$1 = function (spectrum, detail, top) {\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: top,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        maxBound: getMaxYBounds(spectrum),\n        screenRange: getYScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom$1 = function (spectrum, detail, value) {\n      var yValue = findValueOfOffset$1(spectrum, detail, value);\n      var sliderVal = sliderValue$1(yValue);\n      fireSliderChange$2(spectrum, sliderVal);\n      return yValue;\n    };\n    var setToMin$1 = function (spectrum, detail) {\n      var min = minY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(min));\n    };\n    var setToMax$1 = function (spectrum, detail) {\n      var max = maxY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(max));\n    };\n    var moveBy$1 = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange$2(spectrum, sliderValue$1(yValue));\n      return Optional.some(yValue);\n    };\n    var handleMovement$1 = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy$1(direction, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var getValueFromEvent$1 = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.top;\n      });\n    };\n    var findOffsetOfValue$2 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getYScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: value,\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxYBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$2(spectrum, detail, value, minEdge, maxEdge);\n      return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n    };\n    var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbRadius = get$6(thumb.element) / 2;\n      set$2(thumb.element, 'top', pos - thumbRadius + 'px');\n    };\n    var onLeft$1 = Optional.none;\n    var onRight$1 = Optional.none;\n    var onUp$1 = handleMovement$1(-1);\n    var onDown$1 = handleMovement$1(1);\n    var edgeActions$1 = {\n      'top-left': Optional.none(),\n      'top': Optional.some(setToTEdge),\n      'top-right': Optional.none(),\n      'right': Optional.none(),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.some(setToBEdge),\n      'bottom-left': Optional.none(),\n      'left': Optional.none()\n    };\n\n    var VerticalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$1,\n        setToMin: setToMin$1,\n        setToMax: setToMax$1,\n        findValueOfOffset: findValueOfOffset$1,\n        getValueFromEvent: getValueFromEvent$1,\n        findPositionOfValue: findPositionOfValue$1,\n        setPositionFromValue: setPositionFromValue$1,\n        onLeft: onLeft$1,\n        onRight: onRight$1,\n        onUp: onUp$1,\n        onDown: onDown$1,\n        edgeActions: edgeActions$1\n    });\n\n    var fireSliderChange$3 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$2 = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var setValueFrom$2 = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value.left);\n      var yValue = findValueOfOffset$1(spectrum, detail, value.top);\n      var val = sliderValue$2(xValue, yValue);\n      fireSliderChange$3(spectrum, val);\n      return val;\n    };\n    var moveBy$2 = function (direction, isVerticalMovement, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange$3(spectrum, sliderValue$2(xValue, yValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement$2 = function (direction, isVerticalMovement) {\n      return function (spectrum, detail) {\n        return moveBy$2(direction, isVerticalMovement, spectrum, detail).map(function () {\n          return true;\n        });\n      };\n    };\n    var setToMin$2 = function (spectrum, detail) {\n      var mX = minX(detail);\n      var mY = minY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var setToMax$2 = function (spectrum, detail) {\n      var mX = maxX(detail);\n      var mY = maxY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var getValueFromEvent$2 = function (simulatedEvent) {\n      return getEventSource(simulatedEvent);\n    };\n    var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var xPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var yPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbXRadius = get$7(thumb.element) / 2;\n      var thumbYRadius = get$6(thumb.element) / 2;\n      set$2(thumb.element, 'left', xPos - thumbXRadius + 'px');\n      set$2(thumb.element, 'top', yPos - thumbYRadius + 'px');\n    };\n    var onLeft$2 = handleMovement$2(-1, false);\n    var onRight$2 = handleMovement$2(1, false);\n    var onUp$2 = handleMovement$2(-1, true);\n    var onDown$2 = handleMovement$2(1, true);\n    var edgeActions$2 = {\n      'top-left': Optional.some(setToTLEdgeXY),\n      'top': Optional.some(setToTEdgeXY),\n      'top-right': Optional.some(setToTREdgeXY),\n      'right': Optional.some(setToREdgeXY),\n      'bottom-right': Optional.some(setToBREdgeXY),\n      'bottom': Optional.some(setToBEdgeXY),\n      'bottom-left': Optional.some(setToBLEdgeXY),\n      'left': Optional.some(setToLEdgeXY)\n    };\n\n    var TwoDModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$2,\n        setToMin: setToMin$2,\n        setToMax: setToMax$2,\n        getValueFromEvent: getValueFromEvent$2,\n        setPositionFromValue: setPositionFromValue$2,\n        onLeft: onLeft$2,\n        onRight: onRight$2,\n        onUp: onUp$2,\n        onDown: onDown$2,\n        edgeActions: edgeActions$2\n    });\n\n    var SliderSchema = [\n      defaulted$1('stepSize', 1),\n      defaulted$1('onChange', noop),\n      defaulted$1('onChoose', noop),\n      defaulted$1('onInit', noop),\n      defaulted$1('onDragStart', noop),\n      defaulted$1('onDragEnd', noop),\n      defaulted$1('snapToGrid', false),\n      defaulted$1('rounded', true),\n      option('snapStart'),\n      strictOf('model', choose$1('mode', {\n        x: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minX);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', HorizontalModel)\n        ],\n        y: [\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minY);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', VerticalModel)\n        ],\n        xy: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell({\n              x: spec.mode.minX,\n              y: spec.mode.minY\n            });\n          }),\n          strict$1('getInitialValue'),\n          output('manager', TwoDModel)\n        ]\n      })),\n      field$1('sliderBehaviours', [\n        Keying,\n        Representing\n      ]),\n      state$1('mouseIsDown', function () {\n        return Cell(false);\n      })\n    ];\n\n    var sketch = function (detail, components, _spec, _externals) {\n      var _a;\n      var getThumb = function (component) {\n        return getPartOrDie(component, detail, 'thumb');\n      };\n      var getSpectrum = function (component) {\n        return getPartOrDie(component, detail, 'spectrum');\n      };\n      var getLeftEdge = function (component) {\n        return getPart(component, detail, 'left-edge');\n      };\n      var getRightEdge = function (component) {\n        return getPart(component, detail, 'right-edge');\n      };\n      var getTopEdge = function (component) {\n        return getPart(component, detail, 'top-edge');\n      };\n      var getBottomEdge = function (component) {\n        return getPart(component, detail, 'bottom-edge');\n      };\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n      var refresh = function (slider, thumb) {\n        model.setPositionFromValue(slider, thumb, detail, {\n          getLeftEdge: getLeftEdge,\n          getRightEdge: getRightEdge,\n          getTopEdge: getTopEdge,\n          getBottomEdge: getBottomEdge,\n          getSpectrum: getSpectrum\n        });\n      };\n      var changeValue = function (slider, newValue) {\n        modelDetail.value.set(newValue);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n        detail.onChange(slider, thumb, newValue);\n        return Optional.some(true);\n      };\n      var resetToMin = function (slider) {\n        model.setToMin(slider, detail);\n      };\n      var resetToMax = function (slider) {\n        model.setToMax(slider, detail);\n      };\n      var choose = function (slider) {\n        var fireOnChoose = function () {\n          getPart(slider, detail, 'thumb').each(function (thumb) {\n            var value = modelDetail.value.get();\n            detail.onChoose(slider, thumb, value);\n          });\n        };\n        var wasDown = detail.mouseIsDown.get();\n        detail.mouseIsDown.set(false);\n        if (wasDown) {\n          fireOnChoose();\n        }\n      };\n      var onDragStart = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.mouseIsDown.set(true);\n        detail.onDragStart(slider, getThumb(slider));\n      };\n      var onDragEnd = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.onDragEnd(slider, getThumb(slider));\n        choose(slider);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.sliderBehaviours, [\n          Keying.config({\n            mode: 'special',\n            focusIn: function (slider) {\n              return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (_) {\n                return modelDetail.value.get();\n              }\n            }\n          }),\n          Receiving.config({ channels: (_a = {}, _a[mouseReleased()] = { onReceive: choose }, _a) })\n        ]),\n        events: derive([\n          run(sliderChangeEvent(), function (slider, simulatedEvent) {\n            changeValue(slider, simulatedEvent.event.value);\n          }),\n          runOnAttached(function (slider, _simulatedEvent) {\n            var getInitial = modelDetail.getInitialValue();\n            modelDetail.value.set(getInitial);\n            var thumb = getThumb(slider);\n            refresh(slider, thumb);\n            var spectrum = getSpectrum(slider);\n            detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n          }),\n          run(touchstart(), onDragStart),\n          run(touchend(), onDragEnd),\n          run(mousedown(), onDragStart),\n          run(mouseup(), onDragEnd)\n        ]),\n        apis: {\n          resetToMin: resetToMin,\n          resetToMax: resetToMax,\n          changeValue: changeValue,\n          refresh: refresh\n        },\n        domModification: { styles: { position: 'relative' } }\n      };\n    };\n\n    var Slider = composite$1({\n      name: 'Slider',\n      configFields: SliderSchema,\n      partFields: SliderParts,\n      factory: sketch,\n      apis: {\n        resetToMin: function (apis, slider) {\n          apis.resetToMin(slider);\n        },\n        resetToMax: function (apis, slider) {\n          apis.resetToMax(slider);\n        },\n        refresh: function (apis, slider) {\n          apis.refresh(slider);\n        }\n      }\n    });\n\n    var sliderFactory = function (translate, getClass) {\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-spectrum')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-thumb')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider')],\n          attributes: { role: 'presentation' }\n        },\n        rounded: false,\n        model: {\n          mode: 'y',\n          getInitialValue: constant({ y: 0 })\n        },\n        components: [\n          spectrum,\n          thumb\n        ],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChange: function (slider, _thumb, value) {\n          emitWith(slider, sliderUpdate, { value: value });\n        }\n      });\n    };\n\n    var owner$3 = 'form';\n    var schema$h = [field$1('formBehaviours', [Representing])];\n    var getPartName = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$1 = function (fSpec) {\n      var parts = function () {\n        var record = [];\n        var field = function (name, config) {\n          record.push(name);\n          return generateOne(owner$3, getPartName(name), config);\n        };\n        return {\n          field: field,\n          record: function () {\n            return record;\n          }\n        };\n      }();\n      var spec = fSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName(n)\n        });\n      });\n      return composite(owner$3, schema$h, fieldParts, make$4, spec);\n    };\n    var toResult$1 = function (o, e) {\n      return o.fold(function () {\n        return Result.error(e);\n      }, Result.value);\n    };\n    var make$4 = function (detail, components) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.formBehaviours, [Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (form) {\n                var resPs = getAllParts(form, detail);\n                return map$2(resPs, function (resPThunk, pName) {\n                  return resPThunk().bind(function (v) {\n                    var opt = Composing.getCurrent(v);\n                    return toResult$1(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n                  }).map(Representing.getValue);\n                });\n              },\n              setValue: function (form, values) {\n                each$1(values, function (newValue, key) {\n                  getPart(form, detail, key).each(function (wrapper) {\n                    Composing.getCurrent(wrapper).each(function (field) {\n                      Representing.setValue(field, newValue);\n                    });\n                  });\n                });\n              }\n            }\n          })]),\n        apis: {\n          getField: function (form, key) {\n            return getPart(form, detail, key).bind(Composing.getCurrent);\n          }\n        }\n      };\n    };\n    var Form = {\n      getField: makeApi(function (apis, component, key) {\n        return apis.getField(component, key);\n      }),\n      sketch: sketch$1\n    };\n\n    var validInput = generate$1('valid-input');\n    var invalidInput = generate$1('invalid-input');\n    var validatingInput = generate$1('validating-input');\n    var translatePrefix = 'colorcustom.rgb.';\n    var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n      var invalidation = function (label, isValid) {\n        return Invalidating.config({\n          invalidClass: getClass('invalid'),\n          notify: {\n            onValidate: function (comp) {\n              emitWith(comp, validatingInput, { type: label });\n            },\n            onValid: function (comp) {\n              emitWith(comp, validInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            },\n            onInvalid: function (comp) {\n              emitWith(comp, invalidInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            }\n          },\n          validator: {\n            validate: function (comp) {\n              var value = Representing.getValue(comp);\n              var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n              return Future.pure(res);\n            },\n            validateOnLoad: false\n          }\n        });\n      };\n      var renderTextField = function (isValid, name, label, description, data) {\n        var helptext = translate(translatePrefix + 'range');\n        var pLabel = FormField.parts.label({\n          dom: {\n            tag: 'label',\n            innerHtml: label,\n            attributes: { 'aria-label': description }\n          }\n        });\n        var pField = FormField.parts.field({\n          data: data,\n          factory: Input,\n          inputAttributes: __assign({ type: 'text' }, name === 'hex' ? { 'aria-live': 'polite' } : {}),\n          inputClasses: [getClass('textfield')],\n          inputBehaviours: derive$1([\n            invalidation(name, isValid),\n            Tabstopping.config({})\n          ]),\n          onSetValue: function (input) {\n            if (Invalidating.isInvalid(input)) {\n              var run = Invalidating.run(input);\n              run.get(noop);\n            }\n          }\n        });\n        var comps = [\n          pLabel,\n          pField\n        ];\n        var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({ text: helptext })] : [];\n        var components = comps.concat(concats);\n        return {\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' }\n          },\n          components: components\n        };\n      };\n      var copyRgbToHex = function (form, rgba) {\n        var hex = fromRgba(rgba);\n        Form.getField(form, 'hex').each(function (hexField) {\n          if (!Focusing.isFocused(hexField)) {\n            Representing.setValue(form, { hex: hex.value });\n          }\n        });\n        return hex;\n      };\n      var copyRgbToForm = function (form, rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        Representing.setValue(form, {\n          red: red,\n          green: green,\n          blue: blue\n        });\n      };\n      var memPreview = record({\n        dom: {\n          tag: 'div',\n          classes: [getClass('rgba-preview')],\n          styles: { 'background-color': 'white' },\n          attributes: { role: 'presentation' }\n        }\n      });\n      var updatePreview = function (anyInSystem, hex) {\n        memPreview.getOpt(anyInSystem).each(function (preview) {\n          set$2(preview.element, 'background-color', '#' + hex.value);\n        });\n      };\n      var factory = function () {\n        var state = {\n          red: Cell(Optional.some(255)),\n          green: Cell(Optional.some(255)),\n          blue: Cell(Optional.some(255)),\n          hex: Cell(Optional.some('ffffff'))\n        };\n        var copyHexToRgb = function (form, hex) {\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n        };\n        var get = function (prop) {\n          return state[prop].get();\n        };\n        var set = function (prop, value) {\n          state[prop].set(value);\n        };\n        var getValueRgb = function () {\n          return get('red').bind(function (red) {\n            return get('green').bind(function (green) {\n              return get('blue').map(function (blue) {\n                return rgbaColour(red, green, blue, 1);\n              });\n            });\n          });\n        };\n        var setValueRgb = function (rgb) {\n          var red = rgb.red;\n          var green = rgb.green;\n          var blue = rgb.blue;\n          set('red', Optional.some(red));\n          set('green', Optional.some(green));\n          set('blue', Optional.some(blue));\n        };\n        var onInvalidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (data.type !== 'hex') {\n            set(data.type, Optional.none());\n          } else {\n            onInvalidHexx(form);\n          }\n        };\n        var onValidHex = function (form, value) {\n          onValidHexx(form);\n          var hex = hexColour(value);\n          set('hex', Optional.some(value));\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n          emitWith(form, fieldsUpdate, { hex: hex });\n          updatePreview(form, hex);\n        };\n        var onValidRgb = function (form, prop, value) {\n          var val = parseInt(value, 10);\n          set(prop, Optional.some(val));\n          getValueRgb().each(function (rgb) {\n            var hex = copyRgbToHex(form, rgb);\n            updatePreview(form, hex);\n          });\n        };\n        var isHexInputEvent = function (data) {\n          return data.type === 'hex';\n        };\n        var onValidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (isHexInputEvent(data)) {\n            onValidHex(form, data.value);\n          } else {\n            onValidRgb(form, data.type, data.value);\n          }\n        };\n        var formPartStrings = function (key) {\n          return {\n            label: translate(translatePrefix + key + '.label'),\n            description: translate(translatePrefix + key + '.description')\n          };\n        };\n        var redStrings = formPartStrings('red');\n        var greenStrings = formPartStrings('green');\n        var blueStrings = formPartStrings('blue');\n        var hexStrings = formPartStrings('hex');\n        return deepMerge(Form.sketch(function (parts) {\n          return {\n            dom: {\n              tag: 'form',\n              classes: [getClass('rgb-form')],\n              attributes: { 'aria-label': translate('aria.color.picker') }\n            },\n            components: [\n              parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))),\n              parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))),\n              parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))),\n              parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))),\n              memPreview.asSpec()\n            ],\n            formBehaviours: derive$1([\n              Invalidating.config({ invalidClass: getClass('form-invalid') }),\n              config('rgb-form-events', [\n                run(validInput, onValidInput),\n                run(invalidInput, onInvalidInput),\n                run(validatingInput, onInvalidInput)\n              ])\n            ])\n          };\n        }), {\n          apis: {\n            updateHex: function (form, hex) {\n              Representing.setValue(form, { hex: hex.value });\n              copyHexToRgb(form, hex);\n              updatePreview(form, hex);\n            }\n          }\n        });\n      };\n      var rgbFormSketcher = single$2({\n        factory: factory,\n        name: 'RgbForm',\n        configFields: [],\n        apis: {\n          updateHex: function (apis, form, hex) {\n            apis.updateHex(form, hex);\n          }\n        },\n        extraApis: {}\n      });\n      return rgbFormSketcher;\n    };\n\n    var paletteFactory = function (_translate, getClass) {\n      var spectrumPart = Slider.parts.spectrum({\n        dom: {\n          tag: 'canvas',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-spectrum')]\n        }\n      });\n      var thumbPart = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-thumb')],\n          innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n        }\n      });\n      var setColour = function (canvas, rgba) {\n        var width = canvas.width, height = canvas.height;\n        var ctx = canvas.getContext('2d');\n        if (ctx === null) {\n          return;\n        }\n        ctx.fillStyle = rgba;\n        ctx.fillRect(0, 0, width, height);\n        var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n        grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n        grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n        ctx.fillStyle = grdWhite;\n        ctx.fillRect(0, 0, width, height);\n        var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n        grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n        grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n        ctx.fillStyle = grdBlack;\n        ctx.fillRect(0, 0, width, height);\n      };\n      var setSliderColour = function (slider, rgba) {\n        var canvas = slider.components()[0].element.dom;\n        setColour(canvas, toString(rgba));\n      };\n      var factory = function (_detail) {\n        var getInitialValue = constant({\n          x: 0,\n          y: 0\n        });\n        var onChange = function (slider, _thumb, value) {\n          emitWith(slider, paletteUpdate, { value: value });\n        };\n        var onInit = function (_slider, _thumb, spectrum, _value) {\n          setColour(spectrum.element.dom, toString(red));\n        };\n        var sliderBehaviours = derive$1([\n          Composing.config({ find: Optional.some }),\n          Focusing.config({})\n        ]);\n        return Slider.sketch({\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' },\n            classes: [getClass('sv-palette')]\n          },\n          model: {\n            mode: 'xy',\n            getInitialValue: getInitialValue\n          },\n          rounded: false,\n          components: [\n            spectrumPart,\n            thumbPart\n          ],\n          onChange: onChange,\n          onInit: onInit,\n          sliderBehaviours: sliderBehaviours\n        });\n      };\n      var saturationBrightnessPaletteSketcher = single$2({\n        factory: factory,\n        name: 'SaturationBrightnessPalette',\n        configFields: [],\n        apis: {\n          setRgba: function (_apis, slider, rgba) {\n            setSliderColour(slider, rgba);\n          }\n        },\n        extraApis: {}\n      });\n      return saturationBrightnessPaletteSketcher;\n    };\n\n    var makeFactory = function (translate, getClass) {\n      var factory = function (detail) {\n        var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n        var sbPalette = paletteFactory(translate, getClass);\n        var state = { paletteRgba: Cell(red) };\n        var memPalette = record(sbPalette.sketch({}));\n        var memRgb = record(rgbForm.sketch({}));\n        var updatePalette = function (anyInSystem, hex) {\n          memPalette.getOpt(anyInSystem).each(function (palette) {\n            var rgba = fromHex(hex);\n            state.paletteRgba.set(rgba);\n            sbPalette.setRgba(palette, rgba);\n          });\n        };\n        var updateFields = function (anyInSystem, hex) {\n          memRgb.getOpt(anyInSystem).each(function (form) {\n            rgbForm.updateHex(form, hex);\n          });\n        };\n        var runUpdates = function (anyInSystem, hex, updates) {\n          each(updates, function (update) {\n            update(anyInSystem, hex);\n          });\n        };\n        var paletteUpdates = function () {\n          var updates = [updateFields];\n          return function (form, simulatedEvent) {\n            var value = simulatedEvent.event.value;\n            var oldRgb = state.paletteRgba.get();\n            var hsvColour$1 = fromRgb(oldRgb);\n            var newHsvColour = hsvColour(hsvColour$1.hue, value.x, 100 - value.y);\n            var rgb = fromHsv(newHsvColour);\n            var nuHex = fromRgba(rgb);\n            runUpdates(form, nuHex, updates);\n          };\n        };\n        var sliderUpdates = function () {\n          var updates = [\n            updatePalette,\n            updateFields\n          ];\n          return function (form, simulatedEvent) {\n            var value = simulatedEvent.event.value;\n            var hex = calcHex(value.y);\n            runUpdates(form, hex, updates);\n          };\n        };\n        return {\n          uid: detail.uid,\n          dom: detail.dom,\n          components: [\n            memPalette.asSpec(),\n            sliderFactory(translate, getClass),\n            memRgb.asSpec()\n          ],\n          behaviours: derive$1([\n            config('colour-picker-events', [\n              run(paletteUpdate, paletteUpdates()),\n              run(sliderUpdate, sliderUpdates())\n            ]),\n            Composing.config({\n              find: function (comp) {\n                return memRgb.getOpt(comp);\n              }\n            }),\n            Keying.config({ mode: 'acyclic' })\n          ])\n        };\n      };\n      var colourPickerSketcher = single$2({\n        name: 'ColourPicker',\n        configFields: [\n          strict$1('dom'),\n          defaulted$1('onValidHex', noop),\n          defaulted$1('onInvalidHex', noop)\n        ],\n        factory: factory\n      });\n      return colourPickerSketcher;\n    };\n\n    var self$1 = function () {\n      return Composing.config({ find: Optional.some });\n    };\n    var memento = function (mem) {\n      return Composing.config({ find: mem.getOpt });\n    };\n    var childAt = function (index) {\n      return Composing.config({\n        find: function (comp) {\n          return child(comp.element, index).bind(function (element) {\n            return comp.getSystem().getByDom(element).toOptional();\n          });\n        }\n      });\n    };\n    var ComposingConfigs = {\n      self: self$1,\n      memento: memento,\n      childAt: childAt\n    };\n\n    var english = {\n      'colorcustom.rgb.red.label': 'R',\n      'colorcustom.rgb.red.description': 'Red component',\n      'colorcustom.rgb.green.label': 'G',\n      'colorcustom.rgb.green.description': 'Green component',\n      'colorcustom.rgb.blue.label': 'B',\n      'colorcustom.rgb.blue.description': 'Blue component',\n      'colorcustom.rgb.hex.label': '#',\n      'colorcustom.rgb.hex.description': 'Hex color code',\n      'colorcustom.rgb.range': 'Range 0 to 255',\n      'colorcustom.sb.saturation': 'Saturation',\n      'colorcustom.sb.brightness': 'Brightness',\n      'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n      'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n      'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n      'colorcustom.hue.hue': 'Hue',\n      'colorcustom.hue.slider': 'Hue Slider',\n      'colorcustom.hue.palette': 'Hue Palette',\n      'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n      'aria.color.picker': 'Color Picker',\n      'aria.input.invalid': 'Invalid input'\n    };\n    var getEnglishText = function (key) {\n      return english[key];\n    };\n    var translate$1 = function (key) {\n      return getEnglishText(key);\n    };\n    var renderColorPicker = function (_spec) {\n      var getClass = function (key) {\n        return 'tox-' + key;\n      };\n      var colourPickerFactory = makeFactory(translate$1, getClass);\n      var onValidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: true\n        });\n      };\n      var onInvalidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: false\n        });\n      };\n      var memPicker = record(colourPickerFactory.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('color-picker-container')],\n          attributes: { role: 'presentation' }\n        },\n        onValidHex: onValidHex,\n        onInvalidHex: onInvalidHex\n      }));\n      return {\n        dom: { tag: 'div' },\n        components: [memPicker.asSpec()],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                var optHex = optRgbForm.bind(function (rgbForm) {\n                  var formValues = Representing.getValue(rgbForm);\n                  return formValues.hex;\n                });\n                return optHex.map(function (hex) {\n                  return '#' + hex;\n                }).getOr('');\n              },\n              setValue: function (comp, newValue) {\n                var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n                var m = pattern.exec(newValue);\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                optRgbForm.fold(function () {\n                  console.log('Can not find form');\n                }, function (rgbForm) {\n                  Representing.setValue(rgbForm, { hex: Optional.from(m[1]).getOr('') });\n                  Form.getField(rgbForm, 'hex').each(function (hexField) {\n                    emit(hexField, input());\n                  });\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var global$a = tinymce.util.Tools.resolve('tinymce.Resource');\n\n    var isOldCustomEditor = function (spec) {\n      return Object.prototype.hasOwnProperty.call(spec, 'init');\n    };\n    var renderCustomEditor = function (spec) {\n      var editorApi = Cell(Optional.none());\n      var memReplaced = record({ dom: { tag: spec.tag } });\n      var initialValue = Cell(Optional.none());\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-custom-editor']\n        },\n        behaviours: derive$1([\n          config('custom-editor-events', [runOnAttached(function (component) {\n              memReplaced.getOpt(component).each(function (ta) {\n                (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$a.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n                  return init(ta.element.dom, spec.settings);\n                })).then(function (ea) {\n                  initialValue.get().each(function (cvalue) {\n                    ea.setValue(cvalue);\n                  });\n                  initialValue.set(Optional.none());\n                  editorApi.set(Optional.some(ea));\n                });\n              });\n            })]),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return editorApi.get().fold(function () {\n                  return initialValue.get().getOr('');\n                }, function (ed) {\n                  return ed.getValue();\n                });\n              },\n              setValue: function (component, value) {\n                editorApi.get().fold(function () {\n                  initialValue.set(Optional.some(value));\n                }, function (ed) {\n                  return ed.setValue(value);\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ]),\n        components: [memReplaced.asSpec()]\n      };\n    };\n\n    var processors = objOf([\n      defaulted$1('preprocess', identity),\n      defaulted$1('postprocess', identity)\n    ]);\n    var memento$1 = function (mem, rawProcessors) {\n      var ps = asRawOrDie('RepresentingConfigs.memento processors', processors, rawProcessors);\n      return Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var other = mem.get(comp);\n            var rawValue = Representing.getValue(other);\n            return ps.postprocess(rawValue);\n          },\n          setValue: function (comp, rawValue) {\n            var newValue = ps.preprocess(rawValue);\n            var other = mem.get(comp);\n            Representing.setValue(other, newValue);\n          }\n        }\n      });\n    };\n    var withComp = function (optInitialValue, getter, setter) {\n      return Representing.config(deepMerge({\n        store: {\n          mode: 'manual',\n          getValue: getter,\n          setValue: setter\n        }\n      }, optInitialValue.map(function (initialValue) {\n        return { store: { initialValue: initialValue } };\n      }).getOr({})));\n    };\n    var withElement = function (initialValue, getter, setter) {\n      return withComp(initialValue, function (c) {\n        return getter(c.element);\n      }, function (c, v) {\n        return setter(c.element, v);\n      });\n    };\n    var domValue = function (optInitialValue) {\n      return withElement(optInitialValue, get$5, set$3);\n    };\n    var domHtml = function (optInitialValue) {\n      return withElement(optInitialValue, get$1, set);\n    };\n    var memory$1 = function (initialValue) {\n      return Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: initialValue\n        }\n      });\n    };\n    var RepresentingConfigs = {\n      memento: memento$1,\n      withElement: withElement,\n      withComp: withComp,\n      domValue: domValue,\n      domHtml: domHtml,\n      memory: memory$1\n    };\n\n    var extensionsAccepted = '.jpg,.jpeg,.png,.gif';\n    var filterByExtension = function (files) {\n      var re = new RegExp('(' + extensionsAccepted.split(/\\s*,\\s*/).join('|') + ')$', 'i');\n      return filter(from$1(files), function (file) {\n        return re.test(file.name);\n      });\n    };\n    var renderDropZone = function (spec, providersBackstage) {\n      var stopper = function (_, se) {\n        se.stop();\n      };\n      var sequence = function (actions) {\n        return function (comp, se) {\n          each(actions, function (a) {\n            a(comp, se);\n          });\n        };\n      };\n      var onDrop = function (comp, se) {\n        if (!Disabling.isDisabled(comp)) {\n          var transferEvent = se.event.raw;\n          handleFiles(comp, transferEvent.dataTransfer.files);\n        }\n      };\n      var onSelect = function (component, simulatedEvent) {\n        var input = simulatedEvent.event.raw.target;\n        handleFiles(component, input.files);\n      };\n      var handleFiles = function (component, files) {\n        Representing.setValue(component, filterByExtension(files));\n        emitWith(component, formChangeEvent, { name: spec.name });\n      };\n      var memInput = record({\n        dom: {\n          tag: 'input',\n          attributes: {\n            type: 'file',\n            accept: 'image/*'\n          },\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([config('input-file-events', [\n            cutter(click()),\n            cutter(tap())\n          ])])\n      });\n      var renderField = function (s) {\n        return {\n          uid: s.uid,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone-container']\n          },\n          behaviours: derive$1([\n            RepresentingConfigs.memory([]),\n            ComposingConfigs.self(),\n            Disabling.config({}),\n            Toggling.config({\n              toggleClass: 'dragenter',\n              toggleOnExecute: false\n            }),\n            config('dropzone-events', [\n              run('dragenter', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run('dragleave', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run('dragover', stopper),\n              run('drop', sequence([\n                stopper,\n                onDrop\n              ])),\n              run(change(), onSelect)\n            ])\n          ]),\n          components: [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-dropzone'],\n                styles: {}\n              },\n              components: [\n                {\n                  dom: {\n                    tag: 'p',\n                    innerHtml: providersBackstage.translate('Drop an image here')\n                  }\n                },\n                Button.sketch({\n                  dom: {\n                    tag: 'button',\n                    innerHtml: providersBackstage.translate('Browse for an image'),\n                    styles: { position: 'relative' },\n                    classes: [\n                      'tox-button',\n                      'tox-button--secondary'\n                    ]\n                  },\n                  components: [memInput.asSpec()],\n                  action: function (comp) {\n                    var inputComp = memInput.get(comp);\n                    inputComp.element.dom.click();\n                  },\n                  buttonBehaviours: derive$1([\n                    Tabstopping.config({}),\n                    DisablingConfigs.button(providersBackstage.isReadOnly),\n                    receivingConfig()\n                  ])\n                })\n              ]\n            }]\n        };\n      };\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({ factory: { sketch: renderField } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    var renderGrid = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-form__grid',\n            'tox-form__grid--' + spec.columns + 'col'\n          ]\n        },\n        components: map(spec.items, backstage.interpreter)\n      };\n    };\n\n    var beforeObject = generate$1('alloy-fake-before-tabstop');\n    var afterObject = generate$1('alloy-fake-after-tabstop');\n    var craftWithClasses = function (classes) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: {\n            width: '1px',\n            height: '1px',\n            outline: 'none'\n          },\n          attributes: { tabindex: '0' },\n          classes: classes\n        },\n        behaviours: derive$1([\n          Focusing.config({ ignore: true }),\n          Tabstopping.config({})\n        ])\n      };\n    };\n    var craft = function (spec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-navobj']\n        },\n        components: [\n          craftWithClasses([beforeObject]),\n          spec,\n          craftWithClasses([afterObject])\n        ],\n        behaviours: derive$1([ComposingConfigs.childAt(1)])\n      };\n    };\n    var triggerTab = function (placeholder, shiftKey) {\n      emitWith(placeholder, keydown(), {\n        raw: {\n          which: 9,\n          shiftKey: shiftKey\n        }\n      });\n    };\n    var onFocus$1 = function (container, targetComp) {\n      var target = targetComp.element;\n      if (has$2(target, beforeObject)) {\n        triggerTab(container, true);\n      } else if (has$2(target, afterObject)) {\n        triggerTab(container, false);\n      }\n    };\n    var isPseudoStop = function (element) {\n      return closest$4(element, [\n        '.' + beforeObject,\n        '.' + afterObject\n      ].join(','), never);\n    };\n\n    var platformNeedsSandboxing = !(detect$3().browser.isIE() || detect$3().browser.isEdge());\n    var getDynamicSource = function (isSandbox) {\n      var cachedValue = Cell('');\n      return {\n        getValue: function (_frameComponent) {\n          return cachedValue.get();\n        },\n        setValue: function (frameComponent, html) {\n          if (!isSandbox) {\n            set$1(frameComponent.element, 'src', 'javascript:\\'\\'');\n            var doc = frameComponent.element.dom.contentWindow.document;\n            doc.open();\n            doc.write(html);\n            doc.close();\n          } else {\n            set$1(frameComponent.element, 'srcdoc', html);\n          }\n          cachedValue.set(html);\n        }\n      };\n    };\n    var renderIFrame = function (spec, providersBackstage) {\n      var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n      var attributes = __assign(__assign({}, spec.label.map(function (title) {\n        return { title: title };\n      }).getOr({})), isSandbox ? { sandbox: 'allow-scripts allow-same-origin' } : {});\n      var sourcing = getDynamicSource(isSandbox);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var factory = function (newSpec) {\n        return craft({\n          uid: newSpec.uid,\n          dom: {\n            tag: 'iframe',\n            attributes: attributes\n          },\n          behaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({}),\n            RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)\n          ])\n        });\n      };\n      var pField = FormField.parts.field({ factory: { sketch: factory } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    function create$5(width, height) {\n      return resize(document.createElement('canvas'), width, height);\n    }\n    function clone$1(canvas) {\n      var tCanvas = create$5(canvas.width, canvas.height);\n      var ctx = get2dContext(tCanvas);\n      ctx.drawImage(canvas, 0, 0);\n      return tCanvas;\n    }\n    function get2dContext(canvas) {\n      return canvas.getContext('2d');\n    }\n    function resize(canvas, width, height) {\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    }\n\n    function getWidth(image) {\n      return image.naturalWidth || image.width;\n    }\n    function getHeight(image) {\n      return image.naturalHeight || image.height;\n    }\n\n    var promise = function () {\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var anyWindow = window;\n      var asap = Promise.immediateFn || typeof anyWindow.setImmediate === 'function' && anyWindow.setImmediate || function (fn) {\n        setTimeout(fn, 1);\n      };\n      function bind(fn, thisArg) {\n        return function () {\n          return fn.apply(thisArg, arguments);\n        };\n      }\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var _i = 0, _a = this._deferreds; _i < _a.length; _i++) {\n          var deferred = _a[_i];\n          handle.call(this, deferred);\n        }\n        this._deferreds = [];\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      function doResolve(fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      }\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          function res(i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          }\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (reason) {\n        return new Promise(function (resolve, reject) {\n          reject(reason);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n            var value = values_1[_i];\n            value.then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var Promise$1 = window.Promise ? window.Promise : promise();\n\n    function blobToImage(blob) {\n      return new Promise$1(function (resolve, reject) {\n        var blobUrl = URL.createObjectURL(blob);\n        var image = new Image();\n        var removeListeners = function () {\n          image.removeEventListener('load', loaded);\n          image.removeEventListener('error', error);\n        };\n        function loaded() {\n          removeListeners();\n          resolve(image);\n        }\n        function error() {\n          removeListeners();\n          reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n        }\n        image.addEventListener('load', loaded);\n        image.addEventListener('error', error);\n        image.src = blobUrl;\n        if (image.complete) {\n          loaded();\n        }\n      });\n    }\n    function dataUriToBlobSync(uri) {\n      var data = uri.split(',');\n      var matches = /data:([^;]+)/.exec(data[0]);\n      if (!matches) {\n        return Optional.none();\n      }\n      var mimetype = matches[1];\n      var base64 = data[1];\n      var sliceSize = 1024;\n      var byteCharacters = atob(base64);\n      var bytesLength = byteCharacters.length;\n      var slicesCount = Math.ceil(bytesLength / sliceSize);\n      var byteArrays = new Array(slicesCount);\n      for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n        var begin = sliceIndex * sliceSize;\n        var end = Math.min(begin + sliceSize, bytesLength);\n        var bytes = new Array(end - begin);\n        for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n          bytes[i] = byteCharacters[offset].charCodeAt(0);\n        }\n        byteArrays[sliceIndex] = new Uint8Array(bytes);\n      }\n      return Optional.some(new Blob(byteArrays, { type: mimetype }));\n    }\n    function dataUriToBlob(uri) {\n      return new Promise$1(function (resolve, reject) {\n        dataUriToBlobSync(uri).fold(function () {\n          reject('uri is not base64: ' + uri);\n        }, resolve);\n      });\n    }\n    function canvasToBlob(canvas, type, quality) {\n      type = type || 'image/png';\n      if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n        return new Promise$1(function (resolve, reject) {\n          canvas.toBlob(function (blob) {\n            if (blob) {\n              resolve(blob);\n            } else {\n              reject();\n            }\n          }, type, quality);\n        });\n      } else {\n        return dataUriToBlob(canvas.toDataURL(type, quality));\n      }\n    }\n    function canvasToDataURL(canvas, type, quality) {\n      type = type || 'image/png';\n      return canvas.toDataURL(type, quality);\n    }\n    function blobToCanvas(blob) {\n      return blobToImage(blob).then(function (image) {\n        revokeImageUrl(image);\n        var canvas = create$5(getWidth(image), getHeight(image));\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0);\n        return canvas;\n      });\n    }\n    function blobToDataUri(blob) {\n      return new Promise$1(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    }\n    function revokeImageUrl(image) {\n      URL.revokeObjectURL(image.src);\n    }\n\n    function create$6(getCanvas, blob, uri) {\n      var initialType = blob.type;\n      var getType = constant(initialType);\n      function toBlob() {\n        return Promise$1.resolve(blob);\n      }\n      var toDataURL = constant(uri);\n      function toBase64() {\n        return uri.split(',')[1];\n      }\n      function toAdjustedBlob(type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToBlob(canvas, type, quality);\n        });\n      }\n      function toAdjustedDataURL(type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToDataURL(canvas, type, quality);\n        });\n      }\n      function toAdjustedBase64(type, quality) {\n        return toAdjustedDataURL(type, quality).then(function (dataurl) {\n          return dataurl.split(',')[1];\n        });\n      }\n      function toCanvas() {\n        return getCanvas.then(clone$1);\n      }\n      return {\n        getType: getType,\n        toBlob: toBlob,\n        toDataURL: toDataURL,\n        toBase64: toBase64,\n        toAdjustedBlob: toAdjustedBlob,\n        toAdjustedDataURL: toAdjustedDataURL,\n        toAdjustedBase64: toAdjustedBase64,\n        toCanvas: toCanvas\n      };\n    }\n    function fromBlob(blob) {\n      return blobToDataUri(blob).then(function (uri) {\n        return create$6(blobToCanvas(blob), blob, uri);\n      });\n    }\n    function fromCanvas(canvas, type) {\n      return canvasToBlob(canvas, type).then(function (blob) {\n        return create$6(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n      });\n    }\n\n    var blobToImageResult = function (blob) {\n      return fromBlob(blob);\n    };\n\n    function clamp$1(value, min, max) {\n      var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n      if (parsedValue > max) {\n        parsedValue = max;\n      } else if (parsedValue < min) {\n        parsedValue = min;\n      }\n      return parsedValue;\n    }\n    function identity$1() {\n      return [\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ];\n    }\n    var DELTA_INDEX = [\n      0,\n      0.01,\n      0.02,\n      0.04,\n      0.05,\n      0.06,\n      0.07,\n      0.08,\n      0.1,\n      0.11,\n      0.12,\n      0.14,\n      0.15,\n      0.16,\n      0.17,\n      0.18,\n      0.2,\n      0.21,\n      0.22,\n      0.24,\n      0.25,\n      0.27,\n      0.28,\n      0.3,\n      0.32,\n      0.34,\n      0.36,\n      0.38,\n      0.4,\n      0.42,\n      0.44,\n      0.46,\n      0.48,\n      0.5,\n      0.53,\n      0.56,\n      0.59,\n      0.62,\n      0.65,\n      0.68,\n      0.71,\n      0.74,\n      0.77,\n      0.8,\n      0.83,\n      0.86,\n      0.89,\n      0.92,\n      0.95,\n      0.98,\n      1,\n      1.06,\n      1.12,\n      1.18,\n      1.24,\n      1.3,\n      1.36,\n      1.42,\n      1.48,\n      1.54,\n      1.6,\n      1.66,\n      1.72,\n      1.78,\n      1.84,\n      1.9,\n      1.96,\n      2,\n      2.12,\n      2.25,\n      2.37,\n      2.5,\n      2.62,\n      2.75,\n      2.87,\n      3,\n      3.2,\n      3.4,\n      3.6,\n      3.8,\n      4,\n      4.3,\n      4.7,\n      4.9,\n      5,\n      5.5,\n      6,\n      6.5,\n      6.8,\n      7,\n      7.3,\n      7.5,\n      7.8,\n      8,\n      8.4,\n      8.7,\n      9,\n      9.4,\n      9.6,\n      9.8,\n      10\n    ];\n    function multiply(matrix1, matrix2) {\n      var col = [];\n      var out = new Array(25);\n      var val;\n      for (var i = 0; i < 5; i++) {\n        for (var j = 0; j < 5; j++) {\n          col[j] = matrix2[j + i * 5];\n        }\n        for (var j = 0; j < 5; j++) {\n          val = 0;\n          for (var k = 0; k < 5; k++) {\n            val += matrix1[j + k * 5] * col[k];\n          }\n          out[j + i * 5] = val;\n        }\n      }\n      return out;\n    }\n    function adjustContrast(matrix, value) {\n      var x;\n      value = clamp$1(value, -1, 1);\n      value *= 100;\n      if (value < 0) {\n        x = 127 + value / 100 * 127;\n      } else {\n        x = value % 1;\n        if (x === 0) {\n          x = DELTA_INDEX[value];\n        } else {\n          x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n        }\n        x = x * 127 + 127;\n      }\n      return multiply(matrix, [\n        x / 127,\n        0,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        x / 127,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        x / 127,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    }\n    function adjustBrightness(matrix, value) {\n      value = clamp$1(255 * value, -255, 255);\n      return multiply(matrix, [\n        1,\n        0,\n        0,\n        0,\n        value,\n        0,\n        1,\n        0,\n        0,\n        value,\n        0,\n        0,\n        1,\n        0,\n        value,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    }\n    function adjustColors(matrix, adjustR, adjustG, adjustB) {\n      adjustR = clamp$1(adjustR, 0, 2);\n      adjustG = clamp$1(adjustG, 0, 2);\n      adjustB = clamp$1(adjustB, 0, 2);\n      return multiply(matrix, [\n        adjustR,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustG,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustB,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    }\n\n    function colorFilter(ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyColorFilter(canvas, ir.getType(), matrix);\n      });\n    }\n    function applyColorFilter(canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      function applyMatrix(pixelsData, m) {\n        var r, g, b, a;\n        var data = pixelsData.data, m0 = m[0], m1 = m[1], m2 = m[2], m3 = m[3], m4 = m[4], m5 = m[5], m6 = m[6], m7 = m[7], m8 = m[8], m9 = m[9], m10 = m[10], m11 = m[11], m12 = m[12], m13 = m[13], m14 = m[14], m15 = m[15], m16 = m[16], m17 = m[17], m18 = m[18], m19 = m[19];\n        for (var i = 0; i < data.length; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n          a = data[i + 3];\n          data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n          data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n          data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n          data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n        }\n        return pixelsData;\n      }\n      var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    }\n    function convoluteFilter(ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyConvoluteFilter(canvas, ir.getType(), matrix);\n      });\n    }\n    function applyConvoluteFilter(canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      function applyMatrix(pIn, pOut, aMatrix) {\n        function clamp(value, min, max) {\n          if (value > max) {\n            value = max;\n          } else if (value < min) {\n            value = min;\n          }\n          return value;\n        }\n        var side = Math.round(Math.sqrt(aMatrix.length));\n        var halfSide = Math.floor(side / 2);\n        var rgba = pIn.data;\n        var drgba = pOut.data;\n        var w = pIn.width;\n        var h = pIn.height;\n        for (var y = 0; y < h; y++) {\n          for (var x = 0; x < w; x++) {\n            var r = 0;\n            var g = 0;\n            var b = 0;\n            for (var cy = 0; cy < side; cy++) {\n              for (var cx = 0; cx < side; cx++) {\n                var scx = clamp(x + cx - halfSide, 0, w - 1);\n                var scy = clamp(y + cy - halfSide, 0, h - 1);\n                var innerOffset = (scy * w + scx) * 4;\n                var wt = aMatrix[cy * side + cx];\n                r += rgba[innerOffset] * wt;\n                g += rgba[innerOffset + 1] * wt;\n                b += rgba[innerOffset + 2] * wt;\n              }\n            }\n            var offset = (y * w + x) * 4;\n            drgba[offset] = clamp(r, 0, 255);\n            drgba[offset + 1] = clamp(g, 0, 255);\n            drgba[offset + 2] = clamp(b, 0, 255);\n          }\n        }\n        return pOut;\n      }\n      var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n      var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n      pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n      context.putImageData(pixelsOut, 0, 0);\n      return fromCanvas(canvas, type);\n    }\n    function functionColorFilter(colorFn) {\n      var filterImpl = function (canvas, type, value) {\n        var context = get2dContext(canvas);\n        var lookup = new Array(256);\n        function applyLookup(pixelsData, lookupData) {\n          var data = pixelsData.data;\n          for (var i = 0; i < data.length; i += 4) {\n            data[i] = lookupData[data[i]];\n            data[i + 1] = lookupData[data[i + 1]];\n            data[i + 2] = lookupData[data[i + 2]];\n          }\n          return pixelsData;\n        }\n        for (var i = 0; i < lookup.length; i++) {\n          lookup[i] = colorFn(i, value);\n        }\n        var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n        context.putImageData(pixels, 0, 0);\n        return fromCanvas(canvas, type);\n      };\n      return function (ir, value) {\n        return ir.toCanvas().then(function (canvas) {\n          return filterImpl(canvas, ir.getType(), value);\n        });\n      };\n    }\n    function complexAdjustableColorFilter(matrixAdjustFn) {\n      return function (ir, adjust) {\n        return colorFilter(ir, matrixAdjustFn(identity$1(), adjust));\n      };\n    }\n    function basicColorFilter(matrix) {\n      return function (ir) {\n        return colorFilter(ir, matrix);\n      };\n    }\n    function basicConvolutionFilter(kernel) {\n      return function (ir) {\n        return convoluteFilter(ir, kernel);\n      };\n    }\n    var invert = basicColorFilter([\n      -1,\n      0,\n      0,\n      0,\n      255,\n      0,\n      -1,\n      0,\n      0,\n      255,\n      0,\n      0,\n      -1,\n      0,\n      255,\n      0,\n      0,\n      0,\n      1,\n      0,\n      0,\n      0,\n      0,\n      0,\n      1\n    ]);\n    var brightness = complexAdjustableColorFilter(adjustBrightness);\n    var contrast = complexAdjustableColorFilter(adjustContrast);\n    var colorize = function (ir, adjustR, adjustG, adjustB) {\n      return colorFilter(ir, adjustColors(identity$1(), adjustR, adjustG, adjustB));\n    };\n    var sharpen = basicConvolutionFilter([\n      0,\n      -1,\n      0,\n      -1,\n      5,\n      -1,\n      0,\n      -1,\n      0\n    ]);\n    var gamma = functionColorFilter(function (color, value) {\n      return Math.pow(color / 255, 1 - value) * 255;\n    });\n\n    function scale(image, dW, dH) {\n      var sW = getWidth(image);\n      var sH = getHeight(image);\n      var wRatio = dW / sW;\n      var hRatio = dH / sH;\n      var scaleCapped = false;\n      if (wRatio < 0.5 || wRatio > 2) {\n        wRatio = wRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      if (hRatio < 0.5 || hRatio > 2) {\n        hRatio = hRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      var scaled = _scale(image, wRatio, hRatio);\n      return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n        return scale(tCanvas, dW, dH);\n      });\n    }\n    function _scale(image, wRatio, hRatio) {\n      return new Promise$1(function (resolve) {\n        var sW = getWidth(image);\n        var sH = getHeight(image);\n        var dW = Math.floor(sW * wRatio);\n        var dH = Math.floor(sH * hRatio);\n        var canvas = create$5(dW, dH);\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n        resolve(canvas);\n      });\n    }\n\n    function rotate(ir, angle) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyRotate(canvas, ir.getType(), angle);\n      });\n    }\n    function applyRotate(image, type, angle) {\n      var canvas = create$5(image.width, image.height);\n      var context = get2dContext(canvas);\n      var translateX = 0;\n      var translateY = 0;\n      angle = angle < 0 ? 360 + angle : angle;\n      if (angle === 90 || angle === 270) {\n        resize(canvas, canvas.height, canvas.width);\n      }\n      if (angle === 90 || angle === 180) {\n        translateX = canvas.width;\n      }\n      if (angle === 270 || angle === 180) {\n        translateY = canvas.height;\n      }\n      context.translate(translateX, translateY);\n      context.rotate(angle * Math.PI / 180);\n      context.drawImage(image, 0, 0);\n      return fromCanvas(canvas, type);\n    }\n    function flip(ir, axis) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyFlip(canvas, ir.getType(), axis);\n      });\n    }\n    function applyFlip(image, type, axis) {\n      var canvas = create$5(image.width, image.height);\n      var context = get2dContext(canvas);\n      if (axis === 'v') {\n        context.scale(1, -1);\n        context.drawImage(image, 0, -canvas.height);\n      } else {\n        context.scale(-1, 1);\n        context.drawImage(image, -canvas.width, 0);\n      }\n      return fromCanvas(canvas, type);\n    }\n    function crop(ir, x, y, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyCrop(canvas, ir.getType(), x, y, w, h);\n      });\n    }\n    function applyCrop(image, type, x, y, w, h) {\n      var canvas = create$5(w, h);\n      var context = get2dContext(canvas);\n      context.drawImage(image, -x, -y);\n      return fromCanvas(canvas, type);\n    }\n    function resize$1(ir, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return scale(canvas, w, h).then(function (newCanvas) {\n          return fromCanvas(newCanvas, ir.getType());\n        });\n      });\n    }\n\n    var invert$1 = function (ir) {\n      return invert(ir);\n    };\n    var sharpen$1 = function (ir) {\n      return sharpen(ir);\n    };\n    var gamma$1 = function (ir, value) {\n      return gamma(ir, value);\n    };\n    var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n      return colorize(ir, adjustR, adjustG, adjustB);\n    };\n    var brightness$1 = function (ir, adjust) {\n      return brightness(ir, adjust);\n    };\n    var contrast$1 = function (ir, adjust) {\n      return contrast(ir, adjust);\n    };\n    var flip$1 = function (ir, axis) {\n      return flip(ir, axis);\n    };\n    var crop$1 = function (ir, x, y, w, h) {\n      return crop(ir, x, y, w, h);\n    };\n    var resize$2 = function (ir, w, h) {\n      return resize$1(ir, w, h);\n    };\n    var rotate$1 = function (ir, angle) {\n      return rotate(ir, angle);\n    };\n\n    var renderIcon$1 = function (iconHtml, behaviours) {\n      return __assign({\n        dom: {\n          tag: 'span',\n          innerHtml: iconHtml,\n          classes: [\n            'tox-icon',\n            'tox-tbtn__icon-wrap'\n          ]\n        }\n      }, behaviours);\n    };\n    var renderIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon$1(get$d(iconName, iconsProvider), {});\n    };\n    var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon$1(get$d(iconName, iconsProvider), { behaviours: derive$1([Replacing.config({})]) });\n    };\n    var renderLabel$1 = function (text, prefix, providersBackstage) {\n      return {\n        dom: {\n          tag: 'span',\n          innerHtml: providersBackstage.translate(text),\n          classes: [prefix + '__select-label']\n        },\n        behaviours: derive$1([Replacing.config({})])\n      };\n    };\n\n    var _a$1;\n    var internalToolbarButtonExecute = generate$1('toolbar.button.execute');\n    var onToolbarButtonExecute = function (info) {\n      return runOnExecute(function (comp, _simulatedEvent) {\n        runWithApi(info, comp)(function (itemApi) {\n          emitWith(comp, internalToolbarButtonExecute, { buttonApi: itemApi });\n          info.onAction(itemApi);\n        });\n      });\n    };\n    var toolbarButtonEventOrder = (_a$1 = {}, _a$1[execute()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'toolbar-button-events'\n    ], _a$1);\n\n    var updateMenuText = generate$1('update-menu-text');\n    var updateMenuIcon = generate$1('update-menu-icon');\n    var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n      var editorOffCell = Cell(noop);\n      var optMemDisplayText = spec.text.map(function (text) {\n        return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n      });\n      var optMemDisplayIcon = spec.icon.map(function (iconName) {\n        return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n      });\n      var onLeftOrRightInMenu = function (comp, se) {\n        var dropdown = Representing.getValue(comp);\n        Focusing.focus(dropdown);\n        emitWith(dropdown, 'keydown', { raw: se.event.raw });\n        Dropdown.close(dropdown);\n        return Optional.some(true);\n      };\n      var role = spec.role.fold(function () {\n        return {};\n      }, function (role) {\n        return { role: role };\n      });\n      var tooltipAttributes = spec.tooltip.fold(function () {\n        return {};\n      }, function (tooltip) {\n        var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n        return {\n          'title': translatedTooltip,\n          'aria-label': translatedTooltip\n        };\n      });\n      var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? { uid: spec.uid } : {}), role), {\n        dom: {\n          tag: 'button',\n          classes: [\n            prefix,\n            prefix + '--select'\n          ].concat(map(spec.classes, function (c) {\n            return prefix + '--' + c;\n          })),\n          attributes: __assign({}, tooltipAttributes)\n        },\n        components: componentRenderPipeline([\n          optMemDisplayIcon.map(function (mem) {\n            return mem.asSpec();\n          }),\n          optMemDisplayText.map(function (mem) {\n            return mem.asSpec();\n          }),\n          Optional.some({\n            dom: {\n              tag: 'div',\n              classes: [prefix + '__select-chevron'],\n              innerHtml: get$d('chevron-down', sharedBackstage.providers.icons)\n            }\n          })\n        ]),\n        matchWidth: true,\n        useMinWidth: true,\n        dropdownBehaviours: derive$1(__spreadArrays(spec.dropdownBehaviours, [\n          DisablingConfigs.button(function () {\n            return spec.disabled || sharedBackstage.providers.isReadOnly();\n          }),\n          receivingConfig(),\n          Unselecting.config({}),\n          Replacing.config({}),\n          config('dropdown-events', [\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          config('menubutton-update-display-text', [\n            run(updateMenuText, function (comp, se) {\n              optMemDisplayText.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayText) {\n                Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n              });\n            }),\n            run(updateMenuIcon, function (comp, se) {\n              optMemDisplayIcon.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayIcon) {\n                Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n              });\n            })\n          ])\n        ])),\n        eventOrder: deepMerge(toolbarButtonEventOrder, {\n          mousedown: [\n            'focusing',\n            'alloy.base.behaviour',\n            'item-type-events',\n            'normal-dropdown-events'\n          ]\n        }),\n        sandboxBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onLeft: onLeftOrRightInMenu,\n            onRight: onLeftOrRightInMenu\n          })]),\n        lazySink: sharedBackstage.getSink,\n        toggleClass: prefix + '--active',\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        fetch: function (comp) {\n          return Future.nu(curry(spec.fetch, comp));\n        }\n      })));\n      return memDropdown.asSpec();\n    };\n\n    var isMenuItemReference = function (item) {\n      return isString(item);\n    };\n    var isSeparator = function (item) {\n      return item.type === 'separator';\n    };\n    var isExpandingMenuItem = function (item) {\n      return has(item, 'getSubmenuItems');\n    };\n    var separator$1 = { type: 'separator' };\n    var unwrapReferences = function (items, menuItems) {\n      var realItems = foldl(items, function (acc, item) {\n        if (isMenuItemReference(item)) {\n          if (item === '') {\n            return acc;\n          } else if (item === '|') {\n            return acc.length > 0 && !isSeparator(acc[acc.length - 1]) ? acc.concat([separator$1]) : acc;\n          } else if (has(menuItems, item.toLowerCase())) {\n            return acc.concat([menuItems[item.toLowerCase()]]);\n          } else {\n            return acc;\n          }\n        } else {\n          return acc.concat([item]);\n        }\n      }, []);\n      if (realItems.length > 0 && isSeparator(realItems[realItems.length - 1])) {\n        realItems.pop();\n      }\n      return realItems;\n    };\n    var getFromExpandingItem = function (item, menuItems) {\n      var submenuItems = item.getSubmenuItems();\n      var rest = expand(submenuItems, menuItems);\n      var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n      var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n      return {\n        item: item,\n        menus: newMenus,\n        expansions: newExpansions\n      };\n    };\n    var getFromItem = function (item, menuItems) {\n      return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n        item: item,\n        menus: {},\n        expansions: {}\n      };\n    };\n    var generateValueIfRequired = function (item) {\n      if (isSeparator(item)) {\n        return item;\n      } else {\n        var itemValue = get(item, 'value').getOrThunk(function () {\n          return generate$1('generated-menu-item');\n        });\n        return deepMerge({ value: itemValue }, item);\n      }\n    };\n    var expand = function (items, menuItems) {\n      var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n      return foldr(realItems, function (acc, item) {\n        var itemWithValue = generateValueIfRequired(item);\n        var newData = getFromItem(itemWithValue, menuItems);\n        return {\n          menus: deepMerge(acc.menus, newData.menus),\n          items: [newData.item].concat(acc.items),\n          expansions: deepMerge(acc.expansions, newData.expansions)\n        };\n      }, {\n        menus: {},\n        expansions: {},\n        items: []\n      });\n    };\n\n    var build$2 = function (items, itemResponse, backstage, isHorizontalMenu) {\n      var primary = generate$1('primary-menu');\n      var data = expand(items, backstage.shared.providers.menuItems());\n      if (data.items.length === 0) {\n        return Optional.none();\n      }\n      var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n      var submenus = map$2(data.menus, function (menuItems, menuName) {\n        return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n      });\n      var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n      return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n    };\n\n    var getMenuButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        },\n        setActive: function (state) {\n          var elm = component.element;\n          if (state) {\n            add$2(elm, 'tox-tbtn--enabled');\n            set$1(elm, 'aria-pressed', true);\n          } else {\n            remove$4(elm, 'tox-tbtn--enabled');\n            remove$1(elm, 'aria-pressed');\n          }\n        },\n        isActive: function () {\n          return has$2(component.element, 'tox-tbtn--enabled');\n        }\n      };\n    };\n    var renderMenuButton = function (spec, prefix, backstage, role) {\n      return renderCommonDropdown({\n        text: spec.text,\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        role: role,\n        fetch: function (_comp, callback) {\n          spec.fetch(function (items) {\n            callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n          });\n        },\n        onSetup: spec.onSetup,\n        getApi: getMenuButtonApi,\n        columns: 1,\n        presets: 'normal',\n        classes: [],\n        dropdownBehaviours: [Tabstopping.config({})]\n      }, prefix, backstage.shared);\n    };\n    var getFetch$1 = function (items, getButton, backstage) {\n      var getMenuItemAction = function (item) {\n        return function (api) {\n          var newValue = !api.isActive();\n          api.setActive(newValue);\n          item.storage.set(newValue);\n          backstage.shared.getSink().each(function (sink) {\n            getButton().getOpt(sink).each(function (orig) {\n              focus$1(orig.element);\n              emitWith(orig, formActionEvent, {\n                name: item.name,\n                value: item.storage.get()\n              });\n            });\n          });\n        };\n      };\n      var getMenuItemSetup = function (item) {\n        return function (api) {\n          api.setActive(item.storage.get());\n        };\n      };\n      return function (success) {\n        success(map(items, function (item) {\n          var text = item.text.fold(function () {\n            return {};\n          }, function (text) {\n            return { text: text };\n          });\n          return __assign(__assign({\n            type: item.type,\n            active: false\n          }, text), {\n            onAction: getMenuItemAction(item),\n            onSetup: getMenuItemSetup(item)\n          });\n        }));\n      };\n    };\n\n    var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var action = actionOpt.fold(function () {\n        return {};\n      }, function (action) {\n        return { action: action };\n      });\n      var common = __assign({\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(function () {\n            return spec.disabled || providersBackstage.isReadOnly();\n          }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          config('button press', [\n            preventDefault('click'),\n            preventDefault('mousedown')\n          ])\n        ].concat(extraBehaviours)),\n        eventOrder: {\n          click: [\n            'button press',\n            'alloy.base.behaviour'\n          ],\n          mousedown: [\n            'button press',\n            'alloy.base.behaviour'\n          ]\n        }\n      }, action);\n      var domFinal = deepMerge(common, { dom: dom });\n      return deepMerge(domFinal, { components: components });\n    };\n    var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n      var dom = {\n        tag: 'button',\n        classes: ['tox-tbtn'],\n        attributes: tooltipAttributes\n      };\n      var icon = spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      });\n      var components = componentRenderPipeline([icon]);\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n      return Button.sketch(iconButtonSpec);\n    };\n    var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var translatedText = providersBackstage.translate(spec.text);\n      var icon = spec.icon ? spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      }) : Optional.none();\n      var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n      var innerHtml = icon.isSome() ? {} : { innerHtml: translatedText };\n      var classes = __spreadArrays(!spec.primary && !spec.borderless ? [\n        'tox-button',\n        'tox-button--secondary'\n      ] : ['tox-button'], icon.isSome() ? ['tox-button--icon'] : [], spec.borderless ? ['tox-button--naked'] : [], extraClasses);\n      var dom = __assign(__assign({\n        tag: 'button',\n        classes: classes\n      }, innerHtml), { attributes: { title: translatedText } });\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n      return Button.sketch(buttonSpec);\n    };\n    var getAction = function (name, buttonType) {\n      return function (comp) {\n        if (buttonType === 'custom') {\n          emitWith(comp, formActionEvent, {\n            name: name,\n            value: {}\n          });\n        } else if (buttonType === 'submit') {\n          emit(comp, formSubmitEvent);\n        } else if (buttonType === 'cancel') {\n          emit(comp, formCancelEvent);\n        } else {\n          console.error('Unknown button type: ', buttonType);\n        }\n      };\n    };\n    var isMenuFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'menu';\n    };\n    var isNormalFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n    };\n    var renderFooterButton = function (spec, buttonType, backstage) {\n      if (isMenuFooterButtonSpec(spec, buttonType)) {\n        var getButton = function () {\n          return memButton_1;\n        };\n        var menuButtonSpec = spec;\n        var fixedSpec = __assign(__assign({}, spec), {\n          onSetup: function (api) {\n            api.setDisabled(spec.disabled);\n            return noop;\n          },\n          fetch: getFetch$1(menuButtonSpec.items, getButton, backstage)\n        });\n        var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n        return memButton_1.asSpec();\n      } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n        var action = getAction(spec.name, buttonType);\n        var buttonSpec = __assign(__assign({}, spec), { borderless: false });\n        return renderButton(buttonSpec, action, backstage.shared.providers, []);\n      } else {\n        console.error('Unknown footer button type: ', buttonType);\n      }\n    };\n    var renderDialogButton = function (spec, providersBackstage) {\n      var action = getAction(spec.name, 'custom');\n      return renderFormField(Optional.none(), FormField.parts.field(__assign({ factory: Button }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [\n        RepresentingConfigs.memory(''),\n        ComposingConfigs.self()\n      ]))));\n    };\n\n    var schema$i = constant([\n      defaulted$1('field1Name', 'field1'),\n      defaulted$1('field2Name', 'field2'),\n      onStrictHandler('onLockedChange'),\n      markers(['lockClass']),\n      defaulted$1('locked', false),\n      SketchBehaviours.field('coupledFieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var getField = function (comp, detail, partName) {\n      return getPart(comp, detail, partName).bind(Composing.getCurrent);\n    };\n    var coupledPart = function (selfName, otherName) {\n      return required({\n        factory: FormField,\n        name: selfName,\n        overrides: function (detail) {\n          return {\n            fieldBehaviours: derive$1([config('coupled-input-behaviour', [run(input(), function (me) {\n                  getField(me, detail, otherName).each(function (other) {\n                    getPart(me, detail, 'lock').each(function (lock) {\n                      if (Toggling.isOn(lock)) {\n                        detail.onLockedChange(me, other, lock);\n                      }\n                    });\n                  });\n                })])])\n          };\n        }\n      });\n    };\n    var parts$5 = constant([\n      coupledPart('field1', 'field2'),\n      coupledPart('field2', 'field1'),\n      required({\n        factory: Button,\n        schema: [strict$1('dom')],\n        name: 'lock',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                selected: detail.locked,\n                toggleClass: detail.markers.lockClass,\n                aria: { mode: 'pressed' }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var factory$7 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [\n          Composing.config({ find: Optional.some }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var _a;\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n              },\n              setValue: function (comp, value) {\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                if (hasNonNullableKey(value, detail.field1Name)) {\n                  Representing.setValue(parts.field1(), value[detail.field1Name]);\n                }\n                if (hasNonNullableKey(value, detail.field2Name)) {\n                  Representing.setValue(parts.field2(), value[detail.field2Name]);\n                }\n              }\n            }\n          })\n        ]),\n        apis: {\n          getField1: function (component) {\n            return getPart(component, detail, 'field1');\n          },\n          getField2: function (component) {\n            return getPart(component, detail, 'field2');\n          },\n          getLock: function (component) {\n            return getPart(component, detail, 'lock');\n          }\n        }\n      };\n    };\n    var FormCoupledInputs = composite$1({\n      name: 'FormCoupledInputs',\n      configFields: schema$i(),\n      partFields: parts$5(),\n      factory: factory$7,\n      apis: {\n        getField1: function (apis, component) {\n          return apis.getField1(component);\n        },\n        getField2: function (apis, component) {\n          return apis.getField2(component);\n        },\n        getLock: function (apis, component) {\n          return apis.getLock(component);\n        }\n      }\n    });\n\n    var formatSize = function (size) {\n      var unitDec = {\n        '': 0,\n        'px': 0,\n        'pt': 1,\n        'mm': 1,\n        'pc': 2,\n        'ex': 2,\n        'em': 2,\n        'ch': 2,\n        'rem': 2,\n        'cm': 3,\n        'in': 4,\n        '%': 4\n      };\n      var maxDecimal = function (unit) {\n        return unit in unitDec ? unitDec[unit] : 1;\n      };\n      var numText = size.value.toFixed(maxDecimal(size.unit));\n      if (numText.indexOf('.') !== -1) {\n        numText = numText.replace(/\\.?0*$/, '');\n      }\n      return numText + size.unit;\n    };\n    var parseSize = function (sizeText) {\n      var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n      var match = numPattern.exec(sizeText);\n      if (match !== null) {\n        var value = parseFloat(match[1]);\n        var unit = match[2];\n        return Result.value({\n          value: value,\n          unit: unit\n        });\n      } else {\n        return Result.error(sizeText);\n      }\n    };\n    var convertUnit = function (size, unit) {\n      var inInch = {\n        '': 96,\n        'px': 96,\n        'pt': 72,\n        'cm': 2.54,\n        'pc': 12,\n        'mm': 25.4,\n        'in': 1\n      };\n      var supported = function (u) {\n        return Object.prototype.hasOwnProperty.call(inInch, u);\n      };\n      if (size.unit === unit) {\n        return Optional.some(size.value);\n      } else if (supported(size.unit) && supported(unit)) {\n        if (inInch[size.unit] === inInch[unit]) {\n          return Optional.some(size.value);\n        } else {\n          return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var noSizeConversion = function (_input) {\n      return Optional.none();\n    };\n    var ratioSizeConversion = function (scale, unit) {\n      return function (size) {\n        return convertUnit(size, unit).map(function (value) {\n          return {\n            value: value * scale,\n            unit: unit\n          };\n        });\n      };\n    };\n    var makeRatioConverter = function (currentFieldText, otherFieldText) {\n      var cValue = parseSize(currentFieldText).toOptional();\n      var oValue = parseSize(otherFieldText).toOptional();\n      return lift2(cValue, oValue, function (cSize, oSize) {\n        return convertUnit(cSize, oSize.unit).map(function (val) {\n          return oSize.value / val;\n        }).map(function (r) {\n          return ratioSizeConversion(r, oSize.unit);\n        }).getOr(noSizeConversion);\n      }).getOr(noSizeConversion);\n    };\n\n    var renderSizeInput = function (spec, providersBackstage) {\n      var converter = noSizeConversion;\n      var ratioEvent = generate$1('ratio-event');\n      var pLock = FormCoupledInputs.parts.lock({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-lock',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ],\n          attributes: { title: providersBackstage.translate(spec.label.getOr('Constrain proportions')) }\n        },\n        components: [\n          {\n            dom: {\n              tag: 'span',\n              classes: [\n                'tox-icon',\n                'tox-lock-icon__lock'\n              ],\n              innerHtml: get$d('lock', providersBackstage.icons)\n            }\n          },\n          {\n            dom: {\n              tag: 'span',\n              classes: [\n                'tox-icon',\n                'tox-lock-icon__unlock'\n              ],\n              innerHtml: get$d('unlock', providersBackstage.icons)\n            }\n          }\n        ],\n        buttonBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            }\n          }),\n          receivingConfig(),\n          Tabstopping.config({})\n        ])\n      });\n      var formGroup = function (components) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group']\n          },\n          components: components\n        };\n      };\n      var getFieldPart = function (isField1) {\n        return FormField.parts.field({\n          factory: Input,\n          inputClasses: ['tox-textfield'],\n          inputBehaviours: derive$1([\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isReadOnly();\n              }\n            }),\n            receivingConfig(),\n            Tabstopping.config({}),\n            config('size-input-events', [\n              run(focusin(), function (component, _simulatedEvent) {\n                emitWith(component, ratioEvent, { isField1: isField1 });\n              }),\n              run(change(), function (component, _simulatedEvent) {\n                emitWith(component, formChangeEvent, { name: spec.name });\n              })\n            ])\n          ]),\n          selectOnFocus: false\n        });\n      };\n      var getLabel = function (label) {\n        return {\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        };\n      };\n      var widthField = FormCoupledInputs.parts.field1(formGroup([\n        FormField.parts.label(getLabel('Width')),\n        getFieldPart(true)\n      ]));\n      var heightField = FormCoupledInputs.parts.field2(formGroup([\n        FormField.parts.label(getLabel('Height')),\n        getFieldPart(false)\n      ]));\n      return FormCoupledInputs.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-form__controls-h-stack']\n            },\n            components: [\n              widthField,\n              heightField,\n              formGroup([\n                getLabel('&nbsp;'),\n                pLock\n              ])\n            ]\n          }],\n        field1Name: 'width',\n        field2Name: 'height',\n        locked: true,\n        markers: { lockClass: 'tox-locked' },\n        onLockedChange: function (current, other, _lock) {\n          parseSize(Representing.getValue(current)).each(function (size) {\n            converter(size).each(function (newSize) {\n              Representing.setValue(other, formatSize(newSize));\n            });\n          });\n        },\n        coupledFieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            },\n            onDisabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getLock(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getLock(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('size-input-events2', [run(ratioEvent, function (component, simulatedEvent) {\n              var isField1 = simulatedEvent.event.isField1;\n              var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n              var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n              var value1 = optCurrent.map(Representing.getValue).getOr('');\n              var value2 = optOther.map(Representing.getValue).getOr('');\n              converter = makeRatioConverter(value1, value2);\n            })])\n        ])\n      });\n    };\n\n    var undo = constant(generate$1('undo'));\n    var redo = constant(generate$1('redo'));\n    var zoom = constant(generate$1('zoom'));\n    var back = constant(generate$1('back'));\n    var apply = constant(generate$1('apply'));\n    var swap = constant(generate$1('swap'));\n    var transform = constant(generate$1('transform'));\n    var tempTransform = constant(generate$1('temp-transform'));\n    var transformApply = constant(generate$1('transform-apply'));\n    var internal = {\n      undo: undo,\n      redo: redo,\n      zoom: zoom,\n      back: back,\n      apply: apply,\n      swap: swap,\n      transform: transform,\n      tempTransform: tempTransform,\n      transformApply: transformApply\n    };\n    var saveState = constant('save-state');\n    var disable$1 = constant('disable');\n    var enable$1 = constant('enable');\n    var external$2 = {\n      formActionEvent: formActionEvent,\n      saveState: saveState,\n      disable: disable$1,\n      enable: enable$1\n    };\n\n    var renderEditPanel = function (imagePanel, providersBackstage) {\n      var createButton = function (text, action, disabled, primary) {\n        return record(renderButton({\n          name: text,\n          text: text,\n          disabled: disabled,\n          primary: primary,\n          icon: Optional.none(),\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var createIconButton = function (icon, tooltip, action, disabled) {\n        return record(renderIconButton({\n          name: icon,\n          icon: Optional.some(icon),\n          tooltip: Optional.some(tooltip),\n          disabled: disabled,\n          primary: false,\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var disableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.disable(component);\n          }\n        });\n      };\n      var enableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.enable(component);\n          }\n        });\n      };\n      var panelDom = {\n        tag: 'div',\n        classes: [\n          'tox-image-tools__toolbar',\n          'tox-image-tools-edit-panel'\n        ]\n      };\n      var noop$1 = noop;\n      var emit$1 = function (comp, event, data) {\n        emitWith(comp, event, data);\n      };\n      var emitDisable = function (component) {\n        return emit(component, external$2.disable());\n      };\n      var emitEnable = function (component) {\n        return emit(component, external$2.enable());\n      };\n      var emitTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var emitTempTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.tempTransform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var getBackSwap = function (anyInSystem) {\n        return function () {\n          memContainer.getOpt(anyInSystem).each(function (container) {\n            Replacing.set(container, [ButtonPanel]);\n          });\n        };\n      };\n      var emitTransformApply = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transformApply(), {\n          transform: transform,\n          swap: getBackSwap(comp)\n        });\n        emitEnable(comp);\n      };\n      var createBackButton = function () {\n        return createButton('Back', function (button) {\n          return emit$1(button, internal.back(), { swap: getBackSwap(button) });\n        }, false, false);\n      };\n      var createSpacer = function () {\n        return record({\n          dom: {\n            tag: 'div',\n            classes: ['tox-spacer']\n          },\n          behaviours: derive$1([Disabling.config({})])\n        });\n      };\n      var createApplyButton = function () {\n        return createButton('Apply', function (button) {\n          return emit$1(button, internal.apply(), { swap: getBackSwap(button) });\n        }, true, true);\n      };\n      var makeCropTransform = function () {\n        return function (ir) {\n          var rect = imagePanel.getRect();\n          return crop$1(ir, rect.x, rect.y, rect.w, rect.h);\n        };\n      };\n      var cropPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createButton('Apply', function (button) {\n          var transform = makeCropTransform();\n          emitTransformApply(button, transform);\n          imagePanel.hideCrop();\n        }, false, true)\n      ];\n      var CropPanel = Container.sketch({\n        dom: panelDom,\n        components: cropPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(cropPanelComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(cropPanelComponents, comp);\n            })\n          ])])\n      });\n      var memSize = record(renderSizeInput({\n        name: 'size',\n        label: Optional.none(),\n        constrain: true,\n        disabled: false\n      }, providersBackstage));\n      var makeResizeTransform = function (width, height) {\n        return function (ir) {\n          return resize$2(ir, width, height);\n        };\n      };\n      var resizePanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        memSize,\n        createSpacer(),\n        createButton('Apply', function (button) {\n          memSize.getOpt(button).each(function (sizeInput) {\n            var value = Representing.getValue(sizeInput);\n            var width = parseInt(value.width, 10);\n            var height = parseInt(value.height, 10);\n            var transform = makeResizeTransform(width, height);\n            emitTransformApply(button, transform);\n          });\n        }, false, true)\n      ];\n      var ResizePanel = Container.sketch({\n        dom: panelDom,\n        components: resizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(resizePanelComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(resizePanelComponents, comp);\n            })\n          ])])\n      });\n      var makeValueTransform = function (transform, value) {\n        return function (ir) {\n          return transform(ir, value);\n        };\n      };\n      var horizontalFlip = makeValueTransform(flip$1, 'h');\n      var verticalFlip = makeValueTransform(flip$1, 'v');\n      var counterclockwiseRotate = makeValueTransform(rotate$1, -90);\n      var clockwiseRotate = makeValueTransform(rotate$1, 90);\n      var flipRotateOnAction = function (comp, operation) {\n        emitTempTransform(comp, operation);\n      };\n      var flipRotateComponents = [\n        createBackButton(),\n        createSpacer(),\n        createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n          flipRotateOnAction(button, horizontalFlip);\n        }, false),\n        createIconButton('flip-vertically', 'Flip vertically', function (button) {\n          flipRotateOnAction(button, verticalFlip);\n        }, false),\n        createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n          flipRotateOnAction(button, counterclockwiseRotate);\n        }, false),\n        createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n          flipRotateOnAction(button, clockwiseRotate);\n        }, false),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FlipRotatePanel = Container.sketch({\n        dom: panelDom,\n        components: flipRotateComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(flipRotateComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(flipRotateComponents, comp);\n            })\n          ])])\n      });\n      var makeSlider = function (label, onChoose, min, value, max) {\n        var labelPart = Slider.parts.label({\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        });\n        var spectrum = Slider.parts.spectrum({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__rail'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        var thumb = Slider.parts.thumb({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__handle'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        return record(Slider.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider'],\n            attributes: { role: 'presentation' }\n          },\n          model: {\n            mode: 'x',\n            minX: min,\n            maxX: max,\n            getInitialValue: constant({ x: value })\n          },\n          components: [\n            labelPart,\n            spectrum,\n            thumb\n          ],\n          sliderBehaviours: derive$1([Focusing.config({})]),\n          onChoose: onChoose\n        }));\n      };\n      var makeVariableSlider = function (label, transform, min, value, max) {\n        var onChoose = function (slider, _thumb, value) {\n          var valTransform = makeValueTransform(transform, value.x / 100);\n          emitTransform(slider, valTransform);\n        };\n        return makeSlider(label, onChoose, min, value, max);\n      };\n      var variableFilterPanelComponents = function (label, transform, min, value, max) {\n        return [\n          createBackButton(),\n          makeVariableSlider(label, transform, min, value, max),\n          createApplyButton()\n        ];\n      };\n      var createVariableFilterPanel = function (label, transform, min, value, max) {\n        var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n        return Container.sketch({\n          dom: panelDom,\n          components: filterPanelComponents.map(function (mem) {\n            return mem.asSpec();\n          }),\n          containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [\n              run(external$2.disable(), function (comp, _se) {\n                disableAllComponents(filterPanelComponents, comp);\n              }),\n              run(external$2.enable(), function (comp, _se) {\n                enableAllComponents(filterPanelComponents, comp);\n              })\n            ])])\n        });\n      };\n      var filterPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FilterPanel = Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var BrightnessPanel = createVariableFilterPanel('Brightness', brightness$1, -100, 0, 100);\n      var ContrastPanel = createVariableFilterPanel('Contrast', contrast$1, -100, 0, 100);\n      var GammaPanel = createVariableFilterPanel('Gamma', gamma$1, -100, 0, 100);\n      var makeColorTransform = function (red, green, blue) {\n        return function (ir) {\n          return colorize$1(ir, red, green, blue);\n        };\n      };\n      var makeColorSlider = function (label) {\n        var onChoose = function (slider, _thumb, _value) {\n          var redOpt = memRed.getOpt(slider);\n          var blueOpt = memBlue.getOpt(slider);\n          var greenOpt = memGreen.getOpt(slider);\n          redOpt.each(function (red) {\n            blueOpt.each(function (blue) {\n              greenOpt.each(function (green) {\n                var r = Representing.getValue(red).x / 100;\n                var g = Representing.getValue(green).x / 100;\n                var b = Representing.getValue(blue).x / 100;\n                var transform = makeColorTransform(r, g, b);\n                emitTransform(slider, transform);\n              });\n            });\n          });\n        };\n        return makeSlider(label, onChoose, 0, 100, 200);\n      };\n      var memRed = makeColorSlider('R');\n      var memGreen = makeColorSlider('G');\n      var memBlue = makeColorSlider('B');\n      var colorizePanelComponents = [\n        createBackButton(),\n        memRed,\n        memGreen,\n        memBlue,\n        createApplyButton()\n      ];\n      var ColorizePanel = Container.sketch({\n        dom: panelDom,\n        components: colorizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var getTransformPanelEvent = function (panel, transform, update) {\n        return function (button) {\n          var swap = function () {\n            memContainer.getOpt(button).each(function (container) {\n              Replacing.set(container, [panel]);\n              update(container);\n            });\n          };\n          emit$1(button, internal.swap(), {\n            transform: transform,\n            swap: swap\n          });\n        };\n      };\n      var cropPanelUpdate = function (_anyInSystem) {\n        imagePanel.showCrop();\n      };\n      var resizePanelUpdate = function (anyInSystem) {\n        memSize.getOpt(anyInSystem).each(function (sizeInput) {\n          var measurements = imagePanel.getMeasurements();\n          var width = measurements.width;\n          var height = measurements.height;\n          Representing.setValue(sizeInput, {\n            width: width,\n            height: height\n          });\n        });\n      };\n      var sharpenTransform = Optional.some(sharpen$1);\n      var invertTransform = Optional.some(invert$1);\n      var buttonPanelComponents = [\n        createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false),\n        createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false),\n        createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false),\n        createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false),\n        createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false),\n        createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false),\n        createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false),\n        createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false),\n        createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)\n      ];\n      var ButtonPanel = Container.sketch({\n        dom: panelDom,\n        components: buttonPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var container = Container.sketch({\n        dom: { tag: 'div' },\n        components: [ButtonPanel],\n        containerBehaviours: derive$1([Replacing.config({})])\n      });\n      var memContainer = record(container);\n      var getApplyButton = function (anyInSystem) {\n        return memContainer.getOpt(anyInSystem).map(function (container) {\n          var panel = container.components()[0];\n          return panel.components()[panel.components().length - 1];\n        });\n      };\n      return {\n        memContainer: memContainer,\n        getApplyButton: getApplyButton\n      };\n    };\n\n    var global$b = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n\n    var global$c = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n    var global$d = tinymce.util.Tools.resolve('tinymce.util.Observable');\n\n    var global$e = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var global$f = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    function getDocumentSize(doc) {\n      var max = Math.max;\n      var documentElement = doc.documentElement;\n      var body = doc.body;\n      var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n      var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n      var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n      var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n      var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n      var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n      return {\n        width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n        height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n      };\n    }\n    function updateWithTouchData(e) {\n      var keys, i;\n      if (e.changedTouches) {\n        keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n        for (i = 0; i < keys.length; i++) {\n          e[keys[i]] = e.changedTouches[0][keys[i]];\n        }\n      }\n    }\n    function DragHelper (id, settings) {\n      var $eventOverlay;\n      var doc = settings.document || document;\n      var downButton;\n      var startX, startY;\n      var handleElement = doc.getElementById(settings.handle || id);\n      var start = function (e) {\n        var docSize = getDocumentSize(doc);\n        var cursor;\n        updateWithTouchData(e);\n        e.preventDefault();\n        downButton = e.button;\n        var handleElm = handleElement;\n        startX = e.screenX;\n        startY = e.screenY;\n        if (window.getComputedStyle) {\n          cursor = window.getComputedStyle(handleElm, null).getPropertyValue('cursor');\n        } else {\n          cursor = handleElm.runtimeStyle.cursor;\n        }\n        $eventOverlay = global$c('<div></div>').css({\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: docSize.width,\n          height: docSize.height,\n          zIndex: 2147483647,\n          opacity: 0.0001,\n          cursor: cursor\n        }).appendTo(doc.body);\n        global$c(doc).on('mousemove touchmove', drag).on('mouseup touchend', stop);\n        settings.start(e);\n      };\n      var drag = function (e) {\n        updateWithTouchData(e);\n        if (e.button !== downButton) {\n          return stop(e);\n        }\n        e.deltaX = e.screenX - startX;\n        e.deltaY = e.screenY - startY;\n        e.preventDefault();\n        settings.drag(e);\n      };\n      var stop = function (e) {\n        updateWithTouchData(e);\n        global$c(doc).off('mousemove touchmove', drag).off('mouseup touchend', stop);\n        $eventOverlay.remove();\n        if (settings.stop) {\n          settings.stop(e);\n        }\n      };\n      this.destroy = function () {\n        global$c(handleElement).off();\n      };\n      global$c(handleElement).on('mousedown touchstart', start);\n    }\n\n    var count = 0;\n    var create$7 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n      var dragHelpers;\n      var prefix = 'tox-';\n      var id = prefix + 'crid-' + count++;\n      var handles = [\n        {\n          name: 'move',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: 0,\n          deltaH: 0,\n          label: 'Crop Mask'\n        },\n        {\n          name: 'nw',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: -1,\n          deltaH: -1,\n          label: 'Top Left Crop Handle'\n        },\n        {\n          name: 'ne',\n          xMul: 1,\n          yMul: 0,\n          deltaX: 0,\n          deltaY: 1,\n          deltaW: 1,\n          deltaH: -1,\n          label: 'Top Right Crop Handle'\n        },\n        {\n          name: 'sw',\n          xMul: 0,\n          yMul: 1,\n          deltaX: 1,\n          deltaY: 0,\n          deltaW: -1,\n          deltaH: 1,\n          label: 'Bottom Left Crop Handle'\n        },\n        {\n          name: 'se',\n          xMul: 1,\n          yMul: 1,\n          deltaX: 0,\n          deltaY: 0,\n          deltaW: 1,\n          deltaH: 1,\n          label: 'Bottom Right Crop Handle'\n        }\n      ];\n      var blockers = [\n        'top',\n        'right',\n        'bottom',\n        'left'\n      ];\n      var getAbsoluteRect = function (outerRect, relativeRect) {\n        return {\n          x: relativeRect.x + outerRect.x,\n          y: relativeRect.y + outerRect.y,\n          w: relativeRect.w,\n          h: relativeRect.h\n        };\n      };\n      var getRelativeRect = function (outerRect, innerRect) {\n        return {\n          x: innerRect.x - outerRect.x,\n          y: innerRect.y - outerRect.y,\n          w: innerRect.w,\n          h: innerRect.h\n        };\n      };\n      var getInnerRect = function () {\n        return getRelativeRect(clampRect, currentRect);\n      };\n      function moveRect(handle, startRect, deltaX, deltaY) {\n        var x, y, w, h, rect;\n        x = startRect.x;\n        y = startRect.y;\n        w = startRect.w;\n        h = startRect.h;\n        x += deltaX * handle.deltaX;\n        y += deltaY * handle.deltaY;\n        w += deltaX * handle.deltaW;\n        h += deltaY * handle.deltaH;\n        if (w < 20) {\n          w = 20;\n        }\n        if (h < 20) {\n          h = 20;\n        }\n        rect = currentRect = global$b.clamp({\n          x: x,\n          y: y,\n          w: w,\n          h: h\n        }, clampRect, handle.name === 'move');\n        rect = getRelativeRect(clampRect, rect);\n        instance.fire('updateRect', { rect: rect });\n        setInnerRect(rect);\n      }\n      function render() {\n        function createDragHelper(handle) {\n          var startRect;\n          return new DragHelper(id, {\n            document: containerElm.ownerDocument,\n            handle: id + '-' + handle.name,\n            start: function () {\n              startRect = currentRect;\n            },\n            drag: function (e) {\n              moveRect(handle, startRect, e.deltaX, e.deltaY);\n            }\n          });\n        }\n        global$c('<div id=\"' + id + '\" class=\"' + prefix + 'croprect-container\"' + ' role=\"grid\" aria-dropeffect=\"execute\">').appendTo(containerElm);\n        global$e.each(blockers, function (blocker) {\n          global$c('#' + id, containerElm).append('<div id=\"' + id + '-' + blocker + '\"class=\"' + prefix + 'croprect-block\" style=\"display: none\" data-mce-bogus=\"all\">');\n        });\n        global$e.each(handles, function (handle) {\n          global$c('#' + id, containerElm).append('<div id=\"' + id + '-' + handle.name + '\" class=\"' + prefix + 'croprect-handle ' + prefix + 'croprect-handle-' + handle.name + '\"' + 'style=\"display: none\" data-mce-bogus=\"all\" role=\"gridcell\" tabindex=\"-1\"' + ' aria-label=\"' + handle.label + '\" aria-grabbed=\"false\" title=\"' + handle.label + '\">');\n        });\n        dragHelpers = global$e.map(handles, createDragHelper);\n        repaint(currentRect);\n        global$c(containerElm).on('focusin focusout', function (e) {\n          global$c(e.target).attr('aria-grabbed', e.type === 'focus' ? 'true' : 'false');\n        });\n        global$c(containerElm).on('keydown', function (e) {\n          var activeHandle;\n          global$e.each(handles, function (handle) {\n            if (e.target.id === id + '-' + handle.name) {\n              activeHandle = handle;\n              return false;\n            }\n          });\n          function moveAndBlock(evt, handle, startRect, deltaX, deltaY) {\n            evt.stopPropagation();\n            evt.preventDefault();\n            moveRect(activeHandle, startRect, deltaX, deltaY);\n          }\n          switch (e.keyCode) {\n          case global$f.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n          case global$f.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n          case global$f.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n          case global$f.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n          case global$f.ENTER:\n          case global$f.SPACEBAR:\n            e.preventDefault();\n            action();\n            break;\n          }\n        });\n      }\n      function toggleVisibility(state) {\n        var selectors = global$e.map(handles, function (handle) {\n          return '#' + id + '-' + handle.name;\n        }).concat(global$e.map(blockers, function (blocker) {\n          return '#' + id + '-' + blocker;\n        })).join(',');\n        if (state) {\n          global$c(selectors, containerElm).show();\n        } else {\n          global$c(selectors, containerElm).hide();\n        }\n      }\n      function repaint(rect) {\n        function updateElementRect(name, rect) {\n          if (rect.h < 0) {\n            rect.h = 0;\n          }\n          if (rect.w < 0) {\n            rect.w = 0;\n          }\n          global$c('#' + id + '-' + name, containerElm).css({\n            left: rect.x,\n            top: rect.y,\n            width: rect.w,\n            height: rect.h\n          });\n        }\n        global$e.each(handles, function (handle) {\n          global$c('#' + id + '-' + handle.name, containerElm).css({\n            left: rect.w * handle.xMul + rect.x,\n            top: rect.h * handle.yMul + rect.y\n          });\n        });\n        updateElementRect('top', {\n          x: viewPortRect.x,\n          y: viewPortRect.y,\n          w: viewPortRect.w,\n          h: rect.y - viewPortRect.y\n        });\n        updateElementRect('right', {\n          x: rect.x + rect.w,\n          y: rect.y,\n          w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('bottom', {\n          x: viewPortRect.x,\n          y: rect.y + rect.h,\n          w: viewPortRect.w,\n          h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n        });\n        updateElementRect('left', {\n          x: viewPortRect.x,\n          y: rect.y,\n          w: rect.x - viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('move', rect);\n      }\n      function setRect(rect) {\n        currentRect = rect;\n        repaint(currentRect);\n      }\n      function setViewPortRect(rect) {\n        viewPortRect = rect;\n        repaint(currentRect);\n      }\n      function setInnerRect(rect) {\n        setRect(getAbsoluteRect(clampRect, rect));\n      }\n      function setClampRect(rect) {\n        clampRect = rect;\n        repaint(currentRect);\n      }\n      function destroy() {\n        global$e.each(dragHelpers, function (helper) {\n          helper.destroy();\n        });\n        dragHelpers = [];\n      }\n      render();\n      var instance = global$e.extend({\n        toggleVisibility: toggleVisibility,\n        setClampRect: setClampRect,\n        setRect: setRect,\n        getInnerRect: getInnerRect,\n        setInnerRect: setInnerRect,\n        setViewPortRect: setViewPortRect,\n        destroy: destroy\n      }, global$d);\n      return instance;\n    };\n    var CropRect = { create: create$7 };\n\n    var loadImage = function (image) {\n      return new global$4(function (resolve) {\n        var loaded = function () {\n          image.removeEventListener('load', loaded);\n          resolve(image);\n        };\n        if (image.complete) {\n          resolve(image);\n        } else {\n          image.addEventListener('load', loaded);\n        }\n      });\n    };\n    var renderImagePanel = function (initialUrl) {\n      var memBg = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image-bg'],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var zoomState = Cell(1);\n      var cropRect = Cell(Optional.none());\n      var rectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var viewRectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var repaintImg = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var zoom = zoomState.get();\n          var panelW = get$7(panel.element);\n          var panelH = get$6(panel.element);\n          var width = img.dom.naturalWidth * zoom;\n          var height = img.dom.naturalHeight * zoom;\n          var left = Math.max(0, panelW / 2 - width / 2);\n          var top = Math.max(0, panelH / 2 - height / 2);\n          var css = {\n            left: left.toString() + 'px',\n            top: top.toString() + 'px',\n            width: width.toString() + 'px',\n            height: height.toString() + 'px',\n            position: 'absolute'\n          };\n          setAll$1(img, css);\n          memBg.getOpt(panel).each(function (bg) {\n            setAll$1(bg.element, css);\n          });\n          cropRect.get().each(function (cRect) {\n            var rect = rectState.get();\n            cRect.setRect({\n              x: rect.x * zoom + left,\n              y: rect.y * zoom + top,\n              w: rect.w * zoom,\n              h: rect.h * zoom\n            });\n            cRect.setClampRect({\n              x: left,\n              y: top,\n              w: width,\n              h: height\n            });\n            cRect.setViewPortRect({\n              x: 0,\n              y: 0,\n              w: panelW,\n              h: panelH\n            });\n          });\n        });\n      };\n      var zoomFit = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var panelW = get$7(panel.element);\n          var panelH = get$6(panel.element);\n          var width = img.dom.naturalWidth;\n          var height = img.dom.naturalHeight;\n          var zoom = Math.min(panelW / width, panelH / height);\n          if (zoom >= 1) {\n            zoomState.set(1);\n          } else {\n            zoomState.set(zoom);\n          }\n        });\n      };\n      var updateSrc = function (anyInSystem, url) {\n        var img = SugarElement.fromTag('img');\n        set$1(img, 'src', url);\n        return loadImage(img.dom).then(function () {\n          return memContainer.getOpt(anyInSystem).map(function (panel) {\n            var aImg = external({ element: img });\n            Replacing.replaceAt(panel, 1, Optional.some(aImg));\n            var lastViewRect = viewRectState.get();\n            var viewRect = {\n              x: 0,\n              y: 0,\n              w: img.dom.naturalWidth,\n              h: img.dom.naturalHeight\n            };\n            viewRectState.set(viewRect);\n            var rect = global$b.inflate(viewRect, -20, -20);\n            rectState.set(rect);\n            if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n              zoomFit(panel, img);\n            }\n            repaintImg(panel, img);\n            return img;\n          });\n        });\n      };\n      var zoom = function (anyInSystem, direction) {\n        var currentZoom = zoomState.get();\n        var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n        zoomState.set(newZoom);\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var img = panel.components()[1].element;\n          repaintImg(panel, img);\n        });\n      };\n      var showCrop = function () {\n        cropRect.get().each(function (cRect) {\n          cRect.toggleVisibility(true);\n        });\n      };\n      var hideCrop = function () {\n        cropRect.get().each(function (cRect) {\n          cRect.toggleVisibility(false);\n        });\n      };\n      var getRect = function () {\n        return rectState.get();\n      };\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image']\n        },\n        components: [\n          memBg.asSpec(),\n          {\n            dom: {\n              tag: 'img',\n              attributes: { src: initialUrl }\n            }\n          },\n          {\n            dom: { tag: 'div' },\n            behaviours: derive$1([config('image-panel-crop-events', [runOnAttached(function (comp) {\n                  memContainer.getOpt(comp).each(function (container) {\n                    var el = container.element.dom;\n                    var cRect = CropRect.create({\n                      x: 10,\n                      y: 10,\n                      w: 100,\n                      h: 100\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, el, function () {\n                    });\n                    cRect.toggleVisibility(false);\n                    cRect.on('updateRect', function (e) {\n                      var rect = e.rect;\n                      var zoom = zoomState.get();\n                      var newRect = {\n                        x: Math.round(rect.x / zoom),\n                        y: Math.round(rect.y / zoom),\n                        w: Math.round(rect.w / zoom),\n                        h: Math.round(rect.h / zoom)\n                      };\n                      rectState.set(newRect);\n                    });\n                    cropRect.set(Optional.some(cRect));\n                  });\n                })])])\n          }\n        ],\n        containerBehaviours: derive$1([\n          Replacing.config({}),\n          config('image-panel-events', [runOnAttached(function (comp) {\n              updateSrc(comp, initialUrl);\n            })])\n        ])\n      });\n      var memContainer = record(container);\n      var getMeasurements = function () {\n        var viewRect = viewRectState.get();\n        return {\n          width: viewRect.w,\n          height: viewRect.h\n        };\n      };\n      return {\n        memContainer: memContainer,\n        updateSrc: updateSrc,\n        zoom: zoom,\n        showCrop: showCrop,\n        hideCrop: hideCrop,\n        getRect: getRect,\n        getMeasurements: getMeasurements\n      };\n    };\n\n    var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n      return renderIconButton({\n        name: innerHtml,\n        icon: Optional.some(icon),\n        disabled: disabled,\n        tooltip: Optional.some(innerHtml),\n        primary: false,\n        borderless: false\n      }, action, providersBackstage);\n    };\n    var setButtonEnabled = function (button, enabled) {\n      if (enabled) {\n        Disabling.enable(button);\n      } else {\n        Disabling.disable(button);\n      }\n    };\n    var renderSideBar = function (providersBackstage) {\n      var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n        memUndo.getOpt(anyInSystem).each(function (undo) {\n          setButtonEnabled(undo, undoEnabled);\n        });\n        memRedo.getOpt(anyInSystem).each(function (redo) {\n          setButtonEnabled(redo, redoEnabled);\n        });\n      };\n      var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n        emitWith(button, internal.undo(), { direction: 1 });\n      }, providersBackstage));\n      var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n        emitWith(button, internal.redo(), { direction: 1 });\n      }, providersBackstage));\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-image-tools__toolbar',\n            'tox-image-tools__sidebar'\n          ]\n        },\n        components: [\n          memUndo.asSpec(),\n          memRedo.asSpec(),\n          createButton('Zoom in', 'zoom-in', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: 1 });\n          }, providersBackstage),\n          createButton('Zoom out', 'zoom-out', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: -1 });\n          }, providersBackstage)\n        ]\n      });\n      return {\n        container: container,\n        updateButtonUndoStates: updateButtonUndoStates\n      };\n    };\n\n    function UndoStack () {\n      var data = [];\n      var index = -1;\n      function add(state) {\n        var removed = data.splice(++index);\n        data.push(state);\n        return {\n          state: state,\n          removed: removed\n        };\n      }\n      function undo() {\n        if (canUndo()) {\n          return data[--index];\n        }\n      }\n      function redo() {\n        if (canRedo()) {\n          return data[++index];\n        }\n      }\n      function canUndo() {\n        return index > 0;\n      }\n      function canRedo() {\n        return index !== -1 && index < data.length - 1;\n      }\n      return {\n        data: data,\n        add: add,\n        undo: undo,\n        redo: redo,\n        canUndo: canUndo,\n        canRedo: canRedo\n      };\n    }\n\n    var makeState = function (initialState) {\n      var blobState = Cell(initialState);\n      var tempState = Cell(Optional.none());\n      var undoStack = UndoStack();\n      undoStack.add(initialState);\n      var getBlobState = function () {\n        return blobState.get();\n      };\n      var setBlobState = function (state) {\n        blobState.set(state);\n      };\n      var getTempState = function () {\n        return tempState.get().fold(function () {\n          return blobState.get();\n        }, function (temp) {\n          return temp;\n        });\n      };\n      var updateTempState = function (blob) {\n        var newTempState = createState(blob);\n        destroyTempState();\n        tempState.set(Optional.some(newTempState));\n        return newTempState.url;\n      };\n      var createState = function (blob) {\n        return {\n          blob: blob,\n          url: URL.createObjectURL(blob)\n        };\n      };\n      var destroyState = function (state) {\n        URL.revokeObjectURL(state.url);\n      };\n      var destroyStates = function (states) {\n        global$e.each(states, destroyState);\n      };\n      var destroyTempState = function () {\n        tempState.get().each(destroyState);\n        tempState.set(Optional.none());\n      };\n      var addBlobState = function (blob) {\n        var newState = createState(blob);\n        setBlobState(newState);\n        var removed = undoStack.add(newState).removed;\n        destroyStates(removed);\n        return newState.url;\n      };\n      var addTempState = function (blob) {\n        var newState = createState(blob);\n        tempState.set(Optional.some(newState));\n        return newState.url;\n      };\n      var applyTempState = function (postApply) {\n        return tempState.get().fold(function () {\n        }, function (temp) {\n          addBlobState(temp.blob);\n          postApply();\n        });\n      };\n      var undo = function () {\n        var currentState = undoStack.undo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var redo = function () {\n        var currentState = undoStack.redo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var getHistoryStates = function () {\n        var undoEnabled = undoStack.canUndo();\n        var redoEnabled = undoStack.canRedo();\n        return {\n          undoEnabled: undoEnabled,\n          redoEnabled: redoEnabled\n        };\n      };\n      return {\n        getBlobState: getBlobState,\n        setBlobState: setBlobState,\n        addBlobState: addBlobState,\n        getTempState: getTempState,\n        updateTempState: updateTempState,\n        addTempState: addTempState,\n        applyTempState: applyTempState,\n        destroyTempState: destroyTempState,\n        undo: undo,\n        redo: redo,\n        getHistoryStates: getHistoryStates\n      };\n    };\n\n    var renderImageTools = function (detail, providersBackstage) {\n      var state = makeState(detail.currentState);\n      var zoom = function (anyInSystem, simulatedEvent) {\n        var direction = simulatedEvent.event.direction;\n        imagePanel.zoom(anyInSystem, direction);\n      };\n      var updateButtonUndoStates = function (anyInSystem) {\n        var historyStates = state.getHistoryStates();\n        sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.saveState(),\n          value: historyStates.undoEnabled\n        });\n      };\n      var disableUndoRedo = function (anyInSystem) {\n        sideBar.updateButtonUndoStates(anyInSystem, false, false);\n      };\n      var undo = function (anyInSystem, _simulatedEvent) {\n        var url = state.undo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var redo = function (anyInSystem, _simulatedEvent) {\n        var url = state.redo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var imageResultToBlob = function (ir) {\n        return ir.toBlob();\n      };\n      var block = function (anyInSystem) {\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.disable(),\n          value: {}\n        });\n      };\n      var unblock = function (anyInSystem) {\n        editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n          Disabling.enable(applyButton);\n        });\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.enable(),\n          value: {}\n        });\n      };\n      var updateSrc = function (anyInSystem, src) {\n        block(anyInSystem);\n        return imagePanel.updateSrc(anyInSystem, src);\n      };\n      var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n        block(anyInSystem);\n        return blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n          return updateSrc(anyInSystem, url).then(function (oImg) {\n            updateButtonUndoStates(anyInSystem);\n            swap();\n            unblock(anyInSystem);\n            return oImg;\n          });\n        }).catch(function (err) {\n          console.log(err);\n          unblock(anyInSystem);\n          return err;\n        });\n      };\n      var manipulate = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          return state.updateTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var tempManipulate = function (anyInSystem, filter) {\n        var blob = state.getTempState().blob;\n        var action = function (blob) {\n          return state.addTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, noop);\n      };\n      var manipulateApply = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          var url = state.addBlobState(blob);\n          destroyTempState(anyInSystem);\n          return url;\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var apply = function (anyInSystem, simulatedEvent) {\n        var postApply = function () {\n          destroyTempState(anyInSystem);\n          var swap = simulatedEvent.event.swap;\n          swap();\n        };\n        state.applyTempState(postApply);\n      };\n      var destroyTempState = function (anyInSystem) {\n        var currentUrl = state.getBlobState().url;\n        state.destroyTempState();\n        updateButtonUndoStates(anyInSystem);\n        return currentUrl;\n      };\n      var cancel = function (anyInSystem) {\n        var currentUrl = destroyTempState(anyInSystem);\n        updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n          unblock(anyInSystem);\n        });\n      };\n      var back = function (anyInSystem, simulatedEvent) {\n        cancel(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n        imagePanel.hideCrop();\n      };\n      var transform = function (anyInSystem, simulatedEvent) {\n        return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n      };\n      var tempTransform = function (anyInSystem, simulatedEvent) {\n        return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n      };\n      var transformApply = function (anyInSystem, simulatedEvent) {\n        return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n      };\n      var imagePanel = renderImagePanel(detail.currentState.url);\n      var sideBar = renderSideBar(providersBackstage);\n      var editPanel = renderEditPanel(imagePanel, providersBackstage);\n      var swap = function (anyInSystem, simulatedEvent) {\n        disableUndoRedo(anyInSystem);\n        var transform = simulatedEvent.event.transform;\n        var swap = simulatedEvent.event.swap;\n        transform.fold(function () {\n          swap();\n        }, function (transform) {\n          manipulate(anyInSystem, transform, swap);\n        });\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' }\n        },\n        components: [\n          editPanel.memContainer.asSpec(),\n          imagePanel.memContainer.asSpec(),\n          sideBar.container\n        ],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return state.getBlobState();\n              }\n            }\n          }),\n          config('image-tools-events', [\n            run(internal.undo(), undo),\n            run(internal.redo(), redo),\n            run(internal.zoom(), zoom),\n            run(internal.back(), back),\n            run(internal.apply(), apply),\n            run(internal.transform(), transform),\n            run(internal.tempTransform(), tempTransform),\n            run(internal.transformApply(), transformApply),\n            run(internal.swap(), swap)\n          ]),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var renderLabel$2 = function (spec, backstageShared) {\n      var label = {\n        dom: {\n          tag: 'label',\n          innerHtml: backstageShared.providers.translate(spec.label),\n          classes: ['tox-label']\n        }\n      };\n      var comps = map(spec.items, backstageShared.interpreter);\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [label].concat(comps),\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Replacing.config({}),\n          RepresentingConfigs.domHtml(Optional.none()),\n          Keying.config({ mode: 'acyclic' })\n        ])\n      };\n    };\n\n    var isSingleListItem = function (item) {\n      return !has(item, 'items');\n    };\n    var dataAttribute = 'data-value';\n    var fetchItems = function (dropdownComp, name, items, selectedValue) {\n      return map(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return {\n            type: 'nestedmenuitem',\n            text: item.text,\n            getSubmenuItems: function () {\n              return fetchItems(dropdownComp, name, item.items, selectedValue);\n            }\n          };\n        } else {\n          return {\n            type: 'togglemenuitem',\n            text: item.text,\n            value: item.value,\n            active: item.value === selectedValue,\n            onAction: function () {\n              Representing.setValue(dropdownComp, item.value);\n              emitWith(dropdownComp, formChangeEvent, { name: name });\n              Focusing.focus(dropdownComp);\n            }\n          };\n        }\n      });\n    };\n    var findItemByValue = function (items, value) {\n      return findMap(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return findItemByValue(item.items, value);\n        } else {\n          return someIf(item.value === value, item);\n        }\n      });\n    };\n    var renderListBox = function (spec, backstage) {\n      var providersBackstage = backstage.shared.providers;\n      var initialItem = head(spec.items).filter(isSingleListItem);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        factory: {\n          sketch: function (sketchSpec) {\n            return renderCommonDropdown({\n              uid: sketchSpec.uid,\n              text: initialItem.map(function (item) {\n                return item.text;\n              }),\n              icon: Optional.none(),\n              tooltip: spec.label,\n              role: Optional.none(),\n              fetch: function (comp, callback) {\n                var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n                callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n              },\n              onSetup: constant(noop),\n              getApi: constant({}),\n              columns: 1,\n              presets: 'normal',\n              classes: [],\n              dropdownBehaviours: [\n                Tabstopping.config({}),\n                Representing.config({\n                  store: {\n                    mode: 'manual',\n                    initialValue: initialItem.map(function (item) {\n                      return item.value;\n                    }).getOr(''),\n                    getValue: function (comp) {\n                      return get$2(comp.element, dataAttribute);\n                    },\n                    setValue: function (comp, data) {\n                      findItemByValue(spec.items, data).each(function (item) {\n                        set$1(comp.element, dataAttribute, item.value);\n                        emitWith(comp, updateMenuText, { text: item.text });\n                      });\n                    }\n                  }\n                })\n              ]\n            }, 'tox-listbox', backstage.shared);\n          }\n        }\n      });\n      var listBoxWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-listboxfield']\n        },\n        components: [pField]\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [listBoxWrap]\n        ]),\n        fieldBehaviours: derive$1([Disabling.config({\n            disabled: constant(spec.disabled),\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          })])\n      });\n    };\n\n    var renderPanel = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: spec.classes\n        },\n        components: map(spec.items, backstage.shared.interpreter)\n      };\n    };\n\n    var factory$8 = function (detail, _spec) {\n      var options = map(detail.options, function (option) {\n        return {\n          dom: {\n            tag: 'option',\n            value: option.value,\n            innerHtml: option.text\n          }\n        };\n      });\n      var initialValues = detail.data.map(function (v) {\n        return wrap$1('initialValue', v);\n      }).getOr({});\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'select',\n          classes: detail.selectClasses,\n          attributes: detail.selectAttributes\n        },\n        components: options,\n        behaviours: augment(detail.selectBehaviours, [\n          Focusing.config({}),\n          Representing.config({\n            store: __assign({\n              mode: 'manual',\n              getValue: function (select) {\n                return get$5(select.element);\n              },\n              setValue: function (select, newValue) {\n                var found = find(detail.options, function (opt) {\n                  return opt.value === newValue;\n                });\n                if (found.isSome()) {\n                  set$3(select.element, newValue);\n                }\n              }\n            }, initialValues)\n          })\n        ])\n      };\n    };\n    var HtmlSelect = single$2({\n      name: 'HtmlSelect',\n      configFields: [\n        strict$1('options'),\n        field$1('selectBehaviours', [\n          Focusing,\n          Representing\n        ]),\n        defaulted$1('selectClasses', []),\n        defaulted$1('selectAttributes', {}),\n        option('data')\n      ],\n      factory: factory$8\n    });\n\n    var renderSelectBox = function (spec, providersBackstage) {\n      var translatedOptions = map(spec.items, function (item) {\n        return {\n          text: providersBackstage.translate(item.text),\n          value: item.value\n        };\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        selectAttributes: { size: spec.size },\n        options: translatedOptions,\n        factory: HtmlSelect,\n        selectBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            }\n          }),\n          Tabstopping.config({}),\n          config('selectbox-change', [run(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var chevron = spec.size > 1 ? Optional.none() : Optional.some({\n        dom: {\n          tag: 'div',\n          classes: ['tox-selectfield__icon-js'],\n          innerHtml: get$d('chevron-down', providersBackstage.icons)\n        }\n      });\n      var selectWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-selectfield']\n        },\n        components: flatten([\n          [pField],\n          chevron.toArray()\n        ])\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [selectWrap]\n        ]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderTable = function (spec, providersBackstage) {\n      var renderTh = function (text) {\n        return {\n          dom: {\n            tag: 'th',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderHeader = function (header) {\n        return {\n          dom: { tag: 'thead' },\n          components: [{\n              dom: { tag: 'tr' },\n              components: map(header, renderTh)\n            }]\n        };\n      };\n      var renderTd = function (text) {\n        return {\n          dom: {\n            tag: 'td',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderTr = function (row) {\n        return {\n          dom: { tag: 'tr' },\n          components: map(row, renderTd)\n        };\n      };\n      var renderRows = function (rows) {\n        return {\n          dom: { tag: 'tbody' },\n          components: map(rows, renderTr)\n        };\n      };\n      return {\n        dom: {\n          tag: 'table',\n          classes: ['tox-dialog__table']\n        },\n        components: [\n          renderHeader(spec.header),\n          renderRows(spec.cells)\n        ],\n        behaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n\n    var renderTextField = function (spec, providersBackstage) {\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var baseInputBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isReadOnly();\n          }\n        }),\n        receivingConfig(),\n        Keying.config({\n          mode: 'execution',\n          useEnter: spec.multiline !== true,\n          useControlEnter: spec.multiline === true,\n          execute: function (comp) {\n            emit(comp, formSubmitEvent);\n            return Optional.some(true);\n          }\n        }),\n        config('textfield-change', [\n          run(input(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          }),\n          run(postPaste(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          })\n        ]),\n        Tabstopping.config({})\n      ];\n      var validatingBehaviours = spec.validation.map(function (vl) {\n        return Invalidating.config({\n          getRoot: function (input) {\n            return parent(input.element);\n          },\n          invalidClass: 'tox-invalid',\n          validator: {\n            validate: function (input) {\n              var v = Representing.getValue(input);\n              var result = vl.validator(v);\n              return Future.pure(result === true ? Result.value(v) : Result.error(result));\n            },\n            validateOnLoad: vl.validateOnLoad\n          }\n        });\n      }).toArray();\n      var placeholder = spec.placeholder.fold(constant({}), function (p) {\n        return { placeholder: providersBackstage.translate(p) };\n      });\n      var inputMode = spec.inputMode.fold(constant({}), function (mode) {\n        return { inputmode: mode };\n      });\n      var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n      var pField = FormField.parts.field({\n        tag: spec.multiline === true ? 'textarea' : 'input',\n        inputAttributes: inputAttributes,\n        inputClasses: [spec.classname],\n        inputBehaviours: derive$1(flatten([\n          baseInputBehaviours,\n          validatingBehaviours\n        ])),\n        selectOnFocus: false,\n        factory: Input\n      });\n      var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n      var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n      var extraBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isReadOnly();\n          },\n          onDisabled: function (comp) {\n            FormField.getField(comp).each(Disabling.disable);\n          },\n          onEnabled: function (comp) {\n            FormField.getField(comp).each(Disabling.enable);\n          }\n        }),\n        receivingConfig()\n      ];\n      return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n    };\n    var renderInput = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: false,\n        label: spec.label,\n        inputMode: spec.inputMode,\n        placeholder: spec.placeholder,\n        flex: false,\n        disabled: spec.disabled,\n        classname: 'tox-textfield',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n    var renderTextarea = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: true,\n        label: spec.label,\n        inputMode: Optional.none(),\n        placeholder: spec.placeholder,\n        flex: true,\n        disabled: spec.disabled,\n        classname: 'tox-textarea',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n\n    var events$c = function (streamConfig, streamState) {\n      var streams = streamConfig.stream.streams;\n      var processor = streams.setup(streamConfig, streamState);\n      return derive([\n        run(streamConfig.event, processor),\n        runOnDetached(function () {\n          return streamState.cancel();\n        })\n      ].concat(streamConfig.cancelEvent.map(function (e) {\n        return [run(e, function () {\n            return streamState.cancel();\n          })];\n      }).getOr([])));\n    };\n\n    var ActiveStreaming = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$c\n    });\n\n    var throttle = function (_config) {\n      var state = Cell(null);\n      var readState = function () {\n        return { timer: state.get() !== null ? 'set' : 'unset' };\n      };\n      var setTimer = function (t) {\n        state.set(t);\n      };\n      var cancel = function () {\n        var t = state.get();\n        if (t !== null) {\n          t.cancel();\n        }\n      };\n      return nu$5({\n        readState: readState,\n        setTimer: setTimer,\n        cancel: cancel\n      });\n    };\n    var init$6 = function (spec) {\n      return spec.stream.streams.state(spec);\n    };\n\n    var StreamingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        throttle: throttle,\n        init: init$6\n    });\n\n    var setup$2 = function (streamInfo, streamState) {\n      var sInfo = streamInfo.stream;\n      var throttler = last$2(streamInfo.onStream, sInfo.delay);\n      streamState.setTimer(throttler);\n      return function (component, simulatedEvent) {\n        throttler.throttle(component, simulatedEvent);\n        if (sInfo.stopEvent) {\n          simulatedEvent.stop();\n        }\n      };\n    };\n    var StreamingSchema = [\n      strictOf('stream', choose$1('mode', {\n        throttle: [\n          strict$1('delay'),\n          defaulted$1('stopEvent', true),\n          output('streams', {\n            setup: setup$2,\n            state: throttle\n          })\n        ]\n      })),\n      defaulted$1('event', 'input'),\n      option('cancelEvent'),\n      onStrictHandler('onStream')\n    ];\n\n    var Streaming = create$1({\n      fields: StreamingSchema,\n      name: 'streaming',\n      active: ActiveStreaming,\n      state: StreamingState\n    });\n\n    var setValueFromItem = function (model, input, item) {\n      var itemData = Representing.getValue(item);\n      Representing.setValue(input, itemData);\n      setCursorAtEnd(input);\n    };\n    var setSelectionOn = function (input, f) {\n      var el = input.element;\n      var value = get$5(el);\n      var node = el.dom;\n      if (get$2(el, 'type') !== 'number') {\n        f(node, value);\n      }\n    };\n    var setCursorAtEnd = function (input) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(value.length, value.length);\n      });\n    };\n    var setSelectionToEnd = function (input, startOffset) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(startOffset, value.length);\n      });\n    };\n    var attemptSelectOver = function (model, input, item) {\n      if (!model.selectsOver) {\n        return Optional.none();\n      } else {\n        var currentValue = Representing.getValue(input);\n        var inputDisplay_1 = model.getDisplayText(currentValue);\n        var itemValue = Representing.getValue(item);\n        var itemDisplay = model.getDisplayText(itemValue);\n        return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n          setValueFromItem(model, input, item);\n          setSelectionToEnd(input, inputDisplay_1.length);\n        }) : Optional.none();\n      }\n    };\n\n    var itemExecute = constant('alloy.typeahead.itemexecute');\n\n    var make$5 = function (detail, components, spec, externals) {\n      var navigateList = function (comp, simulatedEvent, highlighter) {\n        detail.previewing.set(false);\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        if (Sandboxing.isOpen(sandbox)) {\n          Composing.getCurrent(sandbox).each(function (menu) {\n            Highlighting.getHighlighted(menu).fold(function () {\n              highlighter(menu);\n            }, function () {\n              dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n            });\n          });\n        } else {\n          var onOpenSync = function (sandbox) {\n            Composing.getCurrent(sandbox).each(highlighter);\n          };\n          open$1(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      };\n      var focusBehaviours$1 = focusBehaviours(detail);\n      var mapFetch = function (comp) {\n        return function (tdata) {\n          return tdata.map(function (data) {\n            var menus = values(data.menus);\n            var items = bind(menus, function (menu) {\n              return filter(menu.items, function (item) {\n                return item.type === 'item';\n              });\n            });\n            var repState = Representing.getState(comp);\n            repState.update(map(items, function (item) {\n              return item.data;\n            }));\n            return data;\n          });\n        };\n      };\n      var behaviours = [\n        Focusing.config({}),\n        Representing.config({\n          onSetValue: detail.onSetValue,\n          store: __assign({\n            mode: 'dataset',\n            getDataKey: function (comp) {\n              return get$5(comp.element);\n            },\n            getFallbackEntry: function (itemString) {\n              return {\n                value: itemString,\n                meta: {}\n              };\n            },\n            setValue: function (comp, data) {\n              set$3(comp.element, detail.model.getDisplayText(data));\n            }\n          }, detail.initialData.map(function (d) {\n            return wrap$1('initialValue', d);\n          }).getOr({}))\n        }),\n        Streaming.config({\n          stream: {\n            mode: 'throttle',\n            delay: detail.responseTime,\n            stopEvent: false\n          },\n          onStream: function (component, _simulatedEvent) {\n            var sandbox = Coupling.getCoupled(component, 'sandbox');\n            var focusInInput = Focusing.isFocused(component);\n            if (focusInInput) {\n              if (get$5(component.element).length >= detail.minChars) {\n                var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n                  return Highlighting.getHighlighted(menu).map(Representing.getValue);\n                });\n                detail.previewing.set(true);\n                var onOpenSync = function (_sandbox) {\n                  Composing.getCurrent(sandbox).each(function (menu) {\n                    previousValue_1.fold(function () {\n                      if (detail.model.selectsOver) {\n                        Highlighting.highlightFirst(menu);\n                      }\n                    }, function (pv) {\n                      Highlighting.highlightBy(menu, function (item) {\n                        var itemData = Representing.getValue(item);\n                        return itemData.value === pv.value;\n                      });\n                      Highlighting.getHighlighted(menu).orThunk(function () {\n                        Highlighting.highlightFirst(menu);\n                        return Optional.none();\n                      });\n                    });\n                  });\n                };\n                open$1(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n              }\n            }\n          },\n          cancelEvent: typeaheadCancel()\n        }),\n        Keying.config({\n          mode: 'special',\n          onDown: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n            return Optional.some(true);\n          },\n          onEscape: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            if (Sandboxing.isOpen(sandbox)) {\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n            return Optional.none();\n          },\n          onUp: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n            return Optional.some(true);\n          },\n          onEnter: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n            if (sandboxIsOpen && !detail.previewing.get()) {\n              return Composing.getCurrent(sandbox).bind(function (menu) {\n                return Highlighting.getHighlighted(menu);\n              }).map(function (item) {\n                emitWith(comp, itemExecute(), { item: item });\n                return true;\n              });\n            } else {\n              var currentValue = Representing.getValue(comp);\n              emit(comp, typeaheadCancel());\n              detail.onExecute(sandbox, comp, currentValue);\n              if (sandboxIsOpen) {\n                Sandboxing.close(sandbox);\n              }\n              return Optional.some(true);\n            }\n          }\n        }),\n        Toggling.config({\n          toggleClass: detail.markers.openClass,\n          aria: { mode: 'expanded' }\n        }),\n        Coupling.config({\n          others: {\n            sandbox: function (hotspot) {\n              return makeSandbox(detail, hotspot, {\n                onOpen: function () {\n                  return Toggling.on(hotspot);\n                },\n                onClose: function () {\n                  return Toggling.off(hotspot);\n                }\n              });\n            }\n          }\n        }),\n        config('typeaheadevents', [\n          runOnExecute(function (comp) {\n            var onOpenSync = noop;\n            togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }),\n          run(itemExecute(), function (comp, se) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            setValueFromItem(detail.model, comp, se.event.item);\n            emit(comp, typeaheadCancel());\n            detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n            Sandboxing.close(sandbox);\n            setCursorAtEnd(comp);\n          })\n        ].concat(detail.dismissOnBlur ? [run(postBlur(), function (typeahead) {\n            var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n            if (search(sandbox.element).isNone()) {\n              Sandboxing.close(sandbox);\n            }\n          })] : []))\n      ];\n      return {\n        uid: detail.uid,\n        dom: dom$2(deepMerge(detail, {\n          inputAttributes: {\n            'role': 'combobox',\n            'aria-autocomplete': 'list',\n            'aria-haspopup': 'true'\n          }\n        })),\n        behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n        eventOrder: detail.eventOrder\n      };\n    };\n\n    var schema$j = constant([\n      option('lazySink'),\n      strict$1('fetch'),\n      defaulted$1('minChars', 5),\n      defaulted$1('responseTime', 1000),\n      onHandler('onOpen'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      defaulted$1('layouts', Optional.none()),\n      defaulted$1('eventOrder', {}),\n      defaultedObjOf('model', {}, [\n        defaulted$1('getDisplayText', function (itemData) {\n          return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n        }),\n        defaulted$1('selectsOver', true),\n        defaulted$1('populateFromBrowse', true)\n      ]),\n      onHandler('onSetValue'),\n      onKeyboardHandler('onExecute'),\n      onHandler('onItemExecute'),\n      defaulted$1('inputClasses', []),\n      defaulted$1('inputAttributes', {}),\n      defaulted$1('inputStyles', {}),\n      defaulted$1('matchWidth', true),\n      defaulted$1('useMinWidth', false),\n      defaulted$1('dismissOnBlur', true),\n      markers(['openClass']),\n      option('initialData'),\n      field$1('typeaheadBehaviours', [\n        Focusing,\n        Representing,\n        Streaming,\n        Keying,\n        Toggling,\n        Coupling\n      ]),\n      state$1('previewing', function () {\n        return Cell(true);\n      })\n    ].concat(schema$f()).concat(sandboxFields()));\n    var parts$6 = constant([external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        overrides: function (detail) {\n          return {\n            fakeFocus: true,\n            onHighlight: function (menu, item) {\n              if (!detail.previewing.get()) {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  if (detail.model.populateFromBrowse) {\n                    setValueFromItem(detail.model, input, item);\n                  }\n                });\n              } else {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  attemptSelectOver(detail.model, input, item).fold(function () {\n                    return Highlighting.dehighlight(menu, item);\n                  }, function (fn) {\n                    return fn();\n                  });\n                });\n              }\n              detail.previewing.set(false);\n            },\n            onExecute: function (menu, item) {\n              return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n                emitWith(typeahead, itemExecute(), { item: item });\n                return true;\n              });\n            },\n            onHover: function (menu, item) {\n              detail.previewing.set(false);\n              menu.getSystem().getByUid(detail.uid).each(function (input) {\n                if (detail.model.populateFromBrowse) {\n                  setValueFromItem(detail.model, input, item);\n                }\n              });\n            }\n          };\n        }\n      })]);\n\n    var Typeahead = composite$1({\n      name: 'Typeahead',\n      configFields: schema$j(),\n      partFields: parts$6(),\n      factory: make$5\n    });\n\n    var wrap$2 = function (delegate) {\n      var toCached = function () {\n        return wrap$2(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap$2(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap$2(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign(__assign({}, delegate), {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$c = function (worker) {\n      return wrap$2(Future.nu(worker));\n    };\n    var value$2 = function (value) {\n      return wrap$2(Future.pure(Result.value(value)));\n    };\n    var error$1 = function (error) {\n      return wrap$2(Future.pure(Result.error(error)));\n    };\n    var fromResult$1 = function (result) {\n      return wrap$2(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap$2(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$c(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$c,\n      wrap: wrap$2,\n      pure: value$2,\n      value: value$2,\n      error: error$1,\n      fromResult: fromResult$1,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var separator$2 = { type: 'separator' };\n    var toMenuItem = function (target) {\n      return {\n        type: 'menuitem',\n        value: target.url,\n        text: target.title,\n        meta: { attach: target.attach },\n        onAction: function () {\n        }\n      };\n    };\n    var staticMenuItem = function (title, url) {\n      return {\n        type: 'menuitem',\n        value: url,\n        text: title,\n        meta: { attach: undefined },\n        onAction: function () {\n        }\n      };\n    };\n    var toMenuItems = function (targets) {\n      return map(targets, toMenuItem);\n    };\n    var filterLinkTargets = function (type, targets) {\n      return filter(targets, function (target) {\n        return target.type === type;\n      });\n    };\n    var filteredTargets = function (type, targets) {\n      return toMenuItems(filterLinkTargets(type, targets));\n    };\n    var headerTargets = function (linkInfo) {\n      return filteredTargets('header', linkInfo.targets);\n    };\n    var anchorTargets = function (linkInfo) {\n      return filteredTargets('anchor', linkInfo.targets);\n    };\n    var anchorTargetTop = function (linkInfo) {\n      return Optional.from(linkInfo.anchorTop).map(function (url) {\n        return staticMenuItem('<top>', url);\n      }).toArray();\n    };\n    var anchorTargetBottom = function (linkInfo) {\n      return Optional.from(linkInfo.anchorBottom).map(function (url) {\n        return staticMenuItem('<bottom>', url);\n      }).toArray();\n    };\n    var historyTargets = function (history) {\n      return map(history, function (url) {\n        return staticMenuItem(url, url);\n      });\n    };\n    var joinMenuLists = function (items) {\n      return foldl(items, function (a, b) {\n        var bothEmpty = a.length === 0 || b.length === 0;\n        return bothEmpty ? a.concat(b) : a.concat(separator$2, b);\n      }, []);\n    };\n    var filterByQuery = function (term, menuItems) {\n      var lowerCaseTerm = term.toLowerCase();\n      return filter(menuItems, function (item) {\n        var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n        return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n      });\n    };\n\n    var getItems = function (fileType, input, urlBackstage) {\n      var urlInputValue = Representing.getValue(input);\n      var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n      var info = urlBackstage.getLinkInformation();\n      return info.fold(function () {\n        return [];\n      }, function (linkInfo) {\n        var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n        return fileType === 'file' ? joinMenuLists([\n          history,\n          filterByQuery(term, headerTargets(linkInfo)),\n          filterByQuery(term, flatten([\n            anchorTargetTop(linkInfo),\n            anchorTargets(linkInfo),\n            anchorTargetBottom(linkInfo)\n          ]))\n        ]) : history;\n      });\n    };\n    var errorId = generate$1('aria-invalid');\n    var renderUrlInput = function (spec, backstage, urlBackstage) {\n      var _a;\n      var providersBackstage = backstage.shared.providers;\n      var updateHistory = function (component) {\n        var urlEntry = Representing.getValue(component);\n        urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n      };\n      var pField = FormField.parts.field({\n        factory: Typeahead,\n        dismissOnBlur: true,\n        inputClasses: ['tox-textfield'],\n        sandboxClasses: ['tox-dialog__popups'],\n        inputAttributes: {\n          'aria-errormessage': errorId,\n          'type': 'url'\n        },\n        minChars: 0,\n        responseTime: 0,\n        fetch: function (input) {\n          var items = getItems(spec.filetype, input, urlBackstage);\n          var tdata = build$2(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n          return Future.pure(tdata);\n        },\n        getHotspot: function (comp) {\n          return memUrlBox.getOpt(comp);\n        },\n        onSetValue: function (comp, _newValue) {\n          if (comp.hasConfigured(Invalidating)) {\n            Invalidating.run(comp).get(noop);\n          }\n        },\n        typeaheadBehaviours: derive$1(flatten([\n          urlBackstage.getValidationHandler().map(function (handler) {\n            return Invalidating.config({\n              getRoot: function (comp) {\n                return parent(comp.element);\n              },\n              invalidClass: 'tox-control-wrap--status-invalid',\n              notify: {\n                onInvalid: function (comp, err) {\n                  memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                    set$1(invalidComp.element, 'title', providersBackstage.translate(err));\n                  });\n                }\n              },\n              validator: {\n                validate: function (input) {\n                  var urlEntry = Representing.getValue(input);\n                  return FutureResult.nu(function (completer) {\n                    handler({\n                      type: spec.filetype,\n                      url: urlEntry.value\n                    }, function (validation) {\n                      if (validation.status === 'invalid') {\n                        var err = Result.error(validation.message);\n                        completer(err);\n                      } else {\n                        var val = Result.value(validation.message);\n                        completer(val);\n                      }\n                    });\n                  });\n                },\n                validateOnLoad: false\n              }\n            });\n          }).toArray(),\n          [\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isReadOnly();\n              }\n            }),\n            Tabstopping.config({}),\n            config('urlinput-events', flatten([\n              spec.filetype === 'file' ? [run(input(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                })] : [],\n              [\n                run(change(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                }),\n                run(postPaste(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                })\n              ]\n            ]))\n          ]\n        ])),\n        eventOrder: (_a = {}, _a[input()] = [\n          'streaming',\n          'urlinput-events',\n          'invalidating'\n        ], _a),\n        model: {\n          getDisplayText: function (itemData) {\n            return itemData.value;\n          },\n          selectsOver: false,\n          populateFromBrowse: false\n        },\n        markers: { openClass: 'tox-textfield--popup-open' },\n        lazySink: backstage.shared.getSink,\n        parts: { menu: part(false, 1, 'normal') },\n        onExecute: function (_menu, component, _entry) {\n          emitWith(component, formSubmitEvent, {});\n        },\n        onItemExecute: function (typeahead, _sandbox, _item, _value) {\n          updateHistory(typeahead);\n          emitWith(typeahead, formChangeEvent, { name: spec.name });\n        }\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var makeIcon = function (name, errId, icon, label) {\n        if (icon === void 0) {\n          icon = name;\n        }\n        if (label === void 0) {\n          label = name;\n        }\n        return {\n          dom: {\n            tag: 'div',\n            classes: [\n              'tox-icon',\n              'tox-control-wrap__status-icon-' + name\n            ],\n            innerHtml: get$d(icon, providersBackstage.icons),\n            attributes: __assign({\n              'title': providersBackstage.translate(label),\n              'aria-live': 'polite'\n            }, errId.fold(function () {\n              return {};\n            }, function (id) {\n              return { id: id };\n            }))\n          }\n        };\n      };\n      var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n      var memStatus = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap__status-icon-wrap']\n        },\n        components: [memInvalidIcon.asSpec()]\n      });\n      var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n      var browseUrlEvent = generate$1('browser.url.event');\n      var memUrlBox = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap']\n        },\n        components: [\n          pField,\n          memStatus.asSpec()\n        ],\n        behaviours: derive$1([Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            }\n          })])\n      });\n      var memUrlPickerButton = record(renderButton({\n        name: spec.name,\n        icon: Optional.some('browse'),\n        text: spec.label.getOr(''),\n        disabled: spec.disabled,\n        primary: false,\n        borderless: true\n      }, function (component) {\n        return emit(component, browseUrlEvent);\n      }, providersBackstage, [], ['tox-browse-url']));\n      var controlHWrapper = function () {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__controls-h-stack']\n          },\n          components: flatten([\n            [memUrlBox.asSpec()],\n            optUrlPicker.map(function () {\n              return memUrlPickerButton.asSpec();\n            }).toArray()\n          ])\n        };\n      };\n      var openUrlPicker = function (comp) {\n        Composing.getCurrent(comp).each(function (field) {\n          var componentData = Representing.getValue(field);\n          var urlData = __assign({ fieldname: spec.name }, componentData);\n          optUrlPicker.each(function (picker) {\n            picker(urlData).get(function (chosenData) {\n              Representing.setValue(field, chosenData);\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            });\n          });\n        });\n      };\n      return FormField.sketch({\n        dom: renderFormFieldDom(),\n        components: pLabel.toArray().concat([controlHWrapper()]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isReadOnly();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('url-input-events', [run(browseUrlEvent, openUrlPicker)])\n        ])\n      });\n    };\n\n    var renderAlertBanner = function (spec, providersBackstage) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: [\n            'tox-notification',\n            'tox-notification--in',\n            'tox-notification--' + spec.level\n          ]\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__icon']\n            },\n            components: [Button.sketch({\n                dom: {\n                  tag: 'button',\n                  classes: [\n                    'tox-button',\n                    'tox-button--naked',\n                    'tox-button--icon'\n                  ],\n                  innerHtml: get$d(spec.icon, providersBackstage.icons),\n                  attributes: { title: providersBackstage.translate(spec.iconTooltip) }\n                },\n                action: function (comp) {\n                  emitWith(comp, formActionEvent, {\n                    name: 'alert-banner',\n                    value: spec.url\n                  });\n                }\n              })]\n          },\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__body'],\n              innerHtml: providersBackstage.translate(spec.text)\n            }\n          }\n        ]\n      });\n    };\n\n    var renderCheckbox = function (spec, providerBackstage) {\n      var repBehaviour = Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var el = comp.element.dom;\n            return el.checked;\n          },\n          setValue: function (comp, value) {\n            var el = comp.element.dom;\n            el.checked = value;\n          }\n        }\n      });\n      var toggleCheckboxHandler = function (comp) {\n        comp.element.dom.click();\n        return Optional.some(true);\n      };\n      var pField = FormField.parts.field({\n        factory: { sketch: identity },\n        dom: {\n          tag: 'input',\n          classes: ['tox-checkbox__input'],\n          attributes: { type: 'checkbox' }\n        },\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isReadOnly();\n            }\n          }),\n          Tabstopping.config({}),\n          Focusing.config({}),\n          repBehaviour,\n          Keying.config({\n            mode: 'special',\n            onEnter: toggleCheckboxHandler,\n            onSpace: toggleCheckboxHandler,\n            stopSpaceKeyup: true\n          }),\n          config('checkbox-events', [run(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'span',\n          classes: ['tox-checkbox__label'],\n          innerHtml: providerBackstage.translate(spec.label)\n        },\n        behaviours: derive$1([Unselecting.config({})])\n      });\n      var makeIcon = function (className) {\n        var iconName = className === 'checked' ? 'selected' : 'unselected';\n        return {\n          dom: {\n            tag: 'span',\n            classes: [\n              'tox-icon',\n              'tox-checkbox-icon__' + className\n            ],\n            innerHtml: get$d(iconName, providerBackstage.icons)\n          }\n        };\n      };\n      var memIcons = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-checkbox__icons']\n        },\n        components: [\n          makeIcon('checked'),\n          makeIcon('unchecked')\n        ]\n      });\n      return FormField.sketch({\n        dom: {\n          tag: 'label',\n          classes: ['tox-checkbox']\n        },\n        components: [\n          pField,\n          memIcons.asSpec(),\n          pLabel\n        ],\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isReadOnly();\n            },\n            disableClass: 'tox-checkbox--disabled',\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderHtmlPanel = function (spec) {\n      if (spec.presets === 'presentation') {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html\n          }\n        });\n      } else {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html,\n            attributes: { role: 'document' }\n          },\n          containerBehaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({})\n          ])\n        });\n      }\n    };\n\n    var make$6 = function (render) {\n      return function (parts, spec, backstage) {\n        return get(spec, 'name').fold(function () {\n          return render(spec, backstage);\n        }, function (fieldName) {\n          return parts.field(fieldName, render(spec, backstage));\n        });\n      };\n    };\n    var makeIframe = function (render) {\n      return function (parts, spec, backstage) {\n        var iframeSpec = deepMerge(spec, { source: 'dynamic' });\n        return make$6(render)(parts, iframeSpec, backstage);\n      };\n    };\n    var factories = {\n      bar: make$6(function (spec, backstage) {\n        return renderBar(spec, backstage.shared);\n      }),\n      collection: make$6(function (spec, backstage) {\n        return renderCollection(spec, backstage.shared.providers);\n      }),\n      alertbanner: make$6(function (spec, backstage) {\n        return renderAlertBanner(spec, backstage.shared.providers);\n      }),\n      input: make$6(function (spec, backstage) {\n        return renderInput(spec, backstage.shared.providers);\n      }),\n      textarea: make$6(function (spec, backstage) {\n        return renderTextarea(spec, backstage.shared.providers);\n      }),\n      label: make$6(function (spec, backstage) {\n        return renderLabel$2(spec, backstage.shared);\n      }),\n      iframe: makeIframe(function (spec, backstage) {\n        return renderIFrame(spec, backstage.shared.providers);\n      }),\n      button: make$6(function (spec, backstage) {\n        return renderDialogButton(spec, backstage.shared.providers);\n      }),\n      checkbox: make$6(function (spec, backstage) {\n        return renderCheckbox(spec, backstage.shared.providers);\n      }),\n      colorinput: make$6(function (spec, backstage) {\n        return renderColorInput(spec, backstage.shared, backstage.colorinput);\n      }),\n      colorpicker: make$6(renderColorPicker),\n      dropzone: make$6(function (spec, backstage) {\n        return renderDropZone(spec, backstage.shared.providers);\n      }),\n      grid: make$6(function (spec, backstage) {\n        return renderGrid(spec, backstage.shared);\n      }),\n      listbox: make$6(function (spec, backstage) {\n        return renderListBox(spec, backstage);\n      }),\n      selectbox: make$6(function (spec, backstage) {\n        return renderSelectBox(spec, backstage.shared.providers);\n      }),\n      sizeinput: make$6(function (spec, backstage) {\n        return renderSizeInput(spec, backstage.shared.providers);\n      }),\n      urlinput: make$6(function (spec, backstage) {\n        return renderUrlInput(spec, backstage, backstage.urlinput);\n      }),\n      customeditor: make$6(renderCustomEditor),\n      htmlpanel: make$6(renderHtmlPanel),\n      imagetools: make$6(function (spec, backstage) {\n        return renderImageTools(spec, backstage.shared.providers);\n      }),\n      table: make$6(function (spec, backstage) {\n        return renderTable(spec, backstage.shared.providers);\n      }),\n      panel: make$6(function (spec, backstage) {\n        return renderPanel(spec, backstage);\n      })\n    };\n    var noFormParts = {\n      field: function (_name, spec) {\n        return spec;\n      }\n    };\n    var interpretInForm = function (parts, spec, oldBackstage) {\n      var newBackstage = deepMerge(oldBackstage, {\n        shared: {\n          interpreter: function (childSpec) {\n            return interpretParts(parts, childSpec, newBackstage);\n          }\n        }\n      });\n      return interpretParts(parts, spec, newBackstage);\n    };\n    var interpretParts = function (parts, spec, backstage) {\n      return get(factories, spec.type).fold(function () {\n        console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n        return spec;\n      }, function (factory) {\n        return factory(parts, spec, backstage);\n      });\n    };\n    var interpretWithoutForm = function (spec, backstage) {\n      var parts = noFormParts;\n      return interpretParts(parts, spec, backstage);\n    };\n\n    var bubbleAlignments = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: [],\n      alignRight: [],\n      right: [],\n      left: [],\n      bottom: [],\n      top: []\n    };\n    var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var bubble = nu$8(-12, 12, bubbleAlignments);\n      var overrides = { maxHeightFunction: expandable() };\n      var editableAreaAnchor = function () {\n        return {\n          anchor: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          bubble: bubble,\n          layouts: {\n            onRtl: function () {\n              return [northwest$3];\n            },\n            onLtr: function () {\n              return [northeast$3];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          anchor: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          bubble: bubble,\n          layouts: {\n            onRtl: function () {\n              return [southeast$1];\n            },\n            onLtr: function () {\n              return [southwest$1];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var editableAreaAnchor = function () {\n        return {\n          anchor: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          layouts: {\n            onRtl: function () {\n              return [north$3];\n            },\n            onLtr: function () {\n              return [north$3];\n            }\n          }\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          anchor: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          layouts: {\n            onRtl: function () {\n              return [south$1];\n            },\n            onLtr: function () {\n              return [south$1];\n            }\n          }\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getCursorAnchor = function (editor, bodyElement) {\n      return function () {\n        return {\n          anchor: 'selection',\n          root: bodyElement(),\n          getSelection: function () {\n            var rng = editor.selection.getRng();\n            return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n          }\n        };\n      };\n    };\n    var getNodeAnchor = function (bodyElement) {\n      return function (element) {\n        return {\n          anchor: 'node',\n          root: bodyElement(),\n          node: element\n        };\n      };\n    };\n    var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var bodyElement = function () {\n        return SugarElement.fromDom(editor.getBody());\n      };\n      var contentAreaElement = function () {\n        return SugarElement.fromDom(editor.getContentAreaContainer());\n      };\n      var lazyUseEditableAreaAnchor = function () {\n        return useFixedToolbarContainer || !isToolbarTop();\n      };\n      return {\n        inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        cursor: getCursorAnchor(editor, bodyElement),\n        node: getNodeAnchor(bodyElement)\n      };\n    };\n\n    var colorPicker = function (editor) {\n      return function (callback, value) {\n        var dialog = colorPickerDialog(editor);\n        dialog(callback, value);\n      };\n    };\n    var hasCustomColors$1 = function (editor) {\n      return function () {\n        return hasCustomColors(editor);\n      };\n    };\n    var getColors$2 = function (editor) {\n      return function () {\n        return getColors(editor);\n      };\n    };\n    var getColorCols$2 = function (editor) {\n      return function () {\n        return getColorCols$1(editor);\n      };\n    };\n    var ColorInputBackstage = function (editor) {\n      return {\n        colorPicker: colorPicker(editor),\n        hasCustomColors: hasCustomColors$1(editor),\n        getColors: getColors$2(editor),\n        getColorCols: getColorCols$2(editor)\n      };\n    };\n\n    var isDraggableModal$1 = function (editor) {\n      return function () {\n        return isDraggableModal(editor);\n      };\n    };\n    var DialogBackstage = function (editor) {\n      return { isDraggableModal: isDraggableModal$1(editor) };\n    };\n\n    var HeaderBackstage = function (editor) {\n      var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n      return {\n        isPositionedAtTop: function () {\n          return mode.get() === 'top';\n        },\n        getDockingMode: mode.get,\n        setDockingMode: mode.set\n      };\n    };\n\n    var defaultStyleFormats = [\n      {\n        title: 'Headings',\n        items: [\n          {\n            title: 'Heading 1',\n            format: 'h1'\n          },\n          {\n            title: 'Heading 2',\n            format: 'h2'\n          },\n          {\n            title: 'Heading 3',\n            format: 'h3'\n          },\n          {\n            title: 'Heading 4',\n            format: 'h4'\n          },\n          {\n            title: 'Heading 5',\n            format: 'h5'\n          },\n          {\n            title: 'Heading 6',\n            format: 'h6'\n          }\n        ]\n      },\n      {\n        title: 'Inline',\n        items: [\n          {\n            title: 'Bold',\n            format: 'bold'\n          },\n          {\n            title: 'Italic',\n            format: 'italic'\n          },\n          {\n            title: 'Underline',\n            format: 'underline'\n          },\n          {\n            title: 'Strikethrough',\n            format: 'strikethrough'\n          },\n          {\n            title: 'Superscript',\n            format: 'superscript'\n          },\n          {\n            title: 'Subscript',\n            format: 'subscript'\n          },\n          {\n            title: 'Code',\n            format: 'code'\n          }\n        ]\n      },\n      {\n        title: 'Blocks',\n        items: [\n          {\n            title: 'Paragraph',\n            format: 'p'\n          },\n          {\n            title: 'Blockquote',\n            format: 'blockquote'\n          },\n          {\n            title: 'Div',\n            format: 'div'\n          },\n          {\n            title: 'Pre',\n            format: 'pre'\n          }\n        ]\n      },\n      {\n        title: 'Align',\n        items: [\n          {\n            title: 'Left',\n            format: 'alignleft'\n          },\n          {\n            title: 'Center',\n            format: 'aligncenter'\n          },\n          {\n            title: 'Right',\n            format: 'alignright'\n          },\n          {\n            title: 'Justify',\n            format: 'alignjustify'\n          }\n        ]\n      }\n    ];\n    var isNestedFormat = function (format) {\n      return has(format, 'items');\n    };\n    var isBlockFormat = function (format) {\n      return has(format, 'block');\n    };\n    var isInlineFormat = function (format) {\n      return has(format, 'inline');\n    };\n    var isSelectorFormat = function (format) {\n      return has(format, 'selector');\n    };\n    var mapFormats = function (userFormats) {\n      return foldl(userFormats, function (acc, fmt) {\n        if (isNestedFormat(fmt)) {\n          var result = mapFormats(fmt.items);\n          return {\n            customFormats: acc.customFormats.concat(result.customFormats),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                items: result.formats\n              }])\n          };\n        } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n          var formatName = 'custom-' + fmt.title.toLowerCase();\n          return {\n            customFormats: acc.customFormats.concat([{\n                name: formatName,\n                format: fmt\n              }]),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                format: formatName,\n                icon: fmt.icon\n              }])\n          };\n        } else {\n          return __assign(__assign({}, acc), { formats: acc.formats.concat(fmt) });\n        }\n      }, {\n        customFormats: [],\n        formats: []\n      });\n    };\n    var registerCustomFormats = function (editor, userFormats) {\n      var result = mapFormats(userFormats);\n      var registerFormats = function (customFormats) {\n        each(customFormats, function (fmt) {\n          if (!editor.formatter.has(fmt.name)) {\n            editor.formatter.register(fmt.name, fmt.format);\n          }\n        });\n      };\n      if (editor.formatter) {\n        registerFormats(result.customFormats);\n      } else {\n        editor.on('init', function () {\n          registerFormats(result.customFormats);\n        });\n      }\n      return result.formats;\n    };\n    var getStyleFormats = function (editor) {\n      return getUserStyleFormats(editor).map(function (userFormats) {\n        var registeredUserFormats = registerCustomFormats(editor, userFormats);\n        return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n      }).getOr(defaultStyleFormats);\n    };\n\n    var processBasic = function (item, isSelectedFor, getPreviewFor) {\n      var formatterSpec = {\n        type: 'formatter',\n        isSelected: isSelectedFor(item.format),\n        getStylePreview: getPreviewFor(item.format)\n      };\n      return deepMerge(item, formatterSpec);\n    };\n    var register$3 = function (editor, formats, isSelectedFor, getPreviewFor) {\n      var enrichSupported = function (item) {\n        return processBasic(item, isSelectedFor, getPreviewFor);\n      };\n      var enrichMenu = function (item) {\n        var submenuSpec = { type: 'submenu' };\n        return deepMerge(item, submenuSpec);\n      };\n      var enrichCustom = function (item) {\n        var formatName = generate$1(item.title);\n        var customSpec = {\n          type: 'formatter',\n          format: formatName,\n          isSelected: isSelectedFor(formatName),\n          getStylePreview: getPreviewFor(formatName)\n        };\n        var newItem = deepMerge(item, customSpec);\n        editor.formatter.register(formatName, newItem);\n        return newItem;\n      };\n      var doEnrich = function (items) {\n        return map(items, function (item) {\n          var keys$1 = keys(item);\n          if (hasNonNullableKey(item, 'items')) {\n            var newItems_1 = doEnrich(item.items);\n            return deepMerge(enrichMenu(item), {\n              getStyleItems: function () {\n                return newItems_1;\n              }\n            });\n          } else if (hasNonNullableKey(item, 'format')) {\n            return enrichSupported(item);\n          } else if (keys$1.length === 1 && contains(keys$1, 'title')) {\n            return deepMerge(item, { type: 'separator' });\n          } else {\n            return enrichCustom(item);\n          }\n        });\n      };\n      return doEnrich(formats);\n    };\n\n    var init$7 = function (editor) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var flatten = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind(subs, flatten) : [fmt.format];\n      };\n      var settingsFormats = Cell([]);\n      var settingsFlattenedFormats = Cell([]);\n      var eventsFormats = Cell([]);\n      var eventsFlattenedFormats = Cell([]);\n      var replaceSettings = Cell(false);\n      editor.on('PreInit', function (_e) {\n        var formats = getStyleFormats(editor);\n        var enriched = register$3(editor, formats, isSelectedFor, getPreviewFor);\n        settingsFormats.set(enriched);\n        settingsFlattenedFormats.set(bind(enriched, flatten));\n      });\n      editor.on('addStyleModifications', function (e) {\n        var modifications = register$3(editor, e.items, isSelectedFor, getPreviewFor);\n        eventsFormats.set(modifications);\n        replaceSettings.set(e.replace);\n        eventsFlattenedFormats.set(bind(modifications, flatten));\n      });\n      var getData = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n        var fromEvents = eventsFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      var getFlattenedKeys = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n        var fromEvents = eventsFlattenedFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      return {\n        getData: getData,\n        getFlattenedKeys: getFlattenedKeys\n      };\n    };\n\n    var trim$1 = global$e.trim;\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (node && node.nodeType === 1) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var create$8 = function (type, title, url, level, attach) {\n      return {\n        type: type,\n        title: title,\n        url: url,\n        level: level,\n        attach: attach\n      };\n    };\n    var isChildOfContentEditableTrue = function (node) {\n      while (node = node.parentNode) {\n        var value = node.contentEditable;\n        if (value && value !== 'inherit') {\n          return isContentEditableTrue(node);\n        }\n      }\n      return false;\n    };\n    var select = function (selector, root) {\n      return map(descendants(SugarElement.fromDom(root), selector), function (element) {\n        return element.dom;\n      });\n    };\n    var getElementText = function (elm) {\n      return elm.innerText || elm.textContent;\n    };\n    var getOrGenerateId = function (elm) {\n      return elm.id ? elm.id : generate$1('h');\n    };\n    var isAnchor = function (elm) {\n      return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n    };\n    var isValidAnchor = function (elm) {\n      return isAnchor(elm) && isEditable(elm);\n    };\n    var isHeader = function (elm) {\n      return elm && /^(H[1-6])$/.test(elm.nodeName);\n    };\n    var isEditable = function (elm) {\n      return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n    };\n    var isValidHeader = function (elm) {\n      return isHeader(elm) && isEditable(elm);\n    };\n    var getLevel = function (elm) {\n      return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n    };\n    var headerTarget = function (elm) {\n      var headerId = getOrGenerateId(elm);\n      var attach = function () {\n        elm.id = headerId;\n      };\n      return create$8('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n    };\n    var anchorTarget = function (elm) {\n      var anchorId = elm.id || elm.name;\n      var anchorText = getElementText(elm);\n      return create$8('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n    };\n    var getHeaderTargets = function (elms) {\n      return map(filter(elms, isValidHeader), headerTarget);\n    };\n    var getAnchorTargets = function (elms) {\n      return map(filter(elms, isValidAnchor), anchorTarget);\n    };\n    var getTargetElements = function (elm) {\n      var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n      return elms;\n    };\n    var hasTitle = function (target) {\n      return trim$1(target.title).length > 0;\n    };\n    var find$5 = function (elm) {\n      var elms = getTargetElements(elm);\n      return filter(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n    };\n    var LinkTargets = { find: find$5 };\n\n    var STORAGE_KEY = 'tinymce-url-history';\n    var HISTORY_LENGTH = 5;\n    var isHttpUrl = function (url) {\n      return isString(url) && /^https?/.test(url);\n    };\n    var isArrayOfUrl = function (a) {\n      return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n    };\n    var isRecordOfUrlArray = function (r) {\n      return isObject(r) && find$1(r, function (value) {\n        return !isArrayOfUrl(value);\n      }).isNone();\n    };\n    var getAllHistory = function () {\n      var unparsedHistory = global$9.getItem(STORAGE_KEY);\n      if (unparsedHistory === null) {\n        return {};\n      }\n      var history;\n      try {\n        history = JSON.parse(unparsedHistory);\n      } catch (e) {\n        if (e instanceof SyntaxError) {\n          console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n          return {};\n        }\n        throw e;\n      }\n      if (!isRecordOfUrlArray(history)) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n        return {};\n      }\n      return history;\n    };\n    var setAllHistory = function (history) {\n      if (!isRecordOfUrlArray(history)) {\n        throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n      }\n      global$9.setItem(STORAGE_KEY, JSON.stringify(history));\n    };\n    var getHistory = function (fileType) {\n      var history = getAllHistory();\n      return Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n    };\n    var addToHistory = function (url, fileType) {\n      if (!isHttpUrl(url)) {\n        return;\n      }\n      var history = getAllHistory();\n      var items = Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n      var itemsWithoutUrl = filter(items, function (item) {\n        return item !== url;\n      });\n      history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n      setAllHistory(history);\n    };\n\n    var isTruthy = function (value) {\n      return !!value;\n    };\n    var makeMap = function (value) {\n      return map$2(global$e.makeMap(value, /[, ]/), isTruthy);\n    };\n    var getPicker = function (editor) {\n      return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n    };\n    var getPickerTypes = function (editor) {\n      var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n      var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n      var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n      return getPicker(editor).fold(function () {\n        return false;\n      }, function (_picker) {\n        return optTypes.fold(function () {\n          return true;\n        }, function (types) {\n          return keys(types).length > 0 ? types : false;\n        });\n      });\n    };\n    var getPickerSetting = function (editor, filetype) {\n      var pickerTypes = getPickerTypes(editor);\n      if (isBoolean(pickerTypes)) {\n        return pickerTypes ? getPicker(editor) : Optional.none();\n      } else {\n        return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n      }\n    };\n    var getUrlPicker = function (editor, filetype) {\n      return getPickerSetting(editor, filetype).map(function (picker) {\n        return function (entry) {\n          return Future.nu(function (completer) {\n            var handler = function (value, meta) {\n              if (!isString(value)) {\n                throw new Error('Expected value to be string');\n              }\n              if (meta !== undefined && !isObject(meta)) {\n                throw new Error('Expected meta to be a object');\n              }\n              var r = {\n                value: value,\n                meta: meta\n              };\n              completer(r);\n            };\n            var meta = __assign({\n              filetype: filetype,\n              fieldname: entry.fieldname\n            }, Optional.from(entry.meta).getOr({}));\n            picker.call(editor, handler, entry.value, meta);\n          });\n        };\n      });\n    };\n    var getTextSetting = function (value) {\n      return Optional.from(value).filter(isString).getOrUndefined();\n    };\n    var getLinkInformation = function (editor) {\n      if (noTypeaheadUrls(editor)) {\n        return Optional.none();\n      }\n      return Optional.some({\n        targets: LinkTargets.find(editor.getBody()),\n        anchorTop: getTextSetting(getAnchorTop(editor)),\n        anchorBottom: getTextSetting(getAnchorBottom(editor))\n      });\n    };\n    var getValidationHandler = function (editor) {\n      return Optional.from(getFilePickerValidatorHandler(editor));\n    };\n    var UrlInputBackstage = function (editor) {\n      return {\n        getHistory: getHistory,\n        addToHistory: addToHistory,\n        getLinkInformation: function () {\n          return getLinkInformation(editor);\n        },\n        getValidationHandler: function () {\n          return getValidationHandler(editor);\n        },\n        getUrlPicker: function (filetype) {\n          return getUrlPicker(editor, filetype);\n        }\n      };\n    };\n\n    var init$8 = function (sink, editor, lazyAnchorbar) {\n      var contextMenuState = Cell(false);\n      var toolbar = HeaderBackstage(editor);\n      var backstage = {\n        shared: {\n          providers: {\n            icons: function () {\n              return editor.ui.registry.getAll().icons;\n            },\n            menuItems: function () {\n              return editor.ui.registry.getAll().menuItems;\n            },\n            translate: global$6.translate,\n            isReadOnly: function () {\n              return editor.mode.isReadOnly();\n            }\n          },\n          interpreter: function (s) {\n            return interpretWithoutForm(s, backstage);\n          },\n          anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n          header: toolbar,\n          getSink: function () {\n            return Result.value(sink);\n          }\n        },\n        urlinput: UrlInputBackstage(editor),\n        styleselect: init$7(editor),\n        colorinput: ColorInputBackstage(editor),\n        dialog: DialogBackstage(editor),\n        isContextMenuOpen: function () {\n          return contextMenuState.get();\n        },\n        setContextMenuState: function (state) {\n          return contextMenuState.set(state);\n        }\n      };\n      return backstage;\n    };\n\n    var expandable$1 = constant(function (element, available) {\n      setMax$1(element, Math.floor(available));\n    });\n\n    var showContextToolbarEvent = 'contexttoolbar-show';\n    var hideContextToolbarEvent = 'contexttoolbar-hide';\n\n    var schema$k = constant([\n      strict$1('dom'),\n      defaulted$1('shell', true),\n      field$1('toolbarBehaviours', [Replacing])\n    ]);\n    var enhanceGroups = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var parts$7 = constant([optional({\n        name: 'groups',\n        overrides: enhanceGroups\n      })]);\n\n    var factory$9 = function (detail, components, _spec, _externals) {\n      var setGroups = function (toolbar, groups) {\n        getGroupContainer(toolbar).fold(function () {\n          console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n          throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        }, function (container) {\n          Replacing.set(container, groups);\n        });\n      };\n      var getGroupContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n        apis: { setGroups: setGroups },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var Toolbar = composite$1({\n      name: 'Toolbar',\n      configFields: schema$k(),\n      partFields: parts$7(),\n      factory: factory$9,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        }\n      }\n    });\n\n    var generate$6 = function (xs, f) {\n      var init = {\n        len: 0,\n        list: []\n      };\n      var r = foldl(xs, function (b, a) {\n        var value = f(a, b.len);\n        return value.fold(constant(b), function (v) {\n          return {\n            len: v.finish,\n            list: b.list.concat([v])\n          };\n        });\n      }, init);\n      return r.list;\n    };\n\n    var output$1 = function (within, extra, withinWidth) {\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var apportion = function (units, total, len) {\n      var parray = generate$6(units, function (unit, current) {\n        var width = len(unit);\n        return Optional.some({\n          element: unit,\n          start: current,\n          finish: current + width,\n          width: width\n        });\n      });\n      var within = filter(parray, function (unit) {\n        return unit.finish <= total;\n      });\n      var withinWidth = foldr(within, function (acc, el) {\n        return acc + el.width;\n      }, 0);\n      var extra = parray.slice(within.length);\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var toUnit = function (parray) {\n      return map(parray, function (unit) {\n        return unit.element;\n      });\n    };\n    var fitLast = function (within, extra, withinWidth) {\n      var fits = toUnit(within.concat(extra));\n      return output$1(fits, [], withinWidth);\n    };\n    var overflow = function (within, extra, overflower, withinWidth) {\n      var fits = toUnit(within).concat([overflower]);\n      return output$1(fits, toUnit(extra), withinWidth);\n    };\n    var fitAll = function (within, extra, withinWidth) {\n      return output$1(toUnit(within), [], withinWidth);\n    };\n    var tryFit = function (total, units, len) {\n      var divide = apportion(units, total, len);\n      return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n    };\n    var partition$3 = function (total, units, len, overflower) {\n      var divide = tryFit(total, units, len).getOrThunk(function () {\n        return apportion(units, total - len(overflower), len);\n      });\n      var within = divide.within;\n      var extra = divide.extra;\n      var withinWidth = divide.withinWidth;\n      if (extra.length === 1 && extra[0].width <= len(overflower)) {\n        return fitLast(within, extra, withinWidth);\n      } else if (extra.length >= 1) {\n        return overflow(within, extra, overflower, withinWidth);\n      } else {\n        return fitAll(within, extra, withinWidth);\n      }\n    };\n\n    var setGroups = function (toolbar, storedGroups) {\n      var bGroups = map(storedGroups, function (g) {\n        return premade$1(g);\n      });\n      Toolbar.setGroups(toolbar, bGroups);\n    };\n    var findFocusedComp = function (comps) {\n      return findMap(comps, function (comp) {\n        return search(comp.element).bind(function (focusedElm) {\n          return comp.getSystem().getByDom(focusedElm).toOptional();\n        });\n      });\n    };\n    var refresh = function (toolbar, detail, setOverflow) {\n      var primary = getPartOrDie(toolbar, detail, 'primary');\n      var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n      set$2(primary.element, 'visibility', 'hidden');\n      var groups = detail.builtGroups.get().concat([overflowGroup]);\n      var focusedComp = findFocusedComp(groups);\n      setOverflow([]);\n      setGroups(primary, groups);\n      var availableWidth = get$7(primary.element);\n      var overflows = partition$3(availableWidth, detail.builtGroups.get(), function (comp) {\n        return get$7(comp.element);\n      }, overflowGroup);\n      if (overflows.extra.length === 0) {\n        Replacing.remove(primary, overflowGroup);\n        setOverflow([]);\n      } else {\n        setGroups(primary, overflows.within);\n        setOverflow(overflows.extra);\n      }\n      remove$6(primary.element, 'visibility');\n      reflow(primary.element);\n      focusedComp.each(Focusing.focus);\n    };\n\n    var schema$l = constant([\n      field$1('splitToolbarBehaviours', [Coupling]),\n      state$1('builtGroups', function () {\n        return Cell([]);\n      })\n    ]);\n\n    var schema$m = constant([\n      markers(['overflowToggledClass']),\n      optionFunction('getOverflowBounds'),\n      strict$1('lazySink'),\n      state$1('overflowGroups', function () {\n        return Cell([]);\n      })\n    ].concat(schema$l()));\n    var parts$8 = constant([\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'primary'\n      }),\n      external$1({\n        schema: schema$k(),\n        name: 'overflow'\n      }),\n      external$1({ name: 'overflow-button' }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var schema$n = constant([\n      markers(['toggledClass']),\n      strict$1('lazySink'),\n      strictFunction('fetch'),\n      optionFunction('getBounds'),\n      optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]),\n      schema$1()\n    ]);\n    var parts$9 = constant([\n      external$1({\n        name: 'button',\n        overrides: function (detail) {\n          return {\n            dom: { attributes: { 'aria-haspopup': 'true' } },\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.toggledClass,\n                aria: { mode: 'expanded' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'toolbar',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([Keying.config({\n                mode: 'cyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'button').each(Focusing.focus);\n                  return Optional.none();\n                }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var toggle$2 = function (button, externals) {\n      var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n      if (Sandboxing.isOpen(toolbarSandbox)) {\n        Sandboxing.close(toolbarSandbox);\n      } else {\n        Sandboxing.open(toolbarSandbox, externals.toolbar());\n      }\n    };\n    var position$2 = function (button, toolbar, detail, layouts) {\n      var bounds = detail.getBounds.map(function (bounder) {\n        return bounder();\n      });\n      var sink = detail.lazySink(button).getOrDie();\n      Positioning.positionWithinBounds(sink, {\n        anchor: 'hotspot',\n        hotspot: button,\n        layouts: layouts,\n        overrides: { maxWidthFunction: expandable$1() }\n      }, toolbar, bounds);\n    };\n    var setGroups$1 = function (button, toolbar, detail, layouts, groups) {\n      Toolbar.setGroups(toolbar, groups);\n      position$2(button, toolbar, detail, layouts);\n      Toggling.on(button);\n    };\n    var makeSandbox$1 = function (button, spec, detail) {\n      var ariaOwner = manager();\n      var onOpen = function (sandbox, toolbar) {\n        detail.fetch().get(function (groups) {\n          setGroups$1(button, toolbar, detail, spec.layouts, groups);\n          ariaOwner.link(button.element);\n          Keying.focusIn(toolbar);\n        });\n      };\n      var onClose = function () {\n        Toggling.off(button);\n        Focusing.focus(button);\n        ariaOwner.unlink(button.element);\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { id: ariaOwner.id }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              Sandboxing.close(comp);\n              return Optional.some(true);\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOf(button, queryElem);\n            },\n            getAttachPoint: function () {\n              return detail.lazySink(button).getOrDie();\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel(__assign({ isExtraPart: never }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel$1({\n              doReposition: function () {\n                Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n                  position$2(button, toolbar, detail, spec.layouts);\n                });\n              }\n            }))\n          })\n        ])\n      };\n    };\n    var factory$a = function (detail, components, spec, externals) {\n      return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n        action: function (button) {\n          toggle$2(button, externals);\n        },\n        buttonBehaviours: SketchBehaviours.augment({ dump: externals.button().buttonBehaviours }, [Coupling.config({\n            others: {\n              toolbarSandbox: function (button) {\n                return makeSandbox$1(button, spec, detail);\n              }\n            }\n          })])\n      }))), {\n        apis: {\n          setGroups: function (button, groups) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              setGroups$1(button, toolbar, detail, spec.layouts, groups);\n            });\n          },\n          reposition: function (button) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position$2(button, toolbar, detail, spec.layouts);\n            });\n          },\n          toggle: function (button) {\n            toggle$2(button, externals);\n          },\n          getToolbar: function (button) {\n            return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n          },\n          isOpen: function (button) {\n            return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n          }\n        }\n      });\n    };\n    var FloatingToolbarButton = composite$1({\n      name: 'FloatingToolbarButton',\n      factory: factory$a,\n      configFields: schema$n(),\n      partFields: parts$9(),\n      apis: {\n        setGroups: function (apis, button, groups) {\n          apis.setGroups(button, groups);\n        },\n        reposition: function (apis, button) {\n          apis.reposition(button);\n        },\n        toggle: function (apis, button) {\n          apis.toggle(button);\n        },\n        getToolbar: function (apis, button) {\n          return apis.getToolbar(button);\n        },\n        isOpen: function (apis, button) {\n          return apis.isOpen(button);\n        }\n      }\n    });\n\n    var schema$o = constant([\n      strict$1('items'),\n      markers(['itemSelector']),\n      field$1('tgroupBehaviours', [Keying])\n    ]);\n    var parts$a = constant([group({\n        name: 'items',\n        unit: 'item'\n      })]);\n\n    var factory$b = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n            mode: 'flow',\n            selector: detail.markers.itemSelector\n          })]),\n        domModification: { attributes: { role: 'toolbar' } }\n      };\n    };\n    var ToolbarGroup = composite$1({\n      name: 'ToolbarGroup',\n      configFields: schema$o(),\n      partFields: parts$a(),\n      factory: factory$b\n    });\n\n    var buildGroups = function (comps) {\n      return map(comps, function (g) {\n        return premade$1(g);\n      });\n    };\n    var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n      refresh(toolbar, detail, function (overflowGroups) {\n        detail.overflowGroups.set(overflowGroups);\n        memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n          FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n        });\n      });\n    };\n    var factory$c = function (detail, components, spec, externals) {\n      var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(buildGroups(detail.overflowGroups.get()));\n          });\n        },\n        layouts: {\n          onLtr: function () {\n            return [\n              southwest$1,\n              southeast$1\n            ];\n          },\n          onRtl: function () {\n            return [\n              southeast$1,\n              southwest$1\n            ];\n          },\n          onBottomLtr: function () {\n            return [\n              northwest$1,\n              northeast$1\n            ];\n          },\n          onBottomRtl: function () {\n            return [\n              northeast$1,\n              northwest$1\n            ];\n          }\n        },\n        getBounds: spec.getOverflowBounds,\n        lazySink: detail.lazySink,\n        fireDismissalEventInstead: {},\n        markers: { toggledClass: detail.markers.overflowToggledClass },\n        parts: {\n          button: externals['overflow-button'](),\n          toolbar: externals.overflow()\n        }\n      }));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n            others: {\n              overflowGroup: function () {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), { items: [memFloatingToolbarButton.asSpec()] }));\n              }\n            }\n          })]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            detail.builtGroups.set(map(groups, toolbar.getSystem().build));\n            refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          toggle: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.toggle(floatingToolbarButton);\n            });\n          },\n          isOpen: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n          },\n          reposition: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.reposition(floatingToolbarButton);\n            });\n          },\n          getOverflow: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitFloatingToolbar = composite$1({\n      name: 'SplitFloatingToolbar',\n      configFields: schema$m(),\n      partFields: parts$8(),\n      factory: factory$c,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        reposition: function (apis, toolbar) {\n          apis.reposition(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        },\n        getOverflow: function (apis, toolbar) {\n          return apis.getOverflow(toolbar);\n        }\n      }\n    });\n\n    var getAnimationRoot = function (component, slideConfig) {\n      return slideConfig.getAnimationRoot.fold(function () {\n        return component.element;\n      }, function (get) {\n        return get(component);\n      });\n    };\n\n    var getDimensionProperty = function (slideConfig) {\n      return slideConfig.dimension.property;\n    };\n    var getDimension = function (slideConfig, elem) {\n      return slideConfig.dimension.getDimension(elem);\n    };\n    var disableTransitions = function (component, slideConfig) {\n      var root = getAnimationRoot(component, slideConfig);\n      remove$5(root, [\n        slideConfig.shrinkingClass,\n        slideConfig.growingClass\n      ]);\n    };\n    var setShrunk = function (component, slideConfig) {\n      remove$4(component.element, slideConfig.openClass);\n      add$2(component.element, slideConfig.closedClass);\n      set$2(component.element, getDimensionProperty(slideConfig), '0px');\n      reflow(component.element);\n    };\n    var setGrown = function (component, slideConfig) {\n      remove$4(component.element, slideConfig.closedClass);\n      add$2(component.element, slideConfig.openClass);\n      remove$6(component.element, getDimensionProperty(slideConfig));\n    };\n    var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n      slideState.setCollapsed();\n      set$2(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n      reflow(component.element);\n      disableTransitions(component, slideConfig);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n      slideConfig.onShrunk(component);\n    };\n    var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n      var size = calculatedSize.getOrThunk(function () {\n        return getDimension(slideConfig, component.element);\n      });\n      slideState.setCollapsed();\n      set$2(component.element, getDimensionProperty(slideConfig), size);\n      reflow(component.element);\n      var root = getAnimationRoot(component, slideConfig);\n      remove$4(root, slideConfig.growingClass);\n      add$2(root, slideConfig.shrinkingClass);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n    };\n    var doStartSmartShrink = function (component, slideConfig, slideState) {\n      var size = getDimension(slideConfig, component.element);\n      var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n      shrinker(component, slideConfig, slideState, Optional.some(size));\n    };\n    var doStartGrow = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      var wasShrinking = has$2(root, slideConfig.shrinkingClass);\n      var beforeSize = getDimension(slideConfig, component.element);\n      setGrown(component, slideConfig);\n      var fullSize = getDimension(slideConfig, component.element);\n      var startPartialGrow = function () {\n        set$2(component.element, getDimensionProperty(slideConfig), beforeSize);\n        reflow(component.element);\n      };\n      var startCompleteGrow = function () {\n        setShrunk(component, slideConfig);\n      };\n      var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n      setStartSize();\n      remove$4(root, slideConfig.shrinkingClass);\n      add$2(root, slideConfig.growingClass);\n      setGrown(component, slideConfig);\n      set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n      slideState.setExpanded();\n      slideConfig.onStartGrow(component);\n    };\n    var refresh$2 = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        remove$6(component.element, getDimensionProperty(slideConfig));\n        var fullSize = getDimension(slideConfig, component.element);\n        set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n      }\n    };\n    var grow = function (component, slideConfig, slideState) {\n      if (!slideState.isExpanded()) {\n        doStartGrow(component, slideConfig, slideState);\n      }\n    };\n    var shrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doStartSmartShrink(component, slideConfig, slideState);\n      }\n    };\n    var immediateShrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doImmediateShrink(component, slideConfig, slideState, Optional.none());\n      }\n    };\n    var hasGrown = function (component, slideConfig, slideState) {\n      return slideState.isExpanded();\n    };\n    var hasShrunk = function (component, slideConfig, slideState) {\n      return slideState.isCollapsed();\n    };\n    var isGrowing = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.growingClass) === true;\n    };\n    var isShrinking = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.shrinkingClass) === true;\n    };\n    var isTransitioning = function (component, slideConfig, slideState) {\n      return isGrowing(component, slideConfig) === true || isShrinking(component, slideConfig) === true;\n    };\n    var toggleGrow = function (component, slideConfig, slideState) {\n      var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n      f(component, slideConfig, slideState);\n    };\n\n    var SlidingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$2,\n        grow: grow,\n        shrink: shrink,\n        immediateShrink: immediateShrink,\n        hasGrown: hasGrown,\n        hasShrunk: hasShrunk,\n        isGrowing: isGrowing,\n        isShrinking: isShrinking,\n        isTransitioning: isTransitioning,\n        toggleGrow: toggleGrow,\n        disableTransitions: disableTransitions\n    });\n\n    var exhibit$6 = function (base, slideConfig, _slideState) {\n      var expanded = slideConfig.expanded;\n      return expanded ? nu$6({\n        classes: [slideConfig.openClass],\n        styles: {}\n      }) : nu$6({\n        classes: [slideConfig.closedClass],\n        styles: wrap$1(slideConfig.dimension.property, '0px')\n      });\n    };\n    var events$d = function (slideConfig, slideState) {\n      return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.propertyName === slideConfig.dimension.property) {\n            disableTransitions(component, slideConfig);\n            if (slideState.isExpanded()) {\n              remove$6(component.element, slideConfig.dimension.property);\n            }\n            var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n            notify(component);\n          }\n        })]);\n    };\n\n    var ActiveSliding = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$6,\n        events: events$d\n    });\n\n    var SlidingSchema = [\n      strict$1('closedClass'),\n      strict$1('openClass'),\n      strict$1('shrinkingClass'),\n      strict$1('growingClass'),\n      option('getAnimationRoot'),\n      onHandler('onShrunk'),\n      onHandler('onStartShrink'),\n      onHandler('onGrown'),\n      onHandler('onStartGrow'),\n      defaulted$1('expanded', false),\n      strictOf('dimension', choose$1('property', {\n        width: [\n          output('property', 'width'),\n          output('getDimension', function (elem) {\n            return get$7(elem) + 'px';\n          })\n        ],\n        height: [\n          output('property', 'height'),\n          output('getDimension', function (elem) {\n            return get$6(elem) + 'px';\n          })\n        ]\n      }))\n    ];\n\n    var init$9 = function (spec) {\n      var state = Cell(spec.expanded);\n      var readState = function () {\n        return 'expanded: ' + state.get();\n      };\n      return nu$5({\n        isExpanded: function () {\n          return state.get() === true;\n        },\n        isCollapsed: function () {\n          return state.get() === false;\n        },\n        setCollapsed: curry(state.set, false),\n        setExpanded: curry(state.set, true),\n        readState: readState\n      });\n    };\n\n    var SlidingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$9\n    });\n\n    var Sliding = create$1({\n      fields: SlidingSchema,\n      name: 'sliding',\n      active: ActiveSliding,\n      apis: SlidingApis,\n      state: SlidingState\n    });\n\n    var schema$p = constant([\n      markers([\n        'closedClass',\n        'openClass',\n        'shrinkingClass',\n        'growingClass',\n        'overflowToggledClass'\n      ]),\n      onHandler('onOpened'),\n      onHandler('onClosed')\n    ].concat(schema$l()));\n    var parts$b = constant([\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'primary'\n      }),\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'overflow',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([\n              Sliding.config({\n                dimension: { property: 'height' },\n                closedClass: detail.markers.closedClass,\n                openClass: detail.markers.openClass,\n                shrinkingClass: detail.markers.shrinkingClass,\n                growingClass: detail.markers.growingClass,\n                onShrunk: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(function (button) {\n                    Toggling.off(button);\n                    Focusing.focus(button);\n                  });\n                  detail.onClosed(comp);\n                },\n                onGrown: function (comp) {\n                  Keying.focusIn(comp);\n                  detail.onOpened(comp);\n                },\n                onStartGrow: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Toggling.on);\n                }\n              }),\n              Keying.config({\n                mode: 'acyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n                  return Optional.some(true);\n                }\n              })\n            ])\n          };\n        }\n      }),\n      external$1({\n        name: 'overflow-button',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.overflowToggledClass,\n                aria: { mode: 'pressed' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var isOpen$1 = function (toolbar, detail) {\n      return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n    };\n    var toggleToolbar = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow-button').bind(function () {\n        return getPart(toolbar, detail, 'overflow');\n      }).each(function (overf) {\n        refresh$3(toolbar, detail);\n        Sliding.toggleGrow(overf);\n      });\n    };\n    var refresh$3 = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow').each(function (overflow) {\n        refresh(toolbar, detail, function (groups) {\n          var builtGroups = map(groups, function (g) {\n            return premade$1(g);\n          });\n          Toolbar.setGroups(overflow, builtGroups);\n        });\n        getPart(toolbar, detail, 'overflow-button').each(function (button) {\n          if (Sliding.hasGrown(overflow)) {\n            Toggling.on(button);\n          }\n        });\n        Sliding.refresh(overflow);\n      });\n    };\n    var factory$d = function (detail, components, spec, externals) {\n      var toolbarToggleEvent = 'alloy.toolbar.toggle';\n      var doSetGroups = function (toolbar, groups) {\n        var built = map(groups, toolbar.getSystem().build);\n        detail.builtGroups.set(built);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [\n          Coupling.config({\n            others: {\n              overflowGroup: function (toolbar) {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n                  items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                      action: function (_button) {\n                        emit(toolbar, toolbarToggleEvent);\n                      }\n                    }))]\n                }));\n              }\n            }\n          }),\n          config('toolbar-toggle-events', [run(toolbarToggleEvent, function (toolbar) {\n              toggleToolbar(toolbar, detail);\n            })])\n        ]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            doSetGroups(toolbar, groups);\n            refresh$3(toolbar, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh$3(toolbar, detail);\n          },\n          toggle: function (toolbar) {\n            return toggleToolbar(toolbar, detail);\n          },\n          isOpen: function (toolbar) {\n            return isOpen$1(toolbar, detail);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitSlidingToolbar = composite$1({\n      name: 'SplitSlidingToolbar',\n      configFields: schema$p(),\n      partFields: parts$b(),\n      factory: factory$d,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        }\n      }\n    });\n\n    var toolbarHeightChange = constant(generate$1('toolbar-height-change'));\n\n    var renderToolbarGroupCommon = function (toolbarGroup) {\n      var attributes = toolbarGroup.title.fold(function () {\n        return {};\n      }, function (title) {\n        return { attributes: { title: title } };\n      });\n      return {\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-toolbar__group']\n        }, attributes),\n        components: [ToolbarGroup.parts.items({})],\n        items: toolbarGroup.items,\n        markers: { itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])' },\n        tgroupBehaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n    var renderToolbarGroup = function (toolbarGroup) {\n      return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n    };\n    var getToolbarbehaviours = function (toolbarSpec, modeName) {\n      var onAttached = runOnAttached(function (component) {\n        var groups = map(toolbarSpec.initGroups, renderToolbarGroup);\n        Toolbar.setGroups(component, groups);\n      });\n      return derive$1([\n        DisablingConfigs.toolbarButton(toolbarSpec.providers.isReadOnly),\n        receivingConfig(),\n        Keying.config({\n          mode: modeName,\n          onEscape: toolbarSpec.onEscape,\n          selector: '.tox-toolbar__group'\n        }),\n        config('toolbar-events', [onAttached])\n      ]);\n    };\n    var renderMoreToolbarCommon = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return {\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        parts: {\n          'overflow-group': renderToolbarGroupCommon({\n            title: Optional.none(),\n            items: []\n          }),\n          'overflow-button': renderIconButtonSpec({\n            name: 'more',\n            icon: Optional.some('more-drawer'),\n            disabled: false,\n            tooltip: Optional.some('More...'),\n            primary: false,\n            borderless: false\n          }, Optional.none(), toolbarSpec.providers)\n        },\n        splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      };\n    };\n    var renderFloatingMoreToolbar = function (toolbarSpec) {\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      var overflowXOffset = 4;\n      var primary = SplitFloatingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        lazySink: toolbarSpec.getSink,\n        getOverflowBounds: function () {\n          var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n          var headerBounds = absolute$1(headerElem);\n          var docElem = documentElement(headerElem);\n          var docBounds = absolute$1(docElem);\n          var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n          return bounds$1(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n        },\n        parts: __assign(__assign({}, baseSpec.parts), {\n          overflow: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: toolbarSpec.attributes\n            }\n          }\n        }),\n        components: [primary],\n        markers: { overflowToggledClass: 'tox-tbtn--enabled' }\n      }));\n    };\n    var renderSlidingMoreToolbar = function (toolbarSpec) {\n      var primary = SplitSlidingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      var overflow = SplitSlidingToolbar.parts.overflow({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__overflow']\n        }\n      });\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        components: [\n          primary,\n          overflow\n        ],\n        markers: {\n          openClass: 'tox-toolbar__overflow--open',\n          closedClass: 'tox-toolbar__overflow--closed',\n          growingClass: 'tox-toolbar__overflow--growing',\n          shrinkingClass: 'tox-toolbar__overflow--shrinking',\n          overflowToggledClass: 'tox-tbtn--enabled'\n        },\n        onOpened: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'opened' });\n        },\n        onClosed: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'closed' });\n        }\n      }));\n    };\n    var renderToolbar = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return Toolbar.sketch({\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n        },\n        components: [Toolbar.parts.groups({})],\n        toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      });\n    };\n\n    var groupToolbarButtonSchema = objOf([\n      strictString('type'),\n      strictOf('items', oneOf([\n        arrOfObj$1([\n          strictString('name'),\n          strictArrayOf('items', string)\n        ]),\n        string\n      ]))\n    ].concat(baseToolbarButtonFields));\n    var createGroupToolbarButton = function (spec) {\n      return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n    };\n\n    var baseMenuButtonFields = [\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      strictFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n\n    var MenuButtonSchema = objOf(__spreadArrays([strictString('type')], baseMenuButtonFields));\n    var createMenuButton = function (spec) {\n      return asRaw('menubutton', MenuButtonSchema, spec);\n    };\n\n    var splitButtonSchema = objOf([\n      strictString('type'),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      optionFunction('select'),\n      strictFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedStringEnum('presets', 'normal', [\n        'normal',\n        'color',\n        'listpreview'\n      ]),\n      defaulted$1('columns', 1),\n      strictFunction('onAction'),\n      strictFunction('onItemAction')\n    ]);\n    var createSplitButton = function (spec) {\n      return asRaw('SplitButton', splitButtonSchema, spec);\n    };\n\n    var events$e = function (reflectingConfig, reflectingState) {\n      var update = function (component, data) {\n        reflectingConfig.updateState.each(function (updateState) {\n          var newState = updateState(component, data);\n          reflectingState.set(newState);\n        });\n        reflectingConfig.renderComponents.each(function (renderComponents) {\n          var newComponents = renderComponents(data, reflectingState.get());\n          var newChildren = map(newComponents, component.getSystem().build);\n          replaceChildren(component, newChildren);\n        });\n      };\n      return derive([\n        run(receive(), function (component, message) {\n          var receivingData = message;\n          if (!receivingData.universal) {\n            var channel = reflectingConfig.channel;\n            if (contains(receivingData.channels, channel)) {\n              update(component, receivingData.data);\n            }\n          }\n        }),\n        runOnAttached(function (comp, _se) {\n          reflectingConfig.initialData.each(function (rawData) {\n            update(comp, rawData);\n          });\n        })\n      ]);\n    };\n\n    var ActiveReflecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$e\n    });\n\n    var getState$2 = function (component, replaceConfig, reflectState) {\n      return reflectState;\n    };\n\n    var ReflectingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getState: getState$2\n    });\n\n    var ReflectingSchema = [\n      strict$1('channel'),\n      option('renderComponents'),\n      option('updateState'),\n      option('initialData')\n    ];\n\n    var init$a = function () {\n      var cell = Cell(Optional.none());\n      var set = function (optS) {\n        return cell.set(optS);\n      };\n      var clear = function () {\n        return cell.set(Optional.none());\n      };\n      var get = function () {\n        return cell.get();\n      };\n      var readState = function () {\n        return cell.get().fold(function () {\n          return 'none';\n        }, function (x) {\n          return x;\n        });\n      };\n      return {\n        readState: readState,\n        get: get,\n        set: set,\n        clear: clear\n      };\n    };\n\n    var ReflectingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$a\n    });\n\n    var Reflecting = create$1({\n      fields: ReflectingSchema,\n      name: 'reflecting',\n      active: ActiveReflecting,\n      apis: ReflectingApis,\n      state: ReflectingState\n    });\n\n    var schema$q = constant([\n      strict$1('toggleClass'),\n      strict$1('fetch'),\n      onStrictHandler('onExecute'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      schema$1(),\n      onStrictHandler('onItemExecute'),\n      option('lazySink'),\n      strict$1('dom'),\n      onHandler('onOpen'),\n      field$1('splitDropdownBehaviours', [\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      defaulted$1('matchWidth', false),\n      defaulted$1('useMinWidth', false),\n      defaulted$1('eventOrder', {}),\n      option('role')\n    ].concat(sandboxFields()));\n    var arrowPart = required({\n      factory: Button,\n      schema: [strict$1('dom')],\n      name: 'arrow',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (arrow) {\n            arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n          },\n          buttonBehaviours: derive$1([Toggling.config({\n              toggleOnExecute: false,\n              toggleClass: detail.toggleClass\n            })])\n        };\n      }\n    });\n    var buttonPart = required({\n      factory: Button,\n      schema: [strict$1('dom')],\n      name: 'button',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (btn) {\n            btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n              detail.onExecute(splitDropdown, btn);\n            });\n          }\n        };\n      }\n    });\n    var parts$c = constant([\n      arrowPart,\n      buttonPart,\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [strict$1('text')],\n        name: 'aria-descriptor'\n      }),\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return {\n            onExecute: function (tmenu, item) {\n              tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n                detail.onItemExecute(splitDropdown, tmenu, item);\n              });\n            }\n          };\n        }\n      }),\n      partType()\n    ]);\n\n    var factory$e = function (detail, components, spec, externals) {\n      var _a;\n      var switchToMenu = function (sandbox) {\n        Composing.getCurrent(sandbox).each(function (current) {\n          Highlighting.highlightFirst(current);\n          Keying.focusIn(current);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, function (x) {\n          return x;\n        }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var openMenu = function (comp) {\n        action(comp);\n        return Optional.some(true);\n      };\n      var executeOnButton = function (comp) {\n        var button = getPartOrDie(comp, detail, 'button');\n        emitExecute(button);\n        return Optional.some(true);\n      };\n      var buttonEvents = __assign(__assign({}, derive([runOnAttached(function (component, _simulatedEvent) {\n          var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n          ariaDescriptor.each(function (descriptor) {\n            var descriptorId = generate$1('aria');\n            set$1(descriptor.element, 'id', descriptorId);\n            set$1(component.element, 'aria-describedby', descriptorId);\n          });\n        })])), events$7(Optional.some(action)));\n      var apis = {\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        events: buttonEvents,\n        behaviours: augment(detail.splitDropdownBehaviours, [\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                var arrow = getPartOrDie(hotspot, detail, 'arrow');\n                var extras = {\n                  onOpen: function () {\n                    Toggling.on(arrow);\n                    Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    Toggling.off(arrow);\n                    Toggling.off(hotspot);\n                  }\n                };\n                return makeSandbox(detail, hotspot, extras);\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: executeOnButton,\n            onEnter: executeOnButton,\n            onDown: openMenu\n          }),\n          Focusing.config({}),\n          Toggling.config({\n            toggleOnExecute: false,\n            aria: { mode: 'expanded' }\n          })\n        ]),\n        domModification: {\n          attributes: {\n            'role': detail.role.getOr('button'),\n            'aria-haspopup': true\n          }\n        }\n      };\n    };\n    var SplitDropdown = composite$1({\n      name: 'SplitDropdown',\n      configFields: schema$q(),\n      partFields: parts$c(),\n      factory: factory$e,\n      apis: {\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var getButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getToggleApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getTooltipAttributes = function (tooltip, providersBackstage) {\n      return tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n    };\n    var focusButtonEvent = generate$1('focus-button');\n    var rtlIcon$1 = [\n      'checklist',\n      'ordered-list'\n    ];\n    var rtlTransform$1 = [\n      'indent',\n      'outdent',\n      'table-insert-column-after',\n      'table-insert-column-before',\n      'unordered-list'\n    ];\n    var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n      var _d;\n      var getIconName = function (iconName) {\n        return global$6.isRtl() && contains(rtlIcon$1, iconName) ? iconName + '-rtl' : iconName;\n      };\n      var needsRtlClass = global$6.isRtl() && icon.exists(function (name) {\n        return contains(rtlTransform$1, name);\n      });\n      return {\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []).concat(needsRtlClass ? ['tox-tbtn__icon-rtl'] : []),\n          attributes: getTooltipAttributes(tooltip, providersBackstage)\n        },\n        components: componentRenderPipeline([\n          icon.map(function (iconName) {\n            return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n          }),\n          text.map(function (text) {\n            return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n          })\n        ]),\n        eventOrder: (_d = {}, _d[mousedown()] = [\n          'focusing',\n          'alloy.base.behaviour',\n          'common-button-display-events'\n        ], _d),\n        buttonBehaviours: derive$1([\n          DisablingConfigs.toolbarButton(providersBackstage.isReadOnly),\n          receivingConfig(),\n          config('common-button-display-events', [run(mousedown(), function (button, se) {\n              se.event.prevent();\n              emit(button, focusButtonEvent);\n            })])\n        ].concat(receiver.map(function (r) {\n          return Reflecting.config({\n            channel: r,\n            initialData: {\n              icon: icon,\n              text: text\n            },\n            renderComponents: function (data, _state) {\n              return componentRenderPipeline([\n                data.icon.map(function (iconName) {\n                  return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n                }),\n                data.text.map(function (text) {\n                  return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n                })\n              ]);\n            }\n          });\n        }).toArray()).concat(behaviours.getOr([])))\n      };\n    };\n    var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n      var sharedBackstage = backstage.shared;\n      return FloatingToolbarButton.sketch({\n        lazySink: sharedBackstage.getSink,\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(map(identifyButtons(spec.items), renderToolbarGroup));\n          });\n        },\n        markers: { toggledClass: 'tox-tbtn--enabled' },\n        parts: {\n          button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n          toolbar: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: attributes\n            }\n          }\n        }\n      });\n    };\n    var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n      var editorOffCell = Cell(noop);\n      var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n      return Button.sketch({\n        dom: structure.dom,\n        components: structure.components,\n        eventOrder: toolbarButtonEventOrder,\n        buttonBehaviours: derive$1([\n          config('toolbar-button-events', [\n            onToolbarButtonExecute({\n              onAction: spec.onAction,\n              getApi: specialisation.getApi\n            }),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          DisablingConfigs.toolbarButton(function () {\n            return spec.disabled || providersBackstage.isReadOnly();\n          }),\n          receivingConfig()\n        ].concat(specialisation.toolbarButtonBehaviours))\n      });\n    };\n    var renderToolbarButton = function (spec, providersBackstage) {\n      return renderToolbarButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n        getApi: getButtonApi,\n        onSetup: spec.onSetup\n      }, providersBackstage);\n    };\n    var renderToolbarToggleButton = function (spec, providersBackstage) {\n      return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return deepMerge(renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [\n          Replacing.config({}),\n          Toggling.config({\n            toggleClass: 'tox-tbtn--enabled',\n            aria: { mode: 'pressed' },\n            toggleOnExecute: false\n          })\n        ].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n        getApi: getToggleApi,\n        onSetup: spec.onSetup\n      }, providersBackstage));\n    };\n    var fetchChoices = function (getApi, spec, providersBackstage) {\n      return function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n            spec.onItemAction(getApi(comp), value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(function () {\n            return false;\n          }), providersBackstage), {\n            movement: deriveMenuMovement(spec.columns, spec.presets),\n            menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n                detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n                  var numRows = _d.numRows, numColumns = _d.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              })])\n          })));\n        });\n      };\n    };\n    var renderSplitButton = function (spec, sharedBackstage) {\n      var _d;\n      var displayChannel = generate$1('channel-update-split-dropdown-display');\n      var getApi = function (comp) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(comp);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(comp, state);\n          },\n          setIconFill: function (id, value) {\n            descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$1(underlinePath, 'fill', value);\n            });\n          },\n          setIconStroke: function (id, value) {\n            descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$1(underlinePath, 'stroke', value);\n            });\n          },\n          setActive: function (state) {\n            set$1(comp.element, 'aria-pressed', state);\n            descendant$1(comp.element, 'span').each(function (button) {\n              comp.getSystem().getByDom(button).each(function (buttonComp) {\n                return Toggling.set(buttonComp, state);\n              });\n            });\n          },\n          isActive: function () {\n            return descendant$1(comp.element, 'span').exists(function (button) {\n              return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n            });\n          }\n        };\n      };\n      var editorOffCell = Cell(noop);\n      var specialisation = {\n        getApi: getApi,\n        onSetup: spec.onSetup\n      };\n      return SplitDropdown.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-split-button'],\n          attributes: __assign({ 'aria-pressed': false }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n        },\n        onExecute: function (button) {\n          spec.onAction(getApi(button));\n        },\n        onItemExecute: function (_a, _b, _c) {\n        },\n        splitDropdownBehaviours: derive$1([\n          DisablingConfigs.splitButton(sharedBackstage.providers.isReadOnly),\n          receivingConfig(),\n          config('split-dropdown-events', [\n            run(focusButtonEvent, Focusing.focus),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          Unselecting.config({})\n        ]),\n        eventOrder: (_d = {}, _d[attachedToDom()] = [\n          'alloy.base.behaviour',\n          'split-dropdown-events'\n        ], _d),\n        toggleClass: 'tox-tbtn--enabled',\n        lazySink: sharedBackstage.getSink,\n        fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        components: [\n          SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n              toggleClass: 'tox-tbtn--enabled',\n              toggleOnExecute: false\n            })]), sharedBackstage.providers)),\n          SplitDropdown.parts.arrow({\n            dom: {\n              tag: 'button',\n              classes: [\n                'tox-tbtn',\n                'tox-split-button__chevron'\n              ],\n              innerHtml: get$d('chevron-down', sharedBackstage.providers.icons)\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.splitButton(sharedBackstage.providers.isReadOnly),\n              receivingConfig()\n            ])\n          }),\n          SplitDropdown.parts['aria-descriptor']({ text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter') })\n        ]\n      });\n    };\n\n    var getFormApi = function (input) {\n      return {\n        hide: function () {\n          return emit(input, sandboxClose());\n        },\n        getValue: function () {\n          return Representing.getValue(input);\n        }\n      };\n    };\n    var runOnExecute$1 = function (memInput, original) {\n      return run(internalToolbarButtonExecute, function (comp, se) {\n        var input = memInput.get(comp);\n        var formApi = getFormApi(input);\n        original.onAction(formApi, se.event.buttonApi);\n      });\n    };\n    var renderContextButton = function (memInput, button, extras) {\n      var _a = button.original, primary = _a.primary, rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n        type: 'button',\n        onAction: function () {\n        }\n      })));\n      return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n    };\n    var renderContextToggleButton = function (memInput, button, extras) {\n      var _a = button.original, primary = _a.primary, rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n        type: 'togglebutton',\n        onAction: function () {\n        }\n      })));\n      return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n    };\n    var generateOne$1 = function (memInput, button, providersBackstage) {\n      var extras = { backstage: { shared: { providers: providersBackstage } } };\n      if (button.type === 'contextformtogglebutton') {\n        return renderContextToggleButton(memInput, button, extras);\n      } else {\n        return renderContextButton(memInput, button, extras);\n      }\n    };\n    var generate$7 = function (memInput, buttons, providersBackstage) {\n      var mementos = map(buttons, function (button) {\n        return record(generateOne$1(memInput, button, providersBackstage));\n      });\n      var asSpecs = function () {\n        return map(mementos, function (mem) {\n          return mem.asSpec();\n        });\n      };\n      var findPrimary = function (compInSystem) {\n        return findMap(buttons, function (button, i) {\n          if (button.primary) {\n            return Optional.from(mementos[i]).bind(function (mem) {\n              return mem.getOpt(compInSystem);\n            }).filter(not(Disabling.isDisabled));\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      return {\n        asSpecs: asSpecs,\n        findPrimary: findPrimary\n      };\n    };\n\n    var buildInitGroups = function (ctx, providers) {\n      var inputAttributes = ctx.label.fold(function () {\n        return {};\n      }, function (label) {\n        return { 'aria-label': label };\n      });\n      var memInput = record(Input.sketch({\n        inputClasses: [\n          'tox-toolbar-textfield',\n          'tox-toolbar-nav-js'\n        ],\n        data: ctx.initValue(),\n        inputAttributes: inputAttributes,\n        selectOnFocus: true,\n        inputBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onEnter: function (input) {\n              return commands.findPrimary(input).map(function (primary) {\n                emitExecute(primary);\n                return true;\n              });\n            },\n            onLeft: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            },\n            onRight: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            }\n          })])\n      }));\n      var commands = generate$7(memInput, ctx.commands, providers);\n      return [\n        {\n          title: Optional.none(),\n          items: [memInput.asSpec()]\n        },\n        {\n          title: Optional.none(),\n          items: commands.asSpecs()\n        }\n      ];\n    };\n    var renderContextForm = function (toolbarType, ctx, providers) {\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$1('context-toolbar'),\n        initGroups: buildInitGroups(ctx, providers),\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: providers\n      });\n    };\n    var ContextForm = {\n      renderContextForm: renderContextForm,\n      buildInitGroups: buildInitGroups\n    };\n\n    var getHorizontalBounds = function (contentAreaBox, viewportBounds) {\n      var x = Math.max(viewportBounds.x, contentAreaBox.x);\n      var contentBoxWidth = contentAreaBox.right - x;\n      var maxViewportWidth = viewportBounds.width - (x - viewportBounds.x);\n      var width = Math.min(contentBoxWidth, maxViewportWidth);\n      return {\n        x: x,\n        width: width\n      };\n    };\n    var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var header = descendant$1(container, '.tox-editor-header').getOr(container);\n      var headerBox = box(header);\n      var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n      var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n      if (editor.inline && isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom, viewportBounds.y),\n          bottom: viewportBounds.bottom\n        };\n      }\n      if (editor.inline && !isToolbarAbove) {\n        return {\n          y: viewportBounds.y,\n          bottom: Math.min(headerBox.y, viewportBounds.bottom)\n        };\n      }\n      var containerBounds = box(container);\n      if (isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom, viewportBounds.y),\n          bottom: Math.min(containerBounds.bottom, viewportBounds.bottom)\n        };\n      }\n      return {\n        y: Math.max(containerBounds.y, viewportBounds.y),\n        bottom: Math.min(headerBox.y, viewportBounds.bottom)\n      };\n    };\n    var getContextToolbarBounds = function (editor, sharedBackstage) {\n      var viewportBounds = getBounds(window);\n      var contentAreaBox = box(SugarElement.fromDom(editor.getContentAreaContainer()));\n      var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n      var _a = getHorizontalBounds(contentAreaBox, viewportBounds), x = _a.x, width = _a.width;\n      if (editor.inline && !toolbarOrMenubarEnabled) {\n        return bounds$1(x, viewportBounds.y, width, viewportBounds.height);\n      } else {\n        var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n        var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop), y = _b.y, bottom = _b.bottom;\n        return bounds$1(x, y, width, bottom - y);\n      }\n    };\n\n    var matchTargetWith = function (elem, candidates) {\n      var ctxs = filter(candidates, function (toolbarApi) {\n        return toolbarApi.predicate(elem.dom);\n      });\n      var _a = partition(ctxs, function (t) {\n          return t.type === 'contexttoolbar';\n        }), pass = _a.pass, fail = _a.fail;\n      return {\n        contextToolbars: pass,\n        contextForms: fail\n      };\n    };\n    var filterByPositionForStartNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var doesPositionExist = function (value) {\n          return exists(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var filterToolbarsByPosition = function (value) {\n          return filter(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var hasSelectionToolbars = doesPositionExist('selection');\n        var hasNodeToolbars = doesPositionExist('node');\n        if (hasSelectionToolbars || hasNodeToolbars) {\n          if (hasNodeToolbars && hasSelectionToolbars) {\n            var nodeToolbars = filterToolbarsByPosition('node');\n            var selectionToolbars = map(filterToolbarsByPosition('selection'), function (t) {\n              return __assign(__assign({}, t), { position: 'node' });\n            });\n            return nodeToolbars.concat(selectionToolbars);\n          } else {\n            return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n          }\n        } else {\n          return filterToolbarsByPosition('line');\n        }\n      }\n    };\n    var filterByPositionForAncestorNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var findPosition_1 = function (value) {\n          return find(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var basePosition = findPosition_1('selection').orThunk(function () {\n          return findPosition_1('node');\n        }).orThunk(function () {\n          return findPosition_1('line');\n        }).map(function (t) {\n          return t.position;\n        });\n        return basePosition.fold(function () {\n          return [];\n        }, function (pos) {\n          return filter(toolbars, function (t) {\n            return t.position === pos;\n          });\n        });\n      }\n    };\n    var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n      var nodeMatches = matchTargetWith(elem, nodeCandidates);\n      if (nodeMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [nodeMatches.contextForms[0]]\n        });\n      } else {\n        var editorMatches = matchTargetWith(elem, editorCandidates);\n        if (editorMatches.contextForms.length > 0) {\n          return Optional.some({\n            elem: elem,\n            toolbars: [editorMatches.contextForms[0]]\n          });\n        } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n          var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n          return Optional.some({\n            elem: elem,\n            toolbars: toolbars\n          });\n        } else {\n          return Optional.none();\n        }\n      }\n    };\n    var matchAncestor = function (isRoot, startNode, scopes) {\n      if (isRoot(startNode)) {\n        return Optional.none();\n      } else {\n        return ancestor(startNode, function (ancestorElem) {\n          var _a = matchTargetWith(ancestorElem, scopes.inNodeScope), contextToolbars = _a.contextToolbars, contextForms = _a.contextForms;\n          var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n          return toolbars.length > 0 ? Optional.some({\n            elem: ancestorElem,\n            toolbars: toolbars\n          }) : Optional.none();\n        }, isRoot);\n      }\n    };\n    var lookup$1 = function (scopes, editor) {\n      var rootElem = SugarElement.fromDom(editor.getBody());\n      var isRoot = function (elem) {\n        return eq$1(elem, rootElem);\n      };\n      var isOutsideRoot = function (startNode) {\n        return !isRoot(startNode) && !contains$2(rootElem, startNode);\n      };\n      var startNode = SugarElement.fromDom(editor.selection.getNode());\n      if (isOutsideRoot(startNode)) {\n        return Optional.none();\n      }\n      return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n        return matchAncestor(isRoot, startNode, scopes);\n      });\n    };\n\n    var categorise = function (contextToolbars, navigate) {\n      var forms = {};\n      var inNodeScope = [];\n      var inEditorScope = [];\n      var formNavigators = {};\n      var lookupTable = {};\n      var registerForm = function (key, toolbarSpec) {\n        var contextForm = getOrDie(createContextForm(toolbarSpec));\n        forms[key] = contextForm;\n        contextForm.launch.map(function (launch) {\n          formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n            type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n            onAction: function () {\n              navigate(contextForm);\n            }\n          });\n        });\n        if (contextForm.scope === 'editor') {\n          inEditorScope.push(contextForm);\n        } else {\n          inNodeScope.push(contextForm);\n        }\n        lookupTable[key] = contextForm;\n      };\n      var registerToolbar = function (key, toolbarSpec) {\n        createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n          if (toolbarSpec.scope === 'editor') {\n            inEditorScope.push(contextToolbar);\n          } else {\n            inNodeScope.push(contextToolbar);\n          }\n          lookupTable[key] = contextToolbar;\n        });\n      };\n      var keys$1 = keys(contextToolbars);\n      each(keys$1, function (key) {\n        var toolbarApi = contextToolbars[key];\n        if (toolbarApi.type === 'contextform') {\n          registerForm(key, toolbarApi);\n        } else if (toolbarApi.type === 'contexttoolbar') {\n          registerToolbar(key, toolbarApi);\n        }\n      });\n      return {\n        forms: forms,\n        inNodeScope: inNodeScope,\n        inEditorScope: inEditorScope,\n        lookupTable: lookupTable,\n        formNavigators: formNavigators\n      };\n    };\n\n    var forwardSlideEvent = generate$1('forward-slide');\n    var backSlideEvent = generate$1('backward-slide');\n    var changeSlideEvent = generate$1('change-slide-event');\n    var resizingClass = 'tox-pop--resizing';\n    var renderContextToolbar = function (spec) {\n      var stack = Cell([]);\n      return InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop']\n        },\n        fireDismissalEventInstead: { event: 'doNotDismissYet' },\n        onShow: function (comp) {\n          stack.set([]);\n          InlineView.getContent(comp).each(function (c) {\n            remove$6(c.element, 'visibility');\n          });\n          remove$4(comp.element, resizingClass);\n          remove$6(comp.element, 'width');\n        },\n        inlineBehaviours: derive$1([\n          config('context-toolbar-events', [\n            runOnSource(transitionend(), function (comp, _se) {\n              remove$4(comp.element, resizingClass);\n              remove$6(comp.element, 'width');\n            }),\n            run(changeSlideEvent, function (comp, se) {\n              remove$6(comp.element, 'width');\n              var currentWidth = get$7(comp.element);\n              InlineView.setContent(comp, se.event.contents);\n              add$2(comp.element, resizingClass);\n              var newWidth = get$7(comp.element);\n              set$2(comp.element, 'width', currentWidth + 'px');\n              InlineView.getContent(comp).each(function (newContents) {\n                se.event.focus.bind(function (f) {\n                  focus$1(f);\n                  return search(comp.element);\n                }).orThunk(function () {\n                  Keying.focusIn(newContents);\n                  return active();\n                });\n              });\n              global$2.setTimeout(function () {\n                set$2(comp.element, 'width', newWidth + 'px');\n              }, 0);\n            }),\n            run(forwardSlideEvent, function (comp, se) {\n              InlineView.getContent(comp).each(function (oldContents) {\n                stack.set(stack.get().concat([{\n                    bar: oldContents,\n                    focus: active()\n                  }]));\n              });\n              emitWith(comp, changeSlideEvent, {\n                contents: se.event.forwardContents,\n                focus: Optional.none()\n              });\n            }),\n            run(backSlideEvent, function (comp, _se) {\n              last(stack.get()).each(function (last) {\n                stack.set(stack.get().slice(0, stack.get().length - 1));\n                emitWith(comp, changeSlideEvent, {\n                  contents: premade$1(last.bar),\n                  focus: last.focus\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              return last(stack.get()).fold(function () {\n                return spec.onEscape();\n              }, function (_) {\n                emit(comp, backSlideEvent);\n                return Optional.some(true);\n              });\n            }\n          })\n        ]),\n        lazySink: function () {\n          return Result.value(spec.sink);\n        }\n      });\n    };\n\n    var generateSelectItems = function (_editor, backstage, spec) {\n      var generateItem = function (rawItem, response, disabled, value) {\n        var translatedText = backstage.shared.providers.translate(rawItem.title);\n        if (rawItem.type === 'separator') {\n          return Optional.some({\n            type: 'separator',\n            text: translatedText\n          });\n        } else if (rawItem.type === 'submenu') {\n          var items = bind(rawItem.getStyleItems(), function (si) {\n            return validate(si, response, value);\n          });\n          if (response === 0 && items.length <= 0) {\n            return Optional.none();\n          } else {\n            return Optional.some({\n              type: 'nestedmenuitem',\n              text: translatedText,\n              disabled: items.length <= 0,\n              getSubmenuItems: function () {\n                return bind(rawItem.getStyleItems(), function (si) {\n                  return validate(si, response, value);\n                });\n              }\n            });\n          }\n        } else {\n          return Optional.some(__assign({\n            type: 'togglemenuitem',\n            text: translatedText,\n            icon: rawItem.icon,\n            active: rawItem.isSelected(value),\n            disabled: disabled,\n            onAction: spec.onAction(rawItem)\n          }, rawItem.getStylePreview().fold(function () {\n            return {};\n          }, function (preview) {\n            return { meta: { style: preview } };\n          })));\n        }\n      };\n      var validate = function (item, response, value) {\n        var invalid = item.type === 'formatter' && spec.isInvalid(item);\n        if (response === 0) {\n          return invalid ? [] : generateItem(item, response, false, value).toArray();\n        } else {\n          return generateItem(item, response, invalid, value).toArray();\n        }\n      };\n      var validateItems = function (preItems) {\n        var value = spec.getCurrentValue();\n        var response = spec.shouldHide ? 0 : 1;\n        return bind(preItems, function (item) {\n          return validate(item, response, value);\n        });\n      };\n      var getFetch = function (backstage, getStyleItems) {\n        return function (comp, callback) {\n          var preItems = getStyleItems();\n          var items = validateItems(preItems);\n          var menu = build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n          callback(menu);\n        };\n      };\n      return {\n        validateItems: validateItems,\n        getFetch: getFetch\n      };\n    };\n    var createMenuItems = function (editor, backstage, spec) {\n      var dataset = spec.dataset;\n      var getStyleItems = dataset.type === 'basic' ? function () {\n        return map(dataset.data, function (d) {\n          return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n        });\n      } : dataset.getData;\n      return {\n        items: generateSelectItems(editor, backstage, spec),\n        getStyleItems: getStyleItems\n      };\n    };\n    var createSelectButton = function (editor, backstage, spec) {\n      var _a = createMenuItems(editor, backstage, spec), items = _a.items, getStyleItems = _a.getStyleItems;\n      var getApi = function (comp) {\n        return {\n          getComponent: function () {\n            return comp;\n          }\n        };\n      };\n      var onSetup = function (api) {\n        spec.setInitialValue.each(function (f) {\n          return f(api.getComponent());\n        });\n        return spec.nodeChangeHandler.map(function (f) {\n          var handler = f(api.getComponent());\n          editor.on('NodeChange', handler);\n          return function () {\n            editor.off('NodeChange', handler);\n          };\n        }).getOr(noop);\n      };\n      return renderCommonDropdown({\n        text: spec.icon.isSome() ? Optional.none() : Optional.some(''),\n        icon: spec.icon,\n        tooltip: Optional.from(spec.tooltip),\n        role: Optional.none(),\n        fetch: items.getFetch(backstage, getStyleItems),\n        onSetup: onSetup,\n        getApi: getApi,\n        columns: 1,\n        presets: 'normal',\n        classes: spec.icon.isSome() ? [] : ['bespoke'],\n        dropdownBehaviours: []\n      }, 'tox-tbtn', backstage.shared);\n    };\n\n    var process = function (rawFormats) {\n      return map(rawFormats, function (item) {\n        var title = item, format = item;\n        var values = item.split('=');\n        if (values.length > 1) {\n          title = values[0];\n          format = values[1];\n        }\n        return {\n          title: title,\n          format: format\n        };\n      });\n    };\n    var buildBasicStaticDataset = function (data) {\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n    var Delimiter;\n    (function (Delimiter) {\n      Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n      Delimiter[Delimiter['Space'] = 1] = 'Space';\n    }(Delimiter || (Delimiter = {})));\n    var split = function (rawFormats, delimiter) {\n      if (delimiter === Delimiter.SemiColon) {\n        return rawFormats.replace(/;$/, '').split(';');\n      } else {\n        return rawFormats.split(' ');\n      }\n    };\n    var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n      var rawFormats = editor.getParam(settingName, defaults, 'string');\n      var data = process(split(rawFormats, delimiter));\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n\n    var alignMenuItems = [\n      {\n        title: 'Left',\n        icon: 'align-left',\n        format: 'alignleft',\n        command: 'JustifyLeft'\n      },\n      {\n        title: 'Center',\n        icon: 'align-center',\n        format: 'aligncenter',\n        command: 'JustifyCenter'\n      },\n      {\n        title: 'Right',\n        icon: 'align-right',\n        format: 'alignright',\n        command: 'JustifyRight'\n      },\n      {\n        title: 'Justify',\n        icon: 'align-justify',\n        format: 'alignjustify',\n        command: 'JustifyFull'\n      }\n    ];\n    var getSpec = function (editor) {\n      var getMatchingValue = function () {\n        return find(alignMenuItems, function (item) {\n          return editor.formatter.match(item.format);\n        });\n      };\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (_format) {\n        return function () {\n          return Optional.none();\n        };\n      };\n      var updateSelectMenuIcon = function (comp) {\n        var match = getMatchingValue();\n        var alignment = match.fold(function () {\n          return 'left';\n        }, function (item) {\n          return item.title.toLowerCase();\n        });\n        emitWith(comp, updateMenuIcon, { icon: 'align-' + alignment });\n      };\n      var nodeChangeHandler = Optional.some(function (comp) {\n        return function () {\n          return updateSelectMenuIcon(comp);\n        };\n      });\n      var setInitialValue = Optional.some(function (comp) {\n        return updateSelectMenuIcon(comp);\n      });\n      var dataset = buildBasicStaticDataset(alignMenuItems);\n      var onAction = function (rawItem) {\n        return function () {\n          return find(alignMenuItems, function (item) {\n            return item.format === rawItem.format;\n          }).each(function (item) {\n            return editor.execCommand(item.command);\n          });\n        };\n      };\n      return {\n        tooltip: 'Align',\n        icon: Optional.some('align-left'),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        setInitialValue: setInitialValue,\n        nodeChangeHandler: nodeChangeHandler,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createAlignSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec(editor));\n    };\n    var alignSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec(editor));\n      editor.ui.registry.addNestedMenuItem('align', {\n        text: backstage.shared.providers.translate('Align'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n    var systemStackFonts = [\n      '-apple-system',\n      'Segoe UI',\n      'Roboto',\n      'Helvetica Neue',\n      'sans-serif'\n    ];\n    var splitFonts = function (fontFamily) {\n      var fonts = fontFamily.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        return font.replace(/^['\"]+|['\"]+$/g, '');\n      });\n    };\n    var isSystemFontStack = function (fontFamily) {\n      var matchesSystemStack = function () {\n        var fonts = splitFonts(fontFamily.toLowerCase());\n        return forall(systemStackFonts, function (font) {\n          return fonts.indexOf(font.toLowerCase()) > -1;\n        });\n      };\n      return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n    };\n    var getSpec$1 = function (editor) {\n      var getMatchingValue = function () {\n        var getFirstFont = function (fontFamily) {\n          return fontFamily ? splitFonts(fontFamily)[0] : '';\n        };\n        var fontFamily = editor.queryCommandValue('FontName');\n        var items = dataset.data;\n        var font = fontFamily ? fontFamily.toLowerCase() : '';\n        var matchOpt = find(items, function (item) {\n          var format = item.format;\n          return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n        }).orThunk(function () {\n          if (isSystemFontStack(font)) {\n            return Optional.from({\n              title: 'System Font',\n              format: font\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n        return {\n          matchOpt: matchOpt,\n          font: fontFamily\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = function (item) {\n        return function () {\n          return Optional.some({\n            tag: 'div',\n            styles: item.indexOf('dings') === -1 ? { 'font-family': item } : {}\n          });\n        };\n      };\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontName', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, font = _a.font;\n        var text = matchOpt.fold(function () {\n          return font;\n        }, function (item) {\n          return item.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var nodeChangeHandler = Optional.some(function (comp) {\n        return function () {\n          return updateSelectMenuText(comp);\n        };\n      });\n      var setInitialValue = Optional.some(function (comp) {\n        return updateSelectMenuText(comp);\n      });\n      var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n      return {\n        tooltip: 'Fonts',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: getCurrentValue,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        setInitialValue: setInitialValue,\n        nodeChangeHandler: nodeChangeHandler,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function () {\n          return false;\n        }\n      };\n    };\n    var createFontSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$1(editor));\n    };\n    var fontSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n      editor.ui.registry.addNestedMenuItem('fontformats', {\n        text: backstage.shared.providers.translate('Fonts'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n    var legacyFontSizes = {\n      '8pt': '1',\n      '10pt': '2',\n      '12pt': '3',\n      '14pt': '4',\n      '18pt': '5',\n      '24pt': '6',\n      '36pt': '7'\n    };\n    var round$1 = function (number, precision) {\n      var factor = Math.pow(10, precision);\n      return Math.round(number * factor) / factor;\n    };\n    var toPt = function (fontSize, precision) {\n      if (/[0-9.]+px$/.test(fontSize)) {\n        return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n      }\n      return fontSize;\n    };\n    var toLegacy = function (fontSize) {\n      return get(legacyFontSizes, fontSize).getOr('');\n    };\n    var getSpec$2 = function (editor) {\n      var getMatchingValue = function () {\n        var matchOpt = Optional.none();\n        var items = dataset.data;\n        var fontSize = editor.queryCommandValue('FontSize');\n        if (fontSize) {\n          var _loop_1 = function (precision) {\n            var pt = toPt(fontSize, precision);\n            var legacy = toLegacy(pt);\n            matchOpt = find(items, function (item) {\n              return item.format === fontSize || item.format === pt || item.format === legacy;\n            });\n          };\n          for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n            _loop_1(precision);\n          }\n        }\n        return {\n          matchOpt: matchOpt,\n          size: fontSize\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = constant(Optional.none);\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontSize', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, size = _a.size;\n        var text = matchOpt.fold(function () {\n          return size;\n        }, function (match) {\n          return match.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var nodeChangeHandler = Optional.some(function (comp) {\n        return function () {\n          return updateSelectMenuText(comp);\n        };\n      });\n      var setInitialValue = Optional.some(function (comp) {\n        return updateSelectMenuText(comp);\n      });\n      var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n      return {\n        tooltip: 'Font sizes',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getPreviewFor: getPreviewFor,\n        getCurrentValue: getCurrentValue,\n        onAction: onAction,\n        setInitialValue: setInitialValue,\n        nodeChangeHandler: nodeChangeHandler,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function () {\n          return false;\n        }\n      };\n    };\n    var createFontsizeSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$2(editor));\n    };\n    var fontsizeSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n      editor.ui.registry.addNestedMenuItem('fontsizes', {\n        text: 'Font sizes',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var findNearest = function (editor, getStyles, parents) {\n      var styles = getStyles();\n      return findMap(parents, function (parent) {\n        return find(styles, function (fmt) {\n          return editor.formatter.matchNode(parent, fmt.format);\n        });\n      }).orThunk(function () {\n        if (editor.formatter.match('p')) {\n          return Optional.some({\n            title: 'Paragraph',\n            format: 'p'\n          });\n        }\n        return Optional.none();\n      });\n    };\n    var getCurrentSelectionParents = function (editor) {\n      var currentNode = editor.selection.getStart(true) || editor.getBody();\n      return editor.dom.getParents(currentNode, function () {\n        return true;\n      }, editor.getBody());\n    };\n\n    var revocable = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        set: set\n      };\n    };\n    var destroyable = function () {\n      return revocable(function (s) {\n        return s.destroy();\n      });\n    };\n    var unbindable = function () {\n      return revocable(function (s) {\n        return s.unbind();\n      });\n    };\n    var value$3 = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var onSetupFormatToggle = function (editor, name) {\n      return function (api) {\n        var boundCallback = unbindable();\n        var init = function () {\n          api.setActive(editor.formatter.match(name));\n          var binding = editor.formatter.formatChanged(name, api.setActive);\n          boundCallback.set(binding);\n        };\n        editor.initialized ? init() : editor.on('init', init);\n        return boundCallback.clear;\n      };\n    };\n    var onActionToggleFormat = function (editor) {\n      return function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('mceToggleFormat', false, rawItem.format);\n          });\n        };\n      };\n    };\n\n    var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n    var getSpec$3 = function (editor) {\n      var getMatchingValue = function (nodeChangeEvent) {\n        return findNearest(editor, function () {\n          return dataset.data;\n        }, nodeChangeEvent);\n      };\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          });\n        };\n      };\n      var updateSelectMenuText = function (parents, comp) {\n        var detectedFormat = getMatchingValue(parents);\n        var text = detectedFormat.fold(function () {\n          return 'Paragraph';\n        }, function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var nodeChangeHandler = Optional.some(function (comp) {\n        return function (e) {\n          return updateSelectMenuText(e.parents, comp);\n        };\n      });\n      var setInitialValue = Optional.some(function (comp) {\n        var parents = getCurrentSelectionParents(editor);\n        updateSelectMenuText(parents, comp);\n      });\n      var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n      return {\n        tooltip: 'Blocks',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat(editor),\n        setInitialValue: setInitialValue,\n        nodeChangeHandler: nodeChangeHandler,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createFormatSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$3(editor));\n    };\n    var formatSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n      editor.ui.registry.addNestedMenuItem('blockformats', {\n        text: 'Blocks',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var getSpec$4 = function (editor, dataset) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var updateSelectMenuText = function (parents, comp) {\n        var getFormatItems = function (fmt) {\n          var subs = fmt.items;\n          return subs !== undefined && subs.length > 0 ? bind(subs, getFormatItems) : [{\n              title: fmt.title,\n              format: fmt.format\n            }];\n        };\n        var flattenedItems = bind(getStyleFormats(editor), getFormatItems);\n        var detectedFormat = findNearest(editor, function () {\n          return flattenedItems;\n        }, parents);\n        var text = detectedFormat.fold(function () {\n          return 'Paragraph';\n        }, function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var nodeChangeHandler = Optional.some(function (comp) {\n        return function (e) {\n          return updateSelectMenuText(e.parents, comp);\n        };\n      });\n      var setInitialValue = Optional.some(function (comp) {\n        var parents = getCurrentSelectionParents(editor);\n        updateSelectMenuText(parents, comp);\n      });\n      return {\n        tooltip: 'Formats',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat(editor),\n        setInitialValue: setInitialValue,\n        nodeChangeHandler: nodeChangeHandler,\n        shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        },\n        dataset: dataset\n      };\n    };\n    var createStyleSelect = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      return createSelectButton(editor, backstage, getSpec$4(editor, dataset));\n    };\n    var styleSelectMenu = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      var menuItems = createMenuItems(editor, backstage, getSpec$4(editor, dataset));\n      editor.ui.registry.addNestedMenuItem('formats', {\n        text: 'Formats',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultToolbar = [\n      {\n        name: 'history',\n        items: [\n          'undo',\n          'redo'\n        ]\n      },\n      {\n        name: 'styles',\n        items: ['styleselect']\n      },\n      {\n        name: 'formatting',\n        items: [\n          'bold',\n          'italic'\n        ]\n      },\n      {\n        name: 'alignment',\n        items: [\n          'alignleft',\n          'aligncenter',\n          'alignright',\n          'alignjustify'\n        ]\n      },\n      {\n        name: 'indentation',\n        items: [\n          'outdent',\n          'indent'\n        ]\n      },\n      {\n        name: 'permanent pen',\n        items: ['permanentpen']\n      },\n      {\n        name: 'comments',\n        items: ['addcomment']\n      }\n    ];\n    var renderFromBridge = function (bridgeBuilder, render) {\n      return function (spec, extras, editor) {\n        var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return render(internal, extras, editor);\n      };\n    };\n    var types = {\n      button: renderFromBridge(createToolbarButton, function (s, extras) {\n        return renderToolbarButton(s, extras.backstage.shared.providers);\n      }),\n      togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n        return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n      }),\n      menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n        return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n      }),\n      splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n        return renderSplitButton(s, extras.backstage.shared);\n      }),\n      grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n        var _a;\n        var buttons = editor.ui.registry.getAll().buttons;\n        var identify = function (toolbar) {\n          return identifyButtons(editor, {\n            buttons: buttons,\n            toolbar: toolbar,\n            allowToolbarGroups: false\n          }, extras, Optional.none());\n        };\n        var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n        switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n        }\n      }),\n      styleSelectButton: function (editor, extras) {\n        return createStyleSelect(editor, extras.backstage);\n      },\n      fontsizeSelectButton: function (editor, extras) {\n        return createFontsizeSelect(editor, extras.backstage);\n      },\n      fontSelectButton: function (editor, extras) {\n        return createFontSelect(editor, extras.backstage);\n      },\n      formatButton: function (editor, extras) {\n        return createFormatSelect(editor, extras.backstage);\n      },\n      alignMenuButton: function (editor, extras) {\n        return createAlignSelect(editor, extras.backstage);\n      }\n    };\n    var extractFrom = function (spec, extras, editor) {\n      return get(types, spec.type).fold(function () {\n        console.error('skipping button defined by', spec);\n        return Optional.none();\n      }, function (render) {\n        return Optional.some(render(spec, extras, editor));\n      });\n    };\n    var bespokeButtons = {\n      styleselect: types.styleSelectButton,\n      fontsizeselect: types.fontsizeSelectButton,\n      fontselect: types.fontSelectButton,\n      formatselect: types.formatButton,\n      align: types.alignMenuButton\n    };\n    var removeUnusedDefaults = function (buttons) {\n      var filteredItemGroups = map(defaultToolbar, function (group) {\n        var items = filter(group.items, function (subItem) {\n          return has(buttons, subItem) || has(bespokeButtons, subItem);\n        });\n        return {\n          name: group.name,\n          items: items\n        };\n      });\n      return filter(filteredItemGroups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n    var convertStringToolbar = function (strToolbar) {\n      var groupsStrings = strToolbar.split('|');\n      return map(groupsStrings, function (g) {\n        return { items: g.trim().split(' ') };\n      });\n    };\n    var isToolbarGroupSettingArray = function (toolbar) {\n      return isArrayOf(toolbar, function (t) {\n        return has(t, 'name') && has(t, 'items');\n      });\n    };\n    var createToolbar = function (toolbarConfig) {\n      var toolbar = toolbarConfig.toolbar;\n      var buttons = toolbarConfig.buttons;\n      if (toolbar === false) {\n        return [];\n      } else if (toolbar === undefined || toolbar === true) {\n        return removeUnusedDefaults(buttons);\n      } else if (isString(toolbar)) {\n        return convertStringToolbar(toolbar);\n      } else if (isToolbarGroupSettingArray(toolbar)) {\n        return toolbar;\n      } else {\n        console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n        return [];\n      }\n    };\n    var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n      return get(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n        return prefixes.bind(function (ps) {\n          return findMap(ps, function (prefix) {\n            return get(buttons, prefix + toolbarItem.toLowerCase());\n          });\n        });\n      }).fold(function () {\n        return get(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n          return r(editor, extras);\n        }).orThunk(function () {\n          return Optional.none();\n        });\n      }, function (spec) {\n        if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n          console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n          return Optional.none();\n        } else {\n          return extractFrom(spec, extras, editor);\n        }\n      });\n    };\n    var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n      var toolbarGroups = createToolbar(toolbarConfig);\n      var groups = map(toolbarGroups, function (group) {\n        var items = bind(group.items, function (toolbarItem) {\n          return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n        });\n        return {\n          title: Optional.from(editor.translate(group.name)),\n          items: items\n        };\n      });\n      return filter(groups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n\n    var bubbleSize = 12;\n    var bubbleAlignments$1 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top']\n    };\n    var anchorOverrides = {\n      maxHeightFunction: expandable(),\n      maxWidthFunction: expandable$1()\n    };\n    var desktopAnchorSpecLayouts = {\n      onLtr: function () {\n        return [\n          north$1,\n          south$1,\n          northeast$1,\n          southeast$1,\n          northwest$1,\n          southwest$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          north$1,\n          south$1,\n          northwest$1,\n          southwest$1,\n          northeast$1,\n          southeast$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var mobileAnchorSpecLayouts = {\n      onLtr: function () {\n        return [\n          south$1,\n          southeast$1,\n          southwest$1,\n          northeast$1,\n          northwest$1,\n          north$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          south$1,\n          southwest$1,\n          southeast$1,\n          northwest$1,\n          northeast$1,\n          north$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var getAnchorLayout = function (position, isTouch) {\n      if (position === 'line') {\n        return {\n          bubble: nu$8(bubbleSize, 0, bubbleAlignments$1),\n          layouts: {\n            onLtr: function () {\n              return [east$1];\n            },\n            onRtl: function () {\n              return [west$1];\n            }\n          },\n          overrides: anchorOverrides\n        };\n      } else {\n        return {\n          bubble: nu$8(0, bubbleSize, bubbleAlignments$1),\n          layouts: isTouch ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts,\n          overrides: anchorOverrides\n        };\n      }\n    };\n    var register$4 = function (editor, registryContextToolbars, sink, extras) {\n      var isTouch = detect$3().deviceType.isTouch;\n      var contextbar = build$1(renderContextToolbar({\n        sink: sink,\n        onEscape: function () {\n          editor.focus();\n          return Optional.some(true);\n        }\n      }));\n      var getBounds = function () {\n        return getContextToolbarBounds(editor, extras.backstage.shared);\n      };\n      var isRangeOverlapping = function (aTop, aBottom, bTop, bBottom) {\n        return Math.max(aTop, bTop) <= Math.min(aBottom, bBottom);\n      };\n      var getLastElementVerticalBound = function () {\n        var nodeBounds = lastElement.get().filter(function (ele) {\n          return inBody(SugarElement.fromDom(ele));\n        }).map(function (ele) {\n          return ele.getBoundingClientRect();\n        }).getOrThunk(function () {\n          return editor.selection.getRng().getBoundingClientRect();\n        });\n        var diffTop = editor.inline ? get$8().top : absolute$1(SugarElement.fromDom(editor.getBody())).y;\n        return {\n          y: nodeBounds.top + diffTop,\n          bottom: nodeBounds.bottom + diffTop\n        };\n      };\n      var shouldContextToolbarHide = function () {\n        if (isTouch() && extras.backstage.isContextMenuOpen()) {\n          return true;\n        }\n        var lastElementBounds = getLastElementVerticalBound();\n        var contextToolbarBounds = getBounds();\n        return !isRangeOverlapping(lastElementBounds.y, lastElementBounds.bottom, contextToolbarBounds.y, contextToolbarBounds.bottom);\n      };\n      var forceHide = function () {\n        InlineView.hide(contextbar);\n      };\n      var hideOrRepositionIfNecessary = function () {\n        lastAnchor.get().each(function (anchor) {\n          var contextBarEle = contextbar.element;\n          remove$6(contextBarEle, 'display');\n          if (shouldContextToolbarHide()) {\n            set$2(contextBarEle, 'display', 'none');\n          } else {\n            Positioning.positionWithinBounds(sink, anchor, contextbar, Optional.some(getBounds()));\n          }\n        });\n      };\n      var lastAnchor = Cell(Optional.none());\n      var lastElement = Cell(Optional.none());\n      var timer = Cell(null);\n      var wrapInPopDialog = function (toolbarSpec) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-pop__dialog']\n          },\n          components: [toolbarSpec],\n          behaviours: derive$1([\n            Keying.config({ mode: 'acyclic' }),\n            config('pop-dialog-wrap-events', [\n              runOnAttached(function (comp) {\n                editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n                  return Keying.focusIn(comp);\n                });\n              }),\n              runOnDetached(function (_comp) {\n                editor.shortcuts.remove('ctrl+F9');\n              })\n            ])\n          ])\n        };\n      };\n      var getScopes = cached(function () {\n        return categorise(registryContextToolbars, function (toolbarApi) {\n          var alloySpec = buildToolbar([toolbarApi]);\n          emitWith(contextbar, forwardSlideEvent, { forwardContents: wrapInPopDialog(alloySpec) });\n        });\n      });\n      var buildContextToolbarGroups = function (allButtons, ctx) {\n        return identifyButtons(editor, {\n          buttons: allButtons,\n          toolbar: ctx.items,\n          allowToolbarGroups: false\n        }, extras, Optional.some(['form:']));\n      };\n      var buildContextMenuGroups = function (ctx, providers) {\n        return ContextForm.buildInitGroups(ctx, providers);\n      };\n      var buildToolbar = function (toolbars) {\n        var buttons = editor.ui.registry.getAll().buttons;\n        var scopes = getScopes();\n        var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n        var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n        var initGroups = flatten(map(toolbars, function (ctx) {\n          return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextMenuGroups(ctx, extras.backstage.shared.providers);\n        }));\n        return renderToolbar({\n          type: toolbarType,\n          uid: generate$1('context-toolbar'),\n          initGroups: initGroups,\n          onEscape: Optional.none,\n          cyclicKeying: true,\n          providers: extras.backstage.shared.providers\n        });\n      };\n      editor.on(showContextToolbarEvent, function (e) {\n        var scopes = getScopes();\n        get(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n          launchContext([ctx], e.target === editor ? Optional.none() : Optional.some(e));\n          InlineView.getContent(contextbar).each(Keying.focusIn);\n        });\n      });\n      var getAnchor = function (position, element) {\n        var anchorage = position === 'node' ? extras.backstage.shared.anchors.node(element) : extras.backstage.shared.anchors.cursor();\n        return deepMerge(anchorage, getAnchorLayout(position, isTouch()));\n      };\n      var launchContext = function (toolbarApi, elem) {\n        clearTimer();\n        if (isTouch() && extras.backstage.isContextMenuOpen()) {\n          return;\n        }\n        var toolbarSpec = buildToolbar(toolbarApi);\n        var sElem = elem.map(SugarElement.fromDom);\n        var anchor = getAnchor(toolbarApi[0].position, sElem);\n        lastAnchor.set(Optional.some(anchor));\n        lastElement.set(elem);\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n        InlineView.showWithinBounds(contextbar, anchor, wrapInPopDialog(toolbarSpec), function () {\n          return Optional.some(getBounds());\n        });\n        if (shouldContextToolbarHide()) {\n          set$2(contextBarEle, 'display', 'none');\n        }\n      };\n      var launchContextToolbar = function () {\n        if (!editor.hasFocus()) {\n          return;\n        }\n        var scopes = getScopes();\n        lookup$1(scopes, editor).fold(function () {\n          lastAnchor.set(Optional.none());\n          InlineView.hide(contextbar);\n        }, function (info) {\n          launchContext(info.toolbars, Optional.some(info.elem.dom));\n        });\n      };\n      var clearTimer = function () {\n        var current = timer.get();\n        if (current !== null) {\n          global$2.clearTimeout(current);\n          timer.set(null);\n        }\n      };\n      var resetTimer = function (t) {\n        clearTimer();\n        timer.set(t);\n      };\n      editor.on('init', function () {\n        editor.on(hideContextToolbarEvent, forceHide);\n        editor.on('ScrollContent ScrollWindow longpress', hideOrRepositionIfNecessary);\n        editor.on('click keyup focus SetContent ObjectResized ResizeEditor', function () {\n          resetTimer(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n        });\n        editor.on('focusout', function (_e) {\n          global$2.setEditorTimeout(editor, function () {\n            if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n              lastAnchor.set(Optional.none());\n              InlineView.hide(contextbar);\n            }\n          }, 0);\n        });\n        editor.on('SwitchMode', function () {\n          if (editor.mode.isReadOnly()) {\n            lastAnchor.set(Optional.none());\n            InlineView.hide(contextbar);\n          }\n        });\n        editor.on('NodeChange', function (_e) {\n          search(contextbar.element).fold(function () {\n            resetTimer(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n          }, function (_) {\n          });\n        });\n      });\n    };\n\n    var setup$3 = function (editor, mothership, uiMothership) {\n      var broadcastEvent = function (name, evt) {\n        each([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastEvent(name, evt);\n        });\n      };\n      var broadcastOn = function (channel, message) {\n        each([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastOn([channel], message);\n        });\n      };\n      var fireDismissPopups = function (evt) {\n        return broadcastOn(dismissPopups(), { target: evt.target });\n      };\n      var onTouchstart = bind$3(SugarElement.fromDom(document), 'touchstart', fireDismissPopups);\n      var onTouchmove = bind$3(SugarElement.fromDom(document), 'touchmove', function (evt) {\n        return broadcastEvent(documentTouchmove(), evt);\n      });\n      var onTouchend = bind$3(SugarElement.fromDom(document), 'touchend', function (evt) {\n        return broadcastEvent(documentTouchend(), evt);\n      });\n      var onMousedown = bind$3(SugarElement.fromDom(document), 'mousedown', fireDismissPopups);\n      var onMouseup = bind$3(SugarElement.fromDom(document), 'mouseup', function (evt) {\n        if (evt.raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: evt.target });\n        }\n      });\n      var onContentClick = function (raw) {\n        return broadcastOn(dismissPopups(), { target: SugarElement.fromDom(raw.target) });\n      };\n      var onContentMouseup = function (raw) {\n        if (raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: SugarElement.fromDom(raw.target) });\n        }\n      };\n      var onWindowScroll = function (evt) {\n        return broadcastEvent(windowScroll(), fromRawEvent$1(evt));\n      };\n      var onWindowResize = function (evt) {\n        broadcastOn(repositionPopups(), {});\n        broadcastEvent(windowResize(), fromRawEvent$1(evt));\n      };\n      var onEditorResize = function () {\n        return broadcastOn(repositionPopups(), {});\n      };\n      editor.on('PostRender', function () {\n        editor.on('click', onContentClick);\n        editor.on('tap', onContentClick);\n        editor.on('mouseup', onContentMouseup);\n        editor.on('ScrollWindow', onWindowScroll);\n        editor.on('ResizeWindow', onWindowResize);\n        editor.on('ResizeEditor', onEditorResize);\n      });\n      editor.on('remove', function () {\n        editor.off('click', onContentClick);\n        editor.off('tap', onContentClick);\n        editor.off('mouseup', onContentMouseup);\n        editor.off('ScrollWindow', onWindowScroll);\n        editor.off('ResizeWindow', onWindowResize);\n        editor.off('ResizeEditor', onEditorResize);\n        onMousedown.unbind();\n        onTouchstart.unbind();\n        onTouchmove.unbind();\n        onTouchend.unbind();\n        onMouseup.unbind();\n      });\n      editor.on('detach', function () {\n        detachSystem(mothership);\n        detachSystem(uiMothership);\n        mothership.destroy();\n        uiMothership.destroy();\n      });\n    };\n\n    var parts$d = AlloyParts;\n    var partType$1 = PartType;\n\n    var schema$r = constant([\n      defaulted$1('shell', false),\n      strict$1('makeItem'),\n      defaulted$1('setupItem', noop),\n      SketchBehaviours.field('listBehaviours', [Replacing])\n    ]);\n    var customListDetail = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var itemsPart = optional({\n      name: 'items',\n      overrides: customListDetail\n    });\n    var parts$e = constant([itemsPart]);\n    var name$2 = constant('CustomList');\n\n    var factory$f = function (detail, components, _spec, _external) {\n      var setItems = function (list, items) {\n        getListContainer(list).fold(function () {\n          console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n          throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n        }, function (container) {\n          var itemComps = Replacing.contents(container);\n          var numListsRequired = items.length;\n          var numListsToAdd = numListsRequired - itemComps.length;\n          var itemsToAdd = numListsToAdd > 0 ? range(numListsToAdd, function () {\n            return detail.makeItem();\n          }) : [];\n          var itemsToRemove = itemComps.slice(numListsRequired);\n          each(itemsToRemove, function (item) {\n            return Replacing.remove(container, item);\n          });\n          each(itemsToAdd, function (item) {\n            return Replacing.append(container, item);\n          });\n          var builtLists = Replacing.contents(container);\n          each(builtLists, function (item, i) {\n            detail.setupItem(list, item, items[i], i);\n          });\n        });\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      var getListContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.listBehaviours, extra.behaviours),\n        apis: { setItems: setItems }\n      };\n    };\n    var CustomList = composite$1({\n      name: name$2(),\n      configFields: schema$r(),\n      partFields: parts$e(),\n      factory: factory$f,\n      apis: {\n        setItems: function (apis, list, items) {\n          apis.setItems(list, items);\n        }\n      }\n    });\n\n    var setup$4 = noop;\n    var isDocked = never;\n    var getBehaviours$2 = constant([]);\n\n    var StaticHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$4,\n        isDocked: isDocked,\n        getBehaviours: getBehaviours$2\n    });\n\n    var getOffsetParent = function (element) {\n      var isFixed = getRaw(element, 'position').is('fixed');\n      var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n      return offsetParent$1.orThunk(function () {\n        var marker = SugarElement.fromTag('span');\n        return parent(element).bind(function (parent) {\n          append(parent, marker);\n          var offsetParent$1 = offsetParent(marker);\n          remove(marker);\n          return offsetParent$1;\n        });\n      });\n    };\n    var getOrigin = function (element) {\n      return getOffsetParent(element).map(absolute).getOrThunk(function () {\n        return SugarPosition(0, 0);\n      });\n    };\n\n    var morphAdt = Adt.generate([\n      { static: [] },\n      { absolute: ['positionCss'] },\n      { fixed: ['positionCss'] }\n    ]);\n    var appear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$4(elem, contextualInfo.fadeOutClass);\n      add$2(elem, contextualInfo.fadeInClass);\n      contextualInfo.onShow(component);\n    };\n    var disappear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$4(elem, contextualInfo.fadeInClass);\n      add$2(elem, contextualInfo.fadeOutClass);\n      contextualInfo.onHide(component);\n    };\n    var isPartiallyVisible = function (box, viewport) {\n      return box.y < viewport.bottom && box.bottom > viewport.y;\n    };\n    var isTopCompletelyVisible = function (box, viewport) {\n      return box.y >= viewport.y;\n    };\n    var isBottomCompletelyVisible = function (box, viewport) {\n      return box.bottom <= viewport.bottom;\n    };\n    var isVisibleForModes = function (modes, box, viewport) {\n      return forall(modes, function (mode) {\n        switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n        }\n      });\n    };\n    var getPrior = function (elem, state) {\n      return state.getInitialPosition().map(function (pos) {\n        return bounds$1(pos.bounds.x, pos.bounds.y, get$7(elem), get$6(elem));\n      });\n    };\n    var storePrior = function (elem, box, state) {\n      state.setInitialPosition(Optional.some({\n        style: getAllRaw(elem),\n        position: get$4(elem, 'position') || 'static',\n        bounds: box\n      }));\n    };\n    var revertToOriginal = function (elem, box$1, state) {\n      return state.getInitialPosition().bind(function (position) {\n        state.setInitialPosition(Optional.none());\n        switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box).getOrThunk(function () {\n            return box(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get(position.style, 'left').map(function (_left) {\n            return box$1.x - offsetBox_1.x;\n          }), get(position.style, 'top').map(function (_top) {\n            return box$1.y - offsetBox_1.y;\n          }), get(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box$1.right;\n          }), get(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box$1.bottom;\n          }))));\n        default:\n          return Optional.none();\n        }\n      });\n    };\n    var morphToOriginal = function (elem, viewport, state) {\n      return getPrior(elem, state).filter(function (box) {\n        return isVisibleForModes(state.getModes(), box, viewport);\n      }).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n    var morphToFixed = function (elem, viewport, state) {\n      var box$1 = box(elem);\n      if (!isVisibleForModes(state.getModes(), box$1, viewport)) {\n        storePrior(elem, box$1, state);\n        var winBox = win();\n        var left = box$1.x - winBox.x;\n        var top_1 = viewport.y - winBox.y;\n        var bottom = winBox.bottom - viewport.bottom;\n        var isTop = box$1.y <= viewport.y;\n        return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n      } else {\n        return Optional.none();\n      }\n    };\n    var getMorph = function (component, viewport, state) {\n      var elem = component.element;\n      var isDocked = getRaw(elem, 'position').is('fixed');\n      return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n    };\n    var getMorphToOriginal = function (component, state) {\n      var elem = component.element;\n      return getPrior(elem, state).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n\n    var morphToStatic = function (component, config) {\n      each([\n        'left',\n        'right',\n        'top',\n        'bottom',\n        'position'\n      ], function (prop) {\n        return remove$6(component.element, prop);\n      });\n      config.onUndocked(component);\n    };\n    var morphToCoord = function (component, config, position) {\n      applyPositionCss(component.element, position);\n      var method = position.position === 'fixed' ? config.onDocked : config.onUndocked;\n      method(component);\n    };\n    var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n      if (morphToDocked === void 0) {\n        morphToDocked = false;\n      }\n      config.contextual.each(function (contextInfo) {\n        contextInfo.lazyContext(component).each(function (box) {\n          var isVisible = isPartiallyVisible(box, viewport);\n          if (isVisible !== state.isVisible()) {\n            state.setVisible(isVisible);\n            if (morphToDocked && !isVisible) {\n              add$3(component.element, [contextInfo.fadeOutClass]);\n              contextInfo.onHide(component);\n            } else {\n              var method = isVisible ? appear : disappear;\n              method(component, contextInfo);\n            }\n          }\n        });\n      });\n    };\n    var refreshInternal = function (component, config, state) {\n      var viewport = config.lazyViewport(component);\n      var isDocked = state.isDocked();\n      if (isDocked) {\n        updateVisibility(component, config, state, viewport);\n      }\n      getMorph(component, viewport, state).each(function (morph) {\n        state.setDocked(!isDocked);\n        morph.fold(function () {\n          return morphToStatic(component, config);\n        }, function (position) {\n          return morphToCoord(component, config, position);\n        }, function (position) {\n          updateVisibility(component, config, state, viewport, true);\n          morphToCoord(component, config, position);\n        });\n      });\n    };\n    var resetInternal = function (component, config, state) {\n      var elem = component.element;\n      state.setDocked(false);\n      getMorphToOriginal(component, state).each(function (morph) {\n        morph.fold(function () {\n          return morphToStatic(component, config);\n        }, function (position) {\n          return morphToCoord(component, config, position);\n        }, noop);\n      });\n      state.setVisible(true);\n      config.contextual.each(function (contextInfo) {\n        remove$5(elem, [\n          contextInfo.fadeInClass,\n          contextInfo.fadeOutClass,\n          contextInfo.transitionClass\n        ]);\n        contextInfo.onShow(component);\n      });\n      refresh$4(component, config, state);\n    };\n    var refresh$4 = function (component, config, state) {\n      if (component.getSystem().isConnected()) {\n        refreshInternal(component, config, state);\n      }\n    };\n    var reset = function (component, config, state) {\n      if (state.isDocked()) {\n        resetInternal(component, config, state);\n      }\n    };\n    var isDocked$1 = function (component, config, state) {\n      return state.isDocked();\n    };\n    var setModes = function (component, config, state, modes) {\n      return state.setModes(modes);\n    };\n    var getModes = function (component, config, state) {\n      return state.getModes();\n    };\n\n    var DockingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$4,\n        reset: reset,\n        isDocked: isDocked$1,\n        getModes: getModes,\n        setModes: setModes\n    });\n\n    var events$f = function (dockInfo, dockState) {\n      return derive([\n        runOnSource(transitionend(), function (component, simulatedEvent) {\n          dockInfo.contextual.each(function (contextInfo) {\n            if (has$2(component.element, contextInfo.transitionClass)) {\n              remove$5(component.element, [\n                contextInfo.transitionClass,\n                contextInfo.fadeInClass\n              ]);\n              var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n              notify(component);\n            }\n            simulatedEvent.stop();\n          });\n        }),\n        run(windowScroll(), function (component, _) {\n          refresh$4(component, dockInfo, dockState);\n        }),\n        run(windowResize(), function (component, _) {\n          reset(component, dockInfo, dockState);\n        })\n      ]);\n    };\n\n    var ActiveDocking = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$f\n    });\n\n    var DockingSchema = [\n      optionObjOf('contextual', [\n        strictString('fadeInClass'),\n        strictString('fadeOutClass'),\n        strictString('transitionClass'),\n        strictFunction('lazyContext'),\n        onHandler('onShow'),\n        onHandler('onShown'),\n        onHandler('onHide'),\n        onHandler('onHidden')\n      ]),\n      defaultedFunction('lazyViewport', win),\n      defaultedArrayOf('modes', [\n        'top',\n        'bottom'\n      ], string),\n      onHandler('onDocked'),\n      onHandler('onUndocked')\n    ];\n\n    var init$b = function (spec) {\n      var docked = Cell(false);\n      var visible = Cell(true);\n      var initialBounds = Cell(Optional.none());\n      var modes = Cell(spec.modes);\n      var readState = function () {\n        return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n      };\n      return nu$5({\n        isDocked: docked.get,\n        setDocked: docked.set,\n        getInitialPosition: initialBounds.get,\n        setInitialPosition: initialBounds.set,\n        isVisible: visible.get,\n        setVisible: visible.set,\n        getModes: modes.get,\n        setModes: modes.set,\n        readState: readState\n      });\n    };\n\n    var DockingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$b\n    });\n\n    var Docking = create$1({\n      fields: DockingSchema,\n      name: 'docking',\n      active: ActiveDocking,\n      apis: DockingApis,\n      state: DockingState\n    });\n\n    var visibility = {\n      fadeInClass: 'tox-editor-dock-fadein',\n      fadeOutClass: 'tox-editor-dock-fadeout',\n      transitionClass: 'tox-editor-dock-transition'\n    };\n    var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n    var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n    var scrollFromBehindHeader = function (e, containerHeader) {\n      var doc = owner(containerHeader);\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      var scrollPos = get$8(doc);\n      var markerElement = SugarElement.fromDom(e.elm);\n      var markerPos = absolute$1(markerElement);\n      var markerHeight = get$6(markerElement);\n      var markerTop = markerPos.y;\n      var markerBottom = markerTop + markerHeight;\n      var editorHeaderPos = absolute(containerHeader);\n      var editorHeaderHeight = get$6(containerHeader);\n      var editorHeaderTop = editorHeaderPos.top;\n      var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n      var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n      var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n      if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n        to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n      } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n        var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n        to(scrollPos.left, y, doc);\n      }\n    };\n    var isDockedMode = function (header, mode) {\n      return contains(Docking.getModes(header), mode);\n    };\n    var updateIframeContentFlow = function (header) {\n      var getOccupiedHeight = function (elm) {\n        return getOuter$1(elm) + (parseInt(get$4(elm, 'margin-top'), 10) || 0) + (parseInt(get$4(elm, 'margin-bottom'), 10) || 0);\n      };\n      var elm = header.element;\n      parent(elm).each(function (parentElem) {\n        var padding = 'padding-' + Docking.getModes(header)[0];\n        if (Docking.isDocked(header)) {\n          var parentWidth = get$7(parentElem);\n          set$2(elm, 'width', parentWidth + 'px');\n          set$2(parentElem, padding, getOccupiedHeight(elm) + 'px');\n        } else {\n          remove$6(elm, 'width');\n          remove$6(parentElem, padding);\n        }\n      });\n    };\n    var updateSinkVisibility = function (sinkElem, visible) {\n      if (visible) {\n        remove$4(sinkElem, visibility.fadeOutClass);\n        add$3(sinkElem, [\n          visibility.transitionClass,\n          visibility.fadeInClass\n        ]);\n      } else {\n        remove$4(sinkElem, visibility.fadeInClass);\n        add$3(sinkElem, [\n          visibility.fadeOutClass,\n          visibility.transitionClass\n        ]);\n      }\n    };\n    var updateEditorClasses = function (editor, docked) {\n      var editorContainer = SugarElement.fromDom(editor.getContainer());\n      if (docked) {\n        add$2(editorContainer, editorStickyOnClass);\n        remove$4(editorContainer, editorStickyOffClass);\n      } else {\n        add$2(editorContainer, editorStickyOffClass);\n        remove$4(editorContainer, editorStickyOnClass);\n      }\n    };\n    var restoreFocus = function (headerElem, focusedElem) {\n      var ownerDoc = owner(focusedElem);\n      active(ownerDoc).filter(function (activeElm) {\n        return !eq$1(focusedElem, activeElm);\n      }).filter(function (activeElm) {\n        return eq$1(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains$2(headerElem, activeElm);\n      }).each(function () {\n        return focus$1(focusedElem);\n      });\n    };\n    var findFocusedElem = function (rootElm, lazySink) {\n      return search(rootElm).orThunk(function () {\n        return lazySink().toOptional().bind(function (sink) {\n          return search(sink.element);\n        });\n      });\n    };\n    var setup$5 = function (editor, sharedBackstage, lazyHeader) {\n      if (!editor.inline) {\n        if (!sharedBackstage.header.isPositionedAtTop()) {\n          editor.on('ResizeEditor', function () {\n            lazyHeader().each(Docking.reset);\n          });\n        }\n        editor.on('ResizeWindow ResizeEditor', function () {\n          lazyHeader().each(updateIframeContentFlow);\n        });\n        editor.on('SkinLoaded', function () {\n          lazyHeader().each(function (comp) {\n            Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n          });\n        });\n        editor.on('FullscreenStateChanged', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n      editor.on('AfterScrollIntoView', function (e) {\n        lazyHeader().each(function (header) {\n          Docking.refresh(header);\n          var headerElem = header.element;\n          if (isVisible(headerElem)) {\n            scrollFromBehindHeader(e, headerElem);\n          }\n        });\n      });\n      editor.on('PostRender', function () {\n        updateEditorClasses(editor, false);\n      });\n    };\n    var isDocked$2 = function (lazyHeader) {\n      return lazyHeader().map(Docking.isDocked).getOr(false);\n    };\n    var getIframeBehaviours = function () {\n      var _a;\n      return [Receiving.config({ channels: (_a = {}, _a[toolbarHeightChange()] = { onReceive: updateIframeContentFlow }, _a) })];\n    };\n    var getBehaviours$3 = function (editor, sharedBackstage) {\n      var focusedElm = Cell(Optional.none());\n      var lazySink = sharedBackstage.getSink;\n      var runOnSinkElement = function (f) {\n        lazySink().each(function (sink) {\n          return f(sink.element);\n        });\n      };\n      var onDockingSwitch = function (comp) {\n        if (!editor.inline) {\n          updateIframeContentFlow(comp);\n        }\n        updateEditorClasses(editor, Docking.isDocked(comp));\n        comp.getSystem().broadcastOn([repositionPopups()], {});\n        lazySink().each(function (sink) {\n          return sink.getSystem().broadcastOn([repositionPopups()], {});\n        });\n      };\n      var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n      return __spreadArrays([\n        Focusing.config({}),\n        Docking.config({\n          contextual: __assign({\n            lazyContext: function (comp) {\n              var headerHeight = getOuter$1(comp.element);\n              var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n              var box$1 = box(SugarElement.fromDom(container));\n              var boxHeight = box$1.height - headerHeight;\n              var topBound = box$1.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n              return Optional.some(bounds$1(box$1.x, topBound, box$1.width, boxHeight));\n            },\n            onShow: function () {\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, true);\n              });\n            },\n            onShown: function (comp) {\n              runOnSinkElement(function (elem) {\n                return remove$5(elem, [\n                  visibility.transitionClass,\n                  visibility.fadeInClass\n                ]);\n              });\n              focusedElm.get().each(function (elem) {\n                restoreFocus(comp.element, elem);\n                focusedElm.set(Optional.none());\n              });\n            },\n            onHide: function (comp) {\n              focusedElm.set(findFocusedElem(comp.element, lazySink));\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, false);\n              });\n            },\n            onHidden: function () {\n              runOnSinkElement(function (elem) {\n                return remove$5(elem, [visibility.transitionClass]);\n              });\n            }\n          }, visibility),\n          modes: [sharedBackstage.header.getDockingMode()],\n          onDocked: onDockingSwitch,\n          onUndocked: onDockingSwitch\n        })\n      ], additionalBehaviours);\n    };\n\n    var StickyHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$5,\n        isDocked: isDocked$2,\n        getBehaviours: getBehaviours$3\n    });\n\n    var renderHeader = function (spec) {\n      var editor = spec.editor;\n      var getBehaviours = spec.sticky ? getBehaviours$3 : getBehaviours$2;\n      return {\n        uid: spec.uid,\n        dom: spec.dom,\n        components: spec.components,\n        behaviours: derive$1(getBehaviours(editor, spec.sharedBackstage))\n      };\n    };\n\n    var factory$g = function (detail, spec) {\n      var setMenus = function (comp, menus) {\n        var newMenus = map(menus, function (m) {\n          var buttonSpec = {\n            type: 'menubutton',\n            text: m.text,\n            fetch: function (callback) {\n              callback(m.getItems());\n            }\n          };\n          var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n            return formatError(errInfo);\n          }).getOrDie();\n          return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n        });\n        Replacing.set(comp, newMenus);\n      };\n      var apis = {\n        focus: Keying.focusIn,\n        setMenus: setMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [],\n        behaviours: derive$1([\n          Replacing.config({}),\n          config('menubar-events', [\n            runOnAttached(function (component) {\n              detail.onSetup(component);\n            }),\n            run(mouseover(), function (comp, se) {\n              descendant$1(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n                closest$3(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n                  if (!eq$1(activeButton, hoveredButton)) {\n                    comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                      comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                        Dropdown.expand(hoveredComp);\n                        Dropdown.close(activeComp);\n                        Focusing.focus(hoveredComp);\n                      });\n                    });\n                  }\n                });\n              });\n            }),\n            run(focusShifted(), function (comp, se) {\n              se.event.prevFocus.bind(function (prev) {\n                return comp.getSystem().getByDom(prev).toOptional();\n              }).each(function (prev) {\n                se.event.newFocus.bind(function (nu) {\n                  return comp.getSystem().getByDom(nu).toOptional();\n                }).each(function (nu) {\n                  if (Dropdown.isOpen(prev)) {\n                    Dropdown.expand(nu);\n                    Dropdown.close(prev);\n                  }\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'flow',\n            selector: '.' + 'tox-mbtn',\n            onEscape: function (comp) {\n              detail.onEscape(comp);\n              return Optional.some(true);\n            }\n          }),\n          Tabstopping.config({})\n        ]),\n        apis: apis,\n        domModification: { attributes: { role: 'menubar' } }\n      };\n    };\n    var SilverMenubar = single$2({\n      factory: factory$g,\n      name: 'silver.Menubar',\n      configFields: [\n        strict$1('dom'),\n        strict$1('uid'),\n        strict$1('onEscape'),\n        strict$1('backstage'),\n        defaulted$1('onSetup', noop)\n      ],\n      apis: {\n        focus: function (apis, comp) {\n          apis.focus(comp);\n        },\n        setMenus: function (apis, comp, menus) {\n          apis.setMenus(comp, menus);\n        }\n      }\n    });\n\n    var owner$4 = 'container';\n    var schema$s = [field$1('slotBehaviours', [])];\n    var getPartName$1 = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$2 = function (sSpec) {\n      var parts = function () {\n        var record = [];\n        var slot = function (name, config) {\n          record.push(name);\n          return generateOne(owner$4, getPartName$1(name), config);\n        };\n        return {\n          slot: slot,\n          record: function () {\n            return record;\n          }\n        };\n      }();\n      var spec = sSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName$1(n)\n        });\n      });\n      return composite(owner$4, schema$s, fieldParts, make$7, spec);\n    };\n    var make$7 = function (detail, components) {\n      var getSlotNames = function (_) {\n        return getAllPartNames(detail);\n      };\n      var getSlot = function (container, key) {\n        return getPart(container, detail, key);\n      };\n      var onSlot = function (f, def) {\n        return function (container, key) {\n          return getPart(container, detail, key).map(function (slot) {\n            return f(slot, key);\n          }).getOr(def);\n        };\n      };\n      var onSlots = function (f) {\n        return function (container, keys) {\n          each(keys, function (key) {\n            return f(container, key);\n          });\n        };\n      };\n      var doShowing = function (comp, _key) {\n        return get$2(comp.element, 'aria-hidden') !== 'true';\n      };\n      var doShow = function (comp, key) {\n        if (!doShowing(comp)) {\n          var element = comp.element;\n          remove$6(element, 'display');\n          remove$1(element, 'aria-hidden');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: true\n          });\n        }\n      };\n      var doHide = function (comp, key) {\n        if (doShowing(comp)) {\n          var element = comp.element;\n          set$2(element, 'display', 'none');\n          set$1(element, 'aria-hidden', 'true');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: false\n          });\n        }\n      };\n      var isShowing = onSlot(doShowing, false);\n      var hideSlot = onSlot(doHide);\n      var hideSlots = onSlots(hideSlot);\n      var hideAllSlots = function (container) {\n        return hideSlots(container, getSlotNames());\n      };\n      var showSlot = onSlot(doShow);\n      var apis = {\n        getSlotNames: getSlotNames,\n        getSlot: getSlot,\n        isShowing: isShowing,\n        hideSlot: hideSlot,\n        hideAllSlots: hideAllSlots,\n        showSlot: showSlot\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$c(detail.slotBehaviours),\n        apis: apis\n      };\n    };\n    var slotApis = map$2({\n      getSlotNames: function (apis, c) {\n        return apis.getSlotNames(c);\n      },\n      getSlot: function (apis, c, key) {\n        return apis.getSlot(c, key);\n      },\n      isShowing: function (apis, c, key) {\n        return apis.isShowing(c, key);\n      },\n      hideSlot: function (apis, c, key) {\n        return apis.hideSlot(c, key);\n      },\n      hideAllSlots: function (apis, c) {\n        return apis.hideAllSlots(c);\n      },\n      showSlot: function (apis, c, key) {\n        return apis.showSlot(c, key);\n      }\n    }, function (value) {\n      return makeApi(value);\n    });\n    var SlotContainer = __assign(__assign({}, slotApis), { sketch: sketch$2 });\n\n    var sidebarSchema = objOf([\n      optionString('icon'),\n      optionString('tooltip'),\n      defaultedFunction('onShow', noop),\n      defaultedFunction('onHide', noop),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ]);\n    var createSidebar = function (spec) {\n      return asRaw('sidebar', sidebarSchema, spec);\n    };\n\n    var setup$6 = function (editor) {\n      var sidebars = editor.ui.registry.getAll().sidebars;\n      each(keys(sidebars), function (name) {\n        var spec = sidebars[name];\n        var isActive = function () {\n          return Optional.from(editor.queryCommandValue('ToggleSidebar')).is(name);\n        };\n        editor.ui.registry.addToggleButton(name, {\n          icon: spec.icon,\n          tooltip: spec.tooltip,\n          onAction: function (buttonApi) {\n            editor.execCommand('ToggleSidebar', false, name);\n            buttonApi.setActive(isActive());\n          },\n          onSetup: function (buttonApi) {\n            var handleToggle = function () {\n              return buttonApi.setActive(isActive());\n            };\n            editor.on('ToggleSidebar', handleToggle);\n            return function () {\n              editor.off('ToggleSidebar', handleToggle);\n            };\n          }\n        });\n      });\n    };\n    var getApi = function (comp) {\n      return {\n        element: function () {\n          return comp.element.dom;\n        }\n      };\n    };\n    var makePanels = function (parts, panelConfigs) {\n      var specs = map(keys(panelConfigs), function (name) {\n        var spec = panelConfigs[name];\n        var bridged = getOrDie(createSidebar(spec));\n        return {\n          name: name,\n          getApi: getApi,\n          onSetup: bridged.onSetup,\n          onShow: bridged.onShow,\n          onHide: bridged.onHide\n        };\n      });\n      return map(specs, function (spec) {\n        var editorOffCell = Cell(noop);\n        return parts.slot(spec.name, {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane']\n          },\n          behaviours: SimpleBehaviours.unnamedEvents([\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell),\n            run(slotVisibility(), function (sidepanel, se) {\n              var data = se.event;\n              var optSidePanelSpec = find(specs, function (config) {\n                return config.name === data.name;\n              });\n              optSidePanelSpec.each(function (sidePanelSpec) {\n                var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n                handler(sidePanelSpec.getApi(sidepanel));\n              });\n            })\n          ])\n        });\n      });\n    };\n    var makeSidebar = function (panelConfigs) {\n      return SlotContainer.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane-container']\n          },\n          components: makePanels(parts, panelConfigs),\n          slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n              return SlotContainer.hideAllSlots(slotContainer);\n            })])\n        };\n      });\n    };\n    var setSidebar = function (sidebar, panelConfigs) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n      });\n    };\n    var toggleSidebar = function (sidebar, name) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        optSlotContainer.each(function (slotContainer) {\n          if (Sliding.hasGrown(slider)) {\n            if (SlotContainer.isShowing(slotContainer, name)) {\n              Sliding.shrink(slider);\n            } else {\n              SlotContainer.hideAllSlots(slotContainer);\n              SlotContainer.showSlot(slotContainer, name);\n            }\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n            Sliding.grow(slider);\n          }\n        });\n      });\n    };\n    var whichSidebar = function (sidebar) {\n      var optSlider = Composing.getCurrent(sidebar);\n      return optSlider.bind(function (slider) {\n        var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n        if (sidebarOpen) {\n          var optSlotContainer = Composing.getCurrent(slider);\n          return optSlotContainer.bind(function (slotContainer) {\n            return find(SlotContainer.getSlotNames(slotContainer), function (name) {\n              return SlotContainer.isShowing(slotContainer, name);\n            });\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var fixSize = generate$1('FixSizeEvent');\n    var autoSize = generate$1('AutoSizeEvent');\n    var renderSidebar = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar'],\n          attributes: { role: 'complementary' }\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-sidebar__slider']\n            },\n            components: [],\n            behaviours: derive$1([\n              Tabstopping.config({}),\n              Focusing.config({}),\n              Sliding.config({\n                dimension: { property: 'width' },\n                closedClass: 'tox-sidebar--sliding-closed',\n                openClass: 'tox-sidebar--sliding-open',\n                shrinkingClass: 'tox-sidebar--sliding-shrinking',\n                growingClass: 'tox-sidebar--sliding-growing',\n                onShrunk: function (slider) {\n                  var optSlotContainer = Composing.getCurrent(slider);\n                  optSlotContainer.each(SlotContainer.hideAllSlots);\n                  emit(slider, autoSize);\n                },\n                onGrown: function (slider) {\n                  emit(slider, autoSize);\n                },\n                onStartGrow: function (slider) {\n                  emitWith(slider, fixSize, { width: getRaw(slider.element, 'width').getOr('') });\n                },\n                onStartShrink: function (slider) {\n                  emitWith(slider, fixSize, { width: get$7(slider.element) + 'px' });\n                }\n              }),\n              Replacing.config({}),\n              Composing.config({\n                find: function (comp) {\n                  var children = Replacing.contents(comp);\n                  return head(children);\n                }\n              })\n            ])\n          }],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          config('sidebar-sliding-events', [\n            run(fixSize, function (comp, se) {\n              set$2(comp.element, 'width', se.event.width);\n            }),\n            run(autoSize, function (comp, _se) {\n              remove$6(comp.element, 'width');\n            })\n          ])\n        ])\n      };\n    };\n\n    var getAttrs = function (elem) {\n      var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n      return foldl(attributes, function (b, attr) {\n        var _a;\n        if (attr.name === 'class') {\n          return b;\n        } else {\n          return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n        }\n      }, {});\n    };\n    var getClasses = function (elem) {\n      return Array.prototype.slice.call(elem.dom.classList, 0);\n    };\n    var fromHtml$2 = function (html) {\n      var elem = SugarElement.fromHtml(html);\n      var children$1 = children(elem);\n      var attrs = getAttrs(elem);\n      var classes = getClasses(elem);\n      var contents = children$1.length === 0 ? {} : { innerHtml: get$1(elem) };\n      return __assign({\n        tag: name(elem),\n        classes: classes,\n        attributes: attrs\n      }, contents);\n    };\n\n    var renderSpinner = function (providerBackstage) {\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { 'aria-label': providerBackstage.translate('Loading...') },\n          classes: ['tox-throbber__busy-spinner']\n        },\n        components: [{ dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            onTab: function () {\n              return Optional.some(true);\n            },\n            onShiftTab: function () {\n              return Optional.some(true);\n            }\n          }),\n          Focusing.config({})\n        ])\n      };\n    };\n    var toggleThrobber = function (comp, state, providerBackstage) {\n      var element = comp.element;\n      if (state === true) {\n        Replacing.set(comp, [renderSpinner(providerBackstage)]);\n        remove$6(element, 'display');\n        remove$1(element, 'aria-hidden');\n      } else {\n        Replacing.set(comp, []);\n        set$2(element, 'display', 'none');\n        set$1(element, 'aria-hidden', 'true');\n      }\n    };\n    var renderThrobber = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          attributes: { 'aria-hidden': 'true' },\n          classes: ['tox-throbber'],\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([Replacing.config({})]),\n        components: []\n      };\n    };\n    var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n      var throbberState = Cell(false);\n      var timer = Cell(Optional.none());\n      var toggle = function (state) {\n        if (state !== throbberState.get()) {\n          toggleThrobber(lazyThrobber(), state, sharedBackstage.providers);\n          throbberState.set(state);\n        }\n      };\n      editor.on('ProgressState', function (e) {\n        timer.get().each(global$2.clearTimeout);\n        if (isNumber(e.time)) {\n          var timerId = global$2.setEditorTimeout(editor, function () {\n            return toggle(e.state);\n          }, e.time);\n          timer.set(Optional.some(timerId));\n        } else {\n          toggle(e.state);\n          timer.set(Optional.none());\n        }\n      });\n    };\n\n    var factory$h = function (detail, components, _spec) {\n      var apis = {\n        getSocket: function (comp) {\n          return parts$d.getPart(comp, detail, 'socket');\n        },\n        setSidebar: function (comp, panelConfigs) {\n          parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return setSidebar(sidebar, panelConfigs);\n          });\n        },\n        toggleSidebar: function (comp, name) {\n          parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return toggleSidebar(sidebar, name);\n          });\n        },\n        whichSidebar: function (comp) {\n          return parts$d.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n        },\n        getHeader: function (comp) {\n          return parts$d.getPart(comp, detail, 'header');\n        },\n        getToolbar: function (comp) {\n          return parts$d.getPart(comp, detail, 'toolbar');\n        },\n        setToolbar: function (comp, groups) {\n          parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            toolbar.getApis().setGroups(toolbar, groups);\n          });\n        },\n        setToolbars: function (comp, toolbars) {\n          parts$d.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n            CustomList.setItems(mToolbar, toolbars);\n          });\n        },\n        refreshToolbar: function (comp) {\n          var toolbar = parts$d.getPart(comp, detail, 'toolbar');\n          toolbar.each(function (toolbar) {\n            return toolbar.getApis().refresh(toolbar);\n          });\n        },\n        toggleToolbarDrawer: function (comp) {\n          parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            mapFrom(toolbar.getApis().toggle, function (toggle) {\n              return toggle(toolbar);\n            });\n          });\n        },\n        isToolbarDrawerToggled: function (comp) {\n          return parts$d.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n            return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n              return isOpen(toolbar);\n            });\n          }).getOr(false);\n        },\n        getThrobber: function (comp) {\n          return parts$d.getPart(comp, detail, 'throbber');\n        },\n        focusToolbar: function (comp) {\n          var optToolbar = parts$d.getPart(comp, detail, 'toolbar').orThunk(function () {\n            return parts$d.getPart(comp, detail, 'multiple-toolbar');\n          });\n          optToolbar.each(function (toolbar) {\n            Keying.focusIn(toolbar);\n          });\n        },\n        setMenubar: function (comp, menus) {\n          parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.setMenus(menubar, menus);\n          });\n        },\n        focusMenubar: function (comp) {\n          parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.focus(menubar);\n          });\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        behaviours: detail.behaviours\n      };\n    };\n    var partMenubar = partType$1.optional({\n      factory: SilverMenubar,\n      name: 'menubar',\n      schema: [strict$1('backstage')]\n    });\n    var toolbarFactory = function (spec) {\n      if (spec.type === ToolbarMode.sliding) {\n        return renderSlidingMoreToolbar;\n      } else if (spec.type === ToolbarMode.floating) {\n        return renderFloatingMoreToolbar;\n      } else {\n        return renderToolbar;\n      }\n    };\n    var partMultipleToolbar = partType$1.optional({\n      factory: {\n        sketch: function (spec) {\n          return CustomList.sketch({\n            uid: spec.uid,\n            dom: spec.dom,\n            listBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                selector: '.tox-toolbar'\n              })]),\n            makeItem: function () {\n              return renderToolbar({\n                type: spec.type,\n                uid: generate$1('multiple-toolbar-item'),\n                cyclicKeying: false,\n                initGroups: [],\n                providers: spec.providers,\n                onEscape: function () {\n                  spec.onEscape();\n                  return Optional.some(true);\n                }\n              });\n            },\n            setupItem: function (_mToolbar, tc, data, _index) {\n              Toolbar.setGroups(tc, data);\n            },\n            shell: true\n          });\n        }\n      },\n      name: 'multiple-toolbar',\n      schema: [\n        strict$1('dom'),\n        strict$1('onEscape')\n      ]\n    });\n    var partToolbar = partType$1.optional({\n      factory: {\n        sketch: function (spec) {\n          var renderer = toolbarFactory(spec);\n          var toolbarSpec = {\n            type: spec.type,\n            uid: spec.uid,\n            onEscape: function () {\n              spec.onEscape();\n              return Optional.some(true);\n            },\n            cyclicKeying: false,\n            initGroups: [],\n            getSink: spec.getSink,\n            providers: spec.providers,\n            moreDrawerData: {\n              lazyToolbar: spec.lazyToolbar,\n              lazyMoreButton: spec.lazyMoreButton,\n              lazyHeader: spec.lazyHeader\n            },\n            attributes: spec.attributes\n          };\n          return renderer(toolbarSpec);\n        }\n      },\n      name: 'toolbar',\n      schema: [\n        strict$1('dom'),\n        strict$1('onEscape'),\n        strict$1('getSink')\n      ]\n    });\n    var partHeader = partType$1.optional({\n      factory: { sketch: renderHeader },\n      name: 'header',\n      schema: [strict$1('dom')]\n    });\n    var partSocket = partType$1.optional({\n      name: 'socket',\n      schema: [strict$1('dom')]\n    });\n    var partSidebar = partType$1.optional({\n      factory: { sketch: renderSidebar },\n      name: 'sidebar',\n      schema: [strict$1('dom')]\n    });\n    var partThrobber = partType$1.optional({\n      factory: { sketch: renderThrobber },\n      name: 'throbber',\n      schema: [strict$1('dom')]\n    });\n    var OuterContainer = composite$1({\n      name: 'OuterContainer',\n      factory: factory$h,\n      configFields: [\n        strict$1('dom'),\n        strict$1('behaviours')\n      ],\n      partFields: [\n        partHeader,\n        partMenubar,\n        partToolbar,\n        partMultipleToolbar,\n        partSocket,\n        partSidebar,\n        partThrobber\n      ],\n      apis: {\n        getSocket: function (apis, comp) {\n          return apis.getSocket(comp);\n        },\n        setSidebar: function (apis, comp, panelConfigs) {\n          apis.setSidebar(comp, panelConfigs);\n        },\n        toggleSidebar: function (apis, comp, name) {\n          apis.toggleSidebar(comp, name);\n        },\n        whichSidebar: function (apis, comp) {\n          return apis.whichSidebar(comp);\n        },\n        getHeader: function (apis, comp) {\n          return apis.getHeader(comp);\n        },\n        getToolbar: function (apis, comp) {\n          return apis.getToolbar(comp);\n        },\n        setToolbar: function (apis, comp, grps) {\n          var groups = map(grps, function (grp) {\n            return renderToolbarGroup(grp);\n          });\n          apis.setToolbar(comp, groups);\n        },\n        setToolbars: function (apis, comp, ts) {\n          var renderedToolbars = map(ts, function (g) {\n            return map(g, renderToolbarGroup);\n          });\n          apis.setToolbars(comp, renderedToolbars);\n        },\n        refreshToolbar: function (apis, comp) {\n          return apis.refreshToolbar(comp);\n        },\n        toggleToolbarDrawer: function (apis, comp) {\n          apis.toggleToolbarDrawer(comp);\n        },\n        isToolbarDrawerToggled: function (apis, comp) {\n          return apis.isToolbarDrawerToggled(comp);\n        },\n        getThrobber: function (apis, comp) {\n          return apis.getThrobber(comp);\n        },\n        setMenubar: function (apis, comp, menus) {\n          apis.setMenubar(comp, menus);\n        },\n        focusMenubar: function (apis, comp) {\n          apis.focusMenubar(comp);\n        },\n        focusToolbar: function (apis, comp) {\n          apis.focusToolbar(comp);\n        }\n      }\n    });\n\n    var defaultMenubar = 'file edit view insert format tools table help';\n    var defaultMenus = {\n      file: {\n        title: 'File',\n        items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n      },\n      edit: {\n        title: 'Edit',\n        items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n      },\n      view: {\n        title: 'View',\n        items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n      },\n      insert: {\n        title: 'Insert',\n        items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n      },\n      format: {\n        title: 'Format',\n        items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat'\n      },\n      tools: {\n        title: 'Tools',\n        items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n      },\n      table: {\n        title: 'Table',\n        items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n      },\n      help: {\n        title: 'Help',\n        items: 'help'\n      }\n    };\n    var make$8 = function (menu, registry, editor) {\n      var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n      return {\n        text: menu.title,\n        getItems: function () {\n          return bind(menu.items, function (i) {\n            var itemName = i.toLowerCase();\n            if (itemName.trim().length === 0) {\n              return [];\n            } else if (exists(removedMenuItems, function (removedMenuItem) {\n                return removedMenuItem === itemName;\n              })) {\n              return [];\n            } else if (itemName === 'separator' || itemName === '|') {\n              return [{ type: 'separator' }];\n            } else if (registry.menuItems[itemName]) {\n              return [registry.menuItems[itemName]];\n            } else {\n              return [];\n            }\n          });\n        }\n      };\n    };\n    var parseItemsString = function (items) {\n      if (typeof items === 'string') {\n        return items.split(' ');\n      }\n      return items;\n    };\n    var identifyMenus = function (editor, registry) {\n      var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n      var userDefinedMenus = keys(registry.menus).length > 0;\n      var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n      var validMenus = filter(menubar, function (menuName) {\n        return userDefinedMenus ? registry.menus.hasOwnProperty(menuName) && registry.menus[menuName].hasOwnProperty('items') || defaultMenus.hasOwnProperty(menuName) : defaultMenus.hasOwnProperty(menuName);\n      });\n      var menus = map(validMenus, function (menuName) {\n        var menuData = rawMenuData[menuName];\n        return make$8({\n          title: menuData.title,\n          items: parseItemsString(menuData.items)\n        }, registry, editor);\n      });\n      return filter(menus, function (menu) {\n        var isNotSeparator = function (item) {\n          return item.type !== 'separator';\n        };\n        return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n      });\n    };\n\n    var fireSkinLoaded$1 = function (editor) {\n      var done = function () {\n        editor._skinLoaded = true;\n        fireSkinLoaded(editor);\n      };\n      return function () {\n        if (editor.initialized) {\n          done();\n        } else {\n          editor.on('init', done);\n        }\n      };\n    };\n    var fireSkinLoadError$1 = function (editor, err) {\n      return function () {\n        return fireSkinLoadError(editor, { message: err });\n      };\n    };\n\n    var loadSkin = function (isInline, editor) {\n      var skinUrl = getSkinUrl(editor);\n      var skinUiCss;\n      if (skinUrl) {\n        skinUiCss = skinUrl + '/skin.min.css';\n        editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n      }\n      if (isSkinDisabled(editor) === false && skinUiCss) {\n        var styleSheetLoader_1 = editor.ui.styleSheetLoader;\n        styleSheetLoader_1.load(skinUiCss, fireSkinLoaded$1(editor), fireSkinLoadError$1(editor, 'Skin could not be loaded'));\n        editor.on('remove', function () {\n          return styleSheetLoader_1.unload(skinUiCss);\n        });\n      } else {\n        fireSkinLoaded$1(editor)();\n      }\n    };\n    var iframe = curry(loadSkin, false);\n    var inline = curry(loadSkin, true);\n\n    var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n      var comp = uiComponents.outerContainer;\n      var toolbarConfig = rawUiConfig.toolbar;\n      var toolbarButtonsConfig = rawUiConfig.buttons;\n      if (isArrayOf(toolbarConfig, isString)) {\n        var toolbars = toolbarConfig.map(function (t) {\n          var config = {\n            toolbar: t,\n            buttons: toolbarButtonsConfig,\n            allowToolbarGroups: rawUiConfig.allowToolbarGroups\n          };\n          return identifyButtons(editor, config, { backstage: backstage }, Optional.none());\n        });\n        OuterContainer.setToolbars(comp, toolbars);\n      } else {\n        OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, { backstage: backstage }, Optional.none()));\n      }\n    };\n\n    var DOM = global$5.DOM;\n    var detection = detect$3();\n    var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n    var setupEvents = function (editor, uiComponents) {\n      var contentWindow = editor.getWin();\n      var initialDocEle = editor.getDoc().documentElement;\n      var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n      var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n      var resizeWindow = function () {\n        var outer = lastWindowDimensions.get();\n        if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n          lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var resizeDocument = function () {\n        var docEle = editor.getDoc().documentElement;\n        var inner = lastDocumentDimensions.get();\n        if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n          lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var scroll = function (e) {\n        return fireScrollContent(editor, e);\n      };\n      DOM.bind(contentWindow, 'resize', resizeWindow);\n      DOM.bind(contentWindow, 'scroll', scroll);\n      var elementLoad = capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n      var mothership = uiComponents.uiMothership.element;\n      editor.on('hide', function () {\n        set$2(mothership, 'display', 'none');\n      });\n      editor.on('show', function () {\n        remove$6(mothership, 'display');\n      });\n      editor.on('NodeChange', resizeDocument);\n      editor.on('remove', function () {\n        elementLoad.unbind();\n        DOM.unbind(contentWindow, 'resize', resizeWindow);\n        DOM.unbind(contentWindow, 'scroll', scroll);\n      });\n    };\n    var render = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var lastToolbarWidth = Cell(0);\n      var outerContainer = uiComponents.outerContainer;\n      iframe(editor);\n      var eTargetNode = SugarElement.fromDom(args.targetNode);\n      var uiRoot = getContentContainer(getRootNode(eTargetNode));\n      attachSystemAfter(eTargetNode, uiComponents.mothership);\n      attachSystem(uiRoot, uiComponents.uiMothership);\n      editor.on('PostRender', function () {\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        lastToolbarWidth.set(editor.getWin().innerWidth);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n        setupEvents(editor, uiComponents);\n      });\n      var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n      if (isiOS12) {\n        setAll$1(socket.element, {\n          'overflow': 'scroll',\n          '-webkit-overflow-scrolling': 'touch'\n        });\n        var limit = first(function () {\n          editor.fire('ScrollContent');\n        }, 20);\n        bind$3(socket.element, 'scroll', limit.throttle);\n      }\n      setupReadonlyModeSwitch(editor, uiComponents);\n      editor.addCommand('ToggleSidebar', function (_ui, value) {\n        OuterContainer.toggleSidebar(outerContainer, value);\n        editor.fire('ToggleSidebar');\n      });\n      editor.addQueryValueHandler('ToggleSidebar', function () {\n        return OuterContainer.whichSidebar(outerContainer);\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var refreshDrawer = function () {\n        OuterContainer.refreshToolbar(uiComponents.outerContainer);\n      };\n      if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n        editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n          var width = editor.getWin().innerWidth;\n          if (width !== lastToolbarWidth.get()) {\n            refreshDrawer();\n            lastToolbarWidth.set(width);\n          }\n        });\n      }\n      return {\n        iframeContainer: socket.element.dom,\n        editorContainer: outerContainer.element.dom\n      };\n    };\n\n    var Iframe = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render\n    });\n\n    var parseToInt = function (val) {\n      var re = /^[0-9\\.]+(|px)$/i;\n      if (re.test('' + val)) {\n        return Optional.some(parseInt('' + val, 10));\n      }\n      return Optional.none();\n    };\n    var numToPx = function (val) {\n      return isNumber(val) ? val + 'px' : val;\n    };\n    var calcCappedSize = function (size, minSize, maxSize) {\n      var minOverride = minSize.filter(function (min) {\n        return size < min;\n      });\n      var maxOverride = maxSize.filter(function (max) {\n        return size > max;\n      });\n      return minOverride.or(maxOverride).getOr(size);\n    };\n\n    var getHeight$1 = function (editor) {\n      var baseHeight = getHeightSetting(editor);\n      var minHeight = getMinHeightSetting(editor);\n      var maxHeight = getMaxHeightSetting(editor);\n      return parseToInt(baseHeight).map(function (height) {\n        return calcCappedSize(height, minHeight, maxHeight);\n      });\n    };\n    var getHeightWithFallback = function (editor) {\n      var height = getHeight$1(editor);\n      return height.getOr(getHeightSetting(editor));\n    };\n    var getWidth$1 = function (editor) {\n      var baseWidth = getWidthSetting(editor);\n      var minWidth = getMinWidthSetting(editor);\n      var maxWidth = getMaxWidthSetting(editor);\n      return parseToInt(baseWidth).map(function (width) {\n        return calcCappedSize(width, minWidth, maxWidth);\n      });\n    };\n    var getWidthWithFallback = function (editor) {\n      var width = getWidth$1(editor);\n      return width.getOr(getWidthSetting(editor));\n    };\n\n    var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n      var uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var DOM = global$5.DOM;\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var isSticky = isStickyToolbar(editor);\n      var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth$1(editor));\n      var headerBackstage = backstage.shared.header;\n      var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n      var toolbarMode = getToolbarMode(editor);\n      var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n      var visible = Cell(false);\n      var isVisible = function () {\n        return visible.get() && !editor.removed;\n      };\n      var calcToolbarOffset = function (toolbar) {\n        return isSplitToolbar ? toolbar.fold(function () {\n          return 0;\n        }, function (tbar) {\n          return tbar.components().length > 1 ? get$6(tbar.components()[1].element) : 0;\n        }) : 0;\n      };\n      var calcMode = function (container) {\n        switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$6(container.element) - offset;\n          var targetBounds = box(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$6(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n        case ToolbarLocation.bottom:\n          return 'bottom';\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n        }\n      };\n      var setupMode = function (mode) {\n        var container = floatContainer.get();\n        Docking.setModes(container, [mode]);\n        headerBackstage.setDockingMode(mode);\n        var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n        set$1(container.element, Attribute, verticalDir);\n      };\n      var updateChromeWidth = function () {\n        var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n          var bodyMargin = parseToInt(get$4(body(), 'margin-left')).getOr(0);\n          return get$7(body()) - absolute(targetElm).left + bodyMargin;\n        });\n        set$2(floatContainer.get().element, 'max-width', maxWidth + 'px');\n      };\n      var updateChromePosition = function () {\n        var toolbar = OuterContainer.getToolbar(outerContainer);\n        var offset = calcToolbarOffset(toolbar);\n        var targetBounds = box(targetElm);\n        var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$6(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n        setAll$1(outerContainer.element, {\n          position: 'absolute',\n          top: Math.round(top) + 'px',\n          left: Math.round(targetBounds.x) + 'px'\n        });\n      };\n      var repositionPopups$1 = function () {\n        uiMothership.broadcastOn([repositionPopups()], {});\n      };\n      var updateChromeUi = function (resetDocking) {\n        if (resetDocking === void 0) {\n          resetDocking = false;\n        }\n        if (!isVisible()) {\n          return;\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromeWidth();\n        }\n        if (isSplitToolbar) {\n          OuterContainer.refreshToolbar(outerContainer);\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromePosition();\n        }\n        if (isSticky) {\n          var floatContainerComp = floatContainer.get();\n          resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n        }\n        repositionPopups$1();\n      };\n      var updateMode = function (updateUi) {\n        if (updateUi === void 0) {\n          updateUi = true;\n        }\n        if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n          return;\n        }\n        var currentMode = headerBackstage.getDockingMode();\n        var newMode = calcMode(floatContainer.get());\n        if (newMode !== currentMode) {\n          setupMode(newMode);\n          if (updateUi) {\n            updateChromeUi(true);\n          }\n        }\n      };\n      var show = function () {\n        visible.set(true);\n        set$2(outerContainer.element, 'display', 'flex');\n        DOM.addClass(editor.getBody(), 'mce-edit-focus');\n        remove$6(uiMothership.element, 'display');\n        updateMode(false);\n        updateChromeUi();\n      };\n      var hide = function () {\n        visible.set(false);\n        if (uiComponents.outerContainer) {\n          set$2(outerContainer.element, 'display', 'none');\n          DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n        }\n        set$2(uiMothership.element, 'display', 'none');\n      };\n      return {\n        isVisible: isVisible,\n        isPositionedAtTop: isPositionedAtTop,\n        show: show,\n        hide: hide,\n        update: updateChromeUi,\n        updateMode: updateMode,\n        repositionPopups: repositionPopups$1\n      };\n    };\n\n    var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n      var bounds = box(targetElm);\n      return {\n        pos: isToolbarTop ? bounds.y : bounds.bottom,\n        bounds: bounds\n      };\n    };\n    var setupEvents$1 = function (editor, targetElm, ui, toolbarPersist) {\n      var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n      var resizeContent = function (e) {\n        var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()), pos = _a.pos, bounds = _a.bounds;\n        var _b = prevPosAndBounds.get(), prevPos = _b.pos, prevBounds = _b.bounds;\n        var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n        prevPosAndBounds.set({\n          pos: pos,\n          bounds: bounds\n        });\n        if (hasResized) {\n          fireResizeContent(editor, e);\n        }\n        if (ui.isVisible()) {\n          if (prevPos !== pos) {\n            ui.update(true);\n          } else if (hasResized) {\n            ui.updateMode();\n            ui.repositionPopups();\n          }\n        }\n      };\n      if (!toolbarPersist) {\n        editor.on('activate', ui.show);\n        editor.on('deactivate', ui.hide);\n      }\n      editor.on('SkinLoaded ResizeWindow', function () {\n        return ui.update(true);\n      });\n      editor.on('NodeChange keydown', function (e) {\n        global$2.requestAnimationFrame(function () {\n          return resizeContent(e);\n        });\n      });\n      editor.on('ScrollWindow', function () {\n        return ui.updateMode();\n      });\n      var elementLoad = unbindable();\n      elementLoad.set(capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n      editor.on('remove', function () {\n        elementLoad.clear();\n      });\n    };\n    var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var mothership = uiComponents.mothership, uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var floatContainer = Cell(null);\n      var targetElm = SugarElement.fromDom(args.targetNode);\n      var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n      var toolbarPersist = isToolbarPersist(editor);\n      inline(editor);\n      var render = function () {\n        if (floatContainer.get()) {\n          ui.show();\n          return;\n        }\n        floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n        var uiContainer = getUiContainer(editor);\n        attachSystem(uiContainer, mothership);\n        attachSystem(uiContainer, uiMothership);\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        ui.show();\n        setupEvents$1(editor, targetElm, ui, toolbarPersist);\n        editor.nodeChanged();\n      };\n      editor.on('show', render);\n      editor.on('hide', ui.hide);\n      if (!toolbarPersist) {\n        editor.on('focus', render);\n        editor.on('blur', ui.hide);\n      }\n      editor.on('init', function () {\n        if (editor.hasFocus() || toolbarPersist) {\n          render();\n        }\n      });\n      setupReadonlyModeSwitch(editor, uiComponents);\n      var api = {\n        show: function () {\n          ui.show();\n        },\n        hide: function () {\n          ui.hide();\n        }\n      };\n      return {\n        editorContainer: outerContainer.element.dom,\n        api: api\n      };\n    };\n\n    var Inline = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render$1\n    });\n\n    var register$5 = function (editor) {\n      var alignToolbarButtons = [\n        {\n          name: 'alignleft',\n          text: 'Align left',\n          cmd: 'JustifyLeft',\n          icon: 'align-left'\n        },\n        {\n          name: 'aligncenter',\n          text: 'Align center',\n          cmd: 'JustifyCenter',\n          icon: 'align-center'\n        },\n        {\n          name: 'alignright',\n          text: 'Align right',\n          cmd: 'JustifyRight',\n          icon: 'align-right'\n        },\n        {\n          name: 'alignjustify',\n          text: 'Justify',\n          cmd: 'JustifyFull',\n          icon: 'align-justify'\n        }\n      ];\n      global$e.each(alignToolbarButtons, function (item) {\n        editor.ui.registry.addToggleButton(item.name, {\n          tooltip: item.text,\n          onAction: function () {\n            return editor.execCommand(item.cmd);\n          },\n          icon: item.icon,\n          onSetup: onSetupFormatToggle(editor, item.name)\n        });\n      });\n      var alignNoneToolbarButton = {\n        name: 'alignnone',\n        text: 'No alignment',\n        cmd: 'JustifyNone',\n        icon: 'align-none'\n      };\n      editor.ui.registry.addButton(alignNoneToolbarButton.name, {\n        tooltip: alignNoneToolbarButton.text,\n        onAction: function () {\n          return editor.execCommand(alignNoneToolbarButton.cmd);\n        },\n        icon: alignNoneToolbarButton.icon\n      });\n    };\n\n    var register$6 = function (editor, backstage) {\n      alignSelectMenu(editor, backstage);\n      fontSelectMenu(editor, backstage);\n      styleSelectMenu(editor, backstage);\n      formatSelectMenu(editor, backstage);\n      fontsizeSelectMenu(editor, backstage);\n    };\n\n    var toggleOutdentState = function (api, editor) {\n      api.setDisabled(!editor.queryCommandState('outdent'));\n      var onNodeChange = function () {\n        api.setDisabled(!editor.queryCommandState('outdent'));\n      };\n      editor.on('NodeChange', onNodeChange);\n      return function () {\n        return editor.off('NodeChange', onNodeChange);\n      };\n    };\n    var registerButtons = function (editor) {\n      editor.ui.registry.addButton('outdent', {\n        tooltip: 'Decrease indent',\n        icon: 'outdent',\n        onSetup: function (api) {\n          return toggleOutdentState(api, editor);\n        },\n        onAction: function () {\n          return editor.execCommand('outdent');\n        }\n      });\n      editor.ui.registry.addButton('indent', {\n        tooltip: 'Increase indent',\n        icon: 'indent',\n        onAction: function () {\n          return editor.execCommand('indent');\n        }\n      });\n    };\n    var register$7 = function (editor) {\n      registerButtons(editor);\n    };\n\n    var toggleFormat = function (editor, fmt) {\n      return function () {\n        editor.execCommand('mceToggleFormat', false, fmt);\n      };\n    };\n    var registerFormatButtons = function (editor) {\n      global$e.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          icon: 'bold'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          icon: 'italic'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          icon: 'underline'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          icon: 'strike-through'\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          icon: 'subscript'\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          icon: 'superscript'\n        }\n      ], function (btn, _idx) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onSetup: onSetupFormatToggle(editor, btn.name),\n          onAction: toggleFormat(editor, btn.name)\n        });\n      });\n      for (var i = 1; i <= 6; i++) {\n        var name_1 = 'h' + i;\n        editor.ui.registry.addToggleButton(name_1, {\n          text: name_1.toUpperCase(),\n          tooltip: 'Heading ' + i,\n          onSetup: onSetupFormatToggle(editor, name_1),\n          onAction: toggleFormat(editor, name_1)\n        });\n      }\n    };\n    var registerCommandButtons = function (editor) {\n      global$e.each([\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste'\n        },\n        {\n          name: 'help',\n          text: 'Help',\n          action: 'mceHelp',\n          icon: 'help'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all'\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document'\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting'\n        },\n        {\n          name: 'remove',\n          text: 'Remove',\n          action: 'Delete',\n          icon: 'remove'\n        }\n      ], function (btn) {\n        editor.ui.registry.addButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          }\n        });\n      });\n    };\n    var registerCommandToggleButtons = function (editor) {\n      global$e.each([{\n          name: 'blockquote',\n          text: 'Blockquote',\n          action: 'mceBlockQuote',\n          icon: 'quote'\n        }], function (btn) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          },\n          onSetup: onSetupFormatToggle(editor, btn.name)\n        });\n      });\n    };\n    var registerButtons$1 = function (editor) {\n      registerFormatButtons(editor);\n      registerCommandButtons(editor);\n      registerCommandToggleButtons(editor);\n    };\n    var registerMenuItems = function (editor) {\n      global$e.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          action: 'Bold',\n          icon: 'bold',\n          shortcut: 'Meta+B'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          action: 'Italic',\n          icon: 'italic',\n          shortcut: 'Meta+I'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          action: 'Underline',\n          icon: 'underline',\n          shortcut: 'Meta+U'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          action: 'Strikethrough',\n          icon: 'strike-through',\n          shortcut: ''\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          action: 'Subscript',\n          icon: 'subscript',\n          shortcut: ''\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          action: 'Superscript',\n          icon: 'superscript',\n          shortcut: ''\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting',\n          shortcut: ''\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document',\n          shortcut: ''\n        },\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut',\n          shortcut: 'Meta+X'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy',\n          shortcut: 'Meta+C'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste',\n          shortcut: 'Meta+V'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all',\n          shortcut: 'Meta+A'\n        }\n      ], function (btn) {\n        editor.ui.registry.addMenuItem(btn.name, {\n          text: btn.text,\n          icon: btn.icon,\n          shortcut: btn.shortcut,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          }\n        });\n      });\n      editor.ui.registry.addMenuItem('codeformat', {\n        text: 'Code',\n        icon: 'sourcecode',\n        onAction: toggleFormat(editor, 'code')\n      });\n    };\n    var register$8 = function (editor) {\n      registerButtons$1(editor);\n      registerMenuItems(editor);\n    };\n\n    var toggleUndoRedoState = function (api, editor, type) {\n      var checkState = function () {\n        return editor.undoManager ? editor.undoManager[type]() : false;\n      };\n      var onUndoStateChange = function () {\n        api.setDisabled(editor.mode.isReadOnly() || !checkState());\n      };\n      api.setDisabled(!checkState());\n      editor.on('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n      return function () {\n        return editor.off('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n      };\n    };\n    var registerMenuItems$1 = function (editor) {\n      editor.ui.registry.addMenuItem('undo', {\n        text: 'Undo',\n        icon: 'undo',\n        shortcut: 'Meta+Z',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasUndo');\n        },\n        onAction: function () {\n          return editor.execCommand('undo');\n        }\n      });\n      editor.ui.registry.addMenuItem('redo', {\n        text: 'Redo',\n        icon: 'redo',\n        shortcut: 'Meta+Y',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasRedo');\n        },\n        onAction: function () {\n          return editor.execCommand('redo');\n        }\n      });\n    };\n    var registerButtons$2 = function (editor) {\n      editor.ui.registry.addButton('undo', {\n        tooltip: 'Undo',\n        icon: 'undo',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasUndo');\n        },\n        onAction: function () {\n          return editor.execCommand('undo');\n        }\n      });\n      editor.ui.registry.addButton('redo', {\n        tooltip: 'Redo',\n        icon: 'redo',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasRedo');\n        },\n        onAction: function () {\n          return editor.execCommand('redo');\n        }\n      });\n    };\n    var register$9 = function (editor) {\n      registerMenuItems$1(editor);\n      registerButtons$2(editor);\n    };\n\n    var toggleVisualAidState = function (api, editor) {\n      api.setActive(editor.hasVisual);\n      var onVisualAid = function (e) {\n        api.setActive(e.hasVisual);\n      };\n      editor.on('VisualAid', onVisualAid);\n      return function () {\n        return editor.off('VisualAid', onVisualAid);\n      };\n    };\n    var registerMenuItems$2 = function (editor) {\n      editor.ui.registry.addToggleMenuItem('visualaid', {\n        text: 'Visual aids',\n        onSetup: function (api) {\n          return toggleVisualAidState(api, editor);\n        },\n        onAction: function () {\n          editor.execCommand('mceToggleVisualAid');\n        }\n      });\n    };\n    var registerToolbarButton = function (editor) {\n      editor.ui.registry.addButton('visualaid', {\n        tooltip: 'Visual aids',\n        text: 'Visual aids',\n        onAction: function () {\n          return editor.execCommand('mceToggleVisualAid');\n        }\n      });\n    };\n    var register$a = function (editor) {\n      registerToolbarButton(editor);\n      registerMenuItems$2(editor);\n    };\n\n    var units = {\n      unsupportedLength: [\n        'em',\n        'ex',\n        'cap',\n        'ch',\n        'ic',\n        'rem',\n        'lh',\n        'rlh',\n        'vw',\n        'vh',\n        'vi',\n        'vb',\n        'vmin',\n        'vmax',\n        'cm',\n        'mm',\n        'Q',\n        'in',\n        'pc',\n        'pt',\n        'px'\n      ],\n      fixed: [\n        'px',\n        'pt'\n      ],\n      relative: ['%'],\n      empty: ['']\n    };\n    var pattern = function () {\n      var decimalDigits = '[0-9]+';\n      var signedInteger = '[+-]?' + decimalDigits;\n      var exponentPart = '[eE]' + signedInteger;\n      var dot = '\\\\.';\n      var opt = function (input) {\n        return '(?:' + input + ')?';\n      };\n      var unsignedDecimalLiteral = [\n        'Infinity',\n        decimalDigits + dot + opt(decimalDigits) + opt(exponentPart),\n        dot + decimalDigits + opt(exponentPart),\n        decimalDigits + opt(exponentPart)\n      ].join('|');\n      var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n      return new RegExp('^(' + float + ')(.*)$');\n    }();\n    var isUnit = function (unit, accepted) {\n      return exists(accepted, function (acc) {\n        return exists(units[acc], function (check) {\n          return unit === check;\n        });\n      });\n    };\n    var parse = function (input, accepted) {\n      var match = Optional.from(pattern.exec(input));\n      return match.bind(function (array) {\n        var value = Number(array[1]);\n        var unitRaw = array[2];\n        if (isUnit(unitRaw, accepted)) {\n          return Optional.some({\n            value: value,\n            unit: unitRaw\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalise = function (input, accepted) {\n      return parse(input, accepted).map(function (_a) {\n        var value = _a.value, unit = _a.unit;\n        return value + unit;\n      });\n    };\n\n    var normaliseLineHeight = function (input) {\n      return normalise(input, [\n        'fixed',\n        'relative',\n        'empty'\n      ]).getOr(input);\n    };\n    var getLineHeights = function (editor) {\n      var options = getLineHeightFormats(editor);\n      var apis = new Map();\n      var lastApi = destroyable();\n      var callback = function () {\n        var current = normaliseLineHeight(editor.queryCommandValue('LineHeight'));\n        Optional.from(apis.get(current)).fold(function () {\n          return lastApi.clear();\n        }, function (api) {\n          lastApi.set({\n            destroy: function () {\n              api.setActive(false);\n            }\n          });\n          api.setActive(true);\n        });\n      };\n      editor.on('nodeChange', callback);\n      return map(options, function (value, i) {\n        return {\n          type: 'togglemenuitem',\n          text: value,\n          onSetup: function (api) {\n            apis.set(normaliseLineHeight(value), api);\n            if (i + 1 === options.length) {\n              callback();\n            }\n            return function () {\n              if (i === 0) {\n                editor.off('nodeChange', callback);\n                lastApi.clear();\n              }\n            };\n          },\n          onAction: function () {\n            return editor.execCommand('LineHeight', false, value);\n          }\n        };\n      });\n    };\n    var registerMenuItems$3 = function (editor) {\n      editor.ui.registry.addNestedMenuItem('lineheight', {\n        type: 'nestedmenuitem',\n        text: 'Line height',\n        getSubmenuItems: function () {\n          return getLineHeights(editor);\n        }\n      });\n    };\n    var registerButtons$3 = function (editor) {\n      editor.ui.registry.addMenuButton('lineheight', {\n        tooltip: 'Line height',\n        icon: 'line-height',\n        fetch: function (callback) {\n          return callback(getLineHeights(editor));\n        }\n      });\n    };\n    var register$b = function (editor) {\n      registerMenuItems$3(editor);\n      registerButtons$3(editor);\n    };\n\n    var setup$8 = function (editor, backstage) {\n      register$5(editor);\n      register$8(editor);\n      register$6(editor, backstage);\n      register$9(editor);\n      register$1(editor);\n      register$a(editor);\n      register$7(editor);\n      register$b(editor);\n    };\n\n    var nu$d = function (x, y) {\n      return {\n        anchor: 'makeshift',\n        x: x,\n        y: y\n      };\n    };\n    var transpose$1 = function (pos, dx, dy) {\n      return nu$d(pos.x + dx, pos.y + dy);\n    };\n    var isTouchEvent$1 = function (e) {\n      return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n    };\n    var fromPageXY = function (e) {\n      if (isTouchEvent$1(e)) {\n        var touch = e.touches[0];\n        return nu$d(touch.pageX, touch.pageY);\n      } else {\n        return nu$d(e.pageX, e.pageY);\n      }\n    };\n    var fromClientXY = function (e) {\n      if (isTouchEvent$1(e)) {\n        var touch = e.touches[0];\n        return nu$d(touch.clientX, touch.clientY);\n      } else {\n        return nu$d(e.clientX, e.clientY);\n      }\n    };\n    var transposeContentAreaContainer = function (element, pos) {\n      var containerPos = global$5.DOM.getPos(element);\n      return transpose$1(pos, containerPos.x, containerPos.y);\n    };\n    var getPointAnchor = function (editor, e) {\n      if (e.type === 'contextmenu' || e.type === 'longpress') {\n        if (editor.inline) {\n          return fromPageXY(e);\n        } else {\n          return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n        }\n      } else {\n        return getSelectionAnchor(editor);\n      }\n    };\n    var getSelectionAnchor = function (editor) {\n      return {\n        anchor: 'selection',\n        root: SugarElement.fromDom(editor.selection.getNode())\n      };\n    };\n    var getNodeAnchor$1 = function (editor) {\n      return {\n        anchor: 'node',\n        node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n        root: SugarElement.fromDom(editor.getBody())\n      };\n    };\n\n    var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n      var items = buildMenu();\n      var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchor(editor, e);\n      build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuAt(contextmenu, anchorSpec, {\n          menu: { markers: markers$1('normal') },\n          data: menuData\n        });\n      });\n    };\n\n    var layouts = {\n      onLtr: function () {\n        return [\n          south$1,\n          southeast$1,\n          southwest$1,\n          northeast$1,\n          northwest$1,\n          north$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          south$1,\n          southwest$1,\n          southeast$1,\n          northwest$1,\n          northeast$1,\n          north$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var bubbleSize$1 = 12;\n    var bubbleAlignments$2 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top']\n    };\n    var isTouchWithinSelection = function (editor, e) {\n      var selection = editor.selection;\n      if (selection.isCollapsed() || e.touches.length < 1) {\n        return false;\n      } else {\n        var touch_1 = e.touches[0];\n        var rng = selection.getRng();\n        var rngRectOpt = getFirstRect$1(editor.getWin(), SimSelection.domRange(rng));\n        return rngRectOpt.exists(function (rngRect) {\n          return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n        });\n      }\n    };\n    var getPointAnchorSpec = function (editor, e) {\n      return __assign({\n        bubble: nu$8(0, bubbleSize$1, bubbleAlignments$2),\n        layouts: layouts,\n        overrides: {\n          maxWidthFunction: expandable$1(),\n          maxHeightFunction: expandable()\n        }\n      }, getPointAnchor(editor, e));\n    };\n    var setupiOSOverrides = function (editor) {\n      var originalSelection = editor.selection.getRng();\n      var selectionReset = function () {\n        global$2.setEditorTimeout(editor, function () {\n          editor.selection.setRng(originalSelection);\n        }, 10);\n        unbindEventListeners();\n      };\n      editor.once('touchend', selectionReset);\n      var preventMousedown = function (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      };\n      editor.on('mousedown', preventMousedown, true);\n      var clearSelectionReset = function () {\n        return unbindEventListeners();\n      };\n      editor.once('longpresscancel', clearSelectionReset);\n      var unbindEventListeners = function () {\n        editor.off('touchend', selectionReset);\n        editor.off('longpresscancel', clearSelectionReset);\n        editor.off('mousedown', preventMousedown);\n      };\n    };\n    var show = function (editor, e, items, backstage, contextmenu, useNodeAnchor, highlightImmediately) {\n      var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchorSpec(editor, e);\n      build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuWithinBounds(contextmenu, anchorSpec, {\n          menu: {\n            markers: markers$1('normal'),\n            highlightImmediately: highlightImmediately\n          },\n          data: menuData,\n          type: 'horizontal'\n        }, function () {\n          return Optional.some(getContextToolbarBounds(editor, backstage.shared));\n        });\n        editor.fire(hideContextToolbarEvent);\n      });\n    };\n    var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n      var detection = detect$3();\n      var isiOS = detection.os.isiOS();\n      var isOSX = detection.os.isOSX();\n      var isAndroid = detection.os.isAndroid();\n      var isTouch = detection.deviceType.isTouch();\n      var shouldHighlightImmediately = function () {\n        return !(isAndroid || isiOS || isOSX && isTouch);\n      };\n      var open = function () {\n        var items = buildMenu();\n        show(editor, e, items, backstage, contextmenu, useNodeAnchor, shouldHighlightImmediately());\n      };\n      if ((isOSX || isiOS) && !useNodeAnchor) {\n        var openiOS_1 = function () {\n          setupiOSOverrides(editor);\n          open();\n        };\n        if (isTouchWithinSelection(editor, e)) {\n          openiOS_1();\n        } else {\n          editor.once('selectionchange', openiOS_1);\n          editor.once('touchend', function () {\n            return editor.off('selectionchange', openiOS_1);\n          });\n        }\n      } else {\n        if (isAndroid && !useNodeAnchor) {\n          editor.selection.setCursorLocation(e.target, 0);\n        }\n        open();\n      }\n    };\n\n    var patchPipeConfig = function (config) {\n      return typeof config === 'string' ? config.split(/[ ,]/) : config;\n    };\n    var shouldNeverUseNative = function (editor) {\n      return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n    };\n    var getMenuItems = function (editor, name, defaultItems) {\n      var contextMenus = editor.ui.registry.getAll().contextMenus;\n      return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n        return filter(patchPipeConfig(defaultItems), function (item) {\n          return has(contextMenus, item);\n        });\n      });\n    };\n    var isContextMenuDisabled = function (editor) {\n      return editor.getParam('contextmenu') === false;\n    };\n    var getContextMenu = function (editor) {\n      return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n    };\n    var getAvoidOverlapSelector = function (editor) {\n      return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n    };\n\n    var isSeparator$1 = function (item) {\n      return isString(item) ? item === '|' : item.type === 'separator';\n    };\n    var separator$3 = { type: 'separator' };\n    var makeContextItem = function (item) {\n      if (isString(item)) {\n        return item;\n      } else {\n        switch (item.type) {\n        case 'separator':\n          return separator$3;\n        case 'submenu':\n          return {\n            type: 'nestedmenuitem',\n            text: item.text,\n            icon: item.icon,\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n              if (isString(items)) {\n                return items;\n              } else {\n                return map(items, makeContextItem);\n              }\n            }\n          };\n        default:\n          return {\n            type: 'menuitem',\n            text: item.text,\n            icon: item.icon,\n            onAction: noarg(item.onAction)\n          };\n        }\n      }\n    };\n    var addContextMenuGroup = function (xs, groupItems) {\n      if (groupItems.length === 0) {\n        return xs;\n      }\n      var lastMenuItem = last(xs).filter(function (item) {\n        return !isSeparator$1(item);\n      });\n      var before = lastMenuItem.fold(function () {\n        return [];\n      }, function (_) {\n        return [separator$3];\n      });\n      return xs.concat(before).concat(groupItems).concat([separator$3]);\n    };\n    var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n      var sections = foldl(menuConfig, function (acc, name) {\n        if (has(contextMenus, name)) {\n          var items = contextMenus[name].update(selectedElement);\n          if (isString(items)) {\n            return addContextMenuGroup(acc, items.split(' '));\n          } else if (items.length > 0) {\n            var allItems = map(items, makeContextItem);\n            return addContextMenuGroup(acc, allItems);\n          } else {\n            return acc;\n          }\n        } else {\n          return acc.concat([name]);\n        }\n      }, []);\n      if (sections.length > 0 && isSeparator$1(sections[sections.length - 1])) {\n        sections.pop();\n      }\n      return sections;\n    };\n    var isNativeOverrideKeyEvent = function (editor, e) {\n      return e.ctrlKey && !shouldNeverUseNative(editor);\n    };\n    var isTriggeredByKeyboard = function (editor, e) {\n      return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n    };\n    var getSelectedElement = function (editor, e) {\n      return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n    };\n    var shouldUseNodeAnchor = function (editor, e) {\n      var selector = getAvoidOverlapSelector(editor);\n      if (isTriggeredByKeyboard(editor, e)) {\n        return true;\n      } else if (selector) {\n        var target = getSelectedElement(editor, e);\n        return closest$4(SugarElement.fromDom(target), selector);\n      } else {\n        return false;\n      }\n    };\n    var setup$9 = function (editor, lazySink, backstage) {\n      var detection = detect$3();\n      var isTouch = detection.deviceType.isTouch;\n      var contextmenu = build$1(InlineView.sketch({\n        dom: { tag: 'div' },\n        lazySink: lazySink,\n        onEscape: function () {\n          return editor.focus();\n        },\n        onShow: function () {\n          return backstage.setContextMenuState(true);\n        },\n        onHide: function () {\n          return backstage.setContextMenuState(false);\n        },\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissContextMenu', [run(dismissRequested(), function (comp, _se) {\n              Sandboxing.close(comp);\n              editor.focus();\n            })])])\n      }));\n      var hideContextMenu = function (_e) {\n        return InlineView.hide(contextmenu);\n      };\n      var showContextMenu = function (e) {\n        if (shouldNeverUseNative(editor)) {\n          e.preventDefault();\n        }\n        if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n          return;\n        }\n        var useNodeAnchor = shouldUseNodeAnchor(editor, e);\n        var buildMenu = function () {\n          var selectedElement = getSelectedElement(editor, e);\n          var registry = editor.ui.registry.getAll();\n          var menuConfig = getContextMenu(editor);\n          return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n        };\n        var initAndShow$2 = isTouch() ? initAndShow$1 : initAndShow;\n        initAndShow$2(editor, e, buildMenu, backstage, contextmenu, useNodeAnchor);\n      };\n      editor.on('init', function () {\n        var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n        editor.on(hideEvents, hideContextMenu);\n        editor.on('longpress contextmenu', showContextMenu);\n      });\n    };\n\n    var adt$c = Adt.generate([\n      {\n        offset: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        absolute: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y'\n        ]\n      }\n    ]);\n    var subtract = function (change) {\n      return function (point) {\n        return point.translate(-change.left, -change.top);\n      };\n    };\n    var add$4 = function (change) {\n      return function (point) {\n        return point.translate(change.left, change.top);\n      };\n    };\n    var transform$1 = function (changes) {\n      return function (x, y) {\n        return foldl(changes, function (rest, f) {\n          return f(rest);\n        }, SugarPosition(x, y));\n      };\n    };\n    var asFixed = function (coord, scroll, origin) {\n      return coord.fold(transform$1([\n        add$4(origin),\n        subtract(scroll)\n      ]), transform$1([subtract(scroll)]), transform$1([]));\n    };\n    var asAbsolute = function (coord, scroll, origin) {\n      return coord.fold(transform$1([add$4(origin)]), transform$1([]), transform$1([add$4(scroll)]));\n    };\n    var asOffset = function (coord, scroll, origin) {\n      return coord.fold(transform$1([]), transform$1([subtract(origin)]), transform$1([\n        add$4(scroll),\n        subtract(origin)\n      ]));\n    };\n    var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n    };\n    var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      var left = Math.abs(a1.left - a2.left);\n      var top = Math.abs(a1.top - a2.top);\n      return SugarPosition(left, top);\n    };\n    var toStyles = function (coord, scroll, origin) {\n      var stylesOpt = coord.fold(function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x - origin.left + 'px'),\n          top: Optional.some(y - origin.top + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('fixed'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      });\n      return __assign({\n        right: Optional.none(),\n        bottom: Optional.none()\n      }, stylesOpt);\n    };\n    var translate$2 = function (coord, deltaX, deltaY) {\n      return coord.fold(function (x, y) {\n        return offset(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return absolute$3(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return fixed$1(x + deltaX, y + deltaY);\n      });\n    };\n    var absorb = function (partialCoord, originalCoord, scroll, origin) {\n      var absorbOne = function (stencil, nu) {\n        return function (optX, optY) {\n          var original = stencil(originalCoord, scroll, origin);\n          return nu(optX.getOr(original.left), optY.getOr(original.top));\n        };\n      };\n      return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute$3), absorbOne(asFixed, fixed$1));\n    };\n    var offset = adt$c.offset;\n    var absolute$3 = adt$c.absolute;\n    var fixed$1 = adt$c.fixed;\n\n    var parseAttrToInt = function (element, name) {\n      var value = get$2(element, name);\n      return isUndefined(value) ? NaN : parseInt(value, 10);\n    };\n    var get$e = function (component, snapsInfo) {\n      var element = component.element;\n      var x = parseAttrToInt(element, snapsInfo.leftAttr);\n      var y = parseAttrToInt(element, snapsInfo.topAttr);\n      return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n    };\n    var set$8 = function (component, snapsInfo, pt) {\n      var element = component.element;\n      set$1(element, snapsInfo.leftAttr, pt.left + 'px');\n      set$1(element, snapsInfo.topAttr, pt.top + 'px');\n    };\n    var clear = function (component, snapsInfo) {\n      var element = component.element;\n      remove$1(element, snapsInfo.leftAttr);\n      remove$1(element, snapsInfo.topAttr);\n    };\n\n    var getCoords = function (component, snapInfo, coord, delta) {\n      return get$e(component, snapInfo).fold(function () {\n        return coord;\n      }, function (fixed) {\n        return fixed$1(fixed.left + delta.left, fixed.top + delta.top);\n      });\n    };\n    var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n      var newCoord = getCoords(component, snapInfo, coord, delta);\n      var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n      var fixedCoord = asFixed(newCoord, scroll, origin);\n      set$8(component, snapInfo, fixedCoord);\n      return snap.fold(function () {\n        return {\n          coord: fixed$1(fixedCoord.left, fixedCoord.top),\n          extra: Optional.none()\n        };\n      }, function (spanned) {\n        return {\n          coord: spanned.output,\n          extra: spanned.extra\n        };\n      });\n    };\n    var stopDrag = function (component, snapInfo) {\n      clear(component, snapInfo);\n    };\n    var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n      return findMap(snaps, function (snap) {\n        var sensor = snap.sensor;\n        var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return inRange ? Optional.some({\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        }) : Optional.none();\n      });\n    };\n    var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n      return matchSnap.orThunk(function () {\n        var bestSnap = foldl(snaps, function (acc, snap) {\n          var sensor = snap.sensor;\n          var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n          return acc.deltas.fold(function () {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          }, function (bestDeltas) {\n            var currAvg = (deltas.left + deltas.top) / 2;\n            var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n            if (currAvg <= bestAvg) {\n              return {\n                deltas: Optional.some(deltas),\n                snap: Optional.some(snap)\n              };\n            } else {\n              return acc;\n            }\n          });\n        }, {\n          deltas: Optional.none(),\n          snap: Optional.none()\n        });\n        return bestSnap.snap.map(function (snap) {\n          return {\n            output: absorb(snap.output, newCoord, scroll, origin),\n            extra: snap.extra\n          };\n        });\n      });\n    };\n    var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      return findMatchingSnap(snaps, newCoord, scroll, origin);\n    };\n    var snapTo = function (snap, scroll, origin) {\n      return {\n        coord: absorb(snap.output, snap.output, scroll, origin),\n        extra: snap.extra\n      };\n    };\n\n    var snapTo$1 = function (component, dragConfig, _state, snap) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner(component.element);\n        var scroll_1 = get$8(doc);\n        var origin_1 = getOrigin(target);\n        var snapPin = snapTo(snap, scroll_1, origin_1);\n        var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n    };\n\n    var DraggingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        snapTo: snapTo$1\n    });\n\n    var initialAttribute = 'data-initial-z-index';\n    var resetZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement).each(function (root) {\n        getOpt(root, initialAttribute).fold(function () {\n          return remove$6(root, 'z-index');\n        }, function (zIndex) {\n          return set$2(root, 'z-index', zIndex);\n        });\n        remove$1(root, initialAttribute);\n      });\n    };\n    var changeZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement).each(function (root) {\n        getRaw(root, 'z-index').each(function (zindex) {\n          set$1(root, initialAttribute, zindex);\n        });\n        set$2(root, 'z-index', get$4(blocker.element, 'z-index'));\n      });\n    };\n    var instigate = function (anyComponent, blocker) {\n      anyComponent.getSystem().addToGui(blocker);\n      changeZIndex(blocker);\n    };\n    var discard = function (blocker) {\n      resetZIndex(blocker);\n      blocker.getSystem().removeFromGui(blocker);\n    };\n    var createComponent = function (component, blockerClass, blockerEvents) {\n      return component.getSystem().build(Container.sketch({\n        dom: {\n          styles: {\n            'left': '0px',\n            'top': '0px',\n            'width': '100%',\n            'height': '100%',\n            'position': 'fixed',\n            'z-index': '1000000000000000'\n          },\n          classes: [blockerClass]\n        },\n        events: blockerEvents\n      }));\n    };\n\n    var SnapSchema = optionObjOf('snaps', [\n      strict$1('getSnapPoints'),\n      onHandler('onSensor'),\n      strict$1('leftAttr'),\n      strict$1('topAttr'),\n      defaulted$1('lazyViewport', win),\n      defaulted$1('mustSnap', false)\n    ]);\n\n    var schema$t = [\n      defaulted$1('useFixed', never),\n      strict$1('blockerClass'),\n      defaulted$1('getTarget', identity),\n      defaulted$1('onDrag', noop),\n      defaulted$1('repositionTarget', true),\n      defaulted$1('onDrop', noop),\n      defaultedFunction('getBounds', win),\n      SnapSchema\n    ];\n\n    var getCurrentCoord = function (target) {\n      return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n        var nu = position === 'fixed' ? fixed$1 : offset;\n        return nu(parseInt(left, 10), parseInt(top, 10));\n      }).getOrThunk(function () {\n        var location = absolute(target);\n        return absolute$3(location.left, location.top);\n      });\n    };\n    var clampCoords = function (component, coords, scroll, origin, startData) {\n      var bounds = startData.bounds;\n      var absoluteCoord = asAbsolute(coords, scroll, origin);\n      var newX = clamp(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n      var newY = clamp(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n      var newCoords = absolute$3(newX, newY);\n      return coords.fold(function () {\n        var offset$1 = asOffset(newCoords, scroll, origin);\n        return offset(offset$1.left, offset$1.top);\n      }, function () {\n        return newCoords;\n      }, function () {\n        var fixed = asFixed(newCoords, scroll, origin);\n        return fixed$1(fixed.left, fixed.top);\n      });\n    };\n    var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n      var newCoord = optSnaps.fold(function () {\n        var translated = translate$2(currentCoord, delta.left, delta.top);\n        var fixedCoord = asFixed(translated, scroll, origin);\n        return fixed$1(fixedCoord.left, fixedCoord.top);\n      }, function (snapInfo) {\n        var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n        snapping.extra.each(function (extra) {\n          snapInfo.onSensor(component, extra);\n        });\n        return snapping.coord;\n      });\n      return clampCoords(component, newCoord, scroll, origin, startData);\n    };\n    var dragBy = function (component, dragConfig, startData, delta) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner(component.element);\n        var scroll_1 = get$8(doc);\n        var origin_1 = getOrigin(target);\n        var currentCoord = getCurrentCoord(target);\n        var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n        var styles = toStyles(newCoord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n      dragConfig.onDrag(component, target, delta);\n    };\n\n    var calcStartData = function (dragConfig, comp) {\n      return {\n        bounds: dragConfig.getBounds(),\n        height: getOuter$1(comp.element),\n        width: getOuter$2(comp.element)\n      };\n    };\n    var move$1 = function (component, dragConfig, dragState, dragMode, event) {\n      var delta = dragState.update(dragMode, event);\n      var dragStartData = dragState.getStartData().getOrThunk(function () {\n        return calcStartData(dragConfig, component);\n      });\n      delta.each(function (dlt) {\n        dragBy(component, dragConfig, dragStartData, dlt);\n      });\n    };\n    var stop = function (component, blocker, dragConfig, dragState) {\n      blocker.each(discard);\n      dragConfig.snaps.each(function (snapInfo) {\n        stopDrag(component, snapInfo);\n      });\n      var target = dragConfig.getTarget(component.element);\n      dragState.reset();\n      dragConfig.onDrop(component, target);\n    };\n    var handlers = function (events) {\n      return function (dragConfig, dragState) {\n        var updateStartState = function (comp) {\n          dragState.setStartData(calcStartData(dragConfig, comp));\n        };\n        return derive(__spreadArrays([run(windowScroll(), function (comp) {\n            dragState.getStartData().each(function () {\n              return updateStartState(comp);\n            });\n          })], events(dragConfig, dragState, updateStartState)));\n      };\n    };\n\n    var init$c = function (dragApi) {\n      return derive([\n        run(mousedown(), dragApi.forceDrop),\n        run(mouseup(), dragApi.drop),\n        run(mousemove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        }),\n        run(mouseout(), dragApi.delayDrop)\n      ]);\n    };\n\n    var getData$1 = function (event) {\n      return Optional.from(SugarPosition(event.x, event.y));\n    };\n    var getDelta$1 = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var MouseData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData$1,\n        getDelta: getDelta$1\n    });\n\n    var events$g = function (dragConfig, dragState, updateStartState) {\n      return [run(mousedown(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.button !== 0) {\n            return;\n          }\n          simulatedEvent.stop();\n          var stop$1 = function () {\n            return stop(component, Optional.some(blocker), dragConfig, dragState);\n          };\n          var delayDrop = DelayedFunction(stop$1, 200);\n          var dragApi = {\n            drop: stop$1,\n            delayDrop: delayDrop.schedule,\n            forceDrop: stop$1,\n            move: function (event) {\n              delayDrop.cancel();\n              move$1(component, dragConfig, dragState, MouseData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$c(dragApi));\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        })];\n    };\n    var schema$u = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$g) })]);\n\n    var init$d = function (dragApi) {\n      return derive([\n        run(touchstart(), dragApi.forceDrop),\n        run(touchend(), dragApi.drop),\n        run(touchcancel(), dragApi.drop),\n        run(touchmove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        })\n      ]);\n    };\n\n    var getDataFrom = function (touches) {\n      var touch = touches[0];\n      return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n    };\n    var getData$2 = function (event) {\n      var raw = event.raw;\n      var touches = raw.touches;\n      return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n    };\n    var getDelta$2 = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var TouchData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData$2,\n        getDelta: getDelta$2\n    });\n\n    var events$h = function (dragConfig, dragState, updateStartState) {\n      var blockerCell = Cell(Optional.none());\n      return [\n        run(touchstart(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          var stop$1 = function () {\n            stop(component, blockerCell.get(), dragConfig, dragState);\n            blockerCell.set(Optional.none());\n          };\n          var dragApi = {\n            drop: stop$1,\n            delayDrop: function () {\n            },\n            forceDrop: stop$1,\n            move: function (event) {\n              move$1(component, dragConfig, dragState, TouchData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$d(dragApi));\n          blockerCell.set(Optional.some(blocker));\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        }),\n        run(touchmove(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          move$1(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n        }),\n        run(touchend(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          stop(component, blockerCell.get(), dragConfig, dragState);\n          blockerCell.set(Optional.none());\n        }),\n        run(touchcancel(), function (component) {\n          stop(component, blockerCell.get(), dragConfig, dragState);\n          blockerCell.set(Optional.none());\n        })\n      ];\n    };\n    var schema$v = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$h) })]);\n\n    var events$i = function (dragConfig, dragState, updateStartState) {\n      return __spreadArrays(events$g(dragConfig, dragState, updateStartState), events$h(dragConfig, dragState, updateStartState));\n    };\n    var schema$w = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$i) })]);\n\n    var mouse = schema$u;\n    var touch = schema$v;\n    var mouseOrTouch = schema$w;\n\n    var DraggingBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        mouse: mouse,\n        touch: touch,\n        mouseOrTouch: mouseOrTouch\n    });\n\n    var init$e = function () {\n      var previous = Optional.none();\n      var startData = Optional.none();\n      var reset = function () {\n        previous = Optional.none();\n        startData = Optional.none();\n      };\n      var calculateDelta = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.getDelta(old, nu);\n        });\n        previous = Optional.some(nu);\n        return result;\n      };\n      var update = function (mode, dragEvent) {\n        return mode.getData(dragEvent).bind(function (nuData) {\n          return calculateDelta(mode, nuData);\n        });\n      };\n      var setStartData = function (data) {\n        startData = Optional.some(data);\n      };\n      var getStartData = function () {\n        return startData;\n      };\n      var readState = constant({});\n      return nu$5({\n        readState: readState,\n        reset: reset,\n        update: update,\n        getStartData: getStartData,\n        setStartData: setStartData\n      });\n    };\n\n    var DragState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$e\n    });\n\n    var Dragging = createModes$1({\n      branchKey: 'mode',\n      branches: DraggingBranches,\n      name: 'dragging',\n      active: {\n        events: function (dragConfig, dragState) {\n          var dragger = dragConfig.dragger;\n          return dragger.handlers(dragConfig, dragState);\n        }\n      },\n      extra: {\n        snap: function (sConfig) {\n          return {\n            sensor: sConfig.sensor,\n            range: sConfig.range,\n            output: sConfig.output,\n            extra: Optional.from(sConfig.extra)\n          };\n        }\n      },\n      state: DragState,\n      apis: DraggingApis\n    });\n\n    var snapWidth = 40;\n    var snapOffset = snapWidth / 2;\n    var calcSnap = function (selectorOpt, td, x, y, width, height) {\n      return selectorOpt.fold(function () {\n        return Dragging.snap({\n          sensor: absolute$3(x - snapOffset, y - snapOffset),\n          range: SugarPosition(width, height),\n          output: absolute$3(Optional.some(x), Optional.some(y)),\n          extra: { td: td }\n        });\n      }, function (selectorHandle) {\n        var sensorLeft = x - snapOffset;\n        var sensorTop = y - snapOffset;\n        var sensorWidth = snapWidth;\n        var sensorHeight = snapWidth;\n        var rect = selectorHandle.element.dom.getBoundingClientRect();\n        return Dragging.snap({\n          sensor: absolute$3(sensorLeft, sensorTop),\n          range: SugarPosition(sensorWidth, sensorHeight),\n          output: absolute$3(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n          extra: { td: td }\n        });\n      });\n    };\n    var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n      var isSameCell = function (cellOpt, td) {\n        return cellOpt.exists(function (currentTd) {\n          return eq$1(currentTd, td);\n        });\n      };\n      return {\n        getSnapPoints: getSnapPoints,\n        leftAttr: 'data-drag-left',\n        topAttr: 'data-drag-top',\n        onSensor: function (component, extra) {\n          var td = extra.td;\n          if (!isSameCell(cell.get(), td)) {\n            cell.set(Optional.some(td));\n            onChange(td);\n          }\n        },\n        mustSnap: true\n      };\n    };\n    var createSelector = function (snaps) {\n      return record(Button.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-selector']\n        },\n        buttonBehaviours: derive$1([\n          Dragging.config({\n            mode: 'mouseOrTouch',\n            blockerClass: 'blocker',\n            snaps: snaps\n          }),\n          Unselecting.config({})\n        ]),\n        eventOrder: {\n          mousedown: [\n            'dragging',\n            'alloy.base.behaviour'\n          ],\n          touchstart: [\n            'dragging',\n            'alloy.base.behaviour'\n          ]\n        }\n      }));\n    };\n    var setup$a = function (editor, sink) {\n      var tlTds = Cell([]);\n      var brTds = Cell([]);\n      var isVisible = Cell(false);\n      var startCell = Cell(Optional.none());\n      var finishCell = Cell(Optional.none());\n      var getTopLeftSnap = function (td) {\n        var box = absolute$1(td);\n        return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n      };\n      var getTopLeftSnaps = function () {\n        return map(tlTds.get(), function (td) {\n          return getTopLeftSnap(td);\n        });\n      };\n      var getBottomRightSnap = function (td) {\n        var box = absolute$1(td);\n        return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n      };\n      var getBottomRightSnaps = function () {\n        return map(brTds.get(), function (td) {\n          return getBottomRightSnap(td);\n        });\n      };\n      var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n        finishCell.get().each(function (finish) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n        startCell.get().each(function (start) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var memTopLeft = createSelector(topLeftSnaps);\n      var memBottomRight = createSelector(bottomRightSnaps);\n      var topLeft = build$1(memTopLeft.asSpec());\n      var bottomRight = build$1(memBottomRight.asSpec());\n      var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n        var cellRect = cell.dom.getBoundingClientRect();\n        remove$6(selector.element, 'display');\n        var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n        var aboveViewport = isAbove(cellRect);\n        var belowViewport = isBelow(cellRect, viewportHeight);\n        if (aboveViewport || belowViewport) {\n          set$2(selector.element, 'display', 'none');\n        }\n      };\n      var snapTo = function (selector, cell, getSnapConfig, pos) {\n        var snap = getSnapConfig(cell);\n        Dragging.snapTo(selector, snap);\n        var isAbove = function (rect) {\n          return rect[pos] < 0;\n        };\n        var isBelow = function (rect, viewportHeight) {\n          return rect[pos] > viewportHeight;\n        };\n        showOrHideHandle(selector, cell, isAbove, isBelow);\n      };\n      var snapTopLeft = function (cell) {\n        return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n      };\n      var snapLastTopLeft = function () {\n        return startCell.get().each(snapTopLeft);\n      };\n      var snapBottomRight = function (cell) {\n        return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n      };\n      var snapLastBottomRight = function () {\n        return finishCell.get().each(snapBottomRight);\n      };\n      if (detect$3().deviceType.isTouch()) {\n        editor.on('TableSelectionChange', function (e) {\n          if (!isVisible.get()) {\n            attach$1(sink, topLeft);\n            attach$1(sink, bottomRight);\n            isVisible.set(true);\n          }\n          startCell.set(Optional.some(e.start));\n          finishCell.set(Optional.some(e.finish));\n          e.otherCells.each(function (otherCells) {\n            tlTds.set(otherCells.upOrLeftCells);\n            brTds.set(otherCells.downOrRightCells);\n            snapTopLeft(e.start);\n            snapBottomRight(e.finish);\n          });\n        });\n        editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n          snapLastTopLeft();\n          snapLastBottomRight();\n        });\n        editor.on('TableSelectionClear', function () {\n          if (isVisible.get()) {\n            detach(topLeft);\n            detach(bottomRight);\n            isVisible.set(false);\n          }\n          startCell.set(Optional.none());\n          finishCell.set(Optional.none());\n        });\n      }\n    };\n\n    var ResizeTypes;\n    (function (ResizeTypes) {\n      ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n      ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n      ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n    }(ResizeTypes || (ResizeTypes = {})));\n    var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n      var dimensions = {};\n      dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n      if (resizeType === ResizeTypes.Both) {\n        dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n      }\n      return dimensions;\n    };\n    var resize$3 = function (editor, deltas, resizeType) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var dimensions = getDimensions(editor, deltas, resizeType, get$6(container), get$7(container));\n      each$1(dimensions, function (val, dim) {\n        return set$2(container, dim, numToPx(val));\n      });\n      fireResizeEditor(editor);\n    };\n\n    var isHidden$1 = function (elm) {\n      if (elm.nodeType === 1) {\n        if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n          return true;\n        }\n        if (elm.getAttribute('data-mce-type') === 'bookmark') {\n          return true;\n        }\n      }\n      return false;\n    };\n    var renderElementPath = function (editor, settings, providersBackstage) {\n      if (!settings.delimiter) {\n        settings.delimiter = '\\xBB';\n      }\n      var getDataPath = function (data) {\n        var parts = data || [];\n        var newPathElements = map(parts, function (part, index) {\n          return Button.sketch({\n            dom: {\n              tag: 'div',\n              classes: ['tox-statusbar__path-item'],\n              attributes: {\n                'role': 'button',\n                'data-index': index,\n                'tab-index': -1,\n                'aria-level': index + 1\n              },\n              innerHtml: part.name\n            },\n            action: function (_btn) {\n              editor.focus();\n              editor.selection.select(part.element);\n              editor.nodeChanged();\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.button(providersBackstage.isReadOnly),\n              receivingConfig()\n            ])\n          });\n        });\n        var divider = {\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-divider'],\n            attributes: { 'aria-hidden': true },\n            innerHtml: ' ' + settings.delimiter + ' '\n          }\n        };\n        return foldl(newPathElements.slice(1), function (acc, element) {\n          var newAcc = acc;\n          newAcc.push(divider);\n          newAcc.push(element);\n          return newAcc;\n        }, [newPathElements[0]]);\n      };\n      var updatePath = function (parents) {\n        var newPath = [];\n        var i = parents.length;\n        while (i-- > 0) {\n          var parent_1 = parents[i];\n          if (parent_1.nodeType === 1 && !isHidden$1(parent_1)) {\n            var args = editor.fire('ResolveName', {\n              name: parent_1.nodeName.toLowerCase(),\n              target: parent_1\n            });\n            if (!args.isDefaultPrevented()) {\n              newPath.push({\n                name: args.name,\n                element: parent_1\n              });\n            }\n            if (args.isPropagationStopped()) {\n              break;\n            }\n          }\n        }\n        return newPath;\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path'],\n          attributes: { role: 'navigation' }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'flow',\n            selector: 'div[role=button]'\n          }),\n          Disabling.config({ disabled: providersBackstage.isReadOnly }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          config('elementPathEvents', [runOnAttached(function (comp, _e) {\n              editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n                return Keying.focusIn(comp);\n              });\n              editor.on('NodeChange', function (e) {\n                var newPath = updatePath(e.parents);\n                if (newPath.length > 0) {\n                  Replacing.set(comp, getDataPath(newPath));\n                } else {\n                  Replacing.set(comp, []);\n                }\n              });\n            })])\n        ]),\n        components: []\n      };\n    };\n\n    var renderWordCount = function (editor, providersBackstage) {\n      var _a;\n      var replaceCountText = function (comp, count, mode) {\n        return Replacing.set(comp, [text(providersBackstage.translate([\n            '{0} ' + mode,\n            count[mode]\n          ]))]);\n      };\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: ['tox-statusbar__wordcount']\n        },\n        components: [],\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(providersBackstage.isReadOnly),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: {\n                mode: 'words',\n                count: {\n                  words: 0,\n                  characters: 0\n                }\n              }\n            }\n          }),\n          config('wordcount-events', [\n            runOnExecute(function (comp) {\n              var currentVal = Representing.getValue(comp);\n              var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n              Representing.setValue(comp, {\n                mode: newMode,\n                count: currentVal.count\n              });\n              replaceCountText(comp, currentVal.count, newMode);\n            }),\n            runOnAttached(function (comp) {\n              editor.on('wordCountUpdate', function (e) {\n                var mode = Representing.getValue(comp).mode;\n                Representing.setValue(comp, {\n                  mode: mode,\n                  count: e.wordCount\n                });\n                replaceCountText(comp, e.wordCount, mode);\n              });\n            })\n          ])\n        ]),\n        eventOrder: (_a = {}, _a[execute()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'wordcount-events'\n        ], _a)\n      });\n    };\n\n    var renderStatusbar = function (editor, providersBackstage) {\n      var renderResizeHandlerIcon = function (resizeType) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__resize-handle'],\n            attributes: {\n              'title': providersBackstage.translate('Resize'),\n              'aria-hidden': 'true'\n            },\n            innerHtml: get$d('resize-handle', providersBackstage.icons)\n          },\n          behaviours: derive$1([Dragging.config({\n              mode: 'mouse',\n              repositionTarget: false,\n              onDrag: function (comp, target, delta) {\n                resize$3(editor, delta, resizeType);\n              },\n              blockerClass: 'tox-blocker'\n            })])\n        };\n      };\n      var renderBranding = function () {\n        var label = global$6.translate([\n          'Powered by {0}',\n          'Tiny'\n        ]);\n        var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n        return {\n          dom: {\n            tag: 'span',\n            classes: ['tox-statusbar__branding'],\n            innerHtml: linkHtml\n          }\n        };\n      };\n      var getResizeType = function (editor) {\n        var fallback = !editor.hasPlugin('autoresize');\n        var resize = editor.getParam('resize', fallback);\n        if (resize === false) {\n          return ResizeTypes.None;\n        } else if (resize === 'both') {\n          return ResizeTypes.Both;\n        } else {\n          return ResizeTypes.Vertical;\n        }\n      };\n      var getTextComponents = function () {\n        var components = [];\n        if (editor.getParam('elementpath', true, 'boolean')) {\n          components.push(renderElementPath(editor, {}, providersBackstage));\n        }\n        if (editor.hasPlugin('wordcount')) {\n          components.push(renderWordCount(editor, providersBackstage));\n        }\n        if (editor.getParam('branding', true, 'boolean')) {\n          components.push(renderBranding());\n        }\n        if (components.length > 0) {\n          return [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-statusbar__text-container']\n              },\n              components: components\n            }];\n        }\n        return [];\n      };\n      var getComponents = function () {\n        var components = getTextComponents();\n        var resizeType = getResizeType(editor);\n        if (resizeType !== ResizeTypes.None) {\n          components.push(renderResizeHandlerIcon(resizeType));\n        }\n        return components;\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar']\n        },\n        components: getComponents()\n      };\n    };\n\n    var setup$b = function (editor) {\n      var _a;\n      var isInline = editor.inline;\n      var mode = isInline ? Inline : Iframe;\n      var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n      var lazyOuterContainer = Optional.none();\n      var platform = detect$3();\n      var isIE = platform.browser.isIE();\n      var platformClasses = isIE ? ['tox-platform-ie'] : [];\n      var isTouch = platform.deviceType.isTouch();\n      var touchPlatformClass = 'tox-platform-touch';\n      var deviceClasses = isTouch ? [touchPlatformClass] : [];\n      var isToolbarBottom = isToolbarLocationBottom(editor);\n      var dirAttributes = global$6.isRtl() ? { attributes: { dir: 'rtl' } } : {};\n      var verticalDirAttributes = { attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a) };\n      var lazyHeader = function () {\n        return lazyOuterContainer.bind(OuterContainer.getHeader);\n      };\n      var isHeaderDocked = function () {\n        return header.isDocked(lazyHeader);\n      };\n      var sink = build$1({\n        dom: __assign({\n          tag: 'div',\n          classes: [\n            'tox',\n            'tox-silver-sink',\n            'tox-tinymce-aux'\n          ].concat(platformClasses).concat(deviceClasses)\n        }, dirAttributes),\n        behaviours: derive$1([Positioning.config({\n            useFixed: function () {\n              return isHeaderDocked();\n            }\n          })])\n      });\n      var lazySink = function () {\n        return Result.value(sink);\n      };\n      var memAnchorBar = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-anchorbar']\n        }\n      });\n      var lazyAnchorBar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return memAnchorBar.getOpt(container);\n        }).getOrDie('Could not find a anchor bar element');\n      };\n      var lazyToolbar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getToolbar(container);\n        }).getOrDie('Could not find more toolbar element');\n      };\n      var lazyThrobber = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getThrobber(container);\n        }).getOrDie('Could not find throbber element');\n      };\n      var backstage = init$8(sink, editor, lazyAnchorBar);\n      var partMenubar = OuterContainer.parts.menubar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-menubar']\n        },\n        backstage: backstage,\n        onEscape: function () {\n          editor.focus();\n        }\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var partToolbar = OuterContainer.parts.toolbar(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar']\n        },\n        getSink: lazySink,\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode,\n        lazyToolbar: lazyToolbar,\n        lazyHeader: function () {\n          return lazyHeader().getOrDie('Could not find header element');\n        }\n      }, verticalDirAttributes));\n      var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode\n      });\n      var partSocket = OuterContainer.parts.socket({\n        dom: {\n          tag: 'div',\n          classes: ['tox-edit-area']\n        }\n      });\n      var partSidebar = OuterContainer.parts.sidebar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar']\n        }\n      });\n      var partThrobber = OuterContainer.parts.throbber({\n        dom: {\n          tag: 'div',\n          classes: ['tox-throbber']\n        },\n        backstage: backstage\n      });\n      var sb = editor.getParam('statusbar', true, 'boolean');\n      var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n      var socketSidebarContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar-wrap']\n        },\n        components: [\n          partSocket,\n          partSidebar\n        ]\n      };\n      var hasMultipleToolbar = isMultipleToolbars(editor);\n      var hasToolbar = isToolbarEnabled(editor);\n      var hasMenubar = isMenubarEnabled(editor);\n      var getPartToolbar = function () {\n        if (hasMultipleToolbar) {\n          return [partMultipleToolbar];\n        } else if (hasToolbar) {\n          return [partToolbar];\n        } else {\n          return [];\n        }\n      };\n      var partHeader = OuterContainer.parts.header({\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-editor-header']\n        }, verticalDirAttributes),\n        components: flatten([\n          hasMenubar ? [partMenubar] : [],\n          getPartToolbar(),\n          useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]\n        ]),\n        sticky: isStickyToolbar(editor),\n        editor: editor,\n        sharedBackstage: backstage.shared\n      });\n      var editorComponents = flatten([\n        isToolbarBottom ? [] : [partHeader],\n        isInline ? [] : [socketSidebarContainer],\n        isToolbarBottom ? [partHeader] : []\n      ]);\n      var editorContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-editor-container']\n        },\n        components: editorComponents\n      };\n      var containerComponents = flatten([\n        [editorContainer],\n        isInline ? [] : statusbar.toArray(),\n        [partThrobber]\n      ]);\n      var isHidden = isDistractionFree(editor);\n      var attributes = __assign(__assign({ role: 'application' }, global$6.isRtl() ? { dir: 'rtl' } : {}), isHidden ? { 'aria-hidden': 'true' } : {});\n      var outerContainer = build$1(OuterContainer.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox',\n            'tox-tinymce'\n          ].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n          styles: __assign({ visibility: 'hidden' }, isHidden ? {\n            opacity: '0',\n            border: '0'\n          } : {}),\n          attributes: attributes\n        },\n        components: containerComponents,\n        behaviours: derive$1([Keying.config({\n            mode: 'cyclic',\n            selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a'\n          })])\n      }));\n      lazyOuterContainer = Optional.some(outerContainer);\n      editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n        OuterContainer.focusMenubar(outerContainer);\n      });\n      editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n        OuterContainer.focusToolbar(outerContainer);\n      });\n      editor.addCommand('ToggleToolbarDrawer', function () {\n        OuterContainer.toggleToolbarDrawer(outerContainer);\n      });\n      editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n        return OuterContainer.isToolbarDrawerToggled(outerContainer);\n      });\n      var mothership = takeover(outerContainer);\n      var uiMothership = takeover(sink);\n      setup$3(editor, mothership, uiMothership);\n      var getUi = function () {\n        var channels = {\n          broadcastAll: uiMothership.broadcast,\n          broadcastOn: uiMothership.broadcastOn,\n          register: function () {\n          }\n        };\n        return { channels: channels };\n      };\n      var setEditorSize = function () {\n        var parsedHeight = numToPx(getHeightWithFallback(editor));\n        var parsedWidth = numToPx(getWidthWithFallback(editor));\n        if (!editor.inline) {\n          if (isValidValue('div', 'width', parsedWidth)) {\n            set$2(outerContainer.element, 'width', parsedWidth);\n          }\n          if (isValidValue('div', 'height', parsedHeight)) {\n            set$2(outerContainer.element, 'height', parsedHeight);\n          } else {\n            set$2(outerContainer.element, 'height', '200px');\n          }\n        }\n        return parsedHeight;\n      };\n      var renderUI = function () {\n        header.setup(editor, backstage.shared, lazyHeader);\n        setup$8(editor, backstage);\n        setup$9(editor, lazySink, backstage);\n        setup$6(editor);\n        setup$7(editor, lazyThrobber, backstage.shared);\n        map$2(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n          editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n        });\n        var _a = editor.ui.registry.getAll(), buttons = _a.buttons, menuItems = _a.menuItems, contextToolbars = _a.contextToolbars, sidebars = _a.sidebars;\n        var toolbarOpt = getMultipleToolbarsSetting(editor);\n        var rawUiConfig = {\n          menuItems: menuItems,\n          menus: getMenus(editor),\n          menubar: getMenubar(editor),\n          toolbar: toolbarOpt.getOrThunk(function () {\n            return getToolbar(editor);\n          }),\n          allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n          buttons: buttons,\n          sidebar: sidebars\n        };\n        register$4(editor, contextToolbars, sink, { backstage: backstage });\n        setup$a(editor, sink);\n        var elm = editor.getElement();\n        var height = setEditorSize();\n        var uiComponents = {\n          mothership: mothership,\n          uiMothership: uiMothership,\n          outerContainer: outerContainer\n        };\n        var args = {\n          targetNode: elm,\n          height: height\n        };\n        return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n      };\n      return {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        backstage: backstage,\n        renderUI: renderUI,\n        getUi: getUi\n      };\n    };\n\n    var describedBy = function (describedElement, describeElement) {\n      var describeId = Optional.from(get$2(describedElement, 'id')).fold(function () {\n        var id = generate$1('dialog-describe');\n        set$1(describeElement, 'id', id);\n        return id;\n      }, identity);\n      set$1(describedElement, 'aria-describedby', describeId);\n    };\n\n    var labelledBy = function (labelledElement, labelElement) {\n      var labelId = getOpt(labelledElement, 'id').fold(function () {\n        var id = generate$1('dialog-label');\n        set$1(labelElement, 'id', id);\n        return id;\n      }, identity);\n      set$1(labelledElement, 'aria-labelledby', labelId);\n    };\n\n    var schema$x = constant([\n      strict$1('lazySink'),\n      option('dragBlockClass'),\n      defaultedFunction('getBounds', win),\n      defaulted$1('useTabstopAt', always),\n      defaulted$1('eventOrder', {}),\n      field$1('modalBehaviours', [Keying]),\n      onKeyboardHandler('onExecute'),\n      onStrictKeyboardHandler('onEscape')\n    ]);\n    var basic = { sketch: identity };\n    var parts$f = constant([\n      optional({\n        name: 'draghandle',\n        overrides: function (detail, spec) {\n          return {\n            behaviours: derive$1([Dragging.config({\n                mode: 'mouse',\n                getTarget: function (handle) {\n                  return ancestor$2(handle, '[role=\"dialog\"]').getOr(handle);\n                },\n                blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n                getBounds: detail.getDragBounds\n              })])\n          };\n        }\n      }),\n      required({\n        schema: [strict$1('dom')],\n        name: 'title'\n      }),\n      required({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'close'\n      }),\n      required({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'body'\n      }),\n      optional({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'footer'\n      }),\n      external$1({\n        factory: {\n          sketch: function (spec, detail) {\n            return __assign(__assign({}, spec), {\n              dom: detail.dom,\n              components: detail.components\n            });\n          }\n        },\n        schema: [\n          defaulted$1('dom', {\n            tag: 'div',\n            styles: {\n              position: 'fixed',\n              left: '0px',\n              top: '0px',\n              right: '0px',\n              bottom: '0px'\n            }\n          }),\n          defaulted$1('components', [])\n        ],\n        name: 'blocker'\n      })\n    ]);\n\n    var factory$i = function (detail, components, spec, externals) {\n      var _a;\n      var dialogBusyEvent = generate$1('alloy.dialog.busy');\n      var dialogIdleEvent = generate$1('alloy.dialog.idle');\n      var busyBehaviours = derive$1([\n        Keying.config({\n          mode: 'special',\n          onTab: function () {\n            return Optional.some(true);\n          },\n          onShiftTab: function () {\n            return Optional.some(true);\n          }\n        }),\n        Focusing.config({})\n      ]);\n      var showDialog = function (dialog) {\n        var sink = detail.lazySink(dialog).getOrDie();\n        var busyComp = Cell(Optional.none());\n        var externalBlocker = externals.blocker();\n        var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n          components: externalBlocker.components.concat([premade$1(dialog)]),\n          behaviours: derive$1([\n            Focusing.config({}),\n            config('dialog-blocker-events', [\n              runOnSource(focusin(), function () {\n                Keying.focusIn(dialog);\n              }),\n              run(dialogIdleEvent, function (_blocker, _se) {\n                if (has$1(dialog.element, 'aria-busy')) {\n                  remove$1(dialog.element, 'aria-busy');\n                  busyComp.get().each(function (bc) {\n                    return Replacing.remove(dialog, bc);\n                  });\n                }\n              }),\n              run(dialogBusyEvent, function (blocker, se) {\n                set$1(dialog.element, 'aria-busy', 'true');\n                var getBusySpec = se.event.getBusySpec;\n                busyComp.get().each(function (bc) {\n                  Replacing.remove(dialog, bc);\n                });\n                var busySpec = getBusySpec(dialog, busyBehaviours);\n                var busy = blocker.getSystem().build(busySpec);\n                busyComp.set(Optional.some(busy));\n                Replacing.append(dialog, premade$1(busy));\n                if (busy.hasConfigured(Keying)) {\n                  Keying.focusIn(busy);\n                }\n              })\n            ])\n          ])\n        }));\n        attach$1(sink, blocker);\n        Keying.focusIn(dialog);\n      };\n      var hideDialog = function (dialog) {\n        parent(dialog.element).each(function (blockerDom) {\n          dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n            detach(blocker);\n          });\n        });\n      };\n      var getDialogBody = function (dialog) {\n        return getPartOrDie(dialog, detail, 'body');\n      };\n      var getDialogFooter = function (dialog) {\n        return getPartOrDie(dialog, detail, 'footer');\n      };\n      var setBusy = function (dialog, getBusySpec) {\n        emitWith(dialog, dialogBusyEvent, { getBusySpec: getBusySpec });\n      };\n      var setIdle = function (dialog) {\n        emit(dialog, dialogIdleEvent);\n      };\n      var modalEventsId = generate$1('modal-events');\n      var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: {\n          show: showDialog,\n          hide: hideDialog,\n          getBody: getDialogBody,\n          getFooter: getDialogFooter,\n          setIdle: setIdle,\n          setBusy: setBusy\n        },\n        eventOrder: eventOrder,\n        domModification: {\n          attributes: {\n            'role': 'dialog',\n            'aria-modal': 'true'\n          }\n        },\n        behaviours: augment(detail.modalBehaviours, [\n          Replacing.config({}),\n          Keying.config({\n            mode: 'cyclic',\n            onEnter: detail.onExecute,\n            onEscape: detail.onEscape,\n            useTabstopAt: detail.useTabstopAt\n          }),\n          config(modalEventsId, [runOnAttached(function (c) {\n              labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n              describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n            })])\n        ])\n      };\n    };\n    var ModalDialog = composite$1({\n      name: 'ModalDialog',\n      configFields: schema$x(),\n      partFields: parts$f(),\n      factory: factory$i,\n      apis: {\n        show: function (apis, dialog) {\n          apis.show(dialog);\n        },\n        hide: function (apis, dialog) {\n          apis.hide(dialog);\n        },\n        getBody: function (apis, dialog) {\n          return apis.getBody(dialog);\n        },\n        getFooter: function (apis, dialog) {\n          return apis.getFooter(dialog);\n        },\n        setBusy: function (apis, dialog, getBusySpec) {\n          apis.setBusy(dialog, getBusySpec);\n        },\n        setIdle: function (apis, dialog) {\n          apis.setIdle(dialog);\n        }\n      }\n    });\n\n    var dialogToggleMenuItemSchema = objOf([\n      strictString('type'),\n      strictString('name')\n    ].concat(commonMenuItemFields));\n    var dialogToggleMenuItemDataProcessor = boolean;\n\n    var baseFooterButtonFields = [\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedStringEnum('align', 'end', [\n        'start',\n        'end'\n      ]),\n      defaultedBoolean('primary', false),\n      defaultedBoolean('disabled', false)\n    ];\n    var dialogFooterButtonFields = __spreadArrays(baseFooterButtonFields, [strictString('text')]);\n    var normalFooterButtonFields = __spreadArrays([strictStringEnum('type', [\n        'submit',\n        'cancel',\n        'custom'\n      ])], dialogFooterButtonFields);\n    var menuFooterButtonFields = __spreadArrays([\n      strictStringEnum('type', ['menu']),\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      strictArrayOf('items', dialogToggleMenuItemSchema)\n    ], baseFooterButtonFields);\n    var dialogFooterButtonSchema = choose$1('type', {\n      submit: normalFooterButtonFields,\n      cancel: normalFooterButtonFields,\n      custom: normalFooterButtonFields,\n      menu: menuFooterButtonFields\n    });\n\n    var alertBannerFields = [\n      strictString('type'),\n      strictString('text'),\n      strictStringEnum('level', [\n        'info',\n        'warn',\n        'error',\n        'success'\n      ]),\n      strictString('icon'),\n      defaulted$1('url', '')\n    ];\n    var alertBannerSchema = objOf(alertBannerFields);\n\n    var createBarFields = function (itemsField) {\n      return [\n        strictString('type'),\n        itemsField\n      ];\n    };\n\n    var buttonFields = [\n      strictString('type'),\n      strictString('text'),\n      defaultedBoolean('disabled', false),\n      defaultedBoolean('primary', false),\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedBoolean('borderless', false)\n    ];\n    var buttonSchema = objOf(buttonFields);\n\n    var checkboxFields = [\n      strictString('type'),\n      strictString('name'),\n      strictString('label'),\n      defaultedBoolean('disabled', false)\n    ];\n    var checkboxSchema = objOf(checkboxFields);\n    var checkboxDataProcessor = boolean;\n\n    var formComponentFields = [\n      strictString('type'),\n      strictString('name')\n    ];\n    var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n\n    var collectionFields = formComponentWithLabelFields.concat([defaulted$1('columns', 'auto')]);\n    var collectionSchema = objOf(collectionFields);\n    var collectionDataProcessor = arrOfObj$1([\n      strictString('value'),\n      strictString('text'),\n      strictString('icon')\n    ]);\n\n    var colorInputFields = formComponentWithLabelFields;\n    var colorInputSchema = objOf(colorInputFields);\n    var colorInputDataProcessor = string;\n\n    var colorPickerFields = formComponentWithLabelFields;\n    var colorPickerSchema = objOf(colorPickerFields);\n    var colorPickerDataProcessor = string;\n\n    var customEditorFields = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      strictString('scriptId'),\n      strictString('scriptUrl'),\n      defaultedPostMsg('settings', undefined)\n    ]);\n    var customEditorFieldsOld = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      strictFunction('init')\n    ]);\n    var customEditorSchema = valueOf(function (v) {\n      return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n        return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n      });\n    });\n    var customEditorDataProcessor = string;\n\n    var dropZoneFields = formComponentWithLabelFields;\n    var dropZoneSchema = objOf(dropZoneFields);\n    var dropZoneDataProcessor = arrOfVal();\n\n    var createGridFields = function (itemsField) {\n      return [\n        strictString('type'),\n        strictNumber('columns'),\n        itemsField\n      ];\n    };\n\n    var htmlPanelFields = [\n      strictString('type'),\n      strictString('html'),\n      defaultedStringEnum('presets', 'presentation', [\n        'presentation',\n        'document'\n      ])\n    ];\n    var htmlPanelSchema = objOf(htmlPanelFields);\n\n    var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n    var iframeSchema = objOf(iframeFields);\n    var iframeDataProcessor = string;\n\n    var imageToolsFields = formComponentWithLabelFields.concat([strictOf('currentState', objOf([\n        strict$1('blob'),\n        strictString('url')\n      ]))]);\n    var imageToolsSchema = objOf(imageToolsFields);\n\n    var inputFields = formComponentWithLabelFields.concat([\n      optionString('inputMode'),\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var inputSchema = objOf(inputFields);\n    var inputDataProcessor = string;\n\n    var createLabelFields = function (itemsField) {\n      return [\n        strictString('type'),\n        strictString('label'),\n        itemsField\n      ];\n    };\n\n    var listBoxSingleItemFields = [\n      strictString('text'),\n      strictString('value')\n    ];\n    var listBoxNestedItemFields = [\n      strictString('text'),\n      strictArrayOf('items', thunkOf('items', function () {\n        return listBoxItemSchema;\n      }))\n    ];\n    var listBoxItemSchema = oneOf([\n      objOf(listBoxSingleItemFields),\n      objOf(listBoxNestedItemFields)\n    ]);\n    var listBoxFields = formComponentWithLabelFields.concat([\n      strictArrayOf('items', listBoxItemSchema),\n      defaultedBoolean('disabled', false)\n    ]);\n    var listBoxSchema = objOf(listBoxFields);\n    var listBoxDataProcessor = string;\n\n    var selectBoxFields = formComponentWithLabelFields.concat([\n      strictArrayOfObj('items', [\n        strictString('text'),\n        strictString('value')\n      ]),\n      defaultedNumber('size', 1),\n      defaultedBoolean('disabled', false)\n    ]);\n    var selectBoxSchema = objOf(selectBoxFields);\n    var selectBoxDataProcessor = string;\n\n    var sizeInputFields = formComponentWithLabelFields.concat([\n      defaultedBoolean('constrain', true),\n      defaultedBoolean('disabled', false)\n    ]);\n    var sizeInputSchema = objOf(sizeInputFields);\n    var sizeInputDataProcessor = objOf([\n      strictString('width'),\n      strictString('height')\n    ]);\n\n    var tableFields = [\n      strictString('type'),\n      strictArrayOf('header', string),\n      strictArrayOf('cells', arrOf(string))\n    ];\n    var tableSchema = objOf(tableFields);\n\n    var textAreaFields = formComponentWithLabelFields.concat([\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var textAreaSchema = objOf(textAreaFields);\n    var textAreaDataProcessor = string;\n\n    var urlInputFields = formComponentWithLabelFields.concat([\n      defaultedStringEnum('filetype', 'file', [\n        'image',\n        'media',\n        'file'\n      ]),\n      defaulted$1('disabled', false)\n    ]);\n    var urlInputSchema = objOf(urlInputFields);\n    var urlInputDataProcessor = objOf([\n      strictString('value'),\n      defaulted$1('meta', {})\n    ]);\n\n    var createItemsField = function (name) {\n      return field('items', 'items', strict(), arrOf(valueOf(function (v) {\n        return asRaw('Checking item of ' + name, itemSchema$2, v).fold(function (sErr) {\n          return Result.error(formatError(sErr));\n        }, function (passValue) {\n          return Result.value(passValue);\n        });\n      })));\n    };\n    var itemSchema$2 = valueThunkOf(function () {\n      return chooseProcessor('type', {\n        alertbanner: alertBannerSchema,\n        bar: objOf(createBarFields(createItemsField('bar'))),\n        button: buttonSchema,\n        checkbox: checkboxSchema,\n        colorinput: colorInputSchema,\n        colorpicker: colorPickerSchema,\n        dropzone: dropZoneSchema,\n        grid: objOf(createGridFields(createItemsField('grid'))),\n        iframe: iframeSchema,\n        input: inputSchema,\n        listbox: listBoxSchema,\n        selectbox: selectBoxSchema,\n        sizeinput: sizeInputSchema,\n        textarea: textAreaSchema,\n        urlinput: urlInputSchema,\n        customeditor: customEditorSchema,\n        htmlpanel: htmlPanelSchema,\n        imagetools: imageToolsSchema,\n        collection: collectionSchema,\n        label: objOf(createLabelFields(createItemsField('label'))),\n        table: tableSchema,\n        panel: panelSchema\n      });\n    });\n    var panelFields = [\n      strictString('type'),\n      defaulted$1('classes', []),\n      strictArrayOf('items', itemSchema$2)\n    ];\n    var panelSchema = objOf(panelFields);\n\n    var tabFields = [\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('tab-name');\n      }), string),\n      strictString('title'),\n      strictArrayOf('items', itemSchema$2)\n    ];\n    var tabPanelFields = [\n      strictString('type'),\n      strictArrayOfObj('tabs', tabFields)\n    ];\n    var tabPanelSchema = objOf(tabPanelFields);\n\n    var dialogButtonFields = dialogFooterButtonFields;\n    var dialogButtonSchema = dialogFooterButtonSchema;\n    var dialogSchema = objOf([\n      strictString('title'),\n      strictOf('body', chooseProcessor('type', {\n        panel: panelSchema,\n        tabpanel: tabPanelSchema\n      })),\n      defaultedString('size', 'normal'),\n      strictArrayOf('buttons', dialogButtonSchema),\n      defaulted$1('initialData', {}),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onChange', noop),\n      defaultedFunction('onSubmit', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onCancel', noop),\n      defaulted$1('onTabChange', noop)\n    ]);\n    var createDialog = function (spec) {\n      return asRaw('dialog', dialogSchema, spec);\n    };\n\n    var urlDialogButtonSchema = objOf(__spreadArrays([strictStringEnum('type', [\n        'cancel',\n        'custom'\n      ])], dialogButtonFields));\n    var urlDialogSchema = objOf([\n      strictString('title'),\n      strictString('url'),\n      optionNumber('height'),\n      optionNumber('width'),\n      optionArrayOf('buttons', urlDialogButtonSchema),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onCancel', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onMessage', noop)\n    ]);\n    var createUrlDialog = function (spec) {\n      return asRaw('dialog', urlDialogSchema, spec);\n    };\n\n    var getAllObjects = function (obj) {\n      if (isObject(obj)) {\n        return [obj].concat(bind(values(obj), getAllObjects));\n      } else if (isArray(obj)) {\n        return bind(obj, getAllObjects);\n      } else {\n        return [];\n      }\n    };\n\n    var isNamedItem = function (obj) {\n      return isString(obj.type) && isString(obj.name);\n    };\n    var dataProcessors = {\n      checkbox: checkboxDataProcessor,\n      colorinput: colorInputDataProcessor,\n      colorpicker: colorPickerDataProcessor,\n      dropzone: dropZoneDataProcessor,\n      input: inputDataProcessor,\n      iframe: iframeDataProcessor,\n      sizeinput: sizeInputDataProcessor,\n      selectbox: selectBoxDataProcessor,\n      listbox: listBoxDataProcessor,\n      size: sizeInputDataProcessor,\n      textarea: textAreaDataProcessor,\n      urlinput: urlInputDataProcessor,\n      customeditor: customEditorDataProcessor,\n      collection: collectionDataProcessor,\n      togglemenuitem: dialogToggleMenuItemDataProcessor\n    };\n    var getDataProcessor = function (item) {\n      return Optional.from(dataProcessors[item.type]);\n    };\n    var getNamedItems = function (structure) {\n      return filter(getAllObjects(structure), isNamedItem);\n    };\n\n    var createDataValidator = function (structure) {\n      var namedItems = getNamedItems(structure);\n      var fields = bind(namedItems, function (item) {\n        return getDataProcessor(item).fold(function () {\n          return [];\n        }, function (schema) {\n          return [strictOf(item.name, schema)];\n        });\n      });\n      return objOf(fields);\n    };\n\n    var extract$1 = function (structure) {\n      var internalDialog = getOrDie(createDialog(structure));\n      var dataValidator = createDataValidator(structure);\n      var initialData = structure.initialData;\n      return {\n        internalDialog: internalDialog,\n        dataValidator: dataValidator,\n        initialData: initialData\n      };\n    };\n    var DialogManager = {\n      open: function (factory, structure) {\n        var extraction = extract$1(structure);\n        return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n      },\n      openUrl: function (factory, structure) {\n        var internalDialog = getOrDie(createUrlDialog(structure));\n        return factory(internalDialog);\n      },\n      redial: function (structure) {\n        return extract$1(structure);\n      }\n    };\n\n    var toValidValues = function (values) {\n      var errors = [];\n      var result = {};\n      each$1(values, function (value, name) {\n        value.fold(function () {\n          errors.push(name);\n        }, function (v) {\n          result[name] = v;\n        });\n      });\n      return errors.length > 0 ? Result.error(errors) : Result.value(result);\n    };\n\n    var renderBodyPanel = function (spec, backstage) {\n      var memForm = record(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form'].concat(spec.classes)\n          },\n          components: map(spec.items, function (item) {\n            return interpretInForm(parts, item, backstage);\n          })\n        };\n      }));\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [memForm.asSpec()]\n          }],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          }),\n          ComposingConfigs.memento(memForm),\n          RepresentingConfigs.memento(memForm, {\n            postprocess: function (formValue) {\n              return toValidValues(formValue).fold(function (err) {\n                console.error(err);\n                return {};\n              }, function (vals) {\n                return vals;\n              });\n            }\n          })\n        ])\n      };\n    };\n\n    var factory$j = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events$7(detail.action),\n        behaviours: augment(detail.tabButtonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          })\n        ]),\n        domModification: detail.domModification\n      };\n    };\n    var TabButton = single$2({\n      name: 'TabButton',\n      configFields: [\n        defaulted$1('uid', undefined),\n        strict$1('value'),\n        field('dom', 'dom', mergeWithThunk(function () {\n          return {\n            attributes: {\n              'role': 'tab',\n              'id': generate$1('aria'),\n              'aria-selected': 'false'\n            }\n          };\n        }), anyValue$1()),\n        option('action'),\n        defaulted$1('domModification', {}),\n        field$1('tabButtonBehaviours', [\n          Focusing,\n          Keying,\n          Representing\n        ]),\n        strict$1('view')\n      ],\n      factory: factory$j\n    });\n\n    var schema$y = constant([\n      strict$1('tabs'),\n      strict$1('dom'),\n      defaulted$1('clickToDismiss', false),\n      field$1('tabbarBehaviours', [\n        Highlighting,\n        Keying\n      ]),\n      markers([\n        'tabClass',\n        'selectedClass'\n      ])\n    ]);\n    var tabsPart = group({\n      factory: TabButton,\n      name: 'tabs',\n      unit: 'tab',\n      overrides: function (barDetail) {\n        var dismissTab$1 = function (tabbar, button) {\n          Highlighting.dehighlight(tabbar, button);\n          emitWith(tabbar, dismissTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        var changeTab$1 = function (tabbar, button) {\n          Highlighting.highlight(tabbar, button);\n          emitWith(tabbar, changeTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        return {\n          action: function (button) {\n            var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n            var activeButton = Highlighting.isHighlighted(tabbar, button);\n            var response = function () {\n              if (activeButton && barDetail.clickToDismiss) {\n                return dismissTab$1;\n              } else if (!activeButton) {\n                return changeTab$1;\n              } else {\n                return noop;\n              }\n            }();\n            response(tabbar, button);\n          },\n          domModification: { classes: [barDetail.markers.tabClass] }\n        };\n      }\n    });\n    var parts$g = constant([tabsPart]);\n\n    var factory$k = function (detail, components, _spec, _externals) {\n      return {\n        'uid': detail.uid,\n        'dom': detail.dom,\n        components: components,\n        'debug.sketcher': 'Tabbar',\n        'domModification': { attributes: { role: 'tablist' } },\n        'behaviours': augment(detail.tabbarBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedClass,\n            itemClass: detail.markers.tabClass,\n            onHighlight: function (tabbar, tab) {\n              set$1(tab.element, 'aria-selected', 'true');\n            },\n            onDehighlight: function (tabbar, tab) {\n              set$1(tab.element, 'aria-selected', 'false');\n            }\n          }),\n          Keying.config({\n            mode: 'flow',\n            getInitial: function (tabbar) {\n              return Highlighting.getHighlighted(tabbar).map(function (tab) {\n                return tab.element;\n              });\n            },\n            selector: '.' + detail.markers.tabClass,\n            executeOnMove: true\n          })\n        ])\n      };\n    };\n    var Tabbar = composite$1({\n      name: 'Tabbar',\n      configFields: schema$y(),\n      partFields: parts$g(),\n      factory: factory$k\n    });\n\n    var factory$l = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n        domModification: { attributes: { role: 'tabpanel' } }\n      };\n    };\n    var Tabview = single$2({\n      name: 'Tabview',\n      configFields: [field$1('tabviewBehaviours', [Replacing])],\n      factory: factory$l\n    });\n\n    var schema$z = constant([\n      defaulted$1('selectFirst', true),\n      onHandler('onChangeTab'),\n      onHandler('onDismissTab'),\n      defaulted$1('tabs', []),\n      field$1('tabSectionBehaviours', [])\n    ]);\n    var barPart = required({\n      factory: Tabbar,\n      schema: [\n        strict$1('dom'),\n        strictObjOf('markers', [\n          strict$1('tabClass'),\n          strict$1('selectedClass')\n        ])\n      ],\n      name: 'tabbar',\n      defaults: function (detail) {\n        return { tabs: detail.tabs };\n      }\n    });\n    var viewPart = required({\n      factory: Tabview,\n      name: 'tabview'\n    });\n    var parts$h = constant([\n      barPart,\n      viewPart\n    ]);\n\n    var factory$m = function (detail, components, _spec, _externals) {\n      var changeTab$1 = function (button) {\n        var tabValue = Representing.getValue(button);\n        getPart(button, detail, 'tabview').each(function (tabview) {\n          var tabWithValue = find(detail.tabs, function (t) {\n            return t.value === tabValue;\n          });\n          tabWithValue.each(function (tabData) {\n            var panel = tabData.view();\n            getOpt(button.element, 'id').each(function (id) {\n              set$1(tabview.element, 'aria-labelledby', id);\n            });\n            Replacing.set(tabview, panel);\n            detail.onChangeTab(tabview, button, panel);\n          });\n        });\n      };\n      var changeTabBy = function (section, byPred) {\n        getPart(section, detail, 'tabbar').each(function (tabbar) {\n          byPred(tabbar).each(emitExecute);\n        });\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$c(detail.tabSectionBehaviours),\n        events: derive(flatten([\n          detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n              changeTabBy(section, Highlighting.getFirst);\n            })] : [],\n          [\n            run(changeTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              changeTab$1(button);\n            }),\n            run(dismissTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              detail.onDismissTab(section, button);\n            })\n          ]\n        ])),\n        apis: {\n          getViewItems: function (section) {\n            return getPart(section, detail, 'tabview').map(function (tabview) {\n              return Replacing.contents(tabview);\n            }).getOr([]);\n          },\n          showTab: function (section, tabKey) {\n            var getTabIfNotActive = function (tabbar) {\n              var candidates = Highlighting.getCandidates(tabbar);\n              var optTab = find(candidates, function (c) {\n                return Representing.getValue(c) === tabKey;\n              });\n              return optTab.filter(function (tab) {\n                return !Highlighting.isHighlighted(tabbar, tab);\n              });\n            };\n            changeTabBy(section, getTabIfNotActive);\n          }\n        }\n      };\n    };\n    var TabSection = composite$1({\n      name: 'TabSection',\n      configFields: schema$z(),\n      partFields: parts$h(),\n      factory: factory$m,\n      apis: {\n        getViewItems: function (apis, component) {\n          return apis.getViewItems(component);\n        },\n        showTab: function (apis, component, tabKey) {\n          apis.showTab(component, tabKey);\n        }\n      }\n    });\n\n    var measureHeights = function (allTabs, tabview, tabviewComp) {\n      return map(allTabs, function (_tab, i) {\n        Replacing.set(tabviewComp, allTabs[i].view());\n        var rect = tabview.dom.getBoundingClientRect();\n        Replacing.set(tabviewComp, []);\n        return rect.height;\n      });\n    };\n    var getMaxHeight = function (heights) {\n      return head(sort(heights, function (a, b) {\n        if (a > b) {\n          return -1;\n        } else if (a < b) {\n          return +1;\n        } else {\n          return 0;\n        }\n      }));\n    };\n    var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n      var documentElement$1 = documentElement(dialog).dom;\n      var rootElm = ancestor$2(dialog, '.tox-dialog-wrap').getOr(dialog);\n      var isFixed = get$4(rootElm, 'position') === 'fixed';\n      var maxHeight;\n      if (isFixed) {\n        maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n      } else {\n        maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n      }\n      var tabviewHeight = get$6(tabview);\n      var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$7(tablist);\n      var currentTabHeight = isTabListBeside ? Math.max(get$6(tablist), tabviewHeight) : tabviewHeight;\n      var dialogTopMargin = parseInt(get$4(dialog, 'margin-top'), 10) || 0;\n      var dialogBottomMargin = parseInt(get$4(dialog, 'margin-bottom'), 10) || 0;\n      var dialogHeight = get$6(dialog) + dialogTopMargin + dialogBottomMargin;\n      var chromeHeight = dialogHeight - currentTabHeight;\n      return maxHeight - chromeHeight;\n    };\n    var showTab = function (allTabs, comp) {\n      head(allTabs).each(function (tab) {\n        return TabSection.showTab(comp, tab.value);\n      });\n    };\n    var setTabviewHeight = function (tabview, height) {\n      set$2(tabview, 'height', height + 'px');\n      if (!detect$3().browser.isIE()) {\n        set$2(tabview, 'flex-basis', height + 'px');\n      } else {\n        remove$6(tabview, 'flex-basis');\n      }\n    };\n    var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n      ancestor$2(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n        descendant$1(dialog, '[role=\"tablist\"]').each(function (tablist) {\n          maxTabHeight.get().map(function (height) {\n            set$2(tabview, 'height', '0');\n            set$2(tabview, 'flex-basis', '0');\n            return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n          }).each(function (height) {\n            setTabviewHeight(tabview, height);\n          });\n        });\n      });\n    };\n    var getTabview = function (dialog) {\n      return descendant$1(dialog, '[role=\"tabpanel\"]');\n    };\n    var setMode = function (allTabs) {\n      var smartTabHeight = function () {\n        var maxTabHeight = Cell(Optional.none());\n        var extraEvents = [\n          runOnAttached(function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              set$2(tabview, 'visibility', 'hidden');\n              comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n                var heights = measureHeights(allTabs, tabview, tabviewComp);\n                var maxTabHeightOpt = getMaxHeight(heights);\n                maxTabHeight.set(maxTabHeightOpt);\n              });\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n              remove$6(tabview, 'visibility');\n              showTab(allTabs, comp);\n              global$2.requestAnimationFrame(function () {\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              });\n            });\n          }),\n          run(windowResize(), function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n            });\n          }),\n          run(formResizeEvent, function (comp, _se) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              var oldFocus = active();\n              set$2(tabview, 'visibility', 'hidden');\n              var oldHeight = getRaw(tabview, 'height').map(function (h) {\n                return parseInt(h, 10);\n              });\n              remove$6(tabview, 'height');\n              remove$6(tabview, 'flex-basis');\n              var newHeight = tabview.dom.getBoundingClientRect().height;\n              var hasGrown = oldHeight.forall(function (h) {\n                return newHeight > h;\n              });\n              if (hasGrown) {\n                maxTabHeight.set(Optional.from(newHeight));\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              } else {\n                oldHeight.each(function (h) {\n                  setTabviewHeight(tabview, h);\n                });\n              }\n              remove$6(tabview, 'visibility');\n              oldFocus.each(focus$1);\n            });\n          })\n        ];\n        var selectFirst = false;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      var naiveTabHeight = function () {\n        var extraEvents = [];\n        var selectFirst = true;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      return {\n        smartTabHeight: smartTabHeight,\n        naiveTabHeight: naiveTabHeight\n      };\n    };\n\n    var SendDataToSectionChannel = 'send-data-to-section';\n    var SendDataToViewChannel = 'send-data-to-view';\n    var renderTabPanel = function (spec, backstage) {\n      var storedValue = Cell({});\n      var updateDataWithForm = function (form) {\n        var formData = Representing.getValue(form);\n        var validData = toValidValues(formData).getOr({});\n        var currentData = storedValue.get();\n        var newData = deepMerge(currentData, validData);\n        storedValue.set(newData);\n      };\n      var setDataOnForm = function (form) {\n        var tabData = storedValue.get();\n        Representing.setValue(form, tabData);\n      };\n      var oldTab = Cell(null);\n      var allTabs = map(spec.tabs, function (tab) {\n        return {\n          value: tab.name,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__body-nav-item'],\n            innerHtml: backstage.shared.providers.translate(tab.title)\n          },\n          view: function () {\n            return [Form.sketch(function (parts) {\n                return {\n                  dom: {\n                    tag: 'div',\n                    classes: ['tox-form']\n                  },\n                  components: map(tab.items, function (item) {\n                    return interpretInForm(parts, item, backstage);\n                  }),\n                  formBehaviours: derive$1([\n                    Keying.config({\n                      mode: 'acyclic',\n                      useTabstopAt: not(isPseudoStop)\n                    }),\n                    config('TabView.form.events', [\n                      runOnAttached(setDataOnForm),\n                      runOnDetached(updateDataWithForm)\n                    ]),\n                    Receiving.config({\n                      channels: wrapAll$1([\n                        {\n                          key: SendDataToSectionChannel,\n                          value: { onReceive: updateDataWithForm }\n                        },\n                        {\n                          key: SendDataToViewChannel,\n                          value: { onReceive: setDataOnForm }\n                        }\n                      ])\n                    })\n                  ])\n                };\n              })];\n          }\n        };\n      });\n      var tabMode = setMode(allTabs).smartTabHeight;\n      return TabSection.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        onChangeTab: function (section, button, _viewItems) {\n          var name = Representing.getValue(button);\n          emitWith(section, formTabChangeEvent, {\n            name: name,\n            oldName: oldTab.get()\n          });\n          oldTab.set(name);\n        },\n        tabs: allTabs,\n        components: [\n          TabSection.parts.tabbar({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-nav']\n            },\n            components: [Tabbar.parts.tabs({})],\n            markers: {\n              tabClass: 'tox-tab',\n              selectedClass: 'tox-dialog__body-nav-item--active'\n            },\n            tabbarBehaviours: derive$1([Tabstopping.config({})])\n          }),\n          TabSection.parts.tabview({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            }\n          })\n        ],\n        selectFirst: tabMode.selectFirst,\n        tabSectionBehaviours: derive$1([\n          config('tabpanel', tabMode.extraEvents),\n          Keying.config({ mode: 'acyclic' }),\n          Composing.config({\n            find: function (comp) {\n              return head(TabSection.getViewItems(comp));\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (tsection) {\n                tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n                return storedValue.get();\n              },\n              setValue: function (tsection, value) {\n                storedValue.set(value);\n                tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n              }\n            }\n          })\n        ])\n      });\n    };\n\n    var dialogChannel = generate$1('update-dialog');\n    var titleChannel = generate$1('update-title');\n    var bodyChannel = generate$1('update-body');\n    var footerChannel = generate$1('update-footer');\n    var bodySendMessageChannel = generate$1('body-send-message');\n\n    var renderBody = function (spec, id, backstage, ariaAttrs) {\n      var renderComponents = function (incoming) {\n        switch (incoming.body.type) {\n        case 'tabpanel': {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n        default: {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n        }\n      };\n      var updateState = function (_comp, incoming) {\n        return Optional.some({\n          isTabPanel: function () {\n            return incoming.body.type === 'tabpanel';\n          }\n        });\n      };\n      var ariaAttributes = { 'aria-live': 'polite' };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js'],\n          attributes: __assign(__assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({})), ariaAttrs ? ariaAttributes : {})\n        },\n        components: [],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          Reflecting.config({\n            channel: bodyChannel,\n            updateState: updateState,\n            renderComponents: renderComponents,\n            initialData: spec\n          })\n        ])\n      };\n    };\n    var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n      return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n    };\n    var renderModalBody = function (spec, backstage) {\n      var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n      return ModalDialog.parts.body(bodySpec);\n    };\n    var renderIframeBody = function (spec) {\n      var bodySpec = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-iframe']\n            },\n            components: [craft({\n                dom: {\n                  tag: 'iframe',\n                  attributes: { src: spec.url }\n                },\n                behaviours: derive$1([\n                  Tabstopping.config({}),\n                  Focusing.config({})\n                ])\n              })]\n          }],\n        behaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          })])\n      };\n      return ModalDialog.parts.body(bodySpec);\n    };\n\n    var isTouch = global$8.deviceType.isTouch();\n    var hiddenHeader = function (title, close) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: { display: 'none' },\n          classes: ['tox-dialog__header']\n        },\n        components: [\n          title,\n          close\n        ]\n      };\n    };\n    var pClose = function (onClose, providersBackstage) {\n      return ModalDialog.parts.close(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close')\n          }\n        },\n        action: onClose,\n        buttonBehaviours: derive$1([Tabstopping.config({})])\n      }));\n    };\n    var pUntitled = function () {\n      return ModalDialog.parts.title({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          innerHtml: '',\n          styles: { display: 'none' }\n        }\n      });\n    };\n    var pBodyMessage = function (message, providersBackstage) {\n      return ModalDialog.parts.body({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [{ dom: fromHtml$2('<p>' + providersBackstage.translate(message) + '</p>') }]\n          }]\n      });\n    };\n    var pFooter = function (buttons) {\n      return ModalDialog.parts.footer({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer']\n        },\n        components: buttons\n      });\n    };\n    var pFooterGroup = function (startButtons, endButtons) {\n      return [\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-start']\n          },\n          components: startButtons\n        }),\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-end']\n          },\n          components: endButtons\n        })\n      ];\n    };\n    var renderDialog = function (spec) {\n      var _a;\n      var dialogClass = 'tox-dialog';\n      var blockerClass = dialogClass + '-wrap';\n      var blockerBackdropClass = blockerClass + '__backdrop';\n      var scrollLockClass = dialogClass + '__disable-scroll';\n      return ModalDialog.sketch({\n        lazySink: spec.lazySink,\n        onEscape: function (comp) {\n          spec.onEscape(comp);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem);\n        },\n        dom: {\n          tag: 'div',\n          classes: [dialogClass].concat(spec.extraClasses),\n          styles: __assign({ position: 'relative' }, spec.extraStyles)\n        },\n        components: __spreadArrays([\n          spec.header,\n          spec.body\n        ], spec.footer.toArray()),\n        parts: {\n          blocker: {\n            dom: fromHtml$2('<div class=\"' + blockerClass + '\"></div>'),\n            components: [{\n                dom: {\n                  tag: 'div',\n                  classes: isTouch ? [\n                    blockerBackdropClass,\n                    blockerBackdropClass + '--opaque'\n                  ] : [blockerBackdropClass]\n                }\n              }]\n          }\n        },\n        dragBlockClass: blockerClass,\n        modalBehaviours: derive$1(__spreadArrays([\n          Focusing.config({}),\n          config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          config('scroll-lock', [\n            runOnAttached(function () {\n              add$2(body(), scrollLockClass);\n            }),\n            runOnDetached(function () {\n              remove$4(body(), scrollLockClass);\n            })\n          ])\n        ], spec.extraBehaviours)),\n        eventOrder: __assign((_a = {}, _a[execute()] = ['dialog-events'], _a[attachedToDom()] = [\n          'scroll-lock',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'scroll-lock'\n        ], _a), spec.eventOrder)\n      });\n    };\n\n    var renderClose = function (providersBackstage) {\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close'),\n            'title': providersBackstage.translate('Close')\n          }\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-icon'],\n              innerHtml: get$d('close', providersBackstage.icons)\n            }\n          }],\n        action: function (comp) {\n          emit(comp, formCancelEvent);\n        }\n      });\n    };\n    var renderTitle = function (spec, id, providersBackstage) {\n      var renderComponents = function (data) {\n        return [text(providersBackstage.translate(data.title))];\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          attributes: __assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({}))\n        },\n        components: renderComponents(spec),\n        behaviours: derive$1([Reflecting.config({\n            channel: titleChannel,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderDragHandle = function () {\n      return { dom: fromHtml$2('<div class=\"tox-dialog__draghandle\"></div>') };\n    };\n    var renderInlineHeader = function (spec, titleId, providersBackstage) {\n      return Container.sketch({\n        dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n        components: [\n          renderTitle(spec, Optional.some(titleId), providersBackstage),\n          renderDragHandle(),\n          renderClose(providersBackstage)\n        ],\n        containerBehaviours: derive$1([Dragging.config({\n            mode: 'mouse',\n            blockerClass: 'blocker',\n            getTarget: function (handle) {\n              return closest$3(handle, '[role=\"dialog\"]').getOrDie();\n            },\n            snaps: {\n              getSnapPoints: function () {\n                return [];\n              },\n              leftAttr: 'data-drag-left',\n              topAttr: 'data-drag-top'\n            }\n          })])\n      });\n    };\n    var renderModalHeader = function (spec, providersBackstage) {\n      var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n      var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n      var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n      var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n      return Container.sketch({\n        dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n        components: components\n      });\n    };\n\n    var getHeader = function (title, backstage) {\n      return renderModalHeader({\n        title: backstage.shared.providers.translate(title),\n        draggable: backstage.dialog.isDraggableModal()\n      }, backstage.shared.providers);\n    };\n    var getEventExtras = function (lazyDialog, extra) {\n      return {\n        onClose: function () {\n          return extra.closeWindow();\n        },\n        onBlock: function (blockEvent) {\n          ModalDialog.setBusy(lazyDialog(), function (d, bs) {\n            return {\n              dom: {\n                tag: 'div',\n                classes: ['tox-dialog__busy-spinner'],\n                attributes: { 'aria-label': blockEvent.message },\n                styles: {\n                  left: '0px',\n                  right: '0px',\n                  bottom: '0px',\n                  top: '0px',\n                  position: 'absolute'\n                }\n              },\n              behaviours: bs,\n              components: [{ dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }]\n            };\n          });\n        },\n        onUnblock: function () {\n          ModalDialog.setIdle(lazyDialog());\n        }\n      };\n    };\n    var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n      var _a;\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      return build$1(renderDialog(__assign(__assign({}, spec), {\n        lazySink: backstage.shared.getSink,\n        extraBehaviours: __spreadArrays([\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: initialData\n          }),\n          RepresentingConfigs.memory({})\n        ], spec.extraBehaviours),\n        onEscape: function (comp) {\n          emit(comp, formCancelEvent);\n        },\n        dialogEvents: dialogEvents,\n        eventOrder: (_a = {}, _a[receive()] = [\n          'reflecting',\n          'receiving'\n        ], _a[attachedToDom()] = [\n          'scroll-lock',\n          'reflecting',\n          'messages',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'messages',\n          'reflecting',\n          'scroll-lock'\n        ], _a)\n      })));\n    };\n    var mapMenuButtons = function (buttons) {\n      var mapItems = function (button) {\n        var items = map(button.items, function (item) {\n          var cell = Cell(false);\n          return __assign(__assign({}, item), { storage: cell });\n        });\n        return __assign(__assign({}, button), { items: items });\n      };\n      return map(buttons, function (button) {\n        if (button.type === 'menu') {\n          return mapItems(button);\n        }\n        return button;\n      });\n    };\n    var extractCellsToObject = function (buttons) {\n      return foldl(buttons, function (acc, button) {\n        if (button.type === 'menu') {\n          var menuButton = button;\n          return foldl(menuButton.items, function (innerAcc, item) {\n            innerAcc[item.name] = item.storage;\n            return innerAcc;\n          }, acc);\n        }\n        return acc;\n      }, {});\n    };\n\n    var initCommonEvents = function (fireApiEvent, extras) {\n      return [\n        runWithTarget(focusin(), onFocus$1),\n        fireApiEvent(formCloseEvent, function (_api, spec) {\n          extras.onClose();\n          spec.onClose();\n        }),\n        fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n          spec.onCancel(api);\n          emit(self, formCloseEvent);\n        }),\n        run(formUnblockEvent, function (_c, _se) {\n          return extras.onUnblock();\n        }),\n        run(formBlockEvent, function (_c, se) {\n          return extras.onBlock(se.event);\n        })\n      ];\n    };\n    var initUrlDialog = function (getInstanceApi, extras) {\n      var fireApiEvent = function (eventName, f) {\n        return run(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialog) {\n          f(currentDialog, c);\n        });\n      };\n      return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formActionEvent, function (api, spec, event) {\n          spec.onAction(api, { name: event.name });\n        })]);\n    };\n    var initDialog = function (getInstanceApi, extras, getSink) {\n      var fireApiEvent = function (eventName, f) {\n        return run(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialogInit) {\n          f(currentDialogInit.internalDialog, c);\n        });\n      };\n      return __spreadArrays(initCommonEvents(fireApiEvent, extras), [\n        fireApiEvent(formSubmitEvent, function (api, spec) {\n          return spec.onSubmit(api);\n        }),\n        fireApiEvent(formChangeEvent, function (api, spec, event) {\n          spec.onChange(api, { name: event.name });\n        }),\n        fireApiEvent(formActionEvent, function (api, spec, event, component) {\n          var focusIn = function () {\n            return Keying.focusIn(component);\n          };\n          var isDisabled = function (focused) {\n            return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n              return val === 'true';\n            });\n          };\n          var rootNode = getRootNode(component.element);\n          var current = active(rootNode);\n          spec.onAction(api, {\n            name: event.name,\n            value: event.value\n          });\n          active(rootNode).fold(focusIn, function (focused) {\n            if (isDisabled(focused)) {\n              focusIn();\n            } else if (current.exists(function (cur) {\n                return contains$2(focused, cur) && isDisabled(cur);\n              })) {\n              focusIn();\n            } else {\n              getSink().toOptional().filter(function (sink) {\n                return !contains$2(sink.element, focused);\n              }).each(focusIn);\n            }\n          });\n        }),\n        fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n          spec.onTabChange(api, {\n            newTabName: event.name,\n            oldTabName: event.oldName\n          });\n        }),\n        runOnDetached(function (component) {\n          var api = getInstanceApi();\n          Representing.setValue(component, api.getData());\n        })\n      ]);\n    };\n    var SilverDialogEvents = {\n      initUrlDialog: initUrlDialog,\n      initDialog: initDialog\n    };\n\n    var makeButton = function (button, backstage) {\n      return renderFooterButton(button, button.type, backstage);\n    };\n    var lookup$2 = function (compInSystem, footerButtons, buttonName) {\n      return find(footerButtons, function (button) {\n        return button.name === buttonName;\n      }).bind(function (memButton) {\n        return memButton.memento.getOpt(compInSystem);\n      });\n    };\n    var renderComponents = function (_data, state) {\n      var footerButtons = state.map(function (s) {\n        return s.footerButtons;\n      }).getOr([]);\n      var buttonGroups = partition(footerButtons, function (button) {\n        return button.align === 'start';\n      });\n      var makeGroup = function (edge, buttons) {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-' + edge]\n          },\n          components: map(buttons, function (button) {\n            return button.memento.asSpec();\n          })\n        });\n      };\n      var startButtons = makeGroup('start', buttonGroups.pass);\n      var endButtons = makeGroup('end', buttonGroups.fail);\n      return [\n        startButtons,\n        endButtons\n      ];\n    };\n    var renderFooter = function (initSpec, backstage) {\n      var updateState = function (_comp, data) {\n        var footerButtons = map(data.buttons, function (button) {\n          var memButton = record(makeButton(button, backstage));\n          return {\n            name: button.name,\n            align: button.align,\n            memento: memButton\n          };\n        });\n        var lookupByName = function (compInSystem, buttonName) {\n          return lookup$2(compInSystem, footerButtons, buttonName);\n        };\n        return Optional.some({\n          lookupByName: lookupByName,\n          footerButtons: footerButtons\n        });\n      };\n      return {\n        dom: fromHtml$2('<div class=\"tox-dialog__footer\"></div>'),\n        components: [],\n        behaviours: derive$1([Reflecting.config({\n            channel: footerChannel,\n            initialData: initSpec,\n            updateState: updateState,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderInlineFooter = function (initSpec, backstage) {\n      return renderFooter(initSpec, backstage);\n    };\n    var renderModalFooter = function (initSpec, backstage) {\n      return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n    };\n\n    var getCompByName = function (access, name) {\n      var root = access.getRoot();\n      if (root.getSystem().isConnected()) {\n        var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n        return Form.getField(form_1, name).fold(function () {\n          var footer = access.getFooter();\n          var footerState = Reflecting.getState(footer);\n          return footerState.get().bind(function (f) {\n            return f.lookupByName(form_1, name);\n          });\n        }, function (comp) {\n          return Optional.some(comp);\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var validateData = function (access, data) {\n      var root = access.getRoot();\n      return Reflecting.getState(root).get().map(function (dialogState) {\n        return getOrDie(asRaw('data', dialogState.dataValidator, data));\n      }).getOr(data);\n    };\n    var getDialogApi = function (access, doRedial, menuItemStates) {\n      var withRoot = function (f) {\n        var root = access.getRoot();\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var getData = function () {\n        var root = access.getRoot();\n        var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n        var representedValues = Representing.getValue(valueComp);\n        var menuItemCurrentState = map$2(menuItemStates, function (cell) {\n          return cell.get();\n        });\n        return __assign(__assign({}, representedValues), menuItemCurrentState);\n      };\n      var setData = function (newData) {\n        withRoot(function (_) {\n          var prevData = instanceApi.getData();\n          var mergedData = __assign(__assign({}, prevData), newData);\n          var newInternalData = validateData(access, mergedData);\n          var form = access.getFormWrapper();\n          Representing.setValue(form, newInternalData);\n          each$1(menuItemStates, function (v, k) {\n            if (has(mergedData, k)) {\n              v.set(mergedData[k]);\n            }\n          });\n        });\n      };\n      var disable = function (name) {\n        getCompByName(access, name).each(Disabling.disable);\n      };\n      var enable = function (name) {\n        getCompByName(access, name).each(Disabling.enable);\n      };\n      var focus = function (name) {\n        getCompByName(access, name).each(Focusing.focus);\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var showTab = function (name) {\n        withRoot(function (_) {\n          var body = access.getBody();\n          var bodyState = Reflecting.getState(body);\n          if (bodyState.get().exists(function (b) {\n              return b.isTabPanel();\n            })) {\n            Composing.getCurrent(body).each(function (tabSection) {\n              TabSection.showTab(tabSection, name);\n            });\n          }\n        });\n      };\n      var redial = function (d) {\n        withRoot(function (root) {\n          var dialogInit = doRedial(d);\n          root.getSystem().broadcastOn([dialogChannel], dialogInit);\n          root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n          instanceApi.setData(dialogInit.initialData);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var instanceApi = {\n        getData: getData,\n        setData: setData,\n        disable: disable,\n        enable: enable,\n        focus: focus,\n        block: block,\n        unblock: unblock,\n        showTab: showTab,\n        redial: redial,\n        close: close\n      };\n      return instanceApi;\n    };\n\n    var renderDialog$1 = function (dialogInit, extra, backstage) {\n      var header = getHeader(dialogInit.internalDialog.title, backstage);\n      var body = renderModalBody({ body: dialogInit.internalDialog.body }, backstage);\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var footer = renderModalFooter({ buttons: storagedMenuButtons }, backstage);\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, extra), backstage.shared.getSink);\n      var dialogSize = dialogInit.internalDialog.size !== 'normal' ? dialogInit.internalDialog.size === 'large' ? ['tox-dialog--width-lg'] : ['tox-dialog--width-md'] : [];\n      var spec = {\n        header: header,\n        body: body,\n        footer: Optional.some(footer),\n        extraClasses: dialogSize,\n        extraBehaviours: [],\n        extraStyles: {}\n      };\n      var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n      var modalAccess = function () {\n        var getForm = function () {\n          var outerForm = ModalDialog.getBody(dialog);\n          return Composing.getCurrent(outerForm).getOr(outerForm);\n        };\n        return {\n          getRoot: function () {\n            return dialog;\n          },\n          getBody: function () {\n            return ModalDialog.getBody(dialog);\n          },\n          getFooter: function () {\n            return ModalDialog.getFooter(dialog);\n          },\n          getFormWrapper: getForm\n        };\n      }();\n      var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n      var _a, _b;\n      var dialogLabelId = generate$1('dialog-label');\n      var dialogContentId = generate$1('dialog-content');\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      var memHeader = record(renderInlineHeader({\n        title: dialogInit.internalDialog.title,\n        draggable: true\n      }, dialogLabelId, backstage.shared.providers));\n      var memBody = record(renderInlineBody({ body: dialogInit.internalDialog.body }, dialogContentId, backstage, ariaAttrs));\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var memFooter = record(renderInlineFooter({ buttons: storagedMenuButtons }, backstage));\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, {\n        onBlock: function () {\n        },\n        onUnblock: function () {\n        },\n        onClose: function () {\n          return extra.closeWindow();\n        }\n      }, backstage.shared.getSink);\n      var dialog = build$1({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-dialog',\n            'tox-dialog-inline'\n          ],\n          attributes: (_a = { role: 'dialog' }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = '' + dialogContentId, _a)\n        },\n        eventOrder: (_b = {}, _b[receive()] = [\n          Reflecting.name(),\n          Receiving.name()\n        ], _b[execute()] = ['execute-on-form'], _b[attachedToDom()] = [\n          'reflecting',\n          'execute-on-form'\n        ], _b),\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'cyclic',\n            onEscape: function (c) {\n              emit(c, formCloseEvent);\n              return Optional.some(true);\n            },\n            useTabstopAt: function (elem) {\n              return !isPseudoStop(elem) && (name(elem) !== 'button' || get$2(elem, 'disabled') !== 'disabled');\n            }\n          }),\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: dialogInit\n          }),\n          Focusing.config({}),\n          config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          RepresentingConfigs.memory({})\n        ]),\n        components: [\n          memHeader.asSpec(),\n          memBody.asSpec(),\n          memFooter.asSpec()\n        ]\n      });\n      var instanceApi = getDialogApi({\n        getRoot: function () {\n          return dialog;\n        },\n        getFooter: function () {\n          return memFooter.get(dialog);\n        },\n        getBody: function () {\n          return memBody.get(dialog);\n        },\n        getFormWrapper: function () {\n          var body = memBody.get(dialog);\n          return Composing.getCurrent(body).getOr(body);\n        }\n      }, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var global$g = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n    var getUrlDialogApi = function (root) {\n      var withRoot = function (f) {\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var sendMessage = function (data) {\n        withRoot(function (root) {\n          root.getSystem().broadcastOn([bodySendMessageChannel], data);\n        });\n      };\n      return {\n        block: block,\n        unblock: unblock,\n        close: close,\n        sendMessage: sendMessage\n      };\n    };\n\n    var SUPPORTED_MESSAGE_ACTIONS = [\n      'insertContent',\n      'setContent',\n      'execCommand',\n      'close',\n      'block',\n      'unblock'\n    ];\n    var isSupportedMessage = function (data) {\n      return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n    };\n    var isCustomMessage = function (data) {\n      return !isSupportedMessage(data) && isObject(data) && has(data, 'mceAction');\n    };\n    var handleMessage = function (editor, api, data) {\n      switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n      case 'close':\n        api.close();\n        break;\n      case 'block':\n        api.block(data.message);\n        break;\n      case 'unblock':\n        api.unblock();\n        break;\n      }\n    };\n    var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n      var _a;\n      var header = getHeader(internalDialog.title, backstage);\n      var body = renderIframeBody(internalDialog);\n      var footer = internalDialog.buttons.bind(function (buttons) {\n        if (buttons.length === 0) {\n          return Optional.none();\n        } else {\n          return Optional.some(renderModalFooter({ buttons: buttons }, backstage));\n        }\n      });\n      var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, extra));\n      var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n        return {};\n      }, function (height) {\n        return {\n          'height': height + 'px',\n          'max-height': height + 'px'\n        };\n      })), internalDialog.width.fold(function () {\n        return {};\n      }, function (width) {\n        return {\n          'width': width + 'px',\n          'max-width': width + 'px'\n        };\n      }));\n      var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n      var iframeUri = new global$g(internalDialog.url, { base_uri: new global$g(window.location.href) });\n      var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n      var messageHandlerUnbinder = Cell(Optional.none());\n      var extraBehaviours = [\n        config('messages', [\n          runOnAttached(function () {\n            var unbind = bind$3(SugarElement.fromDom(window), 'message', function (e) {\n              if (iframeUri.isSameOrigin(new global$g(e.raw.origin))) {\n                var data = e.raw.data;\n                if (isSupportedMessage(data)) {\n                  handleMessage(editor, instanceApi, data);\n                } else if (isCustomMessage(data)) {\n                  internalDialog.onMessage(instanceApi, data);\n                }\n              }\n            });\n            messageHandlerUnbinder.set(Optional.some(unbind));\n          }),\n          runOnDetached(function () {\n            messageHandlerUnbinder.get().each(function (unbinder) {\n              return unbinder.unbind();\n            });\n          })\n        ]),\n        Receiving.config({\n          channels: (_a = {}, _a[bodySendMessageChannel] = {\n            onReceive: function (comp, data) {\n              descendant$1(comp.element, 'iframe').each(function (iframeEle) {\n                var iframeWin = iframeEle.dom.contentWindow;\n                iframeWin.postMessage(data, iframeDomain);\n              });\n            }\n          }, _a)\n        })\n      ];\n      var spec = {\n        header: header,\n        body: body,\n        footer: footer,\n        extraClasses: classes,\n        extraBehaviours: extraBehaviours,\n        extraStyles: styles\n      };\n      var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n      var instanceApi = getUrlDialogApi(dialog);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var setup$c = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function () {\n          ModalDialog.hide(alertDialog);\n          callback();\n        };\n        var memFooterClose = record(renderFooterButton({\n          name: 'close-alert',\n          text: 'OK',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage));\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n        var alertDialog = build$1(renderDialog({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n          onEscape: closeDialog,\n          extraClasses: ['tox-alert-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [run(formCancelEvent, closeDialog)],\n          eventOrder: {}\n        }));\n        ModalDialog.show(alertDialog);\n        var footerCloseButton = memFooterClose.get(alertDialog);\n        Focusing.focus(footerCloseButton);\n      };\n      return { open: open };\n    };\n\n    var setup$d = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function (state) {\n          ModalDialog.hide(confirmDialog);\n          callback(state);\n        };\n        var memFooterYes = record(renderFooterButton({\n          name: 'yes',\n          text: 'Yes',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'submit', extras.backstage));\n        var footerNo = renderFooterButton({\n          name: 'no',\n          text: 'No',\n          primary: false,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage);\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(function () {\n          return closeDialog(false);\n        }, sharedBackstage.providers);\n        var confirmDialog = build$1(renderDialog({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [\n            footerNo,\n            memFooterYes.asSpec()\n          ]))),\n          onEscape: function () {\n            return closeDialog(false);\n          },\n          extraClasses: ['tox-confirm-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [\n            run(formCancelEvent, function () {\n              return closeDialog(false);\n            }),\n            run(formSubmitEvent, function () {\n              return closeDialog(true);\n            })\n          ],\n          eventOrder: {}\n        }));\n        ModalDialog.show(confirmDialog);\n        var footerYesButton = memFooterYes.get(confirmDialog);\n        Focusing.focus(footerYesButton);\n      };\n      return { open: open };\n    };\n\n    var validateData$1 = function (data, validator) {\n      return getOrDie(asRaw('data', validator, data));\n    };\n    var isAlertOrConfirmDialog = function (target) {\n      return closest$4(target, '.tox-alert-dialog') || closest$4(target, '.tox-confirm-dialog');\n    };\n    var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n      if (isStickyToolbar && isToolbarLocationTop) {\n        return [];\n      } else {\n        return [Docking.config({\n            contextual: {\n              lazyContext: function () {\n                return Optional.some(box(SugarElement.fromDom(editor.getContentAreaContainer())));\n              },\n              fadeInClass: 'tox-dialog-dock-fadein',\n              fadeOutClass: 'tox-dialog-dock-fadeout',\n              transitionClass: 'tox-dialog-dock-transition'\n            },\n            modes: ['top']\n          })];\n      }\n    };\n    var setup$e = function (extras) {\n      var backstage = extras.backstage;\n      var editor = extras.editor;\n      var isStickyToolbar$1 = isStickyToolbar(editor);\n      var alertDialog = setup$c(extras);\n      var confirmDialog = setup$d(extras);\n      var open = function (config, params, closeWindow) {\n        if (params !== undefined && params.inline === 'toolbar') {\n          return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n        } else if (params !== undefined && params.inline === 'cursor') {\n          return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n        } else {\n          return openModalDialog(config, closeWindow);\n        }\n      };\n      var openUrl = function (config, closeWindow) {\n        return openModalUrlDialog(config, closeWindow);\n      };\n      var openModalUrlDialog = function (config, closeWindow) {\n        var factory = function (contents) {\n          var dialog = renderUrlDialog(contents, {\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, editor, backstage);\n          ModalDialog.show(dialog.dialog);\n          return dialog.instanceApi;\n        };\n        return DialogManager.openUrl(factory, config);\n      };\n      var openModalDialog = function (config, closeWindow) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = internalInitialData;\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var dialog = renderDialog$1(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, backstage);\n          ModalDialog.show(dialog.dialog);\n          dialog.instanceApi.setData(initialData);\n          return dialog.instanceApi;\n        };\n        return DialogManager.open(factory, config);\n      };\n      var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = validateData$1(internalInitialData, dataValidator);\n          var inlineDialog = value$3();\n          var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var refreshDocking = function () {\n            return inlineDialog.on(function (dialog) {\n              InlineView.reposition(dialog);\n              Docking.refresh(dialog);\n            });\n          };\n          var dialogUi = renderInlineDialog(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              inlineDialog.on(InlineView.hide);\n              editor.off('ResizeEditor', refreshDocking);\n              inlineDialog.clear();\n              closeWindow(dialogUi.instanceApi);\n            }\n          }, backstage, ariaAttrs);\n          var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n            lazySink: backstage.shared.getSink,\n            dom: {\n              tag: 'div',\n              classes: []\n            },\n            fireDismissalEventInstead: {}\n          }, isToolbarLocationTop ? {} : { fireRepositionEventInstead: {} }), {\n            inlineBehaviours: derive$1(__spreadArrays([config('window-manager-inline-events', [run(dismissRequested(), function (_comp, _se) {\n                  emit(dialogUi.dialog, formCancelEvent);\n                })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop))),\n            isExtraPart: function (_comp, target) {\n              return isAlertOrConfirmDialog(target);\n            }\n          })));\n          inlineDialog.set(inlineDialogComp);\n          InlineView.showWithin(inlineDialogComp, anchor, premade$1(dialogUi.dialog), Optional.some(body()));\n          if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n            Docking.refresh(inlineDialogComp);\n            editor.on('ResizeEditor', refreshDocking);\n          }\n          dialogUi.instanceApi.setData(initialData);\n          Keying.focusIn(dialogUi.dialog);\n          return dialogUi.instanceApi;\n        };\n        return DialogManager.open(factory, config$1);\n      };\n      var confirm = function (message, callback) {\n        confirmDialog.open(message, function (state) {\n          callback(state);\n        });\n      };\n      var alert = function (message, callback) {\n        alertDialog.open(message, function () {\n          callback();\n        });\n      };\n      var close = function (instanceApi) {\n        instanceApi.close();\n      };\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        close: close,\n        confirm: confirm\n      };\n    };\n\n    function Theme () {\n      global$1.add('silver', function (editor) {\n        var _a = setup$b(editor), uiMothership = _a.uiMothership, backstage = _a.backstage, renderUI = _a.renderUI, getUi = _a.getUi;\n        Autocompleter.register(editor, backstage.shared);\n        var windowMgr = setup$e({\n          editor: editor,\n          backstage: backstage\n        });\n        return {\n          renderUI: renderUI,\n          getWindowManagerImpl: constant(windowMgr),\n          getNotificationManagerImpl: function () {\n            return NotificationManagerImpl(editor, { backstage: backstage }, uiMothership);\n          },\n          ui: getUi()\n        };\n      });\n    }\n\n    Theme();\n\n}());\n"]},"metadata":{},"sourceType":"script"}